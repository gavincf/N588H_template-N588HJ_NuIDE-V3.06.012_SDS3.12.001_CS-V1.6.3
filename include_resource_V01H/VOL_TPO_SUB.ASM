


;----------------------------------
.IF ( C_VOL_LOOP_ENABLE .EQ. 1)
BK0_VOL_ADJ:
	LDA	#C_BIT3
	BIT	<USER_FLAG20
	BNE	BK0_VOL_ADJ_S100
;up
	LDA	VOL_TPO_IDX
	AND	#0F0H
	CMP	#C_MAX_VOL_IDX-010H
	BCS	BK0_VOL_ADJ_S11
	
	CLC
	LDA	VOL_TPO_IDX
	ADC	#10H
	STA	VOL_TPO_IDX
	
	LDA	VOL_TPO_IDX
	AND	#0F0H
	CMP	#C_MAX_VOL_IDX-010H
	BCC	BK0_VOL_ADJ_S10

BK0_VOL_ADJ_S11:

	LDA	#C_BIT3
	TSB	<USER_FLAG20
	
	JSR	BK0_SET_VOL
	
;	MR_PLAY_SP CS_DA
	RTS
;	JMP	BK0_PLAY_NOTE_INCORRECT

BK0_VOL_ADJ_S10:

	JSR	BK0_SET_VOL
;	MR_PLAY_SP CS_DI_6K
	RTS
;	JMP	BK0_PLAY_NOTE_BEEP1

BK0_VOL_ADJ_S100:
	LDA	VOL_TPO_IDX
	AND	#0F0H
	BEQ	BK0_VOL_ADJ_S101
	
	SEC
	LDA	VOL_TPO_IDX
	SBC	#10H
	STA	VOL_TPO_IDX

	LDA	VOL_TPO_IDX
	AND	#0F0H
	BNE	BK0_VOL_ADJ_S110
	
BK0_VOL_ADJ_S101:

	LDA	#C_BIT3
	TRB	<USER_FLAG20
	
	JSR	BK0_SET_VOL
;	MR_PLAY_SP CS_DA
	RTS
;	JSR	BK0_PLAY_NOTE_INCORRECT

	RTS
	
BK0_VOL_ADJ_S110:
	
	JSR	BK0_SET_VOL
;	MR_PLAY_SP CS_DI_6K
	RTS
;	JMP	BK0_PLAY_NOTE_BEEP1


;--------------------------------
BK0_VOL_ADJ_WO_SP:
	LDA	#C_BIT3
	BIT	<USER_FLAG20
	BNE	BK0_VOL_ADJ_WO_SP_S100
;up
	LDA	VOL_TPO_IDX
	AND	#0F0H
	CMP	#C_MAX_VOL_IDX-010H
	BCS	BK0_VOL_ADJ_WO_SP_S11
	
	CLC
	LDA	VOL_TPO_IDX
	ADC	#10H
	STA	VOL_TPO_IDX
	
	LDA	VOL_TPO_IDX
	AND	#0F0H
	CMP	#C_MAX_VOL_IDX-010H
	BCC	BK0_VOL_ADJ_WO_SP_S10

BK0_VOL_ADJ_WO_SP_S11:
	LDA	#C_BIT3
	TSB	<USER_FLAG20

	JMP	BK0_SET_VOL

BK0_VOL_ADJ_WO_SP_S10:

	JMP	BK0_SET_VOL

BK0_VOL_ADJ_WO_SP_S100:
	LDA	VOL_TPO_IDX
	AND	#0F0H
	BEQ	BK0_VOL_ADJ_WO_SP_S101
	
	SEC
	LDA	VOL_TPO_IDX
	SBC	#10H
	STA	VOL_TPO_IDX

	LDA	VOL_TPO_IDX
	AND	#0F0H
	BNE	BK0_VOL_ADJ_WO_SP_S110
	
BK0_VOL_ADJ_WO_SP_S101:

	LDA	#C_BIT3
	TRB	<USER_FLAG20
	JMP	BK0_SET_VOL
	
BK0_VOL_ADJ_WO_SP_S110:
	
	JMP	BK0_SET_VOL
.ENDIF  ; C_VOL_LOOP_ENABLE


BK0_SET_VOL:
	LDA	VOL_TPO_IDX
	AND	#0F0H
	CMP	#0A0H
	BCC	BK0_SET_VOL_S10
	LDA	VOL_TPO_IDX
	AND	#0FH
	ORA	#C_DEFAULT_VOL_IDX
	STA	VOL_TPO_IDX
	LDA	#C_DEFAULT_VOL_IDX
BK0_SET_VOL_S10:
	LSR	A
	LSR	A
	LSR	A
	TAX
	JMP	(BK0_SET_VOL_TBL,X)
BK0_SET_VOL_TBL:
	DW	BK0_SET_VOL_000
	DW	BK0_SET_VOL_001
	DW	BK0_SET_VOL_002
	DW	BK0_SET_VOL_003
	DW	BK0_SET_VOL_004
	DW	BK0_SET_VOL_005
	DW	BK0_SET_VOL_006
	DW	BK0_SET_VOL_007
	DW	BK0_SET_VOL_008

BK0_SET_VOL_000:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_000_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_000_2
	
BK0_SET_VOL_000_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 20
.ENDIF
BK0_SET_VOL_000_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 1
	.ELSE
	SET_VOL1 1
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 1
	.ELSE
	SET_VOL2 1
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_001:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_001_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_001_2
	
BK0_SET_VOL_001_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 40
.ENDIF
BK0_SET_VOL_001_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 2
	.ELSE
	SET_VOL1 2
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 2
	.ELSE
	SET_VOL2 2
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_002:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_002_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_002_2
	
BK0_SET_VOL_002_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 60
.ENDIF
BK0_SET_VOL_002_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 3
	.ELSE
	SET_VOL1 3
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 3
	.ELSE
	SET_VOL2 3
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_003:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_003_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_003_2
	
BK0_SET_VOL_003_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 70
.ENDIF
BK0_SET_VOL_003_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 4
	.ELSE
	SET_VOL1 4
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 4
	.ELSE
	SET_VOL2 4
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_004:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_004_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_004_2
	
BK0_SET_VOL_004_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 80
.ENDIF
BK0_SET_VOL_004_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 5
	.ELSE
	SET_VOL1 5
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 5
	.ELSE
	SET_VOL2 5
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_005:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_005_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_005_2
	
BK0_SET_VOL_005_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 90
.ENDIF
BK0_SET_VOL_005_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 6
	.ELSE
	SET_VOL1 6
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 6
	.ELSE
	SET_VOL2 6
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_006:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_006_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_006_2
	
BK0_SET_VOL_006_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 100
.ENDIF
BK0_SET_VOL_006_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 7
	.ELSE
	SET_VOL1 7
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 7
	.ELSE
	SET_VOL2 7
	.ENDIF
.ENDIF
	RTS
BK0_SET_VOL_007:
BK0_SET_VOL_008:
	MR_DET_MUTE
	BNE	BK0_SET_VOL_007_1
	
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 00
.ENDIF
	BRA	BK0_SET_VOL_007_2
	
BK0_SET_VOL_007_1:
.IF	(C_MS_ENABLE .EQ. 1)
	SET_VOLM 127
.ENDIF
BK0_SET_VOL_007_2:
.IF	(C_SPCH1_ENABLE .EQ. 1)
	.IF ( C_SPCH1_LP8 .EQ. 1 )
	SET_VOL1_LP8 8
	.ELSE
	SET_VOL1 8
	.ENDIF
.ENDIF
.IF	(C_SPCH2_ENABLE .EQ. 1)
	.IF ( C_SPCH2_LP8 .EQ. 1 )
	SET_VOL2_LP8 8
	.ELSE
	SET_VOL2 8
	.ENDIF
.ENDIF
	RTS

