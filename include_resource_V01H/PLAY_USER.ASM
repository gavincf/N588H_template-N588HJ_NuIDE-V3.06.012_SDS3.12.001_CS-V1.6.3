



.IFDEF C_GROUP_EN
;==============================
BK0_PLAY_GROUP_RANDOM:
;random
	STZ	SOUND_NO ;temp used

	LDX	<R_GROUP_NO
	LDA	T_GROUP_MAX,X
	CMP	#1
	BNE	BK0_PLAY_GROUP_RANDOM_S01
; ONLY 1 sound
	LDA	#0
	STA	REG_EA
	BRA	BK0_PLAY_GROUP_RANDOM_S10
	
BK0_PLAY_GROUP_RANDOM_S01:
	STA	REG_EA
	JSR	BK0_GET_RANDOM0
	LDA	R_GROUP_BUF,X
	CMP	<REG_EA
	BNE	BK0_PLAY_GROUP_RANDOM_S10
;
BK0_PLAY_GROUP_RANDOM_NEXT:
	LDX	<R_GROUP_NO
	INC	<REG_EA
	LDA	T_GROUP_MAX,X
	CMP	<REG_EA
	BNE	BK0_PLAY_GROUP_RANDOM_S10
	STZ	<REG_EA
	
BK0_PLAY_GROUP_RANDOM_S10:
	LDA	<REG_EA
	STA	R_GROUP_BUF,X ; STORE TO GROUP BUF
	TAY
;

	LDA	<R_GROUP_NO
	ASL	A
	TAX
	LDA	T_SPEECH_GROUP,X ; EQU/SPEECH TABLE
	STA	<P0_ADDR
	INX
	LDA	T_SPEECH_GROUP,X; EQU/SPEECH TABLE
	STA	<P0_ADDR+1
	
	MR_TEST_GAPTIME_FLAG
	BEQ	BK0_PLAY_GROUP_RANDOM_S12
	MR_CLR_GAPTIME_FLAG

; TIMEOUT
	INC	SOUND_NO
	LDA	SOUND_NO
	CMP	#2
	BCS	BK0_PLAY_GROUP_RANDOM_S40
	
BK0_PLAY_GROUP_RANDOM_S12:
	LDA	(<P0_ADDR),Y

	STA	SOUND_NO
	
	CMP	SPCH1_SOUND_NO
	BEQ	BK0_PLAY_GROUP_RANDOM_NEXT; same with last time

BK0_PLAY_GROUP_RANDOM_S13:
	LDA	SOUND_NO
	STA	SPCH1_SOUND_NO
	
;	JMP	BK0_PLAY_EQU
	JMP	BK0_PLAY_SP

BK0_PLAY_GROUP_RANDOM_S40:
	LDA	(<P0_ADDR),Y
;
	STA	SOUND_NO
	
	JMP	BK0_PLAY_GROUP_RANDOM_S13
.ENDIF
	