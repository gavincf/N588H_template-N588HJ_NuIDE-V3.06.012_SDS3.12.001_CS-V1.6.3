Tue Oct 23 10:35:26 2018







	Macro Assembler  -  Version 1.00.0
		-----------------------------------------------

		Input  Filename : D:\ASM_SAVE_backup\Nuvoton8bit\N588H_template\N588H340_NuIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\UserCmd.asm.app
		Output Filename : D:\ASM_SAVE_backup\Nuvoton8bit\N588H_template\N588H340_NuIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\Code_Release\UserCmd.oc


    1  0000000                   	CHIP	65C02
    2  0000000                   
    3  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\PGM_HEAD_N588H.INI.APP"
    4  0000000                   	SYMBOLS
    5  0000000                   	LINKLIST
    6  0000000                   	DEBUG  		ASM
    7  0000000                   	LINEAR	ON
    8  0000000                   	LONGA	OFF
    9  0000000                   	LONGI	OFF
   10  0000000                   
   11  0000000                   ;FOR *.LIC
   12  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\N588H_SYS_DEF_EQU.INI.APP"
   13  0000000                   DIRECT_PAGE		EQU	00H
   14  0000000                   
   15  0000000                   CHECKSUM_ADDR		EQU 	00H
   16  0000000                   CHECKSUM_ADDR1		EQU 	01H
   17  0000000                   CHECK_RESULT		EQU	02H
   18  0000000                   
   19  0000000                   ROM_START		EQU	0980H
   20  0000000                   ROM_SEC1_END		EQU	099FH
   21  0000000                   CHECKSUM_33TH		EQU	09A0H
   22  0000000                   CHECKSUM_34TH		EQU	09A1H
   23  0000000                   ROM_SEC2_START		EQU	09C0H
   24  0000000                   
   25  0000000                   RAM_BEGIN		EQU	00H
   26  0000000                   
   27  0000000                   .IF	 (PARTNO='N588H000')
   28  0000000                   RAM_END		EQU 7FFH
   29  0000000                   STACK_END   	EQU FFH
   30  0000000                   .ENDIF
   31  0000000                   
   32  0000000                   .IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
   33  0000000                   RAM_END		EQU 7FH
   34  0000000                   STACK_END   	EQU 7FH
   35  0000000                   .ENDIF
   36  0000000                   
   37  0000000                   .IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
   38  0000000                   RAM_END		EQU BFH
   39  0000000                   STACK_END   	EQU BFH
   40  0000000                   .ENDIF
   41  0000000                   
   42  0000000                   ; [Add] N588J chip series
   43  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   44  0000000                   .IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170')
   45  0000000                   RAM_END		EQU 7FH
   46  0000000                   STACK_END   	EQU 7FH





   47  0000000                   .ENDIF
   48  0000000                   
   49  0000000                   .IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
   50  0000000                   RAM_END		EQU BFH
   51  0000000                   STACK_END   	EQU BFH
   52  0000000                   .ENDIF
   53  0000000                   
   54  0000000                   
   55  0000000                   ;------------------------------------------------------
   56  0000000                   .IF	 (PARTNO='N588H000')
   57  0000000                   BODY_END_ADDR 	EQU	80FFH
   58  0000000                   BODY_END_BANK	EQU	20H
   59  0000000                   .ENDIF
   60  0000000                   
   61  0000000                   ; [Add] N588J010 (40K)
   62  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   63  0000000                   .IF	 (PARTNO='N588J010')
   64  0000000                   BODY_END_ADDR 	EQU	A8FFH
   65  0000000                   BODY_END_BANK	EQU	01H
   66  0000000                   .ENDIF
   67  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   68  0000000                   
   69  0000000                   ; [Add] N588J040 (126K)
   70  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   71  0000000                   .IF	 (PARTNO='N588H040').OR.(PARTNO='N588J040')
   72  0000000                   BODY_END_ADDR 	EQU	80FFH
   73  0000000                   BODY_END_BANK	EQU	04H
   74  0000000                   .ENDIF
   75  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   76  0000000                   
   77  0000000                   ; [Add] N588J060 (*206K)
   78  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   79  0000000                   .IF	 (PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588J060')
   80  0000000                   BODY_END_ADDR 	EQU	C0FFH
   81  0000000                   BODY_END_BANK	EQU	06H
   82  0000000                   .ENDIF
   83  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   84  0000000                   
   85  0000000                   ; [Add] N588J080 (254K)
   86  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   87  0000000                   .IF	 (PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588J080').OR.(PARTNO='N588HP080')
   88  0000000                   BODY_END_ADDR 	EQU	80FFH
   89  0000000                   BODY_END_BANK	EQU	08H
   90  0000000                   .ENDIF
   91  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   92  0000000                   
   93  0000000                   ; [Add] N588J120 (*414K)
   94  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   95  0000000                   .IF	 (PARTNO='N588H120').OR.(PARTNO='N588J120')
   96  0000000                   BODY_END_ADDR 	EQU	80FFH
   97  0000000                   BODY_END_BANK	EQU	0DH
   98  0000000                   .ENDIF
   99  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  100  0000000                   
  101  0000000                   ; [Add] N588J170 (510K)
  102  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  103  0000000                   .IF	 (PARTNO='N588H170').OR.(PARTNO='N588J170').OR.(PARTNO='N588HP170')





  104  0000000                   BODY_END_ADDR 	EQU	80FFH
  105  0000000                   BODY_END_BANK	EQU	10H
  106  0000000                   .ENDIF
  107  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  108  0000000                   
  109  0000000                   ; [Add] N588H/J200 (*704K)
  110  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  111  0000000                   .IF	 (PARTNO='N588H200').OR.(PARTNO='N588H201').OR.(PARTNO='N588J200').OR.(PARTNO='N588J201')
  112  0000000                   BODY_END_ADDR 	EQU	88FFH
  113  0000000                   BODY_END_BANK	EQU	16H
  114  0000000                   .ENDIF
  115  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  116  0000000                   
  117  0000000                   ; [Add] N588J250 (*830K)
  118  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  119  0000000                   .IF	 (PARTNO='N588H250').OR.(PARTNO='N588H251').OR.(PARTNO='N588J250').OR.(PARTNO='N588J251')
  120  0000000                   BODY_END_ADDR 	EQU	80FFH
  121  0000000                   BODY_END_BANK	EQU	1AH
  122  0000000                   .ENDIF
  123  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  124  0000000                   
  125  0000000                   ; [Add] N588J340 (*1022K)
  126  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  127  0000000                   .IF	 (PARTNO='N588H340').OR.(PARTNO='N588H341').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J340').OR.(PARTNO='N588J341')
  128  0000000                   BODY_END_ADDR 	EQU	FFFFH
  129  0000000                   BODY_END_BANK	EQU	1FH
  130  0000000                   .ENDIF
  131  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  132  0000000                   
  133  0000000                   ; [Add] N588H480 (*1534K)
  134  0000000                   .IF	 (PARTNO='N588H480').OR.(PARTNO='N588J480')
  135  0000000                   BODY_END_ADDR 	EQU	80FFH
  136  0000000                   BODY_END_BANK	EQU	30H
  137  0000000                   .ENDIF
  138  0000000                   
  139  0000000                   ; [Add] N588H650 (*2044K)
  140  0000000                   .IF	 (PARTNO='N588H650').OR.(PARTNO='N588J650')
  141  0000000                   BODY_END_ADDR 	EQU	F8FFH
  142  0000000                   BODY_END_BANK	EQU	3FH
  143  0000000                   .ENDIF
  144  0000000                   ;------------------------------------------------------
  145  0000000                   ;------------------------------------------------------
  146  0000000                   INT0_PORT	EQU 		01H
  147  0000000                   INT0_TM0	EQU 		02H
  148  0000000                   INT0_TM1	EQU 		04H
  149  0000000                   INT0_TMG0	EQU 		08H
  150  0000000                   INT0_FXF13	EQU 		10H
  151  0000000                   INT0_FXF10	EQU 		20H
  152  0000000                   INT0_TMG1	EQU 		40H
  153  0000000                   INT0_FXF15	EQU 		80H
  154  0000000                   
  155  0000000                   INT1_RTC	EQU 		01H
  156  0000000                   INT1_SPIO_OUT 	EQU 		02H
  157  0000000                   INT1_SPIO_IN	EQU 		04H
  158  0000000                   INT1_SIM	EQU 		08H
  159  0000000                   
  160  0000000                   CTL_CPU_STOP	EQU 		01H





  161  0000000                   CTL_CPU_WDT	EQU 		02H
  162  0000000                   CTL_CPU_FOSC	EQU 		04H
  163  0000000                   CTL_LVD		EQU 		08H
  164  0000000                   CTL_LVD_OCCUR	EQU 		80H
  165  0000000                   
  166  0000000                   RESET_LVR	EQU		01H
  167  0000000                   RESET_PORT	EQU		02H
  168  0000000                   RESET_WDT	EQU		04H
  169  0000000                   RESET_POR	EQU		08H
  170  0000000                   RESET_RPIN	EQU		10H
  171  0000000                   RESET_6502	EQU		20H
  172  0000000                   RESET_ABN	EQU		40H
  173  0000000                   
  174  0000000                   RDPC_WSC	EQU 		10H
  175  0000000                   SIC_EN		EQU 		01H
  176  0000000                   SIC_SPI		EQU 		04H
  177  0000000                   
  178  0000000                   SPEN_EPWM	EQU 		02H
  179  0000000                   SPEN_DAC	EQU 		01H
  180  0000000                   SPEN_NS		EQU 		08H
  181  0000000                   
  182  0000000                   RTC_EN 		EQU 		01H
  183  0000000                   RTC_4S 		EQU 		00H
  184  0000000                   RTC_2HZ 	EQU 		02H
  185  0000000                   RTC_32HZ	EQU 		04H
  186  0000000                   RTC_8HZ 	EQU 		06H
  187  0000000                   
  188  0000000                   RGT_EN		EQU 		01H
  189  0000000                   
  190  0000000                   BP00_PWM	EQU		01H
  191  0000000                   BP01_PWM	EQU		02H
  192  0000000                   BP02_PWM	EQU		04H
  193  0000000                   BP03_PWM	EQU		08H
  194  0000000                   BP04_PWM	EQU		10H
  195  0000000                   BP05_PWM	EQU		20H
  196  0000000                   
  197  0000000                   BP00_MOTOR	EQU		10H
  198  0000000                   BP01_MOTOR	EQU		10H
  199  0000000                   BP02_MOTOR	EQU		20H
  200  0000000                   BP03_MOTOR	EQU		20H
  201  0000000                   BP04_MOTOR	EQU		40H
  202  0000000                   BP05_MOTOR	EQU		40H
  203  0000000                   ;------------------------------------------------------
  204  0000000                   ;------------------------------------------------------
  205  0000000                   BP0		EQU		801H
  206  0000000                   BP0D		EQU		80AH
  207  0000000                   BP0C		EQU		815H
  208  0000000                   
  209  0000000                   BP1		EQU		802H
  210  0000000                   BP1D		EQU		80BH
  211  0000000                   BP1EN	 	EQU 		852H
  212  0000000                   
  213  0000000                   .IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
  214  0000000                   BP2		EQU		803H
  215  0000000                   BP2D		EQU		80CH
  216  0000000                   BP2C		EQU		822H
  217  0000000                   .ENDIF





  218  0000000                   
  219  0000000                   IEF0		EQU		81EH
  220  0000000                   EVF0		EQU		820H
  221  0000000                   EFC0		EQU		816H
  222  0000000                   
  223  0000000                   BANK		EQU		818H
  224  0000000                   RESET_F	   	EQU     	80EH
  225  0000000                   CTL_CPU	   	EQU     	80FH
  226  0000000                   
  227  0000000                   SPEN		EQU		833H
  228  0000000                   .IF(WITH_ALL_MIXER_SFR .EQ. 1)
  229  0000000                   SP0A		EQU		838H
  230  0000000                   SP0AL		EQU		834H
  231  0000000                   .IF	(CHIPSERIES = 'N588H')
  232  0000000                   SP0B		EQU		839H
  233  0000000                   SP0BL		EQU		835H
  234  0000000                   SP0C		EQU		83AH
  235  0000000                   SP0CL		EQU		836H
  236  0000000                   .ENDIF
  237  0000000                   .ENDIF
  238  0000000                   SP0ALT		EQU		83CH
  239  0000000                   SP0AT		EQU		83EH
  240  0000000                   .IF	(CHIPSERIES = 'N588H')
  241  0000000                   SP0BLT		EQU		83DH
  242  0000000                   SP0BT		EQU		83FH
  243  0000000                   SP0CLT		EQU		840H
  244  0000000                   SP0CT		EQU		841H
  245  0000000                   .ENDIF
  246  0000000                   
  247  0000000                   TMG0C		EQU		828H
  248  0000000                   TMG0V		EQU		829H
  249  0000000                   TMG0_O		EQU		82AH
  250  0000000                   TM0C		EQU		82BH
  251  0000000                   TM0V		EQU		82FH
  252  0000000                   TM1C		EQU		82CH
  253  0000000                   TM1V		EQU		830H
  254  0000000                   
  255  0000000                   CMP_C		EQU 		849H
  256  0000000                   PVL		EQU 		84AH
  257  0000000                   
  258  0000000                   PWMC 		EQU 		858H
  259  0000000                   PWV0 		EQU 		859H
  260  0000000                   PWV2 		EQU 		85AH
  261  0000000                   PWV4 		EQU 		85BH
  262  0000000                   
  263  0000000                   	.IF	(PARTNO='N588H000')
  264  0000000                   IP0		EQU		800H
  265  0000000                   IP0M     	EQU		805H
  266  0000000                   IP0EN 		EQU 		850H
  267  0000000                   OP1		EQU		809H
  268  0000000                   
  269  0000000                   RAMP		EQU 		842H
  270  0000000                   
  271  0000000                   SIC		EQU		81CH
  272  0000000                   RDPC		EQU  		81DH	
  273  0000000                   BANK1		EQU		832H
  274  0000000                   EXDAX0 		EQU 		868H





  275  0000000                   EXDAX1 		EQU 		869H
  276  0000000                   EXDAX2 		EQU 		86AH
  277  0000000                   EXDAX3 		EQU 		86BH
  278  0000000                   EXDAY0 		EQU 		86CH
  279  0000000                   EXDAY1 		EQU 		86DH
  280  0000000                   EXDAY2 		EQU 		86EH
  281  0000000                   EXDAY3 		EQU 		86FH	
  282  0000000                   
  283  0000000                   SPIC 		EQU 		85EH
  284  0000000                   SPIB 		EQU 		85FH
  285  0000000                   SPIB_NFT	EQU 		860H
  286  0000000                   
  287  0000000                   TMG1C		EQU 		823H
  288  0000000                   TMG1V		EQU		824H
  289  0000000                   TMG1_O		EQU		825H
  290  0000000                   
  291  0000000                   IEF1		EQU		81FH
  292  0000000                   EVF1		EQU		821H
  293  0000000                   EFC1		EQU		817H
  294  0000000                   
  295  0000000                   VD_C		EQU 		848H
  296  0000000                   RGT 		EQU 		84EH
  297  0000000                   RTCC 		EQU 		863H
  298  0000000                   
  299  0000000                   MPUC		EQU 		84FH
  300  0000000                   MPU10		EQU		8ECH
  301  0000000                   MPU11		EQU		8EDH
  302  0000000                   MPU00		EQU		8EEH
  303  0000000                   MPU01		EQU		8EFH
  304  0000000                   	.ENDIF
  305  0000000                   
  306  0000000                   CFG0 		EQU 		8F0H
  307  0000000                   CFG1 		EQU 		8F1H
  308  0000000                   CFG2 		EQU 		8F2H
  309  0000000                   CFG3 		EQU 		8F3H
  310  0000000                   CFG4 		EQU 		8F4H
  311  0000000                   CFG5 		EQU 		8F5H
  312  0000000                   CFG6 		EQU 		8F6H
  313  0000000                   CFG7 		EQU 		8F7H
  314  0000000                   CFG8 		EQU 		8F8H
  315  0000000                   CFG9 		EQU 		8F9H
  316  0000000                   CFGA 		EQU 		8FAH
  317  0000000                   CFGB 		EQU 		8FBH
  318  0000000                   CFGC 		EQU 		8FCH
  319  0000000                   CFGD 		EQU 		8FDH
  320  0000000                   CFGE 		EQU 		8FEH
  321  0000000                   CFGF 		EQU 		8FFH
  322  0000000                   
  323  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\N55P242_DEFINE.INI.APP"
  324  0000000                   ;----IO REGUSTER----------
  325  0000000                   BPA0			EQU	00H
  326  0000000                   BPB0			EQU	01H
  327  0000000                   BPC0			EQU	02H
  328  0000000                   BPA1			EQU	00H
  329  0000000                   BPB1			EQU	01H
  330  0000000                   BPC1			EQU	02H
  331  0000000                   





  332  0000000                   ;----IO REGUSTER----------
  333  0000000                   ; BUFFER  Data of GPA/B/C
  334  0000000                   ;-------------------------
  335  0000000                   P242BPA_B		EQU	00H
  336  0000000                   P242BPB_B		EQU	01H
  337  0000000                   P242BPC_B		EQU	02H
  338  0000000                   
  339  0000000                   ;-------------------------
  340  0000000                   ; DIRECTION  Data of GPA/B/C
  341  0000000                   ;-------------------------
  342  0000000                   P242BPA_D		EQU	04H
  343  0000000                   P242BPB_D		EQU	05H
  344  0000000                   P242BPC_D		EQU	06H
  345  0000000                   
  346  0000000                   ;-------------------------
  347  0000000                   ; ATTRIBUTE   Data of GPA/B/C
  348  0000000                   ;-------------------------
  349  0000000                   P242BPA_A		EQU	08H
  350  0000000                   P242BPB_A		EQU	09H
  351  0000000                   P242BPC_A		EQU	0AH
  352  0000000                   
  353  0000000                   ;-------------------------
  354  0000000                   ; PIN data   Data of GPA/B/C
  355  0000000                   ;-------------------------
  356  0000000                   P242BPA_P		EQU	0CH
  357  0000000                   P242BPB_P		EQU	0DH
  358  0000000                   P242BPC_P		EQU	0EH
  359  0000000                   
  360  0000000                   
  361  0000000                   
  362  0000000                   ;-----------------WAKE UP--------------------------
  363  0000000                   ;WAKEN[7] ,KCAEN[6], KCBEN[5], KCCEN[4] ; R/W 
  364  0000000                   ;PAC[3], PBC[2], PCC[1], WKFLG[0]  ; Read Only
  365  0000000                   ;--------------------------------------------------
  366  0000000                   ;WAKEN[7]: Wakeup enable bit.
  367  0000000                   ;KCA/B/C_EN :Wakeup enable bit of GPA/B/C
  368  0000000                   ;PAC/PBC/PCC : Change bit GPA/B/C :1: change; 0: no change.
  369  0000000                   ;WKFLG :Only when PAC, PBC and PCC bits are all ¡§0¡¨s is WKFLG bit set to ¡§0¡¨
  370  0000000                   ;--------------------------------------------------
  371  0000000                   P242WKCTL		EQU	0FH
  372  0000000                   
  373  0000000                   ;----RESET------------------
  374  0000000                   P242RESET		EQU	4FH    ; Write Only
  375  0000000                   
  376  0000000                   ;----Device Select----------
  377  0000000                   P242DVSL0		EQU	4CH    ; Write Only
  378  0000000                   P242DVSL1		EQU	4DH    ; Write Only
  379  0000000                   
  380  0000000                   ;----Test Mode--------------
  381  0000000                   ;TEST[7] : 
  382  0000000                   ;---------------------------
  383  0000000                   P242TEST		EQU	4EH    ; R/W
  384  0000000                   
  385  0000000                   
  386  0000000                   
  387  0000000                   ;---AND REGISTER----------
  388  0000000                   ;----For Buffer ----------





  389  0000000                   P242AND_BPA_B		EQU	10H
  390  0000000                   P242AND_BPB_B		EQU	11H
  391  0000000                   P242AND_BPC_B		EQU	12H
  392  0000000                   
  393  0000000                   ;--- For Direction --------
  394  0000000                   P242AND_BPA_D		EQU	14H
  395  0000000                   P242AND_BPB_D		EQU	15H
  396  0000000                   P242AND_BPC_D		EQU	16H
  397  0000000                   
  398  0000000                   ;--- For Attribute  -------
  399  0000000                   P242AND_BPA_A		EQU	18H
  400  0000000                   P242AND_BPB_A		EQU	19H
  401  0000000                   P242AND_BPC_A		EQU	1AH
  402  0000000                   
  403  0000000                   ;---OR REGISTER----------
  404  0000000                   ;----For Buffer ----------
  405  0000000                   P242OR_BPA_B		EQU	20H
  406  0000000                   P242OR_BPB_B		EQU	21H
  407  0000000                   P242OR_BPC_B		EQU	22H
  408  0000000                   
  409  0000000                   ;--- For Direction --------
  410  0000000                   P242OR_BPA_D		EQU	24H
  411  0000000                   P242OR_BPB_D		EQU	25H
  412  0000000                   P242OR_BPC_D		EQU	26H
  413  0000000                   
  414  0000000                   ;--- For Attribute  -------
  415  0000000                   P242OR_BPA_A		EQU	28H
  416  0000000                   P242OR_BPB_A		EQU	29H
  417  0000000                   P242OR_BPC_A		EQU	2AH
  418  0000000                   
  419  0000000                   ;---XOR REGISTER----------
  420  0000000                   ;--- For Attribute  -------
  421  0000000                   P242XOR_BPA_B		EQU	30H
  422  0000000                   P242XOR_BPB_B		EQU	31H
  423  0000000                   P242XOR_BPC_B		EQU	32H
  424  0000000                   
  425  0000000                   ;--- For Direction --------
  426  0000000                   P242XOR_BPA_D		EQU	34H
  427  0000000                   P242XOR_BPB_D		EQU	35H
  428  0000000                   P242XOR_BPC_D		EQU	36H
  429  0000000                   
  430  0000000                   ;--- For Attribute  -------
  431  0000000                   P242XOR_BPA_A		EQU	38H
  432  0000000                   P242XOR_BPB_A		EQU	39H
  433  0000000                   P242XOR_BPC_A		EQU	3AH
  434  0000000                   
  435  0000000                   ;---------------------------
  436  0000000                   ; Constant/Normal Current/
  437  0000000                   ; Current Control of GPA/B/C
  438  0000000                   ;---------------------------
  439  0000000                   P242CNST_BPA		EQU	40H
  440  0000000                   P242CNST_BPB		EQU	41H
  441  0000000                   P242CNST_BPC		EQU	42H
  442  0000000                   
  443  0000000                   ;---PWM REGISTER----------
  444  0000000                   ;   For BPA0~BPA7 
  445  0000000                   ;-------------------------





  446  0000000                   ; Writ Only
  447  0000000                   ;-------------------------
  448  0000000                   P242PWM_BPA0		EQU	50H
  449  0000000                   P242PWM_BPA1		EQU	51H
  450  0000000                   P242PWM_BPA2		EQU	52H
  451  0000000                   P242PWM_BPA3		EQU	53H
  452  0000000                   P242PWM_BPA4		EQU	54H
  453  0000000                   P242PWM_BPA5		EQU	55H
  454  0000000                   P242PWM_BPA6		EQU	56H
  455  0000000                   P242PWM_BPA7		EQU	57H
  456  0000000                   
  457  0000000                   
  458  0000000                   ;---PWM REGISTER----------
  459  0000000                   ;   For BPB0~BPB7 
  460  0000000                   ;-------------------------
  461  0000000                   ; Writ Only
  462  0000000                   ;-------------------------
  463  0000000                   P242PWM_BPB0		EQU	58H
  464  0000000                   P242PWM_BPB1		EQU	59H
  465  0000000                   P242PWM_BPB2		EQU	5AH
  466  0000000                   P242PWM_BPB3		EQU	5BH
  467  0000000                   P242PWM_BPB4		EQU	5CH
  468  0000000                   P242PWM_BPB5		EQU	5DH
  469  0000000                   P242PWM_BPB6		EQU	5EH
  470  0000000                   P242PWM_BPB7		EQU	5FH
  471  0000000                   
  472  0000000                   ;---PWM REGISTER----------
  473  0000000                   ;   For BPC0~BPC7 
  474  0000000                   ;-------------------------
  475  0000000                   ; Writ Only
  476  0000000                   ;-------------------------
  477  0000000                   P242PWM_BPC0		EQU	60H
  478  0000000                   P242PWM_BPC1		EQU	61H
  479  0000000                   P242PWM_BPC2		EQU	62H
  480  0000000                   P242PWM_BPC3		EQU	63H
  481  0000000                   P242PWM_BPC4		EQU	64H
  482  0000000                   P242PWM_BPC5		EQU	65H
  483  0000000                   P242PWM_BPC6		EQU	66H
  484  0000000                   P242PWM_BPC7		EQU	67H
  485  0000000                   
  486  0000000                   ;---ENABLE PWM REGISTER----------
  487  0000000                   ;   For BPA/B/C0~7 
  488  0000000                   ;--------------------------------
  489  0000000                   P242PWMEN_BPA		EQU	78H
  490  0000000                   P242PWMEN_BPB		EQU	79H
  491  0000000                   P242PWMEN_BPC		EQU	7AH
  492  0000000                   
  493  0000000                   ;---PWM CLK REGISTER----------
  494  0000000                   ;   For BPA0~3, BPA4~7
  495  0000000                   ;   For BPB0~3, BPB4~7
  496  0000000                   ;   For BPB0~3, BPB4~7
  497  0000000                   ;--------------------------------
  498  0000000                   P242PWMCK_BPA		EQU	7DH   ; MSB 4bit for BPB, LSB 4bit for BPA
  499  0000000                   P242PWMCK_BPB		EQU	7DH   ; BPA/B same address 7DH
  500  0000000                   P242PWMCK_BPC		EQU	7EH   ; only LSB 4bits for BPC
  501  0000000                   
  502  0000000                   ;===========================================





  503  0000000                   ; Control Symbol Definition
  504  0000000                   ;===========================================
  505  0000000                   ;--------Wake up way-------
  506  0000000                   BY_MISO		EQU	00H
  507  0000000                   BY_PIN		EQU	01H
  508  0000000                   
  509  0000000                   ;--------external port-----
  510  0000000                   XBPA		EQU	0800H   ;.HIGH. For WakeUp bit
  511  0000000                   XBPB		EQU	0401H
  512  0000000                   XBPC		EQU	0202H
  513  0000000                   ;--------------------------
  514  0000000                   ;-------PWM pin------------
  515  0000000                   XPWM0		EQU	0100H
  516  0000000                   XPWM1		EQU	0201H
  517  0000000                   XPWM2		EQU	0402H
  518  0000000                   XPWM3		EQU	0803H
  519  0000000                   XPWM4		EQU	1004H
  520  0000000                   XPWM5		EQU	2005H
  521  0000000                   XPWM6		EQU	4006H
  522  0000000                   XPWM7		EQU	8007H
  523  0000000                   ;--------------------------
  524  0000000                   ;-------PIN pin------------
  525  0000000                   
  526  0000000                   XPIN_ALL	EQU 	00FFh
  527  0000000                   XPINALL		EQU 	00FFh
  528  0000000                   
  529  0000000                   XPIN0		EQU	0001H
  530  0000000                   XPIN1		EQU	0002H
  531  0000000                   XPIN2		EQU	0004H
  532  0000000                   XPIN3		EQU	0008H
  533  0000000                   XPIN4		EQU	0010H
  534  0000000                   XPIN5		EQU	0020H
  535  0000000                   XPIN6		EQU	0040H
  536  0000000                   XPIN7		EQU	0080H
  537  0000000                   ;-------PIN pin------------
  538  0000000                   
  539  0000000                   ;--------------------------
  540  0000000                   
  541  0000000                   ;-------PWM Clock Divider------------
  542  0000000                   ; 00: GPA0~GPA3 PWM clock is Fosc/1.
  543  0000000                   ; 01: GPA0~GPA3 PWM clock is Fosc/2.
  544  0000000                   ; 10: GPA0~GPA3 PWM clock is Fosc/4.
  545  0000000                   ; 11: GPA0~GPA3 PWM clock is Fosc/32
  546  0000000                   ;------------------------------------
  547  0000000                   XPWMA03_DIV1		EQU	00H
  548  0000000                   XPWMA03_DIV2		EQU	01H
  549  0000000                   XPWMA03_DIV4		EQU	02H
  550  0000000                   XPWMA03_DIV32		EQU	03H
  551  0000000                   XPWMA47_DIV1		EQU	00H<<2
  552  0000000                   XPWMA47_DIV2		EQU	01H<<2
  553  0000000                   XPWMA47_DIV4		EQU	02H<<2
  554  0000000                   XPWMA47_DIV32		EQU	03H<<2
  555  0000000                   
  556  0000000                   XPWMB03_DIV1		EQU	00H<<4
  557  0000000                   XPWMB03_DIV2		EQU	01H<<4
  558  0000000                   XPWMB03_DIV4		EQU	02H<<4
  559  0000000                   XPWMB03_DIV32		EQU	03H<<4





  560  0000000                   XPWMB47_DIV1		EQU	00H<<6
  561  0000000                   XPWMB47_DIV2		EQU	01H<<6
  562  0000000                   XPWMB47_DIV4		EQU	02H<<6
  563  0000000                   XPWMB47_DIV32		EQU	03H<<6
  564  0000000                   
  565  0000000                   XPWMC03_DIV1		EQU	00H
  566  0000000                   XPWMC03_DIV2		EQU	01H
  567  0000000                   XPWMC03_DIV4		EQU	02H
  568  0000000                   XPWMC03_DIV32		EQU	03H
  569  0000000                   XPWMC47_DIV1		EQU	00H<<2
  570  0000000                   XPWMC47_DIV2		EQU	01H<<2
  571  0000000                   XPWMC47_DIV4		EQU	02H<<2
  572  0000000                   XPWMC47_DIV32		EQU	03H<<2
  573  0000000                   
  574  0000000                   ;=====================================================
  575  0000000                   ; Other Symobol Definition
  576  0000000                   ;=====================================================
  577  0000000                   ;----------input mode ---------
  578  0000000                   ;float low - A=1,D=0,B=0
  579  0000000                   M_IP_FL		EQU	FF0000H
  580  0000000                   M_IP0_FL	EQU	010000H
  581  0000000                   M_IP1_FL	EQU	020000H
  582  0000000                   M_IP2_FL	EQU	040000H
  583  0000000                   M_IP3_FL	EQU	080000H
  584  0000000                   M_IP4_FL	EQU	100000H
  585  0000000                   M_IP5_FL	EQU	200000H
  586  0000000                   M_IP6_FL	EQU	400000H
  587  0000000                   M_IP7_FL	EQU	800000H
  588  0000000                   
  589  0000000                   ;float high - A=0,D=0,B=0(Default)
  590  0000000                   M_IP_FH		EQU	000000H
  591  0000000                   M_IP0_FH	EQU	000000H
  592  0000000                   M_IP1_FH	EQU	000000H
  593  0000000                   M_IP2_FH	EQU	000000H
  594  0000000                   M_IP3_FH	EQU	000000H
  595  0000000                   M_IP4_FH	EQU	000000H
  596  0000000                   M_IP5_FH	EQU	000000H
  597  0000000                   M_IP6_FH	EQU	000000H
  598  0000000                   M_IP7_FH	EQU	000000H
  599  0000000                   
  600  0000000                   ;pull low - A=1,D=0,B=1
  601  0000000                   M_IP_PL		EQU	FF00FFH
  602  0000000                   M_IP0_PL	EQU	010001H
  603  0000000                   M_IP1_PL	EQU	020002H
  604  0000000                   M_IP2_PL	EQU	040004H
  605  0000000                   M_IP3_PL	EQU	080008H
  606  0000000                   M_IP4_PL	EQU	100010H
  607  0000000                   M_IP5_PL	EQU	200020H
  608  0000000                   M_IP6_PL	EQU	400040H
  609  0000000                   M_IP7_PL	EQU	800080H
  610  0000000                   
  611  0000000                   ;pull high - A=0,D=0,B=1
  612  0000000                   M_IP_PH		EQU	0000FFH
  613  0000000                   M_IP0_PH	EQU	000001H
  614  0000000                   M_IP1_PH	EQU	000002H
  615  0000000                   M_IP2_PH	EQU	000004H
  616  0000000                   M_IP3_PH	EQU	000008H





  617  0000000                   M_IP4_PH	EQU	000010H
  618  0000000                   M_IP5_PH	EQU	000020H
  619  0000000                   M_IP6_PH	EQU	000040H
  620  0000000                   M_IP7_PH	EQU	000080H
  621  0000000                   
  622  0000000                   ;----------output mode ---------
  623  0000000                   ;CMOS high - A=0,D=1,B=1
  624  0000000                   M_OP_CM_H	EQU	00FFFFH
  625  0000000                   M_OP0_CM_H	EQU	000101H
  626  0000000                   M_OP1_CM_H	EQU	000202H
  627  0000000                   M_OP2_CM_H	EQU	000404H
  628  0000000                   M_OP3_CM_H	EQU	000808H
  629  0000000                   M_OP4_CM_H	EQU	001010H
  630  0000000                   M_OP5_CM_H	EQU	002020H
  631  0000000                   M_OP6_CM_H	EQU	004040H
  632  0000000                   M_OP7_CM_H	EQU	008080H
  633  0000000                   
  634  0000000                   ;CMOS low - A=0,D=1,B=0
  635  0000000                   M_OP_CM_L	EQU	00FF00H
  636  0000000                   M_OP0_CM_L	EQU	000100H
  637  0000000                   M_OP1_CM_L	EQU	000200H
  638  0000000                   M_OP2_CM_L	EQU	000400H
  639  0000000                   M_OP3_CM_L	EQU	000800H
  640  0000000                   M_OP4_CM_L	EQU	001000H
  641  0000000                   M_OP5_CM_L	EQU	002000H
  642  0000000                   M_OP6_CM_L	EQU	004000H
  643  0000000                   M_OP7_CM_L	EQU	008000H
  644  0000000                   
  645  0000000                   ;Inverted CMOS high - A=1,D=1,B=0
  646  0000000                   M_OP_ICM_H	EQU	FFFF00H
  647  0000000                   M_OP0_ICM_H	EQU	010100H
  648  0000000                   M_OP1_ICM_H	EQU	020200H
  649  0000000                   M_OP2_ICM_H	EQU	040400H
  650  0000000                   M_OP3_ICM_H	EQU	080800H
  651  0000000                   M_OP4_ICM_H	EQU	101000H
  652  0000000                   M_OP5_ICM_H	EQU	202000H
  653  0000000                   M_OP6_ICM_H	EQU	404000H
  654  0000000                   M_OP7_ICM_H	EQU	808000H
  655  0000000                   
  656  0000000                   ;Inverted CMOS low - A=1,D=1,B=1
  657  0000000                   M_OP_ICM_L	EQU	FFFFFFH
  658  0000000                   M_OP0_ICM_L	EQU	010101H
  659  0000000                   M_OP1_ICM_L	EQU	020202H
  660  0000000                   M_OP2_ICM_L	EQU	040404H
  661  0000000                   M_OP3_ICM_L	EQU	080808H
  662  0000000                   M_OP4_ICM_L	EQU	101010H
  663  0000000                   M_OP5_ICM_L	EQU	202020H
  664  0000000                   M_OP6_ICM_L	EQU	404040H
  665  0000000                   M_OP7_ICM_L	EQU	808080H
  666  0000000                   
  667  0000000                   ;------set output value ---------
  668  0000000                   ;set CMOS low: AND BUF
  669  0000000                   S_OPALL		EQU	FFH
  670  0000000                   S_OP0		EQU	01H
  671  0000000                   S_OP1		EQU	02H
  672  0000000                   S_OP2		EQU	04H
  673  0000000                   S_OP3		EQU	08H





  674  0000000                   S_OP4		EQU	10H
  675  0000000                   S_OP5		EQU	20H
  676  0000000                   S_OP6		EQU	40H
  677  0000000                   S_OP7		EQU	80H
  678  0000000                   ;========================================================
  679  0000000                   
  680  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\CONFIGURATION.INI.APP"
  681  0000000                   LOCAL_TEST						EQU 0
  682  0000000                   ;--------------------------------------------------------------------------
  683  0000000                   ; Configurations : Configurations config features for di-fferent libraries.
  684  0000000                   ;--------------------------------------------------------------------------
  685  0000000                   WITH_VOL_ADJ					EQU 0
  686  0000000                   ; There will be 2 libraries for each chip series such as W566B,W566C,....
  687  0000000                   ; One library with Volume Adjustment, another one without Volume Adjustment.
  688  0000000                   ; 0: WITHOUT VOL ADJ.
  689  0000000                   ; 1: WITH S/W VOL ADJ.
  690  0000000                   ; 2: WITH H/W VOL ADJ.
  691  0000000                   
  692  0000000                   WITH_MULTI_CHANNEL				EQU  0
  693  0000000                   ; There will be 2 libraries 
  694  0000000                   ; One library with 16HQ, another one without 16HQ
  695  0000000                   ; 0: WITHOUT 16HQ.
  696  0000000                   ; 1: WITH 16HQ.	
  697  0000000                   
  698  0000000                   WITH_VOL_REDUCE					EQU 0	
  699  0000000                   
  700  0000000                   WITH_16BIT_MODE					EQU 0
  701  0000000                   ; Some with 65C816 uC, some with 65C02.
  702  0000000                   WITH_32K_BANK					EQU 1
  703  0000000                   ;some with bank (ex:W567,W588), some without (ex:W566,W5691)
  704  0000000                   WITH_T_BUFFER					EQU 1
  705  0000000                   ;T-buffer is the buffer for latch decoded output PCM
  706  0000000                   WITH_READ_DATA_TYPE 			EQU 0
  707  0000000                   ; 0 : from ROM
  708  0000000                   ; 1 : from FI-FO
  709  0000000                   WITH_PCM_OUTPUT_TYPE			EQU 0
  710  0000000                   ; 0 : unsigned PCM
  711  0000000                   ; 1 : signed PCM (2' complement) 
  712  0000000                   ; 2 : signed magnitude
  713  0000000                   WITH_PCM_OUTPUT_SIZE			EQU 2
  714  0000000                   ; 1 : 1 BYTE
  715  0000000                   ; 2 : 2 BYTE	
  716  0000000                   WITH_CMD						EQU 0
  717  0000000                   ; for W569 chips that CPU send command to uC for next operations
  718  0000000                   
  719  0000000                   WITH_FW_MIXER					EQU 0
  720  0000000                   ; I-f a timer mix several channels but output to a T-buffer/Mixer output.
  721  0000000                   ; A firmware mixer will be needed.
  722  0000000                   WITH_COMPRESSED_MIDI			EQU 2
  723  0000000                   WITH_MULTIPLIER					EQU 0
  724  0000000                   ; 0 : FW
  725  0000000                   ; 1 : 9*7
  726  0000000                   ; 2 : 9*8
  727  0000000                   WITH_HEAD_TAIL_PROCESS			EQU 1
  728  0000000                   
  729  0000000                   ;-------------------------------------------------
  730  0000000                   ; for melody symbol definition





  731  0000000                   ;-------------------------------------------------
  732  0000000                   ENV_SHARP_DECAY_AMOUNT				EQU 4
  733  0000000                   
  734  0000000                   WITH_ALL_MIXER_SFR				EQU 0
  735  0000000                   
  736  0000000                   ; Following defines T-buffer registers
  737  0000000                   ;USED ACCOMPANY WITH SP_LO_T_INDEX_TABLE & SP_HI_T_INDEX_TABLE
  738  0000000                   SP_LO_T_START_ADDR				EQU SP0ALT
  739  0000000                   SP_HI_T_START_ADDR				EQU SP0AT
  740  0000000                   
  741  0000000                   SP_LO_T_VS0A					EQU 840H	;SP0CLT
  742  0000000                   SP_HI_T_VS0A					EQU 841H	;SP0CT
  743  0000000                   SP_LO_T_VS1A					EQU SP0ALT
  744  0000000                   SP_HI_T_VS1A					EQU SP0AT
  745  0000000                   SP_LO_T_VS2A					EQU 83DH	;SP0BLT
  746  0000000                   SP_HI_T_VS2A					EQU 83FH	;SP0BT
  747  0000000                   
  748  0000000                   ;	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
  749  0000000                   ;SP_HI_VS0A					EQU SP0C
  750  0000000                   ;SP_HI_VS1A					EQU SP0A
  751  0000000                   ;SP_HI_VS2A					EQU SP0B
  752  0000000                   ;
  753  0000000                   ;SP_LO_VS0A					EQU SP0CL
  754  0000000                   ;SP_LO_VS1A					EQU SP0AL
  755  0000000                   ;SP_LO_VS2A					EQU SP0BL
  756  0000000                   ;
  757  0000000                   ;SP_HI_START_ADDR				EQU SP0A
  758  0000000                   ;SP_LO_START_ADDR				EQU SP0AL
  759  0000000                   ;	.ENDIF
  760  0000000                   
  761  0000000                   SP_START_SIM_BUF_VS0A			EQU 0
  762  0000000                   SP_START_SIM_BUF_VS1A			EQU 0;0
  763  0000000                   SP_START_SIM_BUF_VS2A			EQU 0;0
  764  0000000                   SP_START_SIM_BUF_VS0B 			EQU 0
  765  0000000                   SP_START_SIM_BUF_VS1B			EQU 0
  766  0000000                   
  767  0000000                   
  768  0000000                   ; Following options used for ISR.
  769  0000000                   ; Please disable VS0D->VS0C->VS2B->VS1B->VSF->VSE->...>VS0A 
  770  0000000                   WITH_ISR_VS0A					EQU 0
  771  0000000                   WITH_ISR_VS0B					EQU 0
  772  0000000                   WITH_ISR_VS1A					EQU 1
  773  0000000                   WITH_ISR_VS1B					EQU 0
  774  0000000                   WITH_ISR_VS2A					EQU 0
  775  0000000                   WITH_ISR_VS2B					EQU 0
  776  0000000                   
  777  0000000                   ; Following options used for selecting speech channels.
  778  0000000                   ; Please disable VS0D->VS0C->VS2B->VS1B->VSF->VSE->...>VS0A 
  779  0000000                   WITH_VS0A						EQU 0
  780  0000000                   WITH_VS0B						EQU 0
  781  0000000                   WITH_VS1A						EQU 1
  782  0000000                   WITH_VS1B						EQU 0
  783  0000000                   WITH_VS2A						EQU 0
  784  0000000                   WITH_VS2B						EQU 0
  785  0000000                   WITH_VS0C						EQU 0
  786  0000000                   WITH_VS0D						EQU 0
  787  0000000                   WITH_VS3						EQU 0





  788  0000000                   WITH_VS4						EQU 0
  789  0000000                   WITH_VS5						EQU 0
  790  0000000                   WITH_VS6						EQU 0
  791  0000000                   WITH_VS7						EQU 0
  792  0000000                   WITH_VS8						EQU 0
  793  0000000                   WITH_VS9						EQU 0
  794  0000000                   WITH_VSA						EQU 0
  795  0000000                   WITH_VSB						EQU 0
  796  0000000                   WITH_VSC						EQU 0
  797  0000000                   WITH_VSD						EQU 0
  798  0000000                   WITH_VSE						EQU 0
  799  0000000                   WITH_VSF						EQU 0
  800  0000000                   
  801  0000000                   WITH_MD4						EQU 0
  802  0000000                   WITH_NM4						EQU 1
  803  0000000                   WITH_NM4S						EQU 0
  804  0000000                   WITH_MDM						EQU 0
  805  0000000                   WITH_APM						EQU 0
  806  0000000                   WITH_LP8						EQU 0
  807  0000000                   WITH_VC4						EQU 0
  808  0000000                   WITH_MDR						EQU 0
  809  0000000                   
  810  0000000                   WITH_E2A						EQU 0
  811  0000000                   WITH_EMM						EQU 0
  812  0000000                   WITH_MD6						EQU 0
  813  0000000                   WITH_P10						EQU 0
  814  0000000                   WITH_PC8						EQU 0
  815  0000000                   
  816  0000000                   WITH_SIL						EQU 1
  817  0000000                   WITH_VMDPC8						EQU 0
  818  0000000                   WITH_PCSPC8						EQU 0
  819  0000000                   WITH_TONE						EQU 0
  820  0000000                   WITH_HQPC8						EQU 0
  821  0000000                   
  822  0000000                   WITH_HQ567						EQU 0
  823  0000000                   WITH_VMD567						EQU 0
  824  0000000                   WITH_HQ567_HW						EQU 0
  825  0000000                   WITH_HQ569_HW						EQU 0
  826  0000000                   WITH_YAD						EQU 0
  827  0000000                   WITH_P16						EQU 0
  828  0000000                   WITH_VC8						EQU 0
  829  0000000                   WITH_PC8VMDPCS						EQU 0
  830  0000000                   WITH_LP8VMDPCS						EQU 0
  831  0000000                   WITH_P16VMDPCS						EQU 0
  832  0000000                   ;--------------------------------------------------------------------------
  833  0000000                   ; Options
  834  0000000                   ;--------------------------------------------------------------------------
  835  0000000                   WITH_POLYPHONY					EQU 0
  836  0000000                   WITH_MIDI_CHANNEL				EQU 0
  837  0000000                   WITH_VOL_ADJ_MS					EQU 0
  838  0000000                   
  839  0000000                   WITH_PAUSE_RESUME				EQU 0
  840  0000000                   WITH_CHANNEL_PRESSURE				EQU 0
  841  0000000                   WITH_NOTE_OFFSET				EQU 0
  842  0000000                   WITH_CHANGE_TEMPO				EQU 0
  843  0000000                   WITH_VELOCITY					EQU 0
  844  0000000                   WITH_MS_EXT_MIDI				EQU 0





  845  0000000                   WITH_SYNC_CH1_MS				EQU 0
  846  0000000                   ; Disable this feature will save 5 bytes RAM.
  847  0000000                   WITH_GLOBAL_CHANNEL_VOLM 			EQU 0
  848  0000000                   WITH_GLOBAL_CHANNEL_INS   			EQU 0
  849  0000000                   
  850  0000000                   WITH_PITCH_BEND					EQU 0
  851  0000000                   WITH_MODULATION_DEPTH			EQU 0
  852  0000000                   WITH_CHANNEL_SUSTAIN			EQU 0
  853  0000000                   WITH_SP_MIDI					EQU 0
  854  0000000                   WITH_PERCUSSION					EQU 0
  855  0000000                   WITH_DYNAMIC_CH					EQU 0
  856  0000000                   WITH_MS_ENABLE_CHANNEL			EQU 0
  857  0000000                   ; Disable this feature will save 2 bytes RAM.
  858  0000000                   
  859  0000000                   WITH_SP							EQU 1
  860  0000000                   ; Disable speech channels to save code size.
  861  0000000                   WITH_MS							EQU 0
  862  0000000                   ; Disable melody channels to save RAM and code size.
  863  0000000                   WITH_EVO						EQU 0
  864  0000000                   ; Disable EVO channels to save RAM and code size.
  865  0000000                   
  866  0000000                   ;------for speaker output type-----------------------------------------
  867  0000000                   WITH_SPEAKER_OUTPUT_TYPE 			EQU 	2
  868  0000000                   WITH_SPEAKER_SWITCH      			EQU     0   
  869  0000000                   
  870  0000000                   WITH_SIM_SP                                     EQU     0 
  871  0000000                   WITH_SIM_TYPE					EQU	0
  872  0000000                   ;0:W55F
  873  0000000                   ;1:SPI
  874  0000000                   WITH_EXT32MBIT					EQU	0
  875  0000000                   WITH_EXT64M_SPI					EQU 	0
  876  0000000                   
  877  0000000                   WITH_SP_NUM                                     EQU     1
  878  0000000                   WITH_ONE_HQ					EQU	0
  879  0000000                   WITH_PLAYE					EQU 	0
  880  0000000                   
  881  0000000                   
  882  0000000                   ; Following Options speci-fy what format can be played in each individual channel.
  883  0000000                   ; Properly disable some formats for channels can save RAM and code size.
  884  0000000                   WITH_VS0A_SIL					EQU 0
  885  0000000                   WITH_VS0B_SIL					EQU 0
  886  0000000                   WITH_VS1A_SIL					EQU 1
  887  0000000                   WITH_VS1B_SIL					EQU 0
  888  0000000                   WITH_VS2A_SIL					EQU 0
  889  0000000                   WITH_VS2B_SIL					EQU 0
  890  0000000                   
  891  0000000                   WITH_VS0A_MD4					EQU 0
  892  0000000                   WITH_VS0B_MD4					EQU 0
  893  0000000                   WITH_VS1A_MD4					EQU 0
  894  0000000                   WITH_VS1B_MD4					EQU 0
  895  0000000                   WITH_VS2A_MD4					EQU 0
  896  0000000                   WITH_VS2B_MD4					EQU 0
  897  0000000                   
  898  0000000                   WITH_VS0A_NM4					EQU 0
  899  0000000                   WITH_VS0B_NM4					EQU 0
  900  0000000                   WITH_VS1A_NM4					EQU 1
  901  0000000                   WITH_VS1B_NM4					EQU 0





  902  0000000                   WITH_VS2A_NM4					EQU 0
  903  0000000                   WITH_VS2B_NM4					EQU 0
  904  0000000                   
  905  0000000                   WITH_VS0A_NM4S					EQU 0
  906  0000000                   WITH_VS0B_NM4S					EQU 0
  907  0000000                   WITH_VS1A_NM4S					EQU 0
  908  0000000                   WITH_VS1B_NM4S					EQU 0
  909  0000000                   WITH_VS2A_NM4S					EQU 0
  910  0000000                   WITH_VS2B_NM4S					EQU 0
  911  0000000                   
  912  0000000                   WITH_VS0A_MDM					EQU 0
  913  0000000                   WITH_VS0B_MDM					EQU 0
  914  0000000                   WITH_VS1A_MDM					EQU 0
  915  0000000                   WITH_VS1B_MDM					EQU 0
  916  0000000                   WITH_VS2A_MDM					EQU 0
  917  0000000                   WITH_VS2B_MDM					EQU 0
  918  0000000                   
  919  0000000                   WITH_VS0A_APM					EQU 0
  920  0000000                   WITH_VS0B_APM					EQU 0
  921  0000000                   WITH_VS1A_APM					EQU 0
  922  0000000                   WITH_VS1B_APM					EQU 0
  923  0000000                   WITH_VS2A_APM					EQU 0
  924  0000000                   WITH_VS2B_APM					EQU 0
  925  0000000                   
  926  0000000                   WITH_VS0A_LP8					EQU 0
  927  0000000                   WITH_VS0B_LP8					EQU 0
  928  0000000                   WITH_VS1A_LP8					EQU 0
  929  0000000                   WITH_VS1B_LP8					EQU 0
  930  0000000                   WITH_VS2A_LP8					EQU 0
  931  0000000                   WITH_VS2B_LP8					EQU 0
  932  0000000                   
  933  0000000                   WITH_VS0A_VC4					EQU 0
  934  0000000                   WITH_VS0B_VC4					EQU 0
  935  0000000                   WITH_VS1A_VC4					EQU 0
  936  0000000                   WITH_VS1B_VC4					EQU 0
  937  0000000                   WITH_VS2A_VC4					EQU 0
  938  0000000                   WITH_VS2B_VC4					EQU 0
  939  0000000                   
  940  0000000                   WITH_VS0A_MDR					EQU 0
  941  0000000                   WITH_VS0B_MDR					EQU 0
  942  0000000                   WITH_VS1A_MDR					EQU 0
  943  0000000                   WITH_VS1B_MDR					EQU 0
  944  0000000                   WITH_VS2A_MDR					EQU 0
  945  0000000                   WITH_VS2B_MDR					EQU 0
  946  0000000                   
  947  0000000                   WITH_VS0A_E2A					EQU 0
  948  0000000                   WITH_VS0B_E2A					EQU 0
  949  0000000                   WITH_VS1A_E2A					EQU 0
  950  0000000                   WITH_VS1B_E2A					EQU 0
  951  0000000                   WITH_VS2A_E2A					EQU 0
  952  0000000                   WITH_VS2B_E2A					EQU 0
  953  0000000                   
  954  0000000                   WITH_VS0A_EMM					EQU 0
  955  0000000                   WITH_VS0B_EMM					EQU 0
  956  0000000                   WITH_VS1A_EMM					EQU 0
  957  0000000                   WITH_VS1B_EMM					EQU 0
  958  0000000                   WITH_VS2A_EMM					EQU 0





  959  0000000                   WITH_VS2B_EMM					EQU 0
  960  0000000                   
  961  0000000                   WITH_VS0A_MD6					EQU 0
  962  0000000                   WITH_VS0B_MD6					EQU 0
  963  0000000                   WITH_VS1A_MD6					EQU 0
  964  0000000                   WITH_VS1B_MD6					EQU 0
  965  0000000                   WITH_VS2A_MD6					EQU 0
  966  0000000                   WITH_VS2B_MD6					EQU 0
  967  0000000                   
  968  0000000                   WITH_VS0A_P10					EQU 0
  969  0000000                   WITH_VS0B_P10					EQU 0
  970  0000000                   WITH_VS1A_P10					EQU 0
  971  0000000                   WITH_VS1B_P10					EQU 0
  972  0000000                   WITH_VS2A_P10					EQU 0
  973  0000000                   WITH_VS2B_P10					EQU 0
  974  0000000                   
  975  0000000                   WITH_VS0A_PC8					EQU 0
  976  0000000                   WITH_VS0B_PC8					EQU 0
  977  0000000                   WITH_VS1A_PC8					EQU 0
  978  0000000                   WITH_VS1B_PC8					EQU 0
  979  0000000                   WITH_VS2A_PC8					EQU 0
  980  0000000                   WITH_VS2B_PC8					EQU 0
  981  0000000                   
  982  0000000                   ; PC8 type VMD, disable to save code size.
  983  0000000                   WITH_VS0A_VMDPC8				EQU 0
  984  0000000                   WITH_VS0B_VMDPC8				EQU 0
  985  0000000                   WITH_VS1A_VMDPC8				EQU 0
  986  0000000                   WITH_VS1B_VMDPC8				EQU 0
  987  0000000                   WITH_VS2A_VMDPC8				EQU 0
  988  0000000                   WITH_VS2B_VMDPC8				EQU 0
  989  0000000                   
  990  0000000                   ; PC8 type PCS, disable to save code size.
  991  0000000                   WITH_VS0A_PCSPC8				EQU 0
  992  0000000                   WITH_VS0B_PCSPC8				EQU 0
  993  0000000                   WITH_VS1A_PCSPC8				EQU 0
  994  0000000                   WITH_VS1B_PCSPC8				EQU 0
  995  0000000                   WITH_VS2A_PCSPC8				EQU 0
  996  0000000                   WITH_VS2B_PCSPC8				EQU 0
  997  0000000                   
  998  0000000                   ; I-f there is HQ melody, disable TONE save nothing.
  999  0000000                   WITH_VS0A_TONE					EQU 0
 1000  0000000                   WITH_VS0B_TONE					EQU 0
 1001  0000000                   WITH_VS1A_TONE					EQU 0
 1002  0000000                   WITH_VS1B_TONE					EQU 0
 1003  0000000                   WITH_VS2A_TONE					EQU 0
 1004  0000000                   WITH_VS2B_TONE					EQU 0
 1005  0000000                   
 1006  0000000                   ; W566/W588(PC8) type HQ, disable to save code size.
 1007  0000000                   WITH_VS0A_HQPC8					EQU 0
 1008  0000000                   WITH_VS0B_HQPC8					EQU 0
 1009  0000000                   WITH_VS1A_HQPC8					EQU 0
 1010  0000000                   WITH_VS1B_HQPC8					EQU 0
 1011  0000000                   WITH_VS2A_HQPC8					EQU 0
 1012  0000000                   WITH_VS2B_HQPC8					EQU 0
 1013  0000000                   
 1014  0000000                   WITH_CH0_EVO					EQU 0
 1015  0000000                   WITH_CH1_EVO					EQU 0





 1016  0000000                   WITH_CH2_EVO					EQU 0
 1017  0000000                   
 1018  0000000                   WITH_FILTER					EQU 0
 1019  0000000                   WITH_NOISE_SHAPING				EQU 1
 1020  0000000                   ;0 - not support noise shaping
 1021  0000000                   ;1 - support noise shaping
 1022  0000000                   ;2 - only PWM support shaping
 1023  0000000                   
 1024  0000000                   WITH_DAC_ENABLE					EQU 0
 1025  0000000                   WITH_SP0XL_RESOLUTION				EQU 1
 1026  0000000                   ; 1 - 16 bit
 1027  0000000                   ; 2 - 14 bit
 1028  0000000                   ; 3 - 12 bit
 1029  0000000                   WITH_SPEN_EFFECTIVE_BITS       			EQU 2
 1030  0000000                   ;X X X X PWM_NS DAC_MA PWM DAC  
 1031  0000000                   WITH_RDPC_VALUE         			EQU 1
 1032  0000000                   
 1033  0000000                   WITH_MS_CODA					EQU 0
 1034  0000000                   WITH_SP_MIDI_SIMUL 				EQU 0
 1035  0000000                   WITH_SP_SKIP                       		EQU 0
 1036  0000000                   WITH_SP_GLOBAL_SR                       	EQU 0
 1037  0000000                   
 1038  0000000                   WITH_RAM_OVER_STACK				EQU 	0
 1039  0000000                   WITH_STACK_SIZE					EQU	20
 1040  0000000                   
 1041  0000000                   TONE_2KHZ_TMC	EQU 5
 1042  0000000                   TONE_2KHZ_TMV 	EQU 95
 1043  0000000                   
 1044  0000000                   WITH_SPI_GPIO                                   EQU     0
 1045  0000000                   
 1046  0000000                   WITH_EN_ULTRAIO                 EQU     0
 1047  0000000                   
 1048  0000000                   ; Cap-Sensor Library
 1049  0000000                   ; 
 1050  0000000                   ;;;; There are two libraries for Cap-Sensor.
 1051  0000000                   ;;;; [1] 8  key detection via PORT_ISR
 1052  0000000                   ;;;;    
 1053  0000000                   ;;;;    
 1054  0000000                   ;;;; [2] 8+ key detection via MAIN_LOOP
 1055  0000000                   ;;;;    
 1056  0000000                   ;;;;    
 1057  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1058  0000000                   WITH_PSF_PROJECT  		EQU 0
 1059  0000000                   
 1060  0000000                   WITH_FW_SEN_OPTION_PIN           EQU         0
 1061  0000000                   WITH_CAPSENSOR_MULTISENTABLE     EQU         1
 1062  0000000                   
 1063  0000000                   CAP_SENSOR_TBL0_KEY0_TH              EQU 0
 1064  0000000                   CAP_SENSOR_TBL0_KEY1_TH              EQU 0
 1065  0000000                   CAP_SENSOR_TBL0_KEY2_TH              EQU 0
 1066  0000000                   CAP_SENSOR_TBL0_KEY3_TH              EQU 0
 1067  0000000                   CAP_SENSOR_TBL0_KEY4_TH              EQU 0
 1068  0000000                   CAP_SENSOR_TBL0_KEY5_TH              EQU 0
 1069  0000000                   CAP_SENSOR_TBL0_KEY6_TH              EQU 0
 1070  0000000                   CAP_SENSOR_TBL0_KEY7_TH              EQU 0
 1071  0000000                   CAP_SENSOR_TBL0_KEY8_TH              EQU 0
 1072  0000000                   CAP_SENSOR_TBL0_KEY9_TH              EQU 0





 1073  0000000                   CAP_SENSOR_TBL0_KEY10_TH             EQU 0
 1074  0000000                   CAP_SENSOR_TBL0_KEY11_TH             EQU 0
 1075  0000000                   CAP_SENSOR_TBL0_KEY12_TH             EQU 0
 1076  0000000                   CAP_SENSOR_TBL0_KEY13_TH             EQU 0
 1077  0000000                   CAP_SENSOR_TBL0_KEY14_TH             EQU 0
 1078  0000000                   CAP_SENSOR_TBL0_KEY15_TH             EQU 0
 1079  0000000                   CAP_SENSOR_TBL0_KEY16_TH             EQU 0
 1080  0000000                   CAP_SENSOR_TBL0_KEY17_TH             EQU 0
 1081  0000000                   CAP_SENSOR_TBL0_KEY18_TH             EQU 0
 1082  0000000                   CAP_SENSOR_TBL0_KEY19_TH             EQU 0
 1083  0000000                   CAP_SENSOR_TBL0_KEY20_TH             EQU 0
 1084  0000000                   CAP_SENSOR_TBL0_KEY21_TH             EQU 0
 1085  0000000                   CAP_SENSOR_TBL0_KEY22_TH             EQU 0
 1086  0000000                   CAP_SENSOR_TBL0_KEY23_TH             EQU 0
 1087  0000000                   
 1088  0000000                   
 1089  0000000                   CAP_SENSOR_SEL_PIN0     EQU 0
 1090  0000000                   CAP_SENSOR_SEL_PIN1     EQU 0
 1091  0000000                   CAP_SENSOR_SEL_PIN2     EQU 0
 1092  0000000                   CAP_SENSOR_SEL_PIN3     EQU 0
 1093  0000000                   
 1094  0000000                   CAP_SENSOR_IMPLEMENTATION       EQU 2
 1095  0000000                   WITH_CHARGE_ENABLE              EQU 0
 1096  0000000                   ;CapSensorChargeEnable
 1097  0000000                   
 1098  0000000                   ;;;; Common
 1099  0000000                   ;;;; 
 1100  0000000                   ;;;;
 1101  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1102  0000000                   WITH_FW_CAP_SENSOR_KEYS         EQU 0
 1103  0000000                   CAP_SENSOR_KEY0_TH              EQU 0
 1104  0000000                   CAP_SENSOR_KEY1_TH              EQU 0
 1105  0000000                   CAP_SENSOR_KEY2_TH              EQU 0
 1106  0000000                   CAP_SENSOR_KEY3_TH              EQU 0
 1107  0000000                   CAP_SENSOR_KEY4_TH              EQU 0
 1108  0000000                   CAP_SENSOR_KEY5_TH              EQU 0
 1109  0000000                   CAP_SENSOR_KEY6_TH              EQU 0
 1110  0000000                   CAP_SENSOR_KEY7_TH              EQU 0
 1111  0000000                   CAP_SENSOR_KEY8_TH              EQU 0
 1112  0000000                   CAP_SENSOR_KEY9_TH              EQU 0
 1113  0000000                   CAP_SENSOR_KEY10_TH             EQU 0
 1114  0000000                   CAP_SENSOR_KEY11_TH             EQU 0
 1115  0000000                   CAP_SENSOR_KEY12_TH             EQU 0
 1116  0000000                   CAP_SENSOR_KEY13_TH             EQU 0
 1117  0000000                   CAP_SENSOR_KEY14_TH             EQU 0
 1118  0000000                   CAP_SENSOR_KEY15_TH             EQU 0
 1119  0000000                   CAP_SENSOR_KEY16_TH             EQU 0
 1120  0000000                   CAP_SENSOR_KEY17_TH             EQU 0
 1121  0000000                   CAP_SENSOR_KEY18_TH             EQU 0
 1122  0000000                   CAP_SENSOR_KEY19_TH             EQU 0
 1123  0000000                   CAP_SENSOR_KEY20_TH             EQU 0
 1124  0000000                   CAP_SENSOR_KEY21_TH             EQU 0
 1125  0000000                   CAP_SENSOR_KEY22_TH             EQU 0
 1126  0000000                   CAP_SENSOR_KEY23_TH             EQU 0
 1127  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1128  0000000                   
 1129  0000000                   





 1130  0000000                   ;;;; Cap Sensor V1
 1131  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1132  0000000                   S_CAP_SENSOR_KEY_MASK           EQU 0H
 1133  0000000                   S_TOUCH_KEY_MASK                EQU 0H
 1134  0000000                   S_TOUCH_KEY_MASK_REV            EQU FFH
 1135  0000000                   CAP_SENSOR_KEY_EN0              EQU 0
 1136  0000000                   CAP_SENSOR_KEY_EN1              EQU 0
 1137  0000000                   CAP_SENSOR_KEY_EN2              EQU 0
 1138  0000000                   CAP_SENSOR_KEY_EN3              EQU 0
 1139  0000000                   CAP_SENSOR_KEY_EN4              EQU 0
 1140  0000000                   CAP_SENSOR_KEY_EN5              EQU 0
 1141  0000000                   CAP_SENSOR_KEY_EN6              EQU 0
 1142  0000000                   CAP_SENSOR_KEY_EN7              EQU 0
 1143  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1144  0000000                   
 1145  0000000                   ;;;; Cap Sensor V2
 1146  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1147  0000000                   CAP_SENSOR_KEY0_BP              EQU 0
 1148  0000000                   CAP_SENSOR_KEY1_BP              EQU 0
 1149  0000000                   CAP_SENSOR_KEY2_BP              EQU 0
 1150  0000000                   CAP_SENSOR_KEY3_BP              EQU 0
 1151  0000000                   CAP_SENSOR_KEY4_BP              EQU 0
 1152  0000000                   CAP_SENSOR_KEY5_BP              EQU 0
 1153  0000000                   CAP_SENSOR_KEY6_BP              EQU 0
 1154  0000000                   CAP_SENSOR_KEY7_BP              EQU 0
 1155  0000000                   CAP_SENSOR_KEY8_BP              EQU 0
 1156  0000000                   CAP_SENSOR_KEY9_BP              EQU 0
 1157  0000000                   CAP_SENSOR_KEY10_BP             EQU 0
 1158  0000000                   CAP_SENSOR_KEY11_BP             EQU 0
 1159  0000000                   CAP_SENSOR_KEY12_BP             EQU 0
 1160  0000000                   CAP_SENSOR_KEY13_BP             EQU 0
 1161  0000000                   CAP_SENSOR_KEY14_BP             EQU 0
 1162  0000000                   CAP_SENSOR_KEY15_BP             EQU 0
 1163  0000000                   CAP_SENSOR_KEY16_BP             EQU 0
 1164  0000000                   CAP_SENSOR_KEY17_BP             EQU 0
 1165  0000000                   CAP_SENSOR_KEY18_BP             EQU 0
 1166  0000000                   CAP_SENSOR_KEY19_BP             EQU 0
 1167  0000000                   CAP_SENSOR_KEY20_BP             EQU 0
 1168  0000000                   CAP_SENSOR_KEY21_BP             EQU 0
 1169  0000000                   CAP_SENSOR_KEY22_BP             EQU 0
 1170  0000000                   CAP_SENSOR_KEY23_BP             EQU 0
 1171  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1172  0000000                   
 1173  0000000                   ;;;;IO EXPANDER SETTING
 1174  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1175  0000000                   N55P_DEVICE_NUM		EQU       0          
 1176  0000000                   ;N55PDeviceNum:0/1/2
 1177  0000000                   N55P_DEVICE_UIO_USED	EQU       00H
 1178  0000000                   N55P_DEVICE0_CNSTA    EQU       00H          
 1179  0000000                   N55P_DEVICE0_CNSTB    EQU       00H          
 1180  0000000                   N55P_DEVICE0_CNSTC    EQU       00H          
 1181  0000000                   N55P_DEVICE0_PCKAB    EQU       00H     
 1182  0000000                   N55P_DEVICE0_PCKCD    EQU       00H         
 1183  0000000                   
 1184  0000000                   N55P_DEVICE1_CNSTA    EQU       00H          
 1185  0000000                   N55P_DEVICE1_CNSTB    EQU       00H          
 1186  0000000                   N55P_DEVICE1_CNSTC    EQU       00H          





 1187  0000000                   N55P_DEVICE1_PCKAB    EQU       00H     
 1188  0000000                   N55P_DEVICE1_PCKCD    EQU       00H     
 1189  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1190  0000000                   SPI_COMMAND_ENABLE        EQU 0
 1191  0000000                   I2C_COMMAND_ENABLE        EQU 0
 1192  0000000                   
 1193  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\RAMVAR.INI.APP"
 1194  0000000                   ;  0WITH_VOL_ADJ
 1195  0000000                   ;  0WITH_MULTI_CHANNEL
 1196  0000000                   ;  0WITH_VOL_REDUCE
 1197  0000000                   ;  0WITH_16BIT_MODE
 1198  0000000                   ;  1WITH_32K_BANK
 1199  0000000                   ;  1WITH_T_BUFFER
 1200  0000000                   ;  0WITH_READ_DATA_TYPE
 1201  0000000                   ;  0WITH_PCM_OUTPUT_TYPE
 1202  0000000                   ;  2WITH_PCM_OUTPUT_SIZE
 1203  0000000                   ;  0WITH_CMD
 1204  0000000                   ;  0WITH_FW_MIXER
 1205  0000000                   ;  2WITH_COMPRESSED_MIDI
 1206  0000000                   ;  0WITH_MULTIPLIER
 1207  0000000                   ;  1WITH_HEAD_TAIL_PROCESS
 1208  0000000                   ;  0WITH_ALL_MIXER_SFR
 1209  0000000                   ;  0WITH_ISR_VS0A
 1210  0000000                   ;  0WITH_ISR_VS0B
 1211  0000000                   ;  1WITH_ISR_VS1A
 1212  0000000                   ;  0WITH_ISR_VS1B
 1213  0000000                   ;  0WITH_ISR_VS2A
 1214  0000000                   ;  0WITH_ISR_VS2B
 1215  0000000                   ;  0WITH_VS0A
 1216  0000000                   ;  0WITH_VS0B
 1217  0000000                   ;  1WITH_VS1A
 1218  0000000                   ;  0WITH_VS1B
 1219  0000000                   ;  0WITH_VS2A
 1220  0000000                   ;  0WITH_VS2B
 1221  0000000                   ;  0WITH_VS0C
 1222  0000000                   ;  0WITH_VS0D
 1223  0000000                   ;  0WITH_VS3
 1224  0000000                   ;  0WITH_VS4
 1225  0000000                   ;  0WITH_VS5
 1226  0000000                   ;  0WITH_VS6
 1227  0000000                   ;  0WITH_VS7
 1228  0000000                   ;  0WITH_VS8
 1229  0000000                   ;  0WITH_VS9
 1230  0000000                   ;  0WITH_VSA
 1231  0000000                   ;  0WITH_VSB
 1232  0000000                   ;  0WITH_VSC
 1233  0000000                   ;  0WITH_VSD
 1234  0000000                   ;  0WITH_VSE
 1235  0000000                   ;  0WITH_VSF
 1236  0000000                   ;  0WITH_MD4
 1237  0000000                   ;  1WITH_NM4
 1238  0000000                   ;  0WITH_NM4S
 1239  0000000                   ;  0WITH_MDM
 1240  0000000                   ;  0WITH_APM
 1241  0000000                   ;  0WITH_LP8
 1242  0000000                   ;  0WITH_VC4
 1243  0000000                   ;  0WITH_MDR





 1244  0000000                   ;  0WITH_E2A
 1245  0000000                   ;  0WITH_EMM
 1246  0000000                   ;  0WITH_MD6
 1247  0000000                   ;  0WITH_P10
 1248  0000000                   ;  0WITH_PC8
 1249  0000000                   ;  1WITH_SIL
 1250  0000000                   ;  0WITH_VMDPC8
 1251  0000000                   ;  0WITH_PCSPC8
 1252  0000000                   ;  0WITH_TONE
 1253  0000000                   ;  0WITH_HQPC8
 1254  0000000                   ;  0WITH_HQ567
 1255  0000000                   ;  0WITH_VMD567
 1256  0000000                   ;  0WITH_HQ567_HW
 1257  0000000                   ;  0WITH_HQ569_HW
 1258  0000000                   ;  0WITH_YAD
 1259  0000000                   ;  0WITH_P16
 1260  0000000                   ;  0WITH_VC8
 1261  0000000                   ;  0WITH_PC8VMDPCS
 1262  0000000                   ;  0WITH_LP8VMDPCS
 1263  0000000                   ;  0WITH_P16VMDPCS
 1264  0000000                   ;  0WITH_POLYPHONY
 1265  0000000                   ;  0WITH_MIDI_CHANNEL
 1266  0000000                   ;  0WITH_VOL_ADJ_MS
 1267  0000000                   ;  0WITH_PAUSE_RESUME
 1268  0000000                   ;  0WITH_CHANNEL_PRESSURE
 1269  0000000                   ;  0WITH_NOTE_OFFSET
 1270  0000000                   ;  0WITH_CHANGE_TEMPO
 1271  0000000                   ;  0WITH_VELOCITY
 1272  0000000                   ;  0WITH_MS_EXT_MIDI
 1273  0000000                   ;  0WITH_SYNC_CH1_MS
 1274  0000000                   ;  0WITH_GLOBAL_CHANNEL_VOLM
 1275  0000000                   ;  0WITH_GLOBAL_CHANNEL_INS
 1276  0000000                   ;  0WITH_PITCH_BEND
 1277  0000000                   ;  0WITH_MODULATION_DEPTH
 1278  0000000                   ;  0WITH_CHANNEL_SUSTAIN
 1279  0000000                   ;  0WITH_SP_MIDI
 1280  0000000                   ;  0WITH_PERCUSSION
 1281  0000000                   ;  0WITH_DYNAMIC_CH
 1282  0000000                   ;  0WITH_MS_ENABLE_CHANNEL
 1283  0000000                   ;  1WITH_SP
 1284  0000000                   ;  0WITH_MS
 1285  0000000                   ;  0WITH_EVO
 1286  0000000                   ;  2WITH_SPEAKER_OUTPUT_TYPE
 1287  0000000                   ;  0WITH_SPEAKER_SWITCH
 1288  0000000                   ;  0WITH_SIM_SP
 1289  0000000                   ;  0WITH_SIM_TYPE
 1290  0000000                   ;  0WITH_EXT32MBIT
 1291  0000000                   ;  0WITH_EXT64M_SPI
 1292  0000000                   ;  1WITH_SP_NUM
 1293  0000000                   ;  0WITH_ONE_HQ
 1294  0000000                   ;  0WITH_PLAYE
 1295  0000000                   ;  0WITH_VS0A_SIL
 1296  0000000                   ;  0WITH_VS0B_SIL
 1297  0000000                   ;  1WITH_VS1A_SIL
 1298  0000000                   ;  0WITH_VS1B_SIL
 1299  0000000                   ;  0WITH_VS2A_SIL
 1300  0000000                   ;  0WITH_VS2B_SIL





 1301  0000000                   ;  0WITH_VS0A_MD4
 1302  0000000                   ;  0WITH_VS0B_MD4
 1303  0000000                   ;  0WITH_VS1A_MD4
 1304  0000000                   ;  0WITH_VS1B_MD4
 1305  0000000                   ;  0WITH_VS2A_MD4
 1306  0000000                   ;  0WITH_VS2B_MD4
 1307  0000000                   ;  0WITH_VS0A_NM4
 1308  0000000                   ;  0WITH_VS0B_NM4
 1309  0000000                   ;  1WITH_VS1A_NM4
 1310  0000000                   ;  0WITH_VS1B_NM4
 1311  0000000                   ;  0WITH_VS2A_NM4
 1312  0000000                   ;  0WITH_VS2B_NM4
 1313  0000000                   ;  0WITH_VS0A_NM4S
 1314  0000000                   ;  0WITH_VS0B_NM4S
 1315  0000000                   ;  0WITH_VS1A_NM4S
 1316  0000000                   ;  0WITH_VS1B_NM4S
 1317  0000000                   ;  0WITH_VS2A_NM4S
 1318  0000000                   ;  0WITH_VS2B_NM4S
 1319  0000000                   ;  0WITH_VS0A_MDM
 1320  0000000                   ;  0WITH_VS0B_MDM
 1321  0000000                   ;  0WITH_VS1A_MDM
 1322  0000000                   ;  0WITH_VS1B_MDM
 1323  0000000                   ;  0WITH_VS2A_MDM
 1324  0000000                   ;  0WITH_VS2B_MDM
 1325  0000000                   ;  0WITH_VS0A_APM
 1326  0000000                   ;  0WITH_VS0B_APM
 1327  0000000                   ;  0WITH_VS1A_APM
 1328  0000000                   ;  0WITH_VS1B_APM
 1329  0000000                   ;  0WITH_VS2A_APM
 1330  0000000                   ;  0WITH_VS2B_APM
 1331  0000000                   ;  0WITH_VS0A_LP8
 1332  0000000                   ;  0WITH_VS0B_LP8
 1333  0000000                   ;  0WITH_VS1A_LP8
 1334  0000000                   ;  0WITH_VS1B_LP8
 1335  0000000                   ;  0WITH_VS2A_LP8
 1336  0000000                   ;  0WITH_VS2B_LP8
 1337  0000000                   ;  0WITH_VS0A_VC4
 1338  0000000                   ;  0WITH_VS0B_VC4
 1339  0000000                   ;  0WITH_VS1A_VC4
 1340  0000000                   ;  0WITH_VS1B_VC4
 1341  0000000                   ;  0WITH_VS2A_VC4
 1342  0000000                   ;  0WITH_VS2B_VC4
 1343  0000000                   ;  0WITH_VS0A_MDR
 1344  0000000                   ;  0WITH_VS0B_MDR
 1345  0000000                   ;  0WITH_VS1A_MDR
 1346  0000000                   ;  0WITH_VS1B_MDR
 1347  0000000                   ;  0WITH_VS2A_MDR
 1348  0000000                   ;  0WITH_VS2B_MDR
 1349  0000000                   ;  0WITH_VS0A_E2A
 1350  0000000                   ;  0WITH_VS0B_E2A
 1351  0000000                   ;  0WITH_VS1A_E2A
 1352  0000000                   ;  0WITH_VS1B_E2A
 1353  0000000                   ;  0WITH_VS2A_E2A
 1354  0000000                   ;  0WITH_VS2B_E2A
 1355  0000000                   ;  0WITH_VS0A_EMM
 1356  0000000                   ;  0WITH_VS0B_EMM
 1357  0000000                   ;  0WITH_VS1A_EMM





 1358  0000000                   ;  0WITH_VS1B_EMM
 1359  0000000                   ;  0WITH_VS2A_EMM
 1360  0000000                   ;  0WITH_VS2B_EMM
 1361  0000000                   ;  0WITH_VS0A_MD6
 1362  0000000                   ;  0WITH_VS0B_MD6
 1363  0000000                   ;  0WITH_VS1A_MD6
 1364  0000000                   ;  0WITH_VS1B_MD6
 1365  0000000                   ;  0WITH_VS2A_MD6
 1366  0000000                   ;  0WITH_VS2B_MD6
 1367  0000000                   ;  0WITH_VS0A_P10
 1368  0000000                   ;  0WITH_VS0B_P10
 1369  0000000                   ;  0WITH_VS1A_P10
 1370  0000000                   ;  0WITH_VS1B_P10
 1371  0000000                   ;  0WITH_VS2A_P10
 1372  0000000                   ;  0WITH_VS2B_P10
 1373  0000000                   ;  0WITH_VS0A_PC8
 1374  0000000                   ;  0WITH_VS0B_PC8
 1375  0000000                   ;  0WITH_VS1A_PC8
 1376  0000000                   ;  0WITH_VS1B_PC8
 1377  0000000                   ;  0WITH_VS2A_PC8
 1378  0000000                   ;  0WITH_VS2B_PC8
 1379  0000000                   ;  0WITH_VS0A_VMDPC8
 1380  0000000                   ;  0WITH_VS0B_VMDPC8
 1381  0000000                   ;  0WITH_VS1A_VMDPC8
 1382  0000000                   ;  0WITH_VS1B_VMDPC8
 1383  0000000                   ;  0WITH_VS2A_VMDPC8
 1384  0000000                   ;  0WITH_VS2B_VMDPC8
 1385  0000000                   ;  0WITH_VS0A_PCSPC8
 1386  0000000                   ;  0WITH_VS0B_PCSPC8
 1387  0000000                   ;  0WITH_VS1A_PCSPC8
 1388  0000000                   ;  0WITH_VS1B_PCSPC8
 1389  0000000                   ;  0WITH_VS2A_PCSPC8
 1390  0000000                   ;  0WITH_VS2B_PCSPC8
 1391  0000000                   ;  0WITH_VS0A_TONE
 1392  0000000                   ;  0WITH_VS0B_TONE
 1393  0000000                   ;  0WITH_VS1A_TONE
 1394  0000000                   ;  0WITH_VS1B_TONE
 1395  0000000                   ;  0WITH_VS2A_TONE
 1396  0000000                   ;  0WITH_VS2B_TONE
 1397  0000000                   ;  0WITH_VS0A_HQPC8
 1398  0000000                   ;  0WITH_VS0B_HQPC8
 1399  0000000                   ;  0WITH_VS1A_HQPC8
 1400  0000000                   ;  0WITH_VS1B_HQPC8
 1401  0000000                   ;  0WITH_VS2A_HQPC8
 1402  0000000                   ;  0WITH_VS2B_HQPC8
 1403  0000000                   ;  0WITH_CH0_EVO
 1404  0000000                   ;  0WITH_CH1_EVO
 1405  0000000                   ;  0WITH_CH2_EVO
 1406  0000000                   ;  0WITH_FILTER
 1407  0000000                   ;  1WITH_NOISE_SHAPING
 1408  0000000                   ;  0WITH_DAC_ENABLE
 1409  0000000                   ;  1WITH_SP0XL_RESOLUTION
 1410  0000000                   ;  2WITH_SPEN_EFFECTIVE_BITS
 1411  0000000                   ;  1WITH_RDPC_VALUE
 1412  0000000                   ;  0WITH_MS_CODA
 1413  0000000                   ;  0WITH_SP_MIDI_SIMUL
 1414  0000000                   ;  0WITH_SP_SKIP





 1415  0000000                   ;  0WITH_SP_GLOBAL_SR
 1416  0000000                   ;  0WITH_RAM_OVER_STACK
 1417  0000000                   ; 20WITH_STACK_SIZE
 1418  0000000                   ;  0WITH_SPI_GPIO
 1419  0000000                   ;  0WITH_EN_ULTRAIO
 1420  0000000                   ;  0WITH_PSF_PROJECT
 1421  0000000                   ;  0WITH_FW_SEN_OPTION_PIN
 1422  0000000                   ;  1WITH_CAPSENSOR_MULTISENTABLE
 1423  0000000                   ;  0WITH_CHARGE_ENABLE
 1424  0000000                   ;  0WITH_FW_CAP_SENSOR_KEYS
 1425  0000000                   
 1426  0000000                   ;Support WITH_SP channel variables ========================
 1427  0000000                   CH_STATUS_SP                             EQU  0H ;  1,  0
 1428  0000000                   CH_ISR_SYNTH_START_SP                    EQU  1H ;  2,  1
 1429  0000000                   CH_PREVIOUS_PCM_SP                       EQU  3H ;  2,  3
 1430  0000000                   CH_PAUSE_PCM_SP                          EQU  5H ;  2,  5
 1431  0000000                   CH_DATA_ADDR_SP                          EQU  5H ;  2,  5
 1432  0000000                   CH_RAMP_BUF1_SP                          EQU  5H ;  2,  5
 1433  0000000                   CH_DATA_BANK_SP                          EQU  7H ;  1,  7
 1434  0000000                   CH_PHRASE_REPEAT_NUM_SP                  EQU  8H ;  1,  8
 1435  0000000                   CH_SENTENCE_START_ADDR_SP                EQU  9H ;  2,  9
 1436  0000000                   CH_RAMP_BUF2_SP                          EQU  9H ;  2,  9
 1437  0000000                   CH_SENTENCE_START_BANK_SP                EQU  BH ;  1, 11
 1438  0000000                   ; Size = 12  ==============================================
 1439  0000000                   
 1440  0000000                   ;Not support WITH_APM channel variables ========================
 1441  0000000                   
 1442  0000000                   ;Not support WITH_EAM channel variables ========================
 1443  0000000                   
 1444  0000000                   ;Not support WITH_E2A channel variables ========================
 1445  0000000                   
 1446  0000000                   ;Not support WITH_VC4 channel variables ========================
 1447  0000000                   
 1448  0000000                   ;Not support WITH_YAD channel variables ========================
 1449  0000000                   
 1450  0000000                   ;Support WITH_SIL channel variables ========================
 1451  0000000                   CH_STATUS_SIL                            EQU  0H ;  1,  0
 1452  0000000                   CH_ISR_SYNTH_START_SIL                   EQU  1H ;  2,  1
 1453  0000000                   CH_OLD_SAMPLE_SIL                        EQU  3H ;  2,  3
 1454  0000000                   CH_PAUSE_PCM_SIL                         EQU  5H ;  2,  5
 1455  0000000                   CH_DATA_ADDR_SIL                         EQU  5H ;  2,  5
 1456  0000000                   CH_DATA_BANK_SIL                         EQU  7H ;  1,  7
 1457  0000000                   CH_PHRASE_REPEAT_NUM_SIL                 EQU  8H ;  1,  8
 1458  0000000                   CH_SENTENCE_START_ADDR_SIL               EQU  9H ;  2,  9
 1459  0000000                   CH_SENTENCE_START_BANK_SIL               EQU  BH ;  1, 11
 1460  0000000                   CH_COUNTER_SIL                           EQU  CH ;  1, 12
 1461  0000000                   CH_COUNTER2_SIL                          EQU  DH ;  1, 13
 1462  0000000                   ; Size = 14  ==============================================
 1463  0000000                   
 1464  0000000                   ;Not support WITH_MDM channel variables ========================
 1465  0000000                   
 1466  0000000                   ;Not support WITH_EMM channel variables ========================
 1467  0000000                   
 1468  0000000                   ;Not support WITH_MD6 channel variables ========================
 1469  0000000                   
 1470  0000000                   ;Not support WITH_PC8 channel variables ========================
 1471  0000000                   





 1472  0000000                   ;Not support WITH_LP8 channel variables ========================
 1473  0000000                   
 1474  0000000                   ;Not support WITH_P10 channel variables ========================
 1475  0000000                   
 1476  0000000                   ;Not support WITH_P16 channel variables ========================
 1477  0000000                   
 1478  0000000                   ;Not support WITH_VC8 channel variables ========================
 1479  0000000                   
 1480  0000000                   ;Not support WITH_MD4 channel variables ========================
 1481  0000000                   
 1482  0000000                   ;Not support WITH_MDR channel variables ========================
 1483  0000000                   
 1484  0000000                   ;Support WITH_NM4 channel variables ========================
 1485  0000000                   CH_STATUS_NM4                            EQU  0H ;  1,  0
 1486  0000000                   CH_ISR_SYNTH_START_NM4                   EQU  1H ;  2,  1
 1487  0000000                   CH_OLD_SAMPLE_NM4                        EQU  3H ;  2,  3
 1488  0000000                   CH_PAUSE_PCM_NM4                         EQU  5H ;  2,  5
 1489  0000000                   CH_DATA_ADDR_NM4                         EQU  5H ;  2,  5
 1490  0000000                   CH_DATA_BANK_NM4                         EQU  7H ;  1,  7
 1491  0000000                   CH_PHRASE_REPEAT_NUM_NM4                 EQU  8H ;  1,  8
 1492  0000000                   CH_SENTENCE_START_ADDR_NM4               EQU  9H ;  2,  9
 1493  0000000                   CH_SENTENCE_START_BANK_NM4               EQU  BH ;  1, 11
 1494  0000000                   CH_COUNTER_NM4                           EQU  CH ;  1, 12
 1495  0000000                   CH_GAIN_BUFFER_NM4                       EQU  DH ;  2, 13
 1496  0000000                   CH_DECODE_DATA_NM4                       EQU  FH ;  1, 15
 1497  0000000                   CH_PREV1_BUFFER_NM4                      EQU 10H ;  1, 16
 1498  0000000                   CH_PREV2_BUFFER_NM4                      EQU 11H ;  1, 17
 1499  0000000                   CH_PCM_TABLE_ADDR1_NM4                   EQU 12H ;  2, 18
 1500  0000000                   CH_PCM_TABLE_ADDR2_NM4                   EQU 14H ;  2, 20
 1501  0000000                   CH_INSERT_FLAG_NM4                       EQU 16H ;  1, 22
 1502  0000000                   CH_NEXT_SAMPLE_NM4                       EQU 17H ;  2, 23
 1503  0000000                   ; Size = 25  ==============================================
 1504  0000000                   
 1505  0000000                   ;Not support WITH_NM4S channel variables ========================
 1506  0000000                   CH_STATUS_MS                             EQU  0H ;  0,   0
 1507  0000000                   
 1508  0000000                   
 1509  0000000                   ;Support WITH_EVO channel variables ========================
 1510  0000000                   CH_STATUS_EVO                            EQU  0H ;  1,   0
 1511  0000000                   
 1512  0000000                   ;     RAM addresses =======================================
 1513  0000000                   GLOBAL_PLAY                              EQU  0H ;  1,   0
 1514  0000000                   COMMON_FLAG                              EQU  1H ;  1,   1
 1515  0000000                   COMMON_FLAG2                             EQU  2H ;  1,   2
 1516  0000000                   SPEN_TMP                                 EQU  3H ;  0,   3
 1517  0000000                   SUB_INDEX                                EQU  3H ;  0,   3
 1518  0000000                   COMMAND_OPERAND                          EQU  3H ;  1,   3
 1519  0000000                   RAMP_CHANNEL                             EQU  3H ;  1,   3
 1520  0000000                   RAMP_OPERAND                             EQU  3H ;  1,   3
 1521  0000000                   TEMP_REG1                                EQU  4H ;  2,   4
 1522  0000000                   TEMP_REG2                                EQU  6H ;  2,   6
 1523  0000000                   GLOBAL_VOL_SP0                           EQU  8H ;  1,   8
 1524  0000000                   GLOBAL_VOL_SP1                           EQU  8H ;  1,   8
 1525  0000000                   GLOBAL_VOL_SP2                           EQU  8H ;  1,   8
 1526  0000000                   GLOBAL_MASTER_VOL_MS                     EQU  8H ;  1,   8
 1527  0000000                   CH1_GLOBAL_TMC                           EQU  8H ;  1,   8
 1528  0000000                   CH1_GLOBAL_TMV                           EQU  8H ;  1,   8





 1529  0000000                   CH2_GLOBAL_TMC                           EQU  8H ;  1,   8
 1530  0000000                   CH2_GLOBAL_TMV                           EQU  8H ;  1,   8
 1531  0000000                   CH3_GLOBAL_TMC                           EQU  8H ;  1,   8
 1532  0000000                   CH3_GLOBAL_TMV                           EQU  8H ;  1,   8
 1533  0000000                   VS0A_START                               EQU  8H ;  0,   8
 1534  0000000                   VS0B_START                               EQU  8H ;  0,   8
 1535  0000000                   VS1A_START                               EQU  8H ; 25,   8
 1536  0000000                   VS1B_START                               EQU 21H ;  0,  33
 1537  0000000                   VS2A_START                               EQU 21H ;  0,  33
 1538  0000000                   VS2B_START                               EQU 21H ;  0,  33
 1539  0000000                   MS_START                                 EQU  8H ;  0,   8
 1540  0000000                   EVO0_START                               EQU 21H ;  0,  33
 1541  0000000                   EVO1_START                               EQU 21H ;  0,  33
 1542  0000000                   EVO2_START                               EQU 21H ;  0,  33
 1543  0000000                   CH_SYNTH_CHANNEL0                        EQU 21H ;  0,  33
 1544  0000000                   CH_SYNTH_CHANNEL1                        EQU 21H ;  0,  33
 1545  0000000                   CH_SYNTH_CHANNEL2                        EQU 21H ;  0,  33
 1546  0000000                   GLOBAL_CHANNEL_VOLM0                     EQU 21H ;  0,  33
 1547  0000000                   GLOBAL_CHANNEL_VOLM1                     EQU 21H ;  0,  33
 1548  0000000                   GLOBAL_CHANNEL_VOLM2                     EQU 21H ;  0,  33
 1549  0000000                   GLOBAL_CHANNEL_INS0                      EQU 21H ;  0,  33
 1550  0000000                   GLOBAL_CHANNEL_INS1                      EQU 21H ;  0,  33
 1551  0000000                   GLOBAL_CHANNEL_INS2                      EQU 21H ;  0,  33
 1552  0000000                   CH1_PLAY_SEGMENT                         EQU 21H ;  0,  33
 1553  0000000                   CH2_PLAY_SEGMENT                         EQU 21H ;  0,  33
 1554  0000000                   CH3_PLAY_SEGMENT                         EQU 21H ;  0,  33
 1555  0000000                   BP0M_BAK                                 EQU 21H ;  0,  33
 1556  0000000                   BP1M_BAK                                 EQU 21H ;  0,  33
 1557  0000000                   BP2M_BAK                                 EQU 21H ;  0,  33
 1558  0000000                   USER_START                               EQU 21H ; 33
 1559  0000000                   
 1560  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\SYNTHCONSTANT_EXTERNAL.INI.APP"
 1561  0000000                   	EXTERN TONE_MELODY_TYPE
 1562  0000000                   	EXTERN VMDPC8_MELODY_TYPE
 1563  0000000                   	EXTERN HQPC8_MELODY_TYPE
 1564  0000000                   	EXTERN PCSPC8_MELODY_TYPE
 1565  0000000                   	EXTERN END_MELODY_TYPE
 1566  0000000                   ;========================================================================	
 1567  0000000                   	EXTERN TONE_MELODY_TYPE_2
 1568  0000000                   	EXTERN VMDPC8_MELODY_TYPE_2
 1569  0000000                   	EXTERN HQPC8_MELODY_TYPE_2
 1570  0000000                   	EXTERN PCSPC8_MELODY_TYPE_2
 1571  0000000                   ;========================================================================
 1572  0000000                   	EXTERN RESTYPE_APM
 1573  0000000                   	EXTERN RESTYPE_PC8
 1574  0000000                   	EXTERN RESTYPE_P10
 1575  0000000                   	EXTERN RESTYPE_SIL
 1576  0000000                   	EXTERN RESTYPE_MDM
 1577  0000000                   	EXTERN RESTYPE_EMM
 1578  0000000                   	EXTERN RESTYPE_LP8
 1579  0000000                   	EXTERN RESTYPE_MD6
 1580  0000000                   	EXTERN RESTYPE_E2A
 1581  0000000                   	EXTERN RESTYPE_VC4
 1582  0000000                   	EXTERN RESTYPE_MD4		
 1583  0000000                   	EXTERN RESTYPE_MDR
 1584  0000000                   	EXTERN RESTYPE_NM4
 1585  0000000                   	EXTERN RESTYPE_NM4S	





 1586  0000000                   
 1587  0000000                   	EXTERN RESTYPE_EVO
 1588  0000000                   	EXTERN RESTYPE_MIDI0
 1589  0000000                   ;============================================================================
 1590  0000000                   	EXTERN CHANNEL_ID_START
 1591  0000000                   	EXTERN CHANNEL_VS0A
 1592  0000000                   	EXTERN CHANNEL_VS0B
 1593  0000000                   	EXTERN CHANNEL_VS0
 1594  0000000                   ;-------------------------------------------------------------------------
 1595  0000000                   	EXTERN CHANNEL_VS1A
 1596  0000000                   	EXTERN CHANNEL_VS1B
 1597  0000000                   	EXTERN CHANNEL_VS1
 1598  0000000                   ;-------------------------------------------------------------------------
 1599  0000000                   	EXTERN CHANNEL_VS2A
 1600  0000000                   	EXTERN CHANNEL_VS2B
 1601  0000000                   	EXTERN CHANNEL_VS2
 1602  0000000                   ;-------------------------------------------------------------------------
 1603  0000000                   	EXTERN CHANNEL_MS
 1604  0000000                   ;-------------------------------------------------------------------------
 1605  0000000                   	EXTERN CHANNEL_EVO0			
 1606  0000000                   	EXTERN CHANNEL_EVO1
 1607  0000000                   	EXTERN CHANNEL_EVO2
 1608  0000000                   ;-------------------------------------------------------------------------
 1609  0000000                   	EXTERN CHANNEL_NONE
 1610  0000000                   ;============================================================================
 1611  0000000                   	EXTERN CHANNEL_VS0A_2
 1612  0000000                   	EXTERN CHANNEL_VS0B_2
 1613  0000000                   	EXTERN CHANNEL_VS0_2
 1614  0000000                   	EXTERN CHANNEL_VS1A_2
 1615  0000000                   	EXTERN CHANNEL_VS1B_2
 1616  0000000                   	EXTERN CHANNEL_VS1_2
 1617  0000000                   	EXTERN CHANNEL_VS2A_2
 1618  0000000                   	EXTERN CHANNEL_VS2B_2
 1619  0000000                   	EXTERN CHANNEL_VS2_2
 1620  0000000                   	EXTERN CHANNEL_MS_2
 1621  0000000                   ;========================================================================
 1622  0000000                   ; Speech / melody channel flags
 1623  0000000                   ;========================================================================
 1624  0000000                   	EXTERN SP_BZ
 1625  0000000                   
 1626  0000000                   	EXTERN SP_DC_RAMP_UP_FOR_MS
 1627  0000000                   	EXTERN SP_INIT
 1628  0000000                   
 1629  0000000                   	EXTERN SP_NOTE
 1630  0000000                   
 1631  0000000                   	EXTERN SP_DC_RAMP_DOWN
 1632  0000000                   	EXTERN SP_EXT_NOTE
 1633  0000000                   
 1634  0000000                   	EXTERN SP_PAUSE
 1635  0000000                   
 1636  0000000                   	EXTERN SP_DECAY
 1637  0000000                   	EXTERN SP_RESUME
 1638  0000000                   
 1639  0000000                   	EXTERN SP_DC_RAMP_UP
 1640  0000000                   
 1641  0000000                   	EXTERN SP_ADSR
 1642  0000000                   	EXTERN SP_DRUM





 1643  0000000                   	EXTERN SP_AUD
 1644  0000000                   ;---------------------------------------------------------------------------------------
 1645  0000000                   ; Melody flags
 1646  0000000                   ;---------------------------------------------------------------------------------------
 1647  0000000                   	EXTERN MS_BZ
 1648  0000000                   
 1649  0000000                   	EXTERN MS_DC_RAMP_UP
 1650  0000000                   	EXTERN MS_COMD_PHRASE
 1651  0000000                   
 1652  0000000                   	EXTERN MS_LE
 1653  0000000                   
 1654  0000000                   	EXTERN MS_PS
 1655  0000000                   	EXTERN MS_PAUSE
 1656  0000000                   
 1657  0000000                   	EXTERN MS_DC_RAMP_DOWN
 1658  0000000                   	EXTERN MS_COMD_EVENT
 1659  0000000                   
 1660  0000000                   	EXTERN MS_STOP
 1661  0000000                   
 1662  0000000                   	EXTERN MS_CNP
 1663  0000000                   ;---------------------------------------------------------------------------------------
 1664  0000000                   ; EVO flags
 1665  0000000                   ;---------------------------------------------------------------------------------------
 1666  0000000                   	EXTERN EVO_BZ
 1667  0000000                   
 1668  0000000                   	EXTERN EVO_PAUSE
 1669  0000000                   
 1670  0000000                   	EXTERN EVO_EVENT_TYPE
 1671  0000000                   	EXTERN EVO_NOP_EVENT
 1672  0000000                   	EXTERN EVO_COMD_EVENT
 1673  0000000                   	EXTERN EVO_STOP_EVENT
 1674  0000000                   ;=========================================GLOBAL_PLAY bits
 1675  0000000                   	EXTERN SP1_BZ
 1676  0000000                   	EXTERN SP2_BZ
 1677  0000000                   	EXTERN SP3_BZ
 1678  0000000                   	EXTERN EVO1_BZ
 1679  0000000                   	EXTERN EVO2_BZ
 1680  0000000                   	EXTERN EVO3_BZ
 1681  0000000                   	EXTERN MIDI_BZ
 1682  0000000                   	EXTERN MS_EXT
 1683  0000000                   ;========================================COMMON_FLAG bits
 1684  0000000                   	EXTERN TAIL_OFF_DAC
 1685  0000000                   ;	EXTERN NOISE_SHAPING_FLAG	
 1686  0000000                   ;========================================================================
 1687  0000000                   ;ENV_STATE_HOLD 					EQ 0
 1688  0000000                   	EXTERN ENV_STATE_ATTACK
 1689  0000000                   	EXTERN ENV_STATE_DECAY
 1690  0000000                   	EXTERN ENV_STATE_SUSTAIN
 1691  0000000                   	EXTERN ENV_STATE_RELEASE
 1692  0000000                   
 1693  0000000                   ;========================================================================
 1694  0000000                   	EXTERN HEAD_TAIL_STEP_COUNT
 1695  0000000                   	EXTERN PLAY_PHRASE_LEN
 1696  0000000                   	EXTERN PLAY_PHRASE_MDR_LEN
 1697  0000000                   ;===========================================================================
 1698  0000000                   	EXTERN DRUM_CHANNEL_ID
 1699  0000000                   





 1700  0000000                   	EXTERN SP_CH0
 1701  0000000                   	EXTERN SP_CH1
 1702  0000000                   	EXTERN SP_CH2
 1703  0000000                   
 1704  0000000                   	EXTERN MS_CH0
 1705  0000000                   	EXTERN MS_CH1
 1706  0000000                   	EXTERN MS_CH2
 1707  0000000                   ;===========================================================================
 1708  0000000                   	EXTERN SPEECH_TYPE
 1709  0000000                   	EXTERN EVO_TYPE
 1710  0000000                   	EXTERN GLOBAL_SR_FLAG
 1711  0000000                   	EXTERN GLOBAL_VOL_FLAG
 1712  0000000                   	EXTERN GLOBAL_VOL_MS_FLAG
 1713  0000000                   
 1714  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\MACROS.INI.APP"
 1715  0000000                   A_TOGGLE						EQU	00100000B
 1716  0000000                   I_TOGGLE						EQU	00010000B
 1717  0000000                   AI_TOGGLE						EQU	00110000B
 1718  0000000                   ;===============================================================
 1719  0000000                   ;
 1720  0000000                   ;===============================================================
 1721  0000000                   LDA_DP MACRO VAR_ADDR				
 1722  0000000                   	LDA <VAR_ADDR
 1723  0000000                   	ENDM
 1724  0000000                   ;------------------------------------------------------------------------------
 1725  0000000                   LDA_DP_CH MACRO VAR_ADDR				
 1726  0000000                   	LDA <CHANNEL_ADDR+VAR_ADDR
 1727  0000000                   	ENDM
 1728  0000000                   ;------------------------------------------------------------------------------
 1729  0000000                   LDA_DP_X MACRO VAR_ADDR				
 1730  0000000                   	LDA <VAR_ADDR,X
 1731  0000000                   	ENDM
 1732  0000000                   ;------------------------------------------------------------------------------
 1733  0000000                   LDA_DP_X_CH MACRO VAR_ADDR
 1734  0000000                   	LDA_DP_X CHANNEL_ADDR+VAR_ADDR		
 1735  0000000                   	ENDM
 1736  0000000                   ;------------------------------------------------------------------------------
 1737  0000000                   LDA_AI_Y_CH MACRO VAR_ADDR				
 1738  0000000                   	LDA !DIRECT_PAGE+CHANNEL_ADDR+VAR_ADDR,Y
 1739  0000000                   	ENDM
 1740  0000000                   ;------------------------------------------------------------------------------
 1741  0000000                   LDA_DP_ILI MACRO VAR_ADDR	
 1742  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1743  0000000                   ;	LDA [<VAR_ADDR]
 1744  0000000                   ;	.ELSE
 1745  0000000                   	LDA <VAR_ADDR+2
 1746  0000000                   	STA !BANK
 1747  0000000                   	LDA (<VAR_ADDR)
 1748  0000000                   ;	.ENDIF
 1749  0000000                   	ENDM
 1750  0000000                   ;------------------------------------------------------------------------------
 1751  0000000                   LDA_DP_ILI_Y MACRO VAR_ADDR	
 1752  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1753  0000000                   ;	LDA [<VAR_ADDR],Y
 1754  0000000                   ;	.ELSE
 1755  0000000                   	LDA <VAR_ADDR+2
 1756  0000000                   	STA !BANK





 1757  0000000                   	LDA (<VAR_ADDR),Y
 1758  0000000                   ;	.ENDIF
 1759  0000000                   	ENDM
 1760  0000000                   ;------------------------------------------------------------------------------
 1761  0000000                   LDA_DP_ILI_CH MACRO	VAR_ADDR		
 1762  0000000                   	LDA_DP_ILI_SIM CHANNEL_ADDR+VAR_ADDR
 1763  0000000                   	ENDM
 1764  0000000                   ;===============================================================
 1765  0000000                   LDX_DP_CH MACRO VAR_ADDR				
 1766  0000000                   	LDX <CHANNEL_ADDR+VAR_ADDR
 1767  0000000                   	ENDM
 1768  0000000                   
 1769  0000000                   ;===============================================================
 1770  0000000                   LDY_DP_CH MACRO VAR_ADDR				
 1771  0000000                   	LDY <CHANNEL_ADDR+VAR_ADDR
 1772  0000000                   	ENDM
 1773  0000000                   
 1774  0000000                   ;===============================================================
 1775  0000000                   STY_DP_CH MACRO VAR_ADDR				
 1776  0000000                   	STY <CHANNEL_ADDR+VAR_ADDR
 1777  0000000                   	ENDM
 1778  0000000                   ;===============================================================
 1779  0000000                   STX_DP_CH MACRO VAR_ADDR				
 1780  0000000                   	STX <CHANNEL_ADDR+VAR_ADDR
 1781  0000000                   	ENDM
 1782  0000000                   
 1783  0000000                   ;===============================================================
 1784  0000000                   ;
 1785  0000000                   ;===============================================================
 1786  0000000                   STA_DP MACRO VAR_ADDR				
 1787  0000000                   	STA <VAR_ADDR
 1788  0000000                   	ENDM
 1789  0000000                   ;------------------------------------------------------------------------------
 1790  0000000                   STA_DP_CH MACRO VAR_ADDR				
 1791  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR
 1792  0000000                   	ENDM
 1793  0000000                   ;------------------------------------------------------------------------------
 1794  0000000                   STA_DP_X MACRO VAR_ADDR				
 1795  0000000                   	STA <VAR_ADDR,X
 1796  0000000                   	ENDM
 1797  0000000                   ;------------------------------------------------------------------------------
 1798  0000000                   STA_DP_X_CH MACRO VAR_ADDR
 1799  0000000                   	STA_DP_X CHANNEL_ADDR+VAR_ADDR
 1800  0000000                   	ENDM
 1801  0000000                   
 1802  0000000                   ;------------------------------------------------------------------------------
 1803  0000000                   ; MACRO TO DEFINED ACCESS RAM
 1804  0000000                   ;------------------------------------------------------------------------------
 1805  0000000                   
 1806  0000000                   SYNTH_LABEL MACRO LABEL,CHANNEL_NAME
 1807  0000000                   .IFNDEF WITH_USER_PLAY
 1808  0000000                   CHANNEL_ADDR 		EQU CHANNEL_NAME|_START
 1809  0000000                   ;CHANNEL_ID			EQU CHANNEL_|CHANNEL_NAME
 1810  0000000                   START_CHANNEL_ID 	EQU CHANNEL_|CHANNEL_NAME
 1811  0000000                   START_CHANNEL_ID_2 	EQU CHANNEL_|CHANNEL_NAME|_2
 1812  0000000                   .IF (CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
 1813  0000000                   START_SIM_BUF		EQU	SP_START_SIM_BUF_|CHANNEL_NAME





 1814  0000000                   .ENDIF
 1815  0000000                   .ENDIF
 1816  0000000                   	PUBLIC	LABEL|_|CHANNEL_NAME
 1817  0000000                   LABEL|_|CHANNEL_NAME:					;STATE IS NOW X X X 0 0 0 1 BZ
 1818  0000000                   
 1819  0000000                   	ENDM
 1820  0000000                   
 1821  0000000                   ;================================================================================
 1822  0000000                   SYNTH_LABEL_EVO MACRO LABEL,CHANNEL_NAME
 1823  0000000                   
 1824  0000000                   CHANNEL_ADDR 		EQU CHANNEL_NAME|_START
 1825  0000000                   START_CHANNEL_ID 	EQU CHANNEL_|CHANNEL_NAME
 1826  0000000                   ;START_CHANNEL_ID_2 	EQU CHANNEL_|CHANNEL_NAME|_2
 1827  0000000                   
 1828  0000000                   	PUBLIC	LABEL|_|CHANNEL_NAME
 1829  0000000                   LABEL|_|CHANNEL_NAME:					;STATE IS NOW X X X 0 0 0 1 BZ
 1830  0000000                   
 1831  0000000                   	ENDM
 1832  0000000                   ;===============================================================
 1833  0000000                   STA_ISR MACRO ISR_ADDR,FORMAT_CHANNEL
 1834  0000000                   	LDA #.LOW.ISR_ADDR
 1835  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 1836  0000000                   	LDA #.HIGH.ISR_ADDR
 1837  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 1838  0000000                   	ENDM
 1839  0000000                   ;------------------------------------------------------------------------------
 1840  0000000                   STA_ISR_SKIP MACRO ISR_ADDR,FORMAT_CHANNEL
 1841  0000000                   	EXTERN SP_SKIP_SEGMENT_PROC
 1842  0000000                   	LDA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 1843  0000000                   	CMP #.LOW.SP_SKIP_SEGMENT_PROC
 1844  0000000                   	BNE STA_ISR_SKIP_NEXT#
 1845  0000000                   	LDA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 1846  0000000                   	CMP #.HIGH.SP_SKIP_SEGMENT_PROC
 1847  0000000                   	BEQ STA_ISR_SKIP_END#
 1848  0000000                   
 1849  0000000                   STA_ISR_SKIP_NEXT#:
 1850  0000000                   	LDA #.LOW.ISR_ADDR
 1851  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 1852  0000000                   	LDA #.HIGH.ISR_ADDR
 1853  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 1854  0000000                   STA_ISR_SKIP_END#:
 1855  0000000                   	ENDM
 1856  0000000                   ;------------------------------------------------------------------------------
 1857  0000000                   STA_ISR_X MACRO ISR_ADDR,FORMAT_CHANNEL
 1858  0000000                   	LDA #.LOW.ISR_ADDR
 1859  0000000                   	STA <CH_ISR_SYNTH_START|FORMAT_CHANNEL,X
 1860  0000000                   	LDA #.HIGH.ISR_ADDR
 1861  0000000                   	STA <CH_ISR_SYNTH_START|FORMAT_CHANNEL+1,X
 1862  0000000                   	ENDM
 1863  0000000                   
 1864  0000000                   ;===============================================================
 1865  0000000                   ;
 1866  0000000                   ;===============================================================
 1867  0000000                   ORA_DP_CH MACRO VAR_ADDR
 1868  0000000                   	ORA <CHANNEL_ADDR+VAR_ADDR
 1869  0000000                   	ENDM
 1870  0000000                   





 1871  0000000                   ;===============================================================
 1872  0000000                   ;
 1873  0000000                   ;===============================================================
 1874  0000000                   INC_DP_CH MACRO VAR_ADDR
 1875  0000000                   	INC <CHANNEL_ADDR+VAR_ADDR
 1876  0000000                   	ENDM
 1877  0000000                   
 1878  0000000                   ;===============================================================
 1879  0000000                   ;
 1880  0000000                   ;===============================================================
 1881  0000000                   ASL_DP_CH MACRO VAR_ADDR
 1882  0000000                   	ASL <CHANNEL_ADDR+VAR_ADDR
 1883  0000000                   	ENDM
 1884  0000000                   ;===============================================================
 1885  0000000                   ROL_DP_CH MACRO VAR_ADDR
 1886  0000000                   	ROL <CHANNEL_ADDR+VAR_ADDR
 1887  0000000                   	ENDM
 1888  0000000                   
 1889  0000000                   ;===============================================================
 1890  0000000                   ;
 1891  0000000                   ;===============================================================
 1892  0000000                   LSR_DP_CH MACRO VAR_ADDR
 1893  0000000                   	LSR <CHANNEL_ADDR+VAR_ADDR
 1894  0000000                   	ENDM
 1895  0000000                   
 1896  0000000                   ;===============================================================
 1897  0000000                   ;
 1898  0000000                   ;===============================================================
 1899  0000000                   ROR_DP_CH MACRO VAR_ADDR
 1900  0000000                   	ROR <CHANNEL_ADDR+VAR_ADDR
 1901  0000000                   	ENDM
 1902  0000000                   
 1903  0000000                   ;===============================================================
 1904  0000000                   ;
 1905  0000000                   ;===============================================================
 1906  0000000                   CMP_DP_CH MACRO VAR_ADDR
 1907  0000000                   	CMP <CHANNEL_ADDR+VAR_ADDR
 1908  0000000                   	ENDM
 1909  0000000                   
 1910  0000000                   ;===============================================================
 1911  0000000                   CPX_DP_CH MACRO VAR_ADDR
 1912  0000000                   	CPX <CHANNEL_ADDR+VAR_ADDR
 1913  0000000                   	ENDM
 1914  0000000                   
 1915  0000000                   ;===============================================================
 1916  0000000                   CPY_DP_CH MACRO VAR_ADDR
 1917  0000000                   	CPY <CHANNEL_ADDR+VAR_ADDR
 1918  0000000                   	ENDM
 1919  0000000                   
 1920  0000000                   ;===============================================================
 1921  0000000                   ;
 1922  0000000                   ;===============================================================
 1923  0000000                   ADC_DP_CH MACRO VAR_ADDR
 1924  0000000                   	ADC <CHANNEL_ADDR+VAR_ADDR
 1925  0000000                   	ENDM
 1926  0000000                   
 1927  0000000                   ;===============================================================





 1928  0000000                   ;
 1929  0000000                   ;===============================================================
 1930  0000000                   AND_DP_CH MACRO VAR_ADDR
 1931  0000000                   	AND <CHANNEL_ADDR+VAR_ADDR
 1932  0000000                   	ENDM
 1933  0000000                   
 1934  0000000                   ;===============================================================
 1935  0000000                   ;
 1936  0000000                   ;===============================================================
 1937  0000000                   STZ_DP_CH MACRO VAR_ADDR
 1938  0000000                   	STZ <CHANNEL_ADDR+VAR_ADDR
 1939  0000000                   	ENDM
 1940  0000000                   
 1941  0000000                   ;===============================================================
 1942  0000000                   ;
 1943  0000000                   ;===============================================================
 1944  0000000                   BIT_DP_CH MACRO VAR_ADDR
 1945  0000000                   	BIT <CHANNEL_ADDR+VAR_ADDR
 1946  0000000                   	ENDM
 1947  0000000                   ;===============================================================
 1948  0000000                   ;
 1949  0000000                   ;===============================================================
 1950  0000000                   TRB_DP_CH MACRO VAR_ADDR
 1951  0000000                   	TRB <CHANNEL_ADDR+VAR_ADDR
 1952  0000000                   	ENDM
 1953  0000000                   ;===============================================================
 1954  0000000                   TSB_DP_CH MACRO VAR_ADDR
 1955  0000000                   	TSB <CHANNEL_ADDR+VAR_ADDR
 1956  0000000                   	ENDM
 1957  0000000                   ;===============================================================
 1958  0000000                   ;
 1959  0000000                   ;===============================================================
 1960  0000000                   DEC_DP_CH MACRO VAR_ADDR
 1961  0000000                   	DEC <CHANNEL_ADDR+VAR_ADDR
 1962  0000000                   	ENDM
 1963  0000000                   
 1964  0000000                   ;===============================================================
 1965  0000000                   ;
 1966  0000000                   ;===============================================================
 1967  0000000                   EOR_DP_CH MACRO VAR_ADDR
 1968  0000000                   	EOR <CHANNEL_ADDR+VAR_ADDR
 1969  0000000                   	ENDM
 1970  0000000                   
 1971  0000000                   ;===============================================================
 1972  0000000                   ;
 1973  0000000                   ;===============================================================
 1974  0000000                   SBC_DP_CH MACRO VAR_ADDR
 1975  0000000                   	SBC <CHANNEL_ADDR+VAR_ADDR
 1976  0000000                   	ENDM
 1977  0000000                   
 1978  0000000                   ;------------------------------------------------------------------------------
 1979  0000000                   SBC_DP_ILI_Y MACRO VAR_ADDR	
 1980  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1981  0000000                   ;	SBC [<VAR_ADDR],Y
 1982  0000000                   ;	.ELSE
 1983  0000000                   	LDA <VAR_ADDR+2
 1984  0000000                   	STA !BANK





 1985  0000000                   	SBC (<VAR_ADDR),Y
 1986  0000000                   ;	.ENDIF
 1987  0000000                   	ENDM
 1988  0000000                   
 1989  0000000                   ;------------------------------------------------------------------------------
 1990  0000000                   SBC_DP_ILI_Y_CH MACRO VAR_ADDR	
 1991  0000000                   	SBC_DP_ILI_Y CHANNEL_ADDR+VAR_ADDR	
 1992  0000000                   	ENDM
 1993  0000000                   ;------------------------------------------------------------------------------
 1994  0000000                   ADC_DP_ILI_Y MACRO VAR_ADDR	
 1995  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1996  0000000                   ;	ADC [<VAR_ADDR],Y
 1997  0000000                   ;	.ELSE
 1998  0000000                   	LDA <VAR_ADDR+2
 1999  0000000                   	STA !BANK
 2000  0000000                   	ADC (<VAR_ADDR),Y
 2001  0000000                   ;	.ENDIF
 2002  0000000                   	ENDM
 2003  0000000                   
 2004  0000000                   ;------------------------------------------------------------------------------
 2005  0000000                   ADC_DP_ILI_Y_CH MACRO VAR_ADDR	
 2006  0000000                   	ADC_DP_ILI_Y CHANNEL_ADDR+VAR_ADDR
 2007  0000000                   	ENDM
 2008  0000000                   
 2009  0000000                   ;------------------------------------------------------------------------------
 2010  0000000                   ADC_DP_ILI MACRO VAR_ADDR	
 2011  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2012  0000000                   ;	ADC [<VAR_ADDR]
 2013  0000000                   ;	.ELSE
 2014  0000000                   	LDA <VAR_ADDR+2
 2015  0000000                   	STA !BANK
 2016  0000000                   	ADC (<VAR_ADDR)
 2017  0000000                   ;	.ENDIF
 2018  0000000                   	ENDM
 2019  0000000                   ;------------------------------------------------------------------------------
 2020  0000000                   LDA_DP_ILI_CH_DATA_HQ MACRO CHANNEL_NAME
 2021  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2022  0000000                   	STZ !BANK1
 2023  0000000                   	.ENDIF
 2024  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME+2
 2025  0000000                   	STA !BANK
 2026  0000000                   	LDA (<CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME)
 2027  0000000                   	ENDM
 2028  0000000                   ;------------------------------------------------------------------------------
 2029  0000000                   LDA_DP_ILI_CH_DATA MACRO CHANNEL_NAME
 2030  0000000                   .IFNDEF WITH_USER_PLAY
 2031  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2032  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1|CHANNEL_NAME
 2033  0000000                   	AND #03H
 2034  0000000                   	STA !BANK1
 2035  0000000                   	.ENDIF
 2036  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK|CHANNEL_NAME
 2037  0000000                   	SW_CS
 2038  0000000                   	STA !BANK
 2039  0000000                   	LDA (<CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME)
 2040  0000000                   .ELSE
 2041  0000000                   	LDX <CHANNEL_ADDR+CH_DATA_INDEX|CHANNEL_NAME





 2042  0000000                   	LDA <USER_PLAY_BUF,X
 2043  0000000                   .ENDIF
 2044  0000000                   	ENDM
 2045  0000000                   
 2046  0000000                   ;------------------------------------------------------------------------------
 2047  0000000                   LDA_DP_ILI_CH_DATA_MS MACRO 
 2048  0000000                   	LDA_DP_ILI_CH_DATA _MS
 2049  0000000                   	ENDM
 2050  0000000                   
 2051  0000000                   ;------------------------------------------------------------------------------
 2052  0000000                   LDA_DP_ILI_Y_CH MACRO	VAR_ADDR
 2053  0000000                   	LDA_DP_ILI_Y_SIM CHANNEL_ADDR+VAR_ADDR
 2054  0000000                   	ENDM
 2055  0000000                   
 2056  0000000                   ;===============================================================
 2057  0000000                   ;DESIGNATION
 2058  0000000                   ;===============================================================
 2059  0000000                   LDA_DP_II_Y MACRO	VAR_ADDR
 2060  0000000                   	LDA (<VAR_ADDR),Y
 2061  0000000                   	ENDM
 2062  0000000                   
 2063  0000000                   LDA_DP_II_Y_CH MACRO	VAR_ADDR
 2064  0000000                   	LDA (<CHANNEL_ADDR+VAR_ADDR),Y
 2065  0000000                   	ENDM
 2066  0000000                   
 2067  0000000                   ;------------------------------------------------------------------------------
 2068  0000000                   LDA_DP_II MACRO	VAR_ADDR
 2069  0000000                   	LDA (<VAR_ADDR)
 2070  0000000                   	ENDM
 2071  0000000                   
 2072  0000000                   LDA_DP_II_CH MACRO	VAR_ADDR
 2073  0000000                   	LDA (<CHANNEL_ADDR+VAR_ADDR)
 2074  0000000                   	ENDM
 2075  0000000                   
 2076  0000000                   ;------------------------------------------------------------------------------
 2077  0000000                   ADC_DP_II_Y_CH MACRO	VAR_ADDR
 2078  0000000                   	ADC (<CHANNEL_ADDR+VAR_ADDR),Y
 2079  0000000                   	ENDM
 2080  0000000                   
 2081  0000000                   ;------------------------------------------------------------------------------
 2082  0000000                   SBC_DP_II_Y_CH MACRO	VAR_ADDR
 2083  0000000                   	SBC (<CHANNEL_ADDR+VAR_ADDR),Y
 2084  0000000                   	ENDM
 2085  0000000                   ;===============================================================
 2086  0000000                   ;
 2087  0000000                   ;===============================================================
 2088  0000000                   JMP_QUIT_ISR MACRO
 2089  0000000                   ;	.IF (WITH_VS0B .EQ. 1)
 2090  0000000                   ;	LDX #START_CHANNEL_ID_2
 2091  0000000                   ;	JMP (SP_CHANNEL_QUIT_TABLE,X)
 2092  0000000                   ;	.ELSE
 2093  0000000                   ;	EXTERN		QUIT_LIB_ISR
 2094  0000000                   	.IFNDEF WITH_USER_PLAY
 2095  0000000                   	JMP QUIT_LIB_ISR
 2096  0000000                   	.ELSE
 2097  0000000                   	JMP QUIT_USER_PLAY
 2098  0000000                   	.ENDIF





 2099  0000000                   ;	.ENDIF
 2100  0000000                   	ENDM
 2101  0000000                   
 2102  0000000                   ;===============================================================
 2103  0000000                   ;
 2104  0000000                   ;===============================================================
 2105  0000000                   JMP_QUIT_ISR_CHANNEL_X MACRO
 2106  0000000                   ;	.IF (WITH_VS0B .EQ. 1)
 2107  0000000                   ;		EXTERN SP_CHANNEL_QUIT_TABLE
 2108  0000000                   ;		JMP (SP_CHANNEL_QUIT_TABLE,X)
 2109  0000000                   ;	.ELSE
 2110  0000000                   ;		EXTERN		QUIT_LIB_ISR
 2111  0000000                   		JMP QUIT_LIB_ISR
 2112  0000000                   ;	.ENDIF
 2113  0000000                   ENDM
 2114  0000000                   ;===============================================================
 2115  0000000                   ;
 2116  0000000                   ;===============================================================
 2117  0000000                   ; Internal called only in Macros.ini
 2118  0000000                   INC_ADDR_DP MACRO VAR_ADDR
 2119  0000000                   	INC <VAR_ADDR
 2120  0000000                   	BNE INC_ADDR_CH_END_#
 2121  0000000                   
 2122  0000000                   	INC <VAR_ADDR+1
 2123  0000000                   	LDA <VAR_ADDR+1
 2124  0000000                   	AND #7FH
 2125  0000000                   	BNE INC_ADDR_CH_END_#
 2126  0000000                   CROSS_BANK_#:
 2127  0000000                   	LDA #80H
 2128  0000000                   	STA <VAR_ADDR+1
 2129  0000000                   	INC <VAR_ADDR+2
 2130  0000000                   
 2131  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2132  0000000                   	BNE INC_ADDR_CH_END_#
 2133  0000000                   	INC <VAR_ADDR+3
 2134  0000000                   	.ENDIF
 2135  0000000                   
 2136  0000000                   INC_ADDR_CH_END_#:
 2137  0000000                   	ENDM
 2138  0000000                   ;------------------------------------------------------------------------------
 2139  0000000                   INC_DATA_ADDR_CH	MACRO	FORMAT
 2140  0000000                   .IFNDEF WITH_USER_PLAY
 2141  0000000                   	INC_ADDR_DP CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2142  0000000                   .ELSE
 2143  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_INDEX|FORMAT
 2144  0000000                   	CMP #(USER_PLAY_BUF_SIZE-1)
 2145  0000000                   	BCC NOT_RESET_BUF_INDEX#
 2146  0000000                   	STZ <CHANNEL_ADDR+CH_DATA_INDEX|FORMAT
 2147  0000000                   	BRA END_INC_DATA_ADDR_CH#
 2148  0000000                   
 2149  0000000                   NOT_RESET_BUF_INDEX#:
 2150  0000000                   	INC <CHANNEL_ADDR+CH_DATA_INDEX|FORMAT
 2151  0000000                   
 2152  0000000                   END_INC_DATA_ADDR_CH#:
 2153  0000000                   .ENDIF
 2154  0000000                   	ENDM
 2155  0000000                   ;------------------------------------------------------------------------------





 2156  0000000                   INC_DATA_ADDR_HQ	MACRO	FORMAT
 2157  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2158  0000000                   	BNE INC_DATA_ADDR_HQ_END_#
 2159  0000000                   
 2160  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2161  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2162  0000000                   	AND #7FH
 2163  0000000                   	BNE INC_DATA_ADDR_HQ_END_#
 2164  0000000                   CROSS_BANK_#:
 2165  0000000                   	LDA #80H
 2166  0000000                   	STA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2167  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+2
 2168  0000000                   INC_DATA_ADDR_HQ_END_#:
 2169  0000000                   	ENDM
 2170  0000000                   ;===============================================================
 2171  0000000                   DEC_ADDR_DP MACRO VAR_ADDR
 2172  0000000                   	DEC <VAR_ADDR
 2173  0000000                   	LDA <VAR_ADDR
 2174  0000000                   	CMP #FFH
 2175  0000000                   	BNE DEC_ADDR_CH_END_#
 2176  0000000                   
 2177  0000000                   	DEC <VAR_ADDR+1
 2178  0000000                   	LDA <VAR_ADDR+1
 2179  0000000                   	CMP #7FH
 2180  0000000                   	BNE DEC_ADDR_CH_END_#
 2181  0000000                   
 2182  0000000                   	LDA #FFH
 2183  0000000                   	STA <VAR_ADDR+1
 2184  0000000                   	DEC <VAR_ADDR+2
 2185  0000000                   
 2186  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2187  0000000                   	LDA <VAR_ADDR+2
 2188  0000000                   	CMP #FFH
 2189  0000000                   	BNE IS_BANK_0000#
 2190  0000000                   
 2191  0000000                   	DEC <VAR_ADDR+3
 2192  0000000                   	BRA DEC_ADDR_CH_END_#
 2193  0000000                   	.ENDIF
 2194  0000000                   
 2195  0000000                   IS_BANK_0000#:
 2196  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2197  0000000                   	LDA <VAR_ADDR+2
 2198  0000000                   	.ENDIF
 2199  0000000                   	BNE DEC_ADDR_CH_END_#
 2200  0000000                   
 2201  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2202  0000000                   	LDA <VAR_ADDR+3
 2203  0000000                   	AND #03H
 2204  0000000                   	BNE DEC_ADDR_CH_END_#
 2205  0000000                   	.ENDIF
 2206  0000000                   
 2207  0000000                       LDA #7FH
 2208  0000000                   	STA <VAR_ADDR+1,X
 2209  0000000                   
 2210  0000000                   DEC_ADDR_CH_END_#:
 2211  0000000                   	ENDM
 2212  0000000                   ;------------------------------------------------------------------------------





 2213  0000000                   DEC_DATA_ADDR_CH	MACRO	FORMAT
 2214  0000000                   	DEC_ADDR_DP CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2215  0000000                   	ENDM
 2216  0000000                   ;------------------------------------------------------------------------------
 2217  0000000                   ; X: CHANNEL ADDR.
 2218  0000000                   ; note: INC_NUM cannot over 256D
 2219  0000000                   ;------------------------------------------------------------------------------
 2220  0000000                   ADC_ADDR_II_X	MACRO	VAR_ADDR, INC_NUM
 2221  0000000                   	LDA <VAR_ADDR,X
 2222  0000000                   	CLC
 2223  0000000                   	ADC	#INC_NUM
 2224  0000000                   	STA <VAR_ADDR,X
 2225  0000000                   	BCC ADC_ADDR_CH_#
 2226  0000000                   
 2227  0000000                   	INC <VAR_ADDR+1,X
 2228  0000000                   	LDA <VAR_ADDR+1,X
 2229  0000000                   	AND #7FH
 2230  0000000                   	BNE ADC_ADDR_CH_#
 2231  0000000                   CROSS_BANK_#:
 2232  0000000                   	LDA #80H
 2233  0000000                   	STA <VAR_ADDR+1,X
 2234  0000000                   	INC <VAR_ADDR+2,X
 2235  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2236  0000000                   	BNE ADC_ADDR_CH_#
 2237  0000000                   	INC <VAR_ADDR+3,X
 2238  0000000                   	.ENDIF
 2239  0000000                   ADC_ADDR_CH_#
 2240  0000000                   	ENDM
 2241  0000000                   ;------------------------------------------------------------------------------
 2242  0000000                   ADC_ADDR_II_A_X	MACRO	VAR_ADDR
 2243  0000000                   	CLC
 2244  0000000                   	ADC	<VAR_ADDR,X
 2245  0000000                   	STA <VAR_ADDR,X
 2246  0000000                   	BCC ADC_ADDR_CH_#
 2247  0000000                   
 2248  0000000                   	INC <VAR_ADDR+1,X
 2249  0000000                   	LDA <VAR_ADDR+1,X
 2250  0000000                   	AND #7FH
 2251  0000000                   	BNE ADC_ADDR_CH_#
 2252  0000000                   CROSS_BANK_#:
 2253  0000000                   	LDA #80H
 2254  0000000                   	STA <VAR_ADDR+1,X
 2255  0000000                   	INC <VAR_ADDR+2,X
 2256  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2257  0000000                   	BNE ADC_ADDR_CH_#
 2258  0000000                   	INC <VAR_ADDR+3,X
 2259  0000000                   	.ENDIF
 2260  0000000                   ADC_ADDR_CH_#
 2261  0000000                   	ENDM
 2262  0000000                   ;------------------------------------------------------------------------------
 2263  0000000                   ADC_ADDR_A_X_SENTENCE	MACRO	VAR_ADDR, VAR_ADDR2
 2264  0000000                   	CLC
 2265  0000000                   	ADC	<VAR_ADDR,X
 2266  0000000                   	STA <VAR_ADDR,X
 2267  0000000                   	BCC ADC_ADDR_A_X_SENTENCE_END_#
 2268  0000000                   
 2269  0000000                   	INC <VAR_ADDR+1,X





 2270  0000000                   	LDA <VAR_ADDR+1,X
 2271  0000000                   	AND #7FH
 2272  0000000                   	BNE ADC_ADDR_A_X_SENTENCE_END_#
 2273  0000000                   CROSS_BANK_#:
 2274  0000000                   	LDA #80H
 2275  0000000                   	STA <VAR_ADDR+1,X
 2276  0000000                   	INC <VAR_ADDR+2,X
 2277  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2278  0000000                   	BNE ADC_ADDR_A_X_SENTENCE_END_#
 2279  0000000                   
 2280  0000000                   	CLC
 2281  0000000                   	LDA <VAR_ADDR2+1,X
 2282  0000000                   	ADC	#04H
 2283  0000000                   	STA <VAR_ADDR2+1,X
 2284  0000000                   
 2285  0000000                   	LSR A
 2286  0000000                   	LSR A
 2287  0000000                   	STA !BANK1
 2288  0000000                   	.ENDIF
 2289  0000000                   ADC_ADDR_A_X_SENTENCE_END_#
 2290  0000000                   	ENDM
 2291  0000000                   ;------------------------------------------------------------------------------
 2292  0000000                   ADC_ADDR_MS_SENTENCE	MACRO	VAR_ADDR, VAR_ADDR2
 2293  0000000                   	CLC
 2294  0000000                   	ADC	<CHANNEL_ADDR+VAR_ADDR
 2295  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR
 2296  0000000                   	BCC ADC_ADDR_MS_SENTENCE_END_#
 2297  0000000                   
 2298  0000000                   	INC <CHANNEL_ADDR+VAR_ADDR+1
 2299  0000000                   	LDA <CHANNEL_ADDR+VAR_ADDR+1
 2300  0000000                   	AND #7FH
 2301  0000000                   	BNE ADC_ADDR_MS_SENTENCE_END_#
 2302  0000000                   CROSS_BANK_#:
 2303  0000000                   	LDA #80H
 2304  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR+1
 2305  0000000                   	INC <CHANNEL_ADDR+VAR_ADDR+2
 2306  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2307  0000000                   	BNE ADC_ADDR_MS_SENTENCE_END_#
 2308  0000000                   
 2309  0000000                   	CLC
 2310  0000000                   	LDA <CHANNEL_ADDR+VAR_ADDR2+1
 2311  0000000                   	ADC	#04H
 2312  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR2+1
 2313  0000000                   
 2314  0000000                   	LSR A
 2315  0000000                   	LSR A
 2316  0000000                   	STA !BANK1
 2317  0000000                   	.ENDIF
 2318  0000000                   ADC_ADDR_MS_SENTENCE_END_#
 2319  0000000                   	ENDM
 2320  0000000                   ;------------------------------------------------------------------------------
 2321  0000000                   SBC_ADDR_II_X	MACRO	VAR_ADDR, SBC_NUM
 2322  0000000                   	LDA <VAR_ADDR,X
 2323  0000000                   	SEC
 2324  0000000                   	SBC	#SBC_NUM
 2325  0000000                   	STA <VAR_ADDR,X
 2326  0000000                   	BCS SBC_ADDR_CH_#





 2327  0000000                   
 2328  0000000                   	DEC <VAR_ADDR+1,X
 2329  0000000                   	LDA <VAR_ADDR+1,X
 2330  0000000                   	CMP #7FH
 2331  0000000                   	BNE SBC_ADDR_CH_#
 2332  0000000                   
 2333  0000000                   	LDA #FFH
 2334  0000000                   	STA <VAR_ADDR+1,X
 2335  0000000                   	DEC <VAR_ADDR+2,X
 2336  0000000                   
 2337  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2338  0000000                   	LDA <VAR_ADDR+2,X
 2339  0000000                   	CMP #FFH
 2340  0000000                   	BNE IS_BANK_0000#
 2341  0000000                   
 2342  0000000                   	DEC <VAR_ADDR+3,X
 2343  0000000                   	BRA SBC_ADDR_CH_#
 2344  0000000                   	.ENDIF
 2345  0000000                   
 2346  0000000                   IS_BANK_0000#:
 2347  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2348  0000000                   	LDA <VAR_ADDR+2,X
 2349  0000000                   	.ENDIF
 2350  0000000                   	BNE SBC_ADDR_CH_#
 2351  0000000                   
 2352  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2353  0000000                   	LDA <VAR_ADDR+3,X
 2354  0000000                   	AND #03H
 2355  0000000                   	BNE SBC_ADDR_CH_#
 2356  0000000                   	.ENDIF
 2357  0000000                   
 2358  0000000                       LDA #7FH
 2359  0000000                   	STA <VAR_ADDR+1,X
 2360  0000000                   
 2361  0000000                   SBC_ADDR_CH_#
 2362  0000000                   	ENDM
 2363  0000000                   ;------------------------------------------------------------------------------
 2364  0000000                   ; NOTE: INC_NUM MUST BE 0~255
 2365  0000000                   ;------------------------------------------------------------------------------
 2366  0000000                   ; Internal called only in Macros.ini
 2367  0000000                   ADC_ADDR_A	MACRO	VAR_ADDR
 2368  0000000                   	CLC
 2369  0000000                   	ADC <VAR_ADDR
 2370  0000000                   	STA <VAR_ADDR
 2371  0000000                   	BCC ADC_ADDR_A_END_#
 2372  0000000                   
 2373  0000000                   	INC <VAR_ADDR+1
 2374  0000000                   	LDA <VAR_ADDR+1
 2375  0000000                   	AND #7FH
 2376  0000000                   	BNE ADC_ADDR_A_END_#
 2377  0000000                   CROSS_BANK_#:
 2378  0000000                   	LDA #80H
 2379  0000000                   	STA <VAR_ADDR+1
 2380  0000000                   	INC <VAR_ADDR+2
 2381  0000000                   
 2382  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2383  0000000                   	BNE ADC_ADDR_A_END_#





 2384  0000000                   	INC <VAR_ADDR+3
 2385  0000000                   	.ENDIF
 2386  0000000                   
 2387  0000000                   ADC_ADDR_A_END_#
 2388  0000000                   	ENDM
 2389  0000000                   ;------------------------------------------------------------------------------
 2390  0000000                   ;for Winmelody,Percussion,VoiceMelogy
 2391  0000000                   ADC_DATA_ADDR_A_HQ	MACRO	FORMAT
 2392  0000000                   	CLC
 2393  0000000                   	ADC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2394  0000000                   	STA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2395  0000000                   	BCC ADC_DATA_ADDR_A_HQ_END_#
 2396  0000000                   
 2397  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2398  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2399  0000000                   	AND #7FH
 2400  0000000                   	BNE ADC_DATA_ADDR_A_HQ_END_#
 2401  0000000                   CROSS_BANK_#:
 2402  0000000                   	LDA #80H
 2403  0000000                   	STA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2404  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+2
 2405  0000000                   
 2406  0000000                   ADC_DATA_ADDR_A_HQ_END_#
 2407  0000000                   	ENDM
 2408  0000000                   ;------------------------------------------------------------------------------
 2409  0000000                   ; called by MidiMain.asm for midi sentence list
 2410  0000000                   ADC_ADDR_CH	MACRO	VAR_ADDR, INC_NUM
 2411  0000000                   	LDA #INC_NUM
 2412  0000000                   	ADC_ADDR_A CHANNEL_ADDR+VAR_ADDR
 2413  0000000                   	ENDM
 2414  0000000                   ;------------------------------------------------------------------------------
 2415  0000000                   ;for Winmelody,Percussion,VoiceMelogy
 2416  0000000                   ADC_DATA_ADDR_A_CH	MACRO	FORMAT
 2417  0000000                   	ADC_ADDR_A CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2418  0000000                   	ENDM
 2419  0000000                   ;------------------------------------------------------------------------------
 2420  0000000                   ;for speech address adc
 2421  0000000                   ADC_DATA_ADDR_CH	MACRO	FORMAT, INC_NUM
 2422  0000000                   	LDA #INC_NUM
 2423  0000000                   	ADC_ADDR_A CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2424  0000000                   	ENDM
 2425  0000000                   ;------------------------------------------------------------------------------
 2426  0000000                   ADC_DATA_ADDR_CH_SA_MS	MACRO	INC_NUM
 2427  0000000                   	PHA
 2428  0000000                   	ADC_DATA_ADDR_CH _MS,INC_NUM
 2429  0000000                   	PLA
 2430  0000000                   	ENDM
 2431  0000000                   ;------------------------------------------------------------------------------
 2432  0000000                   ; NOTE: SBC_NUM MUST BE 0~255
 2433  0000000                   ;------------------------------------------------------------------------------
 2434  0000000                   ; Internal called only in Macros.ini
 2435  0000000                   SBC_ADDR	MACRO	VAR_ADDR,SBC_NUM
 2436  0000000                   	SEC
 2437  0000000                   	LDA <VAR_ADDR
 2438  0000000                   	SBC	#SBC_NUM
 2439  0000000                   	STA <VAR_ADDR
 2440  0000000                   	BCS SBC_ADDR_#





 2441  0000000                   
 2442  0000000                   	DEC <VAR_ADDR+1
 2443  0000000                   	LDA <VAR_ADDR+1
 2444  0000000                   	CMP #7FH
 2445  0000000                   	BNE SBC_ADDR_#
 2446  0000000                   
 2447  0000000                   	LDA #FFH
 2448  0000000                   	STA <VAR_ADDR+1
 2449  0000000                   	DEC <VAR_ADDR+2
 2450  0000000                   
 2451  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2452  0000000                   	LDA <VAR_ADDR+2
 2453  0000000                   	CMP #FFH
 2454  0000000                   	BNE IS_BANK_0000#
 2455  0000000                   
 2456  0000000                   	DEC <VAR_ADDR+3
 2457  0000000                   	BRA SBC_ADDR_#
 2458  0000000                   	.ENDIF
 2459  0000000                   
 2460  0000000                   IS_BANK_0000#:
 2461  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2462  0000000                   	LDA <VAR_ADDR+2
 2463  0000000                   	.ENDIF
 2464  0000000                   	BNE SBC_ADDR_#
 2465  0000000                   
 2466  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2467  0000000                   	LDA <VAR_ADDR+3
 2468  0000000                   	AND #03H
 2469  0000000                   	BNE SBC_ADDR_#
 2470  0000000                   	.ENDIF
 2471  0000000                   
 2472  0000000                   	LDA #7FH
 2473  0000000                   	STA <VAR_ADDR+1
 2474  0000000                   
 2475  0000000                   SBC_ADDR_#
 2476  0000000                   	ENDM
 2477  0000000                   ;------------------------------------------------------------------------------
 2478  0000000                   SBC_DATA_ADDR_CH MACRO	FORMAT, SBC_NUM
 2479  0000000                   	SBC_ADDR CHANNEL_ADDR+CH_DATA_ADDR|FORMAT,SBC_NUM
 2480  0000000                   	ENDM
 2481  0000000                   ;======================================================================================
 2482  0000000                   SBC16_DP MACRO VAR_ADDR,NUM
 2483  0000000                   	LDA_DP VAR_ADDR
 2484  0000000                   	SEC
 2485  0000000                   	SBC #NUM
 2486  0000000                   	STA_DP VAR_ADDR
 2487  0000000                   	BCS SBC16_DP_DONE_#
 2488  0000000                   
 2489  0000000                   	LDA_DP VAR_ADDR+1
 2490  0000000                   	SBC #00H
 2491  0000000                   	STA_DP VAR_ADDR+1
 2492  0000000                   
 2493  0000000                   SBC16_DP_DONE_#
 2494  0000000                   	ENDM
 2495  0000000                   ;======================================================================================
 2496  0000000                   SBC16_DP_2B MACRO VAR_ADDR,NUM
 2497  0000000                   	LDA_DP VAR_ADDR





 2498  0000000                   	SEC
 2499  0000000                   	SBC #.LOW.NUM
 2500  0000000                   	STA_DP VAR_ADDR
 2501  0000000                   
 2502  0000000                   	LDA_DP VAR_ADDR+1
 2503  0000000                   	SBC #.HIGH.NUM
 2504  0000000                   	STA_DP VAR_ADDR+1
 2505  0000000                   	ENDM
 2506  0000000                   ;------------------------------------------------------------------------------
 2507  0000000                   ; Add By TSH
 2508  0000000                   ;--------------------------------------------------------------------------
 2509  0000000                   SBC16_DP_X MACRO VAR_ADDR,NUM
 2510  0000000                   	LDA_DP_X VAR_ADDR
 2511  0000000                   	SEC
 2512  0000000                   	SBC #NUM
 2513  0000000                   	STA_DP_X VAR_ADDR
 2514  0000000                   	BCS SBC16_DP_X_DONE_#
 2515  0000000                   
 2516  0000000                   	LDA_DP_X VAR_ADDR+1
 2517  0000000                   	SBC #00H
 2518  0000000                   	STA_DP_X VAR_ADDR+1
 2519  0000000                   
 2520  0000000                   SBC16_DP_X_DONE_#
 2521  0000000                   	ENDM
 2522  0000000                   ;------------------------------------------------------------------------------
 2523  0000000                   ; Add By TSH
 2524  0000000                   ;--------------------------------------------------------------------------
 2525  0000000                   SBC16_DP_RAM MACRO VAR_ADDR,VAR_RAM
 2526  0000000                   	LDA_DP VAR_ADDR
 2527  0000000                   	SEC
 2528  0000000                   	SBC <VAR_RAM
 2529  0000000                   	STA_DP VAR_ADDR
 2530  0000000                   	BCS SBC16_DP_RAM_DONE_#
 2531  0000000                   
 2532  0000000                   	LDA_DP VAR_ADDR+1
 2533  0000000                   	SBC #00H
 2534  0000000                   	STA_DP VAR_ADDR+1
 2535  0000000                   
 2536  0000000                   SBC16_DP_RAM_DONE_#
 2537  0000000                   	ENDM
 2538  0000000                   ;------------------------------------------------------------------------------
 2539  0000000                   ; Add By TSH
 2540  0000000                   ;--------------------------------------------------------------------------
 2541  0000000                   SBC16_DP_X_RAM MACRO VAR_ADDR,VAR_RAM
 2542  0000000                   	LDA_DP_X VAR_ADDR
 2543  0000000                   	SEC
 2544  0000000                   	SBC <VAR_RAM
 2545  0000000                   	STA_DP_X VAR_ADDR
 2546  0000000                   	BCS SBC16_DP_RAM_DONE_#
 2547  0000000                   
 2548  0000000                   	LDA_DP_X VAR_ADDR+1
 2549  0000000                   	SBC #00H
 2550  0000000                   	STA_DP_X VAR_ADDR+1
 2551  0000000                   
 2552  0000000                   SBC16_DP_RAM_DONE_#
 2553  0000000                   	ENDM
 2554  0000000                   ;------------------------------------------------------------------------------





 2555  0000000                   SBC16_DP_CH MACRO VAR_ADDR,NUM
 2556  0000000                   	SBC16_DP CHANNEL_ADDR+VAR_ADDR,NUM
 2557  0000000                   	ENDM
 2558  0000000                   ;======================================================================================
 2559  0000000                   SBC24_DP MACRO VAR_ADDR,NUM
 2560  0000000                   	LDA_DP VAR_ADDR
 2561  0000000                   	SEC
 2562  0000000                   	SBC #NUM
 2563  0000000                   	STA_DP VAR_ADDR
 2564  0000000                   	BCS SBC24_DP_DONE_#
 2565  0000000                   
 2566  0000000                   	LDA_DP VAR_ADDR+1
 2567  0000000                   	SBC #00H
 2568  0000000                   	STA_DP VAR_ADDR+1
 2569  0000000                   	BCS SBC24_DP_DONE_#
 2570  0000000                   
 2571  0000000                   	LDA_DP VAR_ADDR+2
 2572  0000000                   	SBC #00H
 2573  0000000                   	STA_DP VAR_ADDR+2
 2574  0000000                   
 2575  0000000                   SBC24_DP_DONE_#
 2576  0000000                   	ENDM
 2577  0000000                   
 2578  0000000                   ;---------------------------------------------------------------------------
 2579  0000000                   SBC24_DP_CH MACRO VAR_ADDR,NUM
 2580  0000000                   	SBC24_DP CHANNEL_ADDR+VAR_ADDR,NUM
 2581  0000000                   	ENDM
 2582  0000000                   ;======================================================================================
 2583  0000000                   ;
 2584  0000000                   ;======================================================================================
 2585  0000000                   ADC16_DP MACRO VAR_ADDR,NUM
 2586  0000000                   	LDA_DP VAR_ADDR
 2587  0000000                   	CLC
 2588  0000000                   	ADC #NUM
 2589  0000000                   	STA_DP VAR_ADDR
 2590  0000000                   	LDA_DP VAR_ADDR+1
 2591  0000000                   	ADC #00H
 2592  0000000                   	STA_DP VAR_ADDR+1
 2593  0000000                   	ENDM
 2594  0000000                   ;--------------------------------------------------------------------------
 2595  0000000                   ADC16_DP_2B MACRO VAR_ADDR,NUM
 2596  0000000                   	LDA_DP VAR_ADDR
 2597  0000000                   	CLC
 2598  0000000                   	ADC #.LOW.NUM
 2599  0000000                   	STA_DP VAR_ADDR
 2600  0000000                   	LDA_DP VAR_ADDR+1
 2601  0000000                   	ADC #.HIGH.NUM
 2602  0000000                   	STA_DP VAR_ADDR+1
 2603  0000000                   	ENDM
 2604  0000000                   ;--------------------------------------------------------------------------
 2605  0000000                   ; Add By TSH
 2606  0000000                   ;--------------------------------------------------------------------------
 2607  0000000                   ADC16_DP_RAM MACRO VAR_ADDR,RAM_VAR
 2608  0000000                   	LDA_DP VAR_ADDR
 2609  0000000                   	CLC
 2610  0000000                   	ADC <RAM_VAR
 2611  0000000                   	STA_DP VAR_ADDR





 2612  0000000                   	LDA_DP VAR_ADDR+1
 2613  0000000                   	ADC #00H
 2614  0000000                   	STA_DP VAR_ADDR+1
 2615  0000000                   	ENDM
 2616  0000000                   ;---------------------------------------------------------------------------
 2617  0000000                   ADC16_DP_X MACRO VAR_ADDR,NUM
 2618  0000000                   	LDA_DP_X VAR_ADDR
 2619  0000000                   	CLC
 2620  0000000                   	ADC #NUM
 2621  0000000                   	STA_DP_X VAR_ADDR
 2622  0000000                   	LDA_DP_X VAR_ADDR+1
 2623  0000000                   	ADC #00H
 2624  0000000                   	STA_DP_X VAR_ADDR+1
 2625  0000000                   	ENDM
 2626  0000000                   ;---------------------------------------------------------------------------
 2627  0000000                   ADC16_DP_CH MACRO VAR_ADDR,NUM
 2628  0000000                   	ADC16_DP CHANNEL_ADDR+VAR_ADDR,NUM
 2629  0000000                   	ENDM
 2630  0000000                   
 2631  0000000                   ;======================================================================================
 2632  0000000                   ADC24_DP MACRO VAR_ADDR,NUM
 2633  0000000                   	LDA_DP VAR_ADDR
 2634  0000000                   	CLC
 2635  0000000                   	ADC #NUM
 2636  0000000                   	STA_DP VAR_ADDR
 2637  0000000                   	BCC ADC24_DONE_#
 2638  0000000                   
 2639  0000000                   	LDA_DP VAR_ADDR+1
 2640  0000000                   	ADC #00H
 2641  0000000                   	STA_DP VAR_ADDR+1
 2642  0000000                   	BCC ADC24_DONE_#
 2643  0000000                   
 2644  0000000                   	LDA_DP VAR_ADDR+2
 2645  0000000                   	ADC #00H
 2646  0000000                   	STA_DP VAR_ADDR+2
 2647  0000000                   
 2648  0000000                   ADC24_DONE_#:
 2649  0000000                   	ENDM
 2650  0000000                   ;======================================================================================
 2651  0000000                   ADC32_DP MACRO VAR_ADDR,NUM
 2652  0000000                   	LDA_DP VAR_ADDR
 2653  0000000                   	CLC
 2654  0000000                   	ADC #NUM
 2655  0000000                   	STA_DP VAR_ADDR
 2656  0000000                   	BCC ADC32_DONE_#
 2657  0000000                   
 2658  0000000                   	LDA_DP VAR_ADDR+1
 2659  0000000                   	ADC #00H
 2660  0000000                   	STA_DP VAR_ADDR+1
 2661  0000000                   	BCC ADC32_DONE_#
 2662  0000000                   
 2663  0000000                   	LDA_DP VAR_ADDR+2
 2664  0000000                   	ADC #00H
 2665  0000000                   	STA_DP VAR_ADDR+2
 2666  0000000                   	BCC ADC32_DONE_#
 2667  0000000                   
 2668  0000000                   	LDA_DP VAR_ADDR+3





 2669  0000000                   	ADC #00H
 2670  0000000                   	STA_DP VAR_ADDR+3
 2671  0000000                   
 2672  0000000                   ADC32_DONE_#:
 2673  0000000                   	ENDM
 2674  0000000                   ;======================================================================================
 2675  0000000                   ;
 2676  0000000                   ;======================================================================================
 2677  0000000                   ;CHECK_EXT_EVENT_ENABLE_CHANNEL MACRO BY_PASS_LABEL
 2678  0000000                   ;	;=== CHK I-F EXT_MIDI_EVENT ===
 2679  0000000                   ;	.IF (WITH_READ_DATA_TYPE .EQ. 0)
 2680  0000000                   ;	EXTERN	CHECK_EXT_EVENT_ENABLE_CHANNEL_PROC
 2681  0000000                   ;	JSR CHECK_EXT_EVENT_ENABLE_CHANNEL_PROC
 2682  0000000                   ;	CPY #01H
 2683  0000000                   ;	BEQ CHECK_EXT_EVENT_CHANNEL_END_#
 2684  0000000                   ;
 2685  0000000                   ;	JMP BY_PASS_LABEL
 2686  0000000                   ;
 2687  0000000                   ;CHECK_EXT_EVENT_CHANNEL_END_#
 2688  0000000                   ;	.ENDIF
 2689  0000000                   ;	ENDM
 2690  0000000                   
 2691  0000000                   ;======================================================================================
 2692  0000000                   ; INPUT: X- CHANNEL ADDR. 
 2693  0000000                   ;======================================================================================
 2694  0000000                   SET_SYNTH_CHANNEL_NOTE_VELOCITY MACRO CHANNEL_NAME
 2695  0000000                   ;	LDA_DP_CH CH_MIDI_CHANNEL_MS
 2696  0000000                   ;	STA <CH_SYNTH_CHANNEL|CHANNEL_NAME,X
 2697  0000000                   
 2698  0000000                   	LDA_DP_CH CH_MIDI_NOTE_MS
 2699  0000000                   	STA <CH_SYNTH_NOTE|CHANNEL_NAME,X
 2700  0000000                   
 2701  0000000                   	LDA #WITH_VELOCITY
 2702  0000000                   	BEQ SET_NEXT_DATA_#
 2703  0000000                   
 2704  0000000                   	LDA_DP_CH CH_MIDI_VELOCITY_MS			;0~127
 2705  0000000                   	STA <CH_SYNTH_VELOCITY|CHANNEL_NAME,X
 2706  0000000                   
 2707  0000000                   SET_NEXT_DATA_#
 2708  0000000                   ;	.IF (WITH_COMPRESSED_MIDI .GT. 0)
 2709  0000000                   ;	.IF (WITH_COMPRESSED_MIDI .EQ. 2H)
 2710  0000000                   ; W588 Compress Midi
 2711  0000000                   ;	.ELSE
 2712  0000000                   ;		LDA_DP_CH CH_MIDI_SYNTH_LENGTH_MS
 2713  0000000                   ;		STA <CH_SYNTH_LENGTH|CHANNEL_NAME,X
 2714  0000000                   ;	.ENDIF
 2715  0000000                   ;SET_DONE:
 2716  0000000                   ;	.ENDIF
 2717  0000000                   
 2718  0000000                   	ENDM
 2719  0000000                   
 2720  0000000                   ;======================================================================================
 2721  0000000                   ; INPUT: Y-CHANNEL INDEX, X- CHANNEL ADDR. 
 2722  0000000                   ;======================================================================================
 2723  0000000                   ;================================
 2724  0000000                   ; For Speech PC8 Volume Table
 2725  0000000                   ;--------------------------------





 2726  0000000                   SET_PC8_VOL_MUL_8X3_SP_ADDR MACRO CHANNEL_NAME
 2727  0000000                   	EXTERN	MULTIPLY_8x3_HI_TABLE
 2728  0000000                   	LDA <CH_R_FINAL_VOLUME|CHANNEL_NAME,X
 2729  0000000                   	AND #7FH ;BUG: 821
 2730  0000000                   	LSR A
 2731  0000000                   	CLC
 2732  0000000                   	ADC #.HIGH.MULTIPLY_8x3_HI_TABLE
 2733  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME+1,X
 2734  0000000                   	LDA #.LOW.MULTIPLY_8x3_HI_TABLE
 2735  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME,X
 2736  0000000                   	ENDM
 2737  0000000                   ;--------------------------------------------------------------------------
 2738  0000000                   ;================================
 2739  0000000                   ; For Speech LP8 Volume Table
 2740  0000000                   ;--------------------------------
 2741  0000000                   SET_LP8_VOL_MUL_8X3_SP_ADDR MACRO CHANNEL_NAME
 2742  0000000                   	EXTERN	MULTIPLY_L8x3_HI_TABLE
 2743  0000000                   	LDA <CH_R_FINAL_VOLUME|CHANNEL_NAME,X
 2744  0000000                   	AND #7FH  ;BUG: 821
 2745  0000000                   	LSR A
 2746  0000000                   	CLC
 2747  0000000                   	ADC #.HIGH.MULTIPLY_L8x3_HI_TABLE
 2748  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME+1,X
 2749  0000000                   	LDA #.LOW.MULTIPLY_L8x3_HI_TABLE
 2750  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME,X
 2751  0000000                   	ENDM
 2752  0000000                   ;===============================================================
 2753  0000000                   GET_ENV_VALUE MACRO 
 2754  0000000                   	SEI	; two JSR steps, so disable interrupt
 2755  0000000                   	JSR SET_TONE_ENV_ADDR_INC_COUNT_PROC
 2756  0000000                   	LDA_DP_ILI CH_FXF_TEMP_REG1
 2757  0000000                   	CLI
 2758  0000000                   	ENDM
 2759  0000000                   
 2760  0000000                   ;===============================================================
 2761  0000000                   ; A changed
 2762  0000000                   ;===============================================================
 2763  0000000                   JSR_AII_X MACRO JSR_ADDR
 2764  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2765  0000000                   ;	JSR (JSR_ADDR,X)
 2766  0000000                   ;	.ELSE
 2767  0000000                   	LDA #.HIGH.RETURN_ADDR_#
 2768  0000000                   	PHA
 2769  0000000                   ;	LDA #.LOW.RETURN_ADDR_#-1
 2770  0000000                   	LDA #.LOW.RETURN_ADDR_#
 2771  0000000                   	PHA
 2772  0000000                   	JMP (JSR_ADDR,X)
 2773  0000000                   RETURN_ADDR_#:
 2774  0000000                   	NOP
 2775  0000000                   ;	.ENDIF
 2776  0000000                   	ENDM
 2777  0000000                   ;---------------------------------------------------------------
 2778  0000000                   ; PHY for Return Addr
 2779  0000000                   ;---------------------------------------------------------------
 2780  0000000                   JSR_AII_PHY_X MACRO JSR_ADDR
 2781  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2782  0000000                   ;	JSR (JSR_ADDR,X)





 2783  0000000                   ;	.ELSE
 2784  0000000                   	LDY #.HIGH.RETURN_ADDR_Y_#
 2785  0000000                   	PHY
 2786  0000000                   	LDY #.LOW.RETURN_ADDR_Y_#
 2787  0000000                   	PHY
 2788  0000000                   	JMP (JSR_ADDR,X)
 2789  0000000                   RETURN_ADDR_Y_#:
 2790  0000000                   	NOP
 2791  0000000                   ;	.ENDIF
 2792  0000000                   	ENDM
 2793  0000000                   ;--------------------------------------------------------------------------
 2794  0000000                   JSR_AII_X_SA MACRO JSR_ADDR,BUF_ADDR
 2795  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2796  0000000                   ;	JSR (JSR_ADDR,X)
 2797  0000000                   ;	.ELSE
 2798  0000000                   	STA <BUF_ADDR
 2799  0000000                   	LDA #.HIGH.RETURN_ADDR_#
 2800  0000000                   	PHA
 2801  0000000                   ;	LDA #.LOW.RETURN_ADDR_#-1
 2802  0000000                   	LDA #.LOW.RETURN_ADDR_#
 2803  0000000                   	PHA
 2804  0000000                   	LDA <BUF_ADDR
 2805  0000000                   	JMP (JSR_ADDR,X)
 2806  0000000                   RETURN_ADDR_#:
 2807  0000000                   	NOP
 2808  0000000                   ;	.ENDIF
 2809  0000000                   	ENDM
 2810  0000000                   ;--------------------------------------------------------------------------
 2811  0000000                   JSR_AII_X_TA MACRO JSR_ADDR,DATA
 2812  0000000                   	LDA #.HIGH.RETURN_ADDR_#
 2813  0000000                   	PHA
 2814  0000000                   	LDA #.LOW.RETURN_ADDR_#
 2815  0000000                   	PHA
 2816  0000000                   	LDA #DATA
 2817  0000000                   	JMP (JSR_ADDR,X)
 2818  0000000                   RETURN_ADDR_#:
 2819  0000000                   	NOP
 2820  0000000                   	ENDM
 2821  0000000                   ;===============================================================
 2822  0000000                   JSR_AII_X_LA MACRO JSR_ADDR
 2823  0000000                   	LDA #.HIGH.RETURN_ADDR_LA_#
 2824  0000000                   	PHA
 2825  0000000                   	LDA #.LOW.RETURN_ADDR_LA_#
 2826  0000000                   	PHA
 2827  0000000                   
 2828  0000000                   	JMP (JSR_ADDR,X)
 2829  0000000                   RETURN_ADDR_LA_#:
 2830  0000000                   	NOP
 2831  0000000                   	ENDM
 2832  0000000                   
 2833  0000000                   ;===============================================================
 2834  0000000                   ;
 2835  0000000                   ;===============================================================
 2836  0000000                   T_XY MACRO
 2837  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2838  0000000                   ;	TXY
 2839  0000000                   ;	.ELSE





 2840  0000000                   	PHX
 2841  0000000                   	PLY
 2842  0000000                   ;	.ENDIF
 2843  0000000                   	ENDM
 2844  0000000                   ;--------------------------------------------------------------------------
 2845  0000000                   T_YX MACRO
 2846  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2847  0000000                   ;	TYX
 2848  0000000                   ;	.ELSE
 2849  0000000                   	PHY
 2850  0000000                   	PLX
 2851  0000000                   ;	.ENDIF
 2852  0000000                   	ENDM
 2853  0000000                   ;===============================================================
 2854  0000000                   ;
 2855  0000000                   ;===============================================================
 2856  0000000                   IDX16		MACRO
 2857  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2858  0000000                   ;	REP		#I_TOGGLE
 2859  0000000                   ;	LONGI	ON
 2860  0000000                   ;	.ENDIF
 2861  0000000                   	ENDM
 2862  0000000                   
 2863  0000000                   ;--------------------------------------------------------------------------
 2864  0000000                   ACC16		MACRO
 2865  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2866  0000000                   ;	REP		#A_TOGGLE
 2867  0000000                   ;	LONGA	ON
 2868  0000000                   ;	.ENDIF
 2869  0000000                   	ENDM
 2870  0000000                   
 2871  0000000                   ;--------------------------------------------------------------------------
 2872  0000000                   IDX8		MACRO
 2873  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2874  0000000                   ;	SEP		#I_TOGGLE
 2875  0000000                   ;	LONGI	OFF
 2876  0000000                   ;	.ENDIF
 2877  0000000                   	ENDM
 2878  0000000                   
 2879  0000000                   ;--------------------------------------------------------------------------
 2880  0000000                   ACC8		MACRO
 2881  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2882  0000000                   ;	SEP		#A_TOGGLE
 2883  0000000                   ;	LONGA	OFF
 2884  0000000                   ;	.ENDIF
 2885  0000000                   	ENDM
 2886  0000000                   
 2887  0000000                   ;--------------------------------------------------------------------------
 2888  0000000                   AI16		MACRO
 2889  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2890  0000000                   ;	REP		#AI_TOGGLE
 2891  0000000                   ;	LONGI	ON
 2892  0000000                   ;	LONGA	ON
 2893  0000000                   ;	.ENDIF
 2894  0000000                   	ENDM
 2895  0000000                   
 2896  0000000                   ;--------------------------------------------------------------------------





 2897  0000000                   AI8			MACRO
 2898  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2899  0000000                   ;	SEP		#AI_TOGGLE
 2900  0000000                   ;	LONGI	OFF
 2901  0000000                   ;	LONGA	OFF
 2902  0000000                   ;	.ENDIF
 2903  0000000                   	ENDM
 2904  0000000                   
 2905  0000000                   ;--------------------------------------------------------------------------
 2906  0000000                   ;**************************************************************************
 2907  0000000                   STA_DP_II_Y MACRO	VAR_ADDR
 2908  0000000                   	STA (<VAR_ADDR),Y
 2909  0000000                   	ENDM
 2910  0000000                   
 2911  0000000                   STA_DP_II_Y_CH MACRO	VAR_ADDR
 2912  0000000                   	STA (<CHANNEL_ADDR+VAR_ADDR),Y
 2913  0000000                   	ENDM
 2914  0000000                   
 2915  0000000                   ;---------------------------------------------------------------------------
 2916  0000000                   MULTIPLY_256X8_PORC  MACRO OP1, OP2
 2917  0000000                   	SEI
 2918  0000000                   		LDA <OP2
 2919  0000000                   		ASL A
 2920  0000000                   		TAX
 2921  0000000                   		LDA <OP1		
 2922  0000000                   		BPL MULTIPLE_PLUS_256X8_#
 2923  0000000                   ; 2's complement
 2924  0000000                   		EOR #FFH
 2925  0000000                   		INC A			
 2926  0000000                   MULTIPLE_PLUS_256X8_#:	
 2927  0000000                   		TAY
 2928  0000000                   		ASL A
 2929  0000000                   			EXTERN MULTIPLY_128_8_TABLE
 2930  0000000                   		LDA !MULTIPLY_128_8_TABLE, X
 2931  0000000                   		STA <TEMP_REG1
 2932  0000000                   		LDA !MULTIPLY_128_8_TABLE+1, X
 2933  0000000                   		STA <TEMP_REG1+1
 2934  0000000                   		LDA (<TEMP_REG1), Y		; only get MSB
 2935  0000000                   	CLI
 2936  0000000                   	ENDM
 2937  0000000                   
 2938  0000000                   ;--------------------------------------------------------------------------
 2939  0000000                   SHARP_DECAY_INS MACRO
 2940  0000000                   	LDA <CH_STATUS_MC,X
 2941  0000000                   	ORA #SP_DECAY
 2942  0000000                   	AND #FFH^(SP_NOTE)
 2943  0000000                   	STA <CH_STATUS_MC,X
 2944  0000000                   ;	STA <CH_DECAY_STATUS_MC,X
 2945  0000000                   	ENDM
 2946  0000000                   ;------------------------------------------------------------------------------
 2947  0000000                   ;load SIC buffer data
 2948  0000000                   LDA_DP_ILI_CH_DATA_SP_EXT MACRO CHANNEL_NAME, INDEX  
 2949  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)
 2950  0000000                   ;LDA_DP_CH CH_DATA_BANK|CHANNEL_NAME
 2951  0000000                   ;CMP #80H
 2952  0000000                   ;BCC INTERNAL_SP#
 2953  0000000                   ;LDA #.LOW.START_SIM_BUF





 2954  0000000                   ;BEQ EXT_NO_SIM_BUF_SP#
 2955  0000000                   	LDY #INDEX
 2956  0000000                   	LDA START_SIM_BUF,Y
 2957  0000000                   ;BRA END_SP#
 2958  0000000                   ;EXT_NO_SIM_BUF_SP#:
 2959  0000000                   ;.ENDIF
 2960  0000000                   	ENDM
 2961  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;	
 2962  0000000                   ;set SIC to get next data,set COMMON_FLAG
 2963  0000000                   SET_SIC_BUF_SP_EXT MACRO VALUE, CHANNEL_NAME
 2964  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)
 2965  0000000                   	LDY #START_CHANNEL_ID
 2966  0000000                   	EXTERN SP_TM_CH_MAP_TABLE
 2967  0000000                   	LDA !SP_TM_CH_MAP_TABLE,Y
 2968  0000000                   	TAY
 2969  0000000                   	LDA !SP_CH_SIM_BUF_SET,Y
 2970  0000000                   ;BEQ END_SET_SIC_SP#
 2971  0000000                   	ORA #VALUE
 2972  0000000                   	STA !SIC
 2973  0000000                   	LDA #RDPC_WSC
 2974  0000000                   	TRB !RDPC
 2975  0000000                   	LDA !SP_CH_SIM_BUF_LOOP_FLAG,Y
 2976  0000000                   	TSB <COMMON_FLAG
 2977  0000000                   	LDA_DP_ILI_CH_DATA CHANNEL_NAME
 2978  0000000                   ;INTERNAL_SP_RS#:
 2979  0000000                   ;END_SET_SIC_SP#:	
 2980  0000000                   ;.ENDIF
 2981  0000000                   	ENDM	
 2982  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 2983  0000000                   ;wait for SIC buffer ready
 2984  0000000                   WAIT_SIC_LOOP_SP_EXT MACRO     
 2985  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)
 2986  0000000                   	LDY #START_CHANNEL_ID
 2987  0000000                   	EXTERN SP_TM_CH_MAP_TABLE
 2988  0000000                   	LDA !SP_TM_CH_MAP_TABLE,Y
 2989  0000000                   	TAY
 2990  0000000                   	LDA !SP_CH_SIM_BUF_LOOP_FLAG,Y
 2991  0000000                   ;BEQ SP_NO_WAIT#
 2992  0000000                   	BIT <COMMON_FLAG
 2993  0000000                   	BEQ SP_NO_WAIT#
 2994  0000000                   	TRB <COMMON_FLAG
 2995  0000000                   WAIT_SP#:
 2996  0000000                   	LDA !SIC
 2997  0000000                   	BPL WAIT_SP#
 2998  0000000                   	LDA #RDPC_WSC
 2999  0000000                   	TSB !RDPC
 3000  0000000                   SP_NO_WAIT#:			
 3001  0000000                   ;.ENDIF
 3002  0000000                   	ENDM	
 3003  0000000                   
 3004  0000000                   STA_ISR_SIM_BUF MACRO ISR_ADDR,FORMAT_CHANNEL
 3005  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)	
 3006  0000000                   ;LDA #.LOW.START_SIM_BUF
 3007  0000000                   ;BEQ NO_RESET_ISR_SP#	
 3008  0000000                   	LDA #.LOW.ISR_ADDR
 3009  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 3010  0000000                   	LDA #.HIGH.ISR_ADDR





 3011  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 3012  0000000                   ;NO_RESET_ISR_SP#:	
 3013  0000000                   ;.ENDIF
 3014  0000000                   	ENDM
 3015  0000000                   
 3016  0000000                   GET_SPEN MACRO
 3017  0000000                   	LDA #WITH_SPEAKER_SWITCH
 3018  0000000                   	BEQ DEFAULT_SPEAKER#
 3019  0000000                   	LDA <SPEN_TMP
 3020  0000000                   	BRA END_GET_SPEN#
 3021  0000000                   DEFAULT_SPEAKER#:
 3022  0000000                   	LDA #WITH_SPEAKER_OUTPUT_TYPE
 3023  0000000                   END_GET_SPEN#:
 3024  0000000                   	ENDM
 3025  0000000                   
 3026  0000000                   OPEN_SPEN MACRO
 3027  0000000                   	GET_SPEN
 3028  0000000                   SET_SPEAKER#:
 3029  0000000                   ;	ORA #SPEN_NS
 3030  0000000                   	STA !SPEN
 3031  0000000                   OPEN_SPEN_END#:
 3032  0000000                   	ENDM
 3033  0000000                   
 3034  0000000                   CLOSE_SPEN MACRO
 3035  0000000                   	STZ !SPEN
 3036  0000000                   	ENDM
 3037  0000000                   ;==========================================================
 3038  0000000                   LDA_DATA_ILI_X MACRO  CHANNEL_NAME
 3039  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3040  0000000                   	LDA <CH_DATA_BANK1|CHANNEL_NAME,X
 3041  0000000                   	AND #03H
 3042  0000000                   	STA !BANK1
 3043  0000000                   	.ENDIF
 3044  0000000                   	LDA <CH_DATA_BANK|CHANNEL_NAME,X
 3045  0000000                   	SW_CS
 3046  0000000                   	STA !BANK
 3047  0000000                   	LDA (<CH_DATA_ADDR|CHANNEL_NAME,X)
 3048  0000000                   	ENDM
 3049  0000000                   ;==========================================================
 3050  0000000                   ;SWITCH W551C320 CS PIN
 3051  0000000                   ;==========================================================
 3052  0000000                   LDA_DP_ILI_Y_SIM MACRO VAR_ADDR	
 3053  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 3054  0000000                   ;	LDA [<VAR_ADDR],Y
 3055  0000000                   ;	.ELSE
 3056  0000000                   	LDA <VAR_ADDR+2
 3057  0000000                   	SW_CS
 3058  0000000                   	STA !BANK
 3059  0000000                   	LDA (<VAR_ADDR),Y
 3060  0000000                   ;	.ENDIF
 3061  0000000                   	ENDM
 3062  0000000                   ;---------------------------------------------------------------------------
 3063  0000000                   LDA_DP_ILI_SIM MACRO VAR_ADDR	
 3064  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 3065  0000000                   ;	LDA [<VAR_ADDR]
 3066  0000000                   ;	.ELSE
 3067  0000000                   	LDA <VAR_ADDR+2





 3068  0000000                   	SW_CS
 3069  0000000                   	STA !BANK
 3070  0000000                   	LDA (<VAR_ADDR)
 3071  0000000                   ;	.ENDIF
 3072  0000000                   	ENDM
 3073  0000000                   ;---------------------------------------------------------------------------
 3074  0000000                   SW_CS  MACRO
 3075  0000000                   .IF (WITH_EXT32MBIT .EQ. 1)
 3076  0000000                   	CMP #80H
 3077  0000000                   	BCC END_SW_CS#
 3078  0000000                   	CMP #C0H
 3079  0000000                   	PHA
 3080  0000000                   	LDA #08H
 3081  0000000                   	BCC NOT_SW#
 3082  0000000                   	TSB !BP2
 3083  0000000                   	PLA
 3084  0000000                   	AND #BFH
 3085  0000000                   	BRA END_SW_CS#
 3086  0000000                   NOT_SW#:
 3087  0000000                       TRB !BP2
 3088  0000000                   	PLA
 3089  0000000                   END_SW_CS#:
 3090  0000000                   .ENDIF
 3091  0000000                   	ENDM
 3092  0000000                   
 3093  0000000                   ;---------------------------------------------------------------------------
 3094  0000000                   STORE_SW_CS MACRO
 3095  0000000                   .IF (WITH_EXT32MBIT .EQ. 1)
 3096  0000000                   	LDA !BANK	
 3097  0000000                   	CMP #80H
 3098  0000000                   	BCC END_STORE_SW_CS#
 3099  0000000                   ;	LDA #WITH_EXT32MBIT
 3100  0000000                   ;	BEQ END_STORE_SW_CS#
 3101  0000000                   	LDA !BP2
 3102  0000000                   	AND #08H
 3103  0000000                   	PHA
 3104  0000000                   END_STORE_SW_CS#:
 3105  0000000                   .ELSE
 3106  0000000                   .IF (WITH_EXT64M_SPI .EQ. 1H)
 3107  0000000                   	LDA !BANK1
 3108  0000000                   	AND #03H
 3109  0000000                   	PHA
 3110  0000000                   .ENDIF
 3111  0000000                   .ENDIF
 3112  0000000                   	ENDM
 3113  0000000                   
 3114  0000000                   ;---------------------------------------------------------------------------
 3115  0000000                   RELOAD_SW_CS MACRO
 3116  0000000                   .IF (WITH_EXT32MBIT .EQ. 1)
 3117  0000000                   	CMP #80H
 3118  0000000                   	BCC END_RELOAD_SW_CS#
 3119  0000000                   	PLA 
 3120  0000000                   	BEQ SW_CS_0#
 3121  0000000                   	LDA #08H
 3122  0000000                   	TSB !BP2
 3123  0000000                   	BRA END_RELOAD_SW_CS#
 3124  0000000                   SW_CS_0#:





 3125  0000000                   	LDA #08H
 3126  0000000                       TRB !BP2
 3127  0000000                   END_RELOAD_SW_CS#:
 3128  0000000                   .ELSE
 3129  0000000                   .IF (WITH_EXT64M_SPI .EQ. 1H)
 3130  0000000                   	PLA
 3131  0000000                   	STA !BANK1
 3132  0000000                   .ENDIF
 3133  0000000                   .ENDIF
 3134  0000000                   	ENDM
 3135  0000000                   ;---------------------------------------------------------------------------
 3136  0000000                   CHECK_MIDI_CHANNEL_MAPPING  MACRO
 3137  0000000                   .IF (WITH_MULTI_CHANNEL .EQ. 1)
 3138  0000000                   	LDY #FFH
 3139  0000000                   CHECK_MIDI_CHANNEL_MAPPING_NEXT#:
 3140  0000000                   	INY
 3141  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 3142  0000000                   		CPY #03H
 3143  0000000                   	.ELSE
 3144  0000000                   		CPY #02H
 3145  0000000                   	.ENDIF
 3146  0000000                   	BCS BY_PASS_MIDI_EVENT
 3147  0000000                   
 3148  0000000                   	EXTERN MS_CHANNEL_TABLE
 3149  0000000                   	LDA !MS_CHANNEL_TABLE,Y
 3150  0000000                   	BEQ CHECK_MIDI_CHANNEL_MAPPING_NEXT#
 3151  0000000                   
 3152  0000000                   	EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 3153  0000000                   	LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 3154  0000000                   	LDA CH_SYNTH_CHANNEL0,X
 3155  0000000                   	CMP_DP_CH CH_MIDI_CHANNEL_MS
 3156  0000000                   	BNE CHECK_MIDI_CHANNEL_MAPPING_NEXT#
 3157  0000000                   
 3158  0000000                   CHECK_MIDI_CHANNEL_PERCUSSION#:
 3159  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 3160  0000000                   		CPY #MS_CH2	;PERCUSSION CHANNEL
 3161  0000000                   	.ELSE
 3162  0000000                   		CPY #MS_CH1
 3163  0000000                   	.ENDIF
 3164  0000000                   	BNE STORE_MIDI_CHANNEL_MAPPING#
 3165  0000000                   
 3166  0000000                   	LDA_DP_CH CH_MIDI_CHANNEL_MS
 3167  0000000                   	CMP #09H
 3168  0000000                   	BNE STORE_MIDI_CHANNEL_MAPPING#
 3169  0000000                   
 3170  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 3171  0000000                   		LDY #MS_CH2	;PERCUSSION CHANNEL
 3172  0000000                   	.ELSE
 3173  0000000                   		LDY #MS_CH1
 3174  0000000                   	.ENDIF
 3175  0000000                   	EXTERN MS_CHANNEL_PCSPC8_TABLE
 3176  0000000                   	LDA !MS_CHANNEL_PCSPC8_TABLE,Y
 3177  0000000                   	BEQ BY_PASS_MIDI_EVENT
 3178  0000000                   
 3179  0000000                   	LDY #DRUM_CHANNEL_ID
 3180  0000000                   	STY_DP_CH CH_MIDI_CHANNEL_MS
 3181  0000000                   	BRA DECODE_MULTI_CHANNEL





 3182  0000000                   
 3183  0000000                   STORE_MIDI_CHANNEL_MAPPING#:
 3184  0000000                   	STY_DP_CH CH_MIDI_CHANNEL_MS
 3185  0000000                   
 3186  0000000                   	LDA #WITH_CHANNEL_PRESSURE
 3187  0000000                   	BEQ DECODE_MULTI_CHANNEL
 3188  0000000                   
 3189  0000000                   	LDY_DP_CH CH_MIDI_CHANNEL_MS
 3190  0000000                   	LDA !CH_CHANNEL_VOLUME,Y
 3191  0000000                   	BNE DECODE_MULTI_CHANNEL
 3192  0000000                   
 3193  0000000                   BY_PASS_MIDI_EVENT:
 3194  0000000                   	LDY #00H
 3195  0000000                   	BRA END_CHECK_MIDI_CHANNEL_MAPPING#
 3196  0000000                   DECODE_MULTI_CHANNEL:
 3197  0000000                   	LDY #01H	
 3198  0000000                   END_CHECK_MIDI_CHANNEL_MAPPING#:
 3199  0000000                   .ENDIF
 3200  0000000                   	ENDM
 3201  0000000                   ;=====================================================================================
 3202  0000000                   ;=====================================================================================
 3203  0000000                   SET_SENTENCE_BANK1 MACRO VAR_ADDR
 3204  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3205  0000000                   	LDA <VAR_ADDR+1,X
 3206  0000000                   	LSR A 
 3207  0000000                   	LSR A 
 3208  0000000                   	STA !BANK1
 3209  0000000                   	.ENDIF
 3210  0000000                   	ENDM
 3211  0000000                   ;---------------------------------------------------------------------------
 3212  0000000                   SET_ADDR_BANK1 MACRO VAR_ADDR
 3213  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3214  0000000                   	LDA <VAR_ADDR+1,X
 3215  0000000                   	AND #03H
 3216  0000000                   	STA !BANK1
 3217  0000000                   	.ENDIF
 3218  0000000                   	ENDM
 3219  0000000                   ;---------------------------------------------------------------------------
 3220  0000000                   SET_MS_SENTENCE_BANK1 MACRO
 3221  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3222  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1_MS
 3223  0000000                   	LSR A 
 3224  0000000                   	LSR A 
 3225  0000000                   	STA !BANK1
 3226  0000000                   	.ENDIF
 3227  0000000                   	ENDM
 3228  0000000                   ;---------------------------------------------------------------------------
 3229  0000000                   SET_MS_ADDR_BANK1 MACRO
 3230  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3231  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1_MS
 3232  0000000                   	AND #03H
 3233  0000000                   	STA !BANK1
 3234  0000000                   	.ENDIF
 3235  0000000                   	ENDM
 3236  0000000                   ;---------------------------------------------------------------------------
 3237  0000000                   STORE_BANK1 MACRO
 3238  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)





 3239  0000000                   	LDA !BANK1
 3240  0000000                   	AND #03H
 3241  0000000                   	STA <TEMP_REG2+1
 3242  0000000                   	.ENDIF
 3243  0000000                   	ENDM	
 3244  0000000                   ;---------------------------------------------------------------------------
 3245  0000000                   SET_BANK1 MACRO
 3246  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3247  0000000                   	LDA <TEMP_REG2+1
 3248  0000000                   	AND #03H
 3249  0000000                   	STA !BANK1
 3250  0000000                   	.ENDIF
 3251  0000000                   	ENDM
 3252  0000000                   ;---------------------------------------------------------------------------
 3253  0000000                   GET_SPEAKER_TPYE MACRO 
 3254  0000000                   	LDA #WITH_SPEAKER_SWITCH
 3255  0000000                   	BEQ NOT_SWITCH_SPEAKER#
 3256  0000000                   	LDA <SPEN_TMP
 3257  0000000                   	BRA CHECK_DAC_MODE#
 3258  0000000                   NOT_SWITCH_SPEAKER#:
 3259  0000000                   	LDA #WITH_SPEAKER_OUTPUT_TYPE
 3260  0000000                   CHECK_DAC_MODE#:
 3261  0000000                   	ENDM
 3262  0000000                   ;---------------------------------------------------------------------------
 3263  0000000                   CHECK_NS_ACTIVE MACRO
 3264  0000000                   	LDA !SPEN
 3265  0000000                   	AND #WITH_SPEN_EFFECTIVE_BITS
 3266  0000000                   	BIT #08H
 3267  0000000                   	ENDM
 3268  0000000                   ;=====================================================================================
 3269  0000000                   ;=====================================================================================
 3270  0000000                   TSB_IEF_REG MACRO IEF_REG,EFC_REG
 3271  0000000                         BIT !IEF_REG
 3272  0000000                         BNE END_TSB_IEF_REG#             			
 3273  0000000                         STA !EFC_REG  
 3274  0000000                         PHP
 3275  0000000                         SEI                              		
 3276  0000000                         TSB !IEF_REG 
 3277  0000000                         PLP
 3278  0000000                   END_TSB_IEF_REG#:  
 3279  0000000                         ENDM
 3280  0000000                   ;-----------------------------------------------------------	
 3281  0000000                   TRB_IEF_REG MACRO IEF_REG,EFC_REG
 3282  0000000                         PHP
 3283  0000000                         SEI				; avoid port_int be disabled always 
 3284  0000000                         TRB !IEF_REG     
 3285  0000000                         PLP
 3286  0000000                         STA !EFC_REG
 3287  0000000                         ENDM
 3288  0000000                   ;=====================================================================================
 3289  0000000                   ;=====================================================================================
 3290  0000000                   ADC16_ADDR_X MACRO VAR_ADDR
 3291  0000000                   	CLC 
 3292  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3293  0000000                   	ADC <VAR_ADDR
 3294  0000000                   	STA <CH_DATA_ADDR_SP,X
 3295  0000000                   	LDA <CH_DATA_ADDR_SP+1,X





 3296  0000000                   	ADC <VAR_ADDR+1
 3297  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3298  0000000                   	LDA <CH_DATA_BANK_SP,X
 3299  0000000                   	ADC #00H
 3300  0000000                   	STA <CH_DATA_BANK_SP,X
 3301  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3302  0000000                   	LDA <CH_DATA_BANK_SP+1,X
 3303  0000000                   	ADC #00H
 3304  0000000                   	STA <CH_DATA_BANK_SP+1,X
 3305  0000000                   
 3306  0000000                   	AND #03H
 3307  0000000                   	BNE CHECK_CROSS_BANK#
 3308  0000000                   	.ENDIF
 3309  0000000                   
 3310  0000000                   	LDA <CH_DATA_BANK_SP,X
 3311  0000000                   	BNE CHECK_CROSS_BANK#
 3312  0000000                   
 3313  0000000                   CHECK_CROSS_BANK_BANK0#:
 3314  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3315  0000000                   	CMP #80H
 3316  0000000                   	BCC END_ADC16_ADDR_X#
 3317  0000000                   	INC <CH_DATA_BANK_SP,X
 3318  0000000                   	BRA END_ADC16_ADDR_X#
 3319  0000000                   
 3320  0000000                   CHECK_CROSS_BANK#:
 3321  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3322  0000000                   	CMP #80H
 3323  0000000                   	BEQ END_ADC16_ADDR_X#
 3324  0000000                   	BCS END_ADC16_ADDR_X#
 3325  0000000                   
 3326  0000000                   	CLC 
 3327  0000000                    	LDA <CH_DATA_ADDR_SP+1,X
 3328  0000000                   	ADC #80H
 3329  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3330  0000000                   
 3331  0000000                   END_ADC16_ADDR_X#:
 3332  0000000                   	ENDM
 3333  0000000                   ;---------------------------------------------------------------------------
 3334  0000000                   ADC32_ADDR_X MACRO VAR_ADDR
 3335  0000000                   	LDA <VAR_ADDR+1
 3336  0000000                   	CMP #80H
 3337  0000000                   	BCC ADC32_ADDR_X_PRE#
 3338  0000000                   
 3339  0000000                   	SEC 
 3340  0000000                   	LDA <VAR_ADDR+1
 3341  0000000                   	SBC #80H
 3342  0000000                   	STA <VAR_ADDR+1
 3343  0000000                   
 3344  0000000                   	ASL <VAR_ADDR+2
 3345  0000000                   	ROL <VAR_ADDR+3
 3346  0000000                   	CLC 
 3347  0000000                   	LDA <VAR_ADDR+2
 3348  0000000                   	ADC #01H
 3349  0000000                   	STA <VAR_ADDR+2
 3350  0000000                   	LDA <VAR_ADDR+3
 3351  0000000                   	ADC #00H
 3352  0000000                   	STA <VAR_ADDR+3





 3353  0000000                   	BRA ADC32_ADDR_X_NEXT#
 3354  0000000                   
 3355  0000000                   ADC32_ADDR_X_PRE#:
 3356  0000000                   	ASL <VAR_ADDR+2
 3357  0000000                   	ROL <VAR_ADDR+3
 3358  0000000                   
 3359  0000000                   ADC32_ADDR_X_NEXT#:
 3360  0000000                   	CLC 
 3361  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3362  0000000                   	ADC <VAR_ADDR
 3363  0000000                   	STA <CH_DATA_ADDR_SP,X
 3364  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3365  0000000                   	ADC <VAR_ADDR+1
 3366  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3367  0000000                   	LDA <CH_DATA_BANK_SP,X
 3368  0000000                   	ADC <VAR_ADDR+2
 3369  0000000                   	STA <CH_DATA_BANK_SP,X
 3370  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3371  0000000                   	LDA <CH_DATA_BANK_SP+1,X
 3372  0000000                   	ADC <VAR_ADDR+3
 3373  0000000                   	STA <CH_DATA_BANK_SP+1,X
 3374  0000000                   
 3375  0000000                   	AND #03H
 3376  0000000                   	BNE CHECK_CROSS_BANK#
 3377  0000000                   	.ENDIF
 3378  0000000                   
 3379  0000000                   	LDA <CH_DATA_BANK_SP,X
 3380  0000000                   	BNE CHECK_CROSS_BANK#
 3381  0000000                   
 3382  0000000                   CHECK_CROSS_BANK_BANK0#:
 3383  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3384  0000000                   	CMP #80H
 3385  0000000                   	BCC END_ADC32_ADDR_X#
 3386  0000000                   	INC <CH_DATA_BANK_SP,X
 3387  0000000                   	BRA END_ADC32_ADDR_X#
 3388  0000000                   
 3389  0000000                   CHECK_CROSS_BANK#:
 3390  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3391  0000000                   	CMP #80H
 3392  0000000                   	BEQ END_ADC32_ADDR_X#
 3393  0000000                   	BCS END_ADC32_ADDR_X#
 3394  0000000                   
 3395  0000000                   	CLC 
 3396  0000000                    	LDA <CH_DATA_ADDR_SP+1,X
 3397  0000000                   	ADC #80H
 3398  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3399  0000000                   
 3400  0000000                   END_ADC32_ADDR_X#:
 3401  0000000                   	ENDM
 3402  0000000                   ;---------------------------------------------------------------------------
 3403  0000000                   ADC16_ADDR_X_EX_ MACRO VAR_ADDR
 3404  0000000                   	CLC 
 3405  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3406  0000000                   	ADC <VAR_ADDR
 3407  0000000                   	STA <CH_DATA_ADDR_SP,X
 3408  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3409  0000000                   	ADC <VAR_ADDR+1





 3410  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3411  0000000                   	LDA <CH_DATA_BANK_SP,X
 3412  0000000                   	ADC #00H
 3413  0000000                   	STA <CH_DATA_BANK_SP,X
 3414  0000000                   	ENDM
 3415  0000000                   ;---------------------------------------------------------------------------
 3416  0000000                   ADC32_ADDR_X_EX_ MACRO VAR_ADDR
 3417  0000000                   	CLC 
 3418  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3419  0000000                   	ADC <VAR_ADDR
 3420  0000000                   	STA <CH_DATA_ADDR_SP,X
 3421  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3422  0000000                   	ADC <VAR_ADDR+1
 3423  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3424  0000000                   	LDA <CH_DATA_BANK_SP,X
 3425  0000000                   	ADC <VAR_ADDR+2
 3426  0000000                   	STA <CH_DATA_BANK_SP,X
 3427  0000000                   	ENDM	
 3428  0000000                   ;=====================================================================================
 3429  0000000                   ; Add the SIM function implementing by GPIO 2012/12/11 by CWChang
 3430  0000000                   ;=====================================================================================
 3431  0000000                   NEX_CMD_WRITE_STATUS:	.EQU	01h
 3432  0000000                   NEX_CMD_PAGE_PROGRAM:	.EQU	02h
 3433  0000000                   NEX_CMD_READ_DATA:		.EQU	03h
 3434  0000000                   NEX_CMD_WRITE_DISABLE:	.EQU	04h
 3435  0000000                   NEX_CMD_READ_STATUS:	.EQU	05h
 3436  0000000                   NEX_CMD_WRITE_ENABLE:	.EQU	06h
 3437  0000000                   NEX_CMD_FAST_READ:		.EQU	0Bh
 3438  0000000                   NEX_CMD_DEVICE_ID:		.EQU	ABh
 3439  0000000                   NEX_CMD_RELEASE_POWER_DOWN	.EQU	ABh
 3440  0000000                   NEX_CMD_POWER_DOWN:		.EQU	B9h
 3441  0000000                   NEX_CMD_BULK_ERASE:		.EQU	C7h
 3442  0000000                   NEX_CMD_SECTOR_ERASE:	.EQU	D8h
 3443  0000000                   
 3444  0000000                   BIT_0	.EQU	(1<<0)
 3445  0000000                   BIT_1	.EQU	(1<<1)
 3446  0000000                   BIT_2	.EQU	(1<<2)
 3447  0000000                   BIT_3	.EQU	(1<<3)
 3448  0000000                   BIT_4	.EQU	(1<<4)
 3449  0000000                   BIT_5	.EQU	(1<<5)
 3450  0000000                   BIT_6	.EQU	(1<<6)
 3451  0000000                   BIT_7	.EQU	(1<<7)
 3452  0000000                   
 3453  0000000                   ;SPI
 3454  0000000                   BPn:	EQU	BP0
 3455  0000000                   BPnD:	EQU	BP0D
 3456  0000000                   ;BPnM:	EQU	BP1M
 3457  0000000                   BPn_SPI_MASK_1:	EQU	10101010b
 3458  0000000                   BPn_SPI_MASK_2:	EQU	00000001b
 3459  0000000                   NEX_CLK_ADDR:	.EQU	BPn
 3460  0000000                   NEX_CLK:		.EQU	BIT_2
 3461  0000000                   NEX_CLK_B:		.EQU	11111011b
 3462  0000000                   NEX_DI_ADDR:	.EQU	BPn
 3463  0000000                   NEX_DI:			.EQU	BIT_6
 3464  0000000                   NEX_DI_B:		.EQU	10111111b
 3465  0000000                   NEX_DO_ADDR:	.EQU	BPn
 3466  0000000                   NEX_DO:			.EQU	BIT_0





 3467  0000000                   NEX_DO_B:		.EQU	11111110b
 3468  0000000                   NEX_CS0_ADDR:	.EQU	BPn
 3469  0000000                   NEX_CS0:		.EQU	BIT_4
 3470  0000000                   NEX_CS0_B:		.EQU	11101111b
 3471  0000000                   ;;IOSPI_BUFFER   .EQU	50H
 3472  0000000                   ;----------------------------------------------------
 3473  0000000                   NEX_ON0:	.MACRO
 3474  0000000                   	LDA	!NEX_CS0_ADDR
 3475  0000000                   	ORA !BPnD 
 3476  0000000                   	AND #NEX_CS0_B
 3477  0000000                   	STA	!NEX_CS0_ADDR
 3478  0000000                   	.ENDM
 3479  0000000                   ;----------------------------------------------------
 3480  0000000                   NEX_OFF0:	.MACRO
 3481  0000000                   	LDA	!NEX_CS0_ADDR
 3482  0000000                   	ORA !BPnD
 3483  0000000                   	ORA  #NEX_CS0
 3484  0000000                   	STA	!NEX_CS0_ADDR
 3485  0000000                   	.ENDM
 3486  0000000                   ;----------------------------------------------------
 3487  0000000                   NEX_CLK_OUT:	.MACRO
 3488  0000000                   	LDA	!NEX_CLK_ADDR
 3489  0000000                   	ORA !BPnD
 3490  0000000                   	ORA #NEX_CLK
 3491  0000000                   	STA !NEX_CLK_ADDR
 3492  0000000                   	AND #NEX_CLK_B	
 3493  0000000                   	STA	!NEX_CLK_ADDR
 3494  0000000                   	.ENDM
 3495  0000000                   ;----------------------------------------------------
 3496  0000000                   NEX_DI_0:	.MACRO
 3497  0000000                   	LDA	!NEX_DI_ADDR
 3498  0000000                   	ORA !BPnD
 3499  0000000                   	AND #NEX_DI_B
 3500  0000000                   	STA	!NEX_DI_ADDR
 3501  0000000                   	NEX_CLK_OUT
 3502  0000000                   	.ENDM
 3503  0000000                   ;----------------------------------------------------
 3504  0000000                   NEX_DI_1:	.MACRO
 3505  0000000                   	LDA !NEX_DI_ADDR
 3506  0000000                   	ORA !BPnD
 3507  0000000                   	ORA #NEX_DI
 3508  0000000                   	STA	!NEX_DI_ADDR
 3509  0000000                   	NEX_CLK_OUT
 3510  0000000                   	.ENDM
 3511  0000000                   ;----------------------------------------------------
 3512  0000000                   NEX_DI_X:	.MACRO
 3513  0000000                   ;ROL	<NFV_TEMP
 3514  0000000                       ROL	<IOSPI_BUFFER+3
 3515  0000000                   	BCS	NEX_DI_1_#
 3516  0000000                   NEX_DI_0_#:
 3517  0000000                   	NEX_DI_0
 3518  0000000                   	BRA	NEX_DI_X_END_#
 3519  0000000                   NEX_DI_1_#:
 3520  0000000                   	NEX_DI_1
 3521  0000000                   NEX_DI_X_END_#:
 3522  0000000                   	.ENDM
 3523  0000000                   ;----------------------------------------------------





 3524  0000000                   NEX_DO_X:	.MACRO
 3525  0000000                   	LDA	!NEX_DO_ADDR
 3526  0000000                   ;ROL	A
 3527  0000000                       ROR	A
 3528  0000000                   ;ROL	<NFV_TEMP
 3529  0000000                       ROL <IOSPI_BUFFER+3
 3530  0000000                   	NEX_CLK_OUT
 3531  0000000                   	.ENDM
 3532  0000000                   ;----------------------------------------------------
 3533  0000000                   NEX_DI_BYTE_X:	.MACRO
 3534  0000000                   	STA	<IOSPI_BUFFER+3
 3535  0000000                   ;STA <NFV_TEMP
 3536  0000000                   	NEX_DI_X
 3537  0000000                   	NEX_DI_X
 3538  0000000                   	NEX_DI_X
 3539  0000000                   	NEX_DI_X
 3540  0000000                   	NEX_DI_X
 3541  0000000                   	NEX_DI_X
 3542  0000000                   	NEX_DI_X
 3543  0000000                   	NEX_DI_X
 3544  0000000                   	.ENDM
 3545  0000000                   ;----------------------------------------------------
 3546  0000000                   NEX_DO_BYTE_X:	.MACRO
 3547  0000000                   	NEX_DO_X
 3548  0000000                   	NEX_DO_X
 3549  0000000                   	NEX_DO_X
 3550  0000000                   	NEX_DO_X
 3551  0000000                   	NEX_DO_X
 3552  0000000                   	NEX_DO_X
 3553  0000000                   	NEX_DO_X
 3554  0000000                   	NEX_DO_X
 3555  0000000                   	LDA	<IOSPI_BUFFER+3
 3556  0000000                   ;LDA <NFV_TEMP
 3557  0000000                   	.ENDM
 3558  0000000                   ;----------------------------------------------------
 3559  0000000                   NEX_CLK_BYTE:	.MACRO
 3560  0000000                   	NEX_CLK_OUT
 3561  0000000                   	NEX_CLK_OUT
 3562  0000000                   	NEX_CLK_OUT
 3563  0000000                   	NEX_CLK_OUT
 3564  0000000                   	NEX_CLK_OUT
 3565  0000000                   	NEX_CLK_OUT
 3566  0000000                   	NEX_CLK_OUT
 3567  0000000                   	NEX_CLK_OUT
 3568  0000000                   	.ENDM
 3569  0000000                   ;----------------------------------------------------
 3570  0000000                   ;----------------------------------------------------
 3571  0000000                   ; NEX_READ_DATA_START:
 3572  0000000                   ;----------------------------------------------------
 3573  0000000                   NEX_READ_DATA_START: .MACRO
 3574  0000000                   	LDA	#NEX_CMD_READ_DATA
 3575  0000000                   	NEX_DI_BYTE_X
 3576  0000000                   	LDA	<IOSPI_BUFFER+2
 3577  0000000                   	NEX_DI_BYTE_X
 3578  0000000                   	LDA	<IOSPI_BUFFER+1
 3579  0000000                   	NEX_DI_BYTE_X
 3580  0000000                   	LDA	<IOSPI_BUFFER





 3581  0000000                   	NEX_DI_BYTE_X
 3582  0000000                   	.ENDM
 3583  0000000                   ;----------------------------------------------------
 3584  0000000                   ; NEX_READ_CONTINUE:
 3585  0000000                   ;----------------------------------------------------
 3586  0000000                   NEX_READ_CONTINUE: .MACRO
 3587  0000000                   	NEX_DO_BYTE_X
 3588  0000000                   	.ENDM
 3589  0000000                   ;----------------------------------------------------
 3590  0000000                   IOSPI_ADDR_MAPPING MACRO VAR_ADDR	
 3591  0000000                   	LDA <VAR_ADDR+2
 3592  0000000                   	BIT #01H
 3593  0000000                   	BNE ODD_BANK# 
 3594  0000000                   	LDA <VAR_ADDR+1
 3595  0000000                   	AND #7FH
 3596  0000000                   	STA <IOSPI_BUFFER+1
 3597  0000000                   	BRA ADDR_MAPPING_END# 
 3598  0000000                   ODD_BANK#:	
 3599  0000000                   	LDA <VAR_ADDR+1
 3600  0000000                   	STA <IOSPI_BUFFER+1
 3601  0000000                   ADDR_MAPPING_END#:   
 3602  0000000                   	LDA <VAR_ADDR+2
 3603  0000000                   	AND #7FH
 3604  0000000                   	LSR A
 3605  0000000                   	STA <IOSPI_BUFFER+2
 3606  0000000                   	LDA <VAR_ADDR
 3607  0000000                   	STA <IOSPI_BUFFER
 3608  0000000                   	ENDM
 3609  0000000                   ;----------------------------------------------------
 3610  0000000                   IOSPI_ADDR_MAPPING_X MACRO VAR_ADDR	
 3611  0000000                   	LDA <VAR_ADDR+2,X
 3612  0000000                   	BIT #01H
 3613  0000000                   	BNE ODD_BANK# 
 3614  0000000                   	LDA <VAR_ADDR+1,X
 3615  0000000                   	AND #7FH
 3616  0000000                   	STA <IOSPI_BUFFER+1
 3617  0000000                   	BRA ADDR_MAPPING_END# 
 3618  0000000                   ODD_BANK#:	
 3619  0000000                   	LDA <VAR_ADDR+1,X
 3620  0000000                   	STA <IOSPI_BUFFER+1
 3621  0000000                   ADDR_MAPPING_END#:   
 3622  0000000                   	LDA <VAR_ADDR+2,X
 3623  0000000                   	AND #7FH
 3624  0000000                   	LSR A
 3625  0000000                   	STA <IOSPI_BUFFER+2
 3626  0000000                   	LDA <VAR_ADDR,X
 3627  0000000                   	STA <IOSPI_BUFFER
 3628  0000000                   	ENDM
 3629  0000000                   ;----------------------------------------------------
 3630  0000000                   IOSPI_ADDR_LOAD MACRO VAR_ADDR	
 3631  0000000                   	LDA VAR_ADDR
 3632  0000000                   	STA <IOSPI_BUFFER
 3633  0000000                   	LDA VAR_ADDR+1
 3634  0000000                   	STA <IOSPI_BUFFER+1
 3635  0000000                   	LDA VAR_ADDR+2
 3636  0000000                   	STA <IOSPI_BUFFER+2
 3637  0000000                   	ENDM





 3638  0000000                   ;----------------------------------------------------
 3639  0000000                   IOSPI_ADDR_LOAD_X MACRO VAR_ADDR	
 3640  0000000                   	LDA VAR_ADDR,X
 3641  0000000                   	STA <IOSPI_BUFFER
 3642  0000000                   	LDA VAR_ADDR+1,X
 3643  0000000                   	STA <IOSPI_BUFFER+1
 3644  0000000                   	LDA VAR_ADDR+2,X
 3645  0000000                   	STA <IOSPI_BUFFER+2
 3646  0000000                   	ENDM
 3647  0000000                   ;-----------------------------------------------------
 3648  0000000                   IOSPI_INIT  MACRO 	
 3649  0000000                   	LDA !BPnD
 3650  0000000                   	AND #BPn_SPI_MASK_1
 3651  0000000                   	ORA #BPn_SPI_MASK_2
 3652  0000000                   	STA !BPnD
 3653  0000000                   	LDA !BPn
 3654  0000000                   	ORA !BPnD
 3655  0000000                   	AND #BPn_SPI_MASK_1
 3656  0000000                   	ORA #BPn_SPI_MASK_2
 3657  0000000                   	STA !BPn
 3658  0000000                   	NEX_OFF0
 3659  0000000                   	ENDM
 3660  0000000                   ;-----------------------------------------------------
 3661  0000000                   LDA_DP_ILI_SIM_IOSPI MACRO 	VAR_ADDR
 3662  0000000                   ;IOSPI_ADDR_MAPPING TEMP_REG1
 3663  0000000                   	IOSPI_INIT
 3664  0000000                   
 3665  0000000                   	LDA VAR_ADDR
 3666  0000000                   	STA <IOSPI_BUFFER
 3667  0000000                   	LDA VAR_ADDR+1
 3668  0000000                   	STA <IOSPI_BUFFER+1
 3669  0000000                   	LDA VAR_ADDR+2
 3670  0000000                   	STA <IOSPI_BUFFER+2
 3671  0000000                   
 3672  0000000                   	NEX_ON0
 3673  0000000                   	NEX_READ_DATA_START
 3674  0000000                   	NEX_READ_CONTINUE
 3675  0000000                   	NEX_OFF0
 3676  0000000                   
 3677  0000000                   	LDA <IOSPI_BUFFER+3
 3678  0000000                   	ENDM
 3679  0000000                   ;----------------------------------------------------
 3680  0000000                   LDA_DP_ILI_Y_SIM_IOSPI MACRO VAR_ADDR	
 3681  0000000                   ;IOSPI_ADDR_MAPPING TEMP_REG1
 3682  0000000                   	IOSPI_INIT
 3683  0000000                   
 3684  0000000                   	LDA VAR_ADDR
 3685  0000000                   	STA <IOSPI_BUFFER
 3686  0000000                   	LDA VAR_ADDR+1
 3687  0000000                   	STA <IOSPI_BUFFER+1
 3688  0000000                   	LDA VAR_ADDR+2
 3689  0000000                   	STA <IOSPI_BUFFER+2
 3690  0000000                   
 3691  0000000                   	TYA 
 3692  0000000                   	CLC 
 3693  0000000                   	ADC <IOSPI_BUFFER
 3694  0000000                   	STA <IOSPI_BUFFER





 3695  0000000                   	LDA <IOSPI_BUFFER+1
 3696  0000000                   	ADC #00H
 3697  0000000                   	STA <IOSPI_BUFFER+1
 3698  0000000                   	LDA <IOSPI_BUFFER+2
 3699  0000000                   	ADC #00H
 3700  0000000                   	STA <IOSPI_BUFFER+2	
 3701  0000000                   
 3702  0000000                   	NEX_ON0
 3703  0000000                   	NEX_READ_DATA_START
 3704  0000000                   	NEX_READ_CONTINUE
 3705  0000000                   	NEX_OFF0
 3706  0000000                   
 3707  0000000                   	LDA <IOSPI_BUFFER+3
 3708  0000000                   	ENDM
 3709  0000000                   ;------------------------------------------------
 3710  0000000                   ;load Temp buffer data
 3711  0000000                   LDA_DP_ILI_CH_DATA_SP_EXT_IOSPI MACRO CHANNEL_NAME,INDEX  
 3712  0000000                   	LDY #INDEX
 3713  0000000                   	LDA !IOSPI_BUFFER,Y
 3714  0000000                   	ENDM
 3715  0000000                   ;-------------------------------------------------
 3716  0000000                   SET_SIC_BUF_SP_EXT_IOSPI MACRO VALUE, CHANNEL_NAME
 3717  0000000                   	LDY #0	
 3718  0000000                   CONTINUE_READ#:	
 3719  0000000                   	NEX_READ_CONTINUE
 3720  0000000                   	STA !IOSPI_BUFFER,Y
 3721  0000000                   	INY 
 3722  0000000                   	CPY #VALUE+1
 3723  0000000                   	BEQ CONTINUE_READ_END#
 3724  0000000                   	JMP CONTINUE_READ#
 3725  0000000                   CONTINUE_READ_END#:		
 3726  0000000                   	ENDM
 3727  0000000                   ;------------------------------------------------------------------------------
 3728  0000000                   ;------------------------------------------------------------------------------	
 3729  0000000                   NEX_POWER_DOWN MACRO
 3730  0000000                   	LDA #NEX_CMD_POWER_DOWN
 3731  0000000                   	NEX_DI_BYTE_X
 3732  0000000                   	ENDM
 3733  0000000                   ;----------------------------------------------------
 3734  0000000                   NEX_RELEASE_POWER_DOWN MACRO
 3735  0000000                   	LDA #NEX_CMD_RELEASE_POWER_DOWN
 3736  0000000                   	NEX_DI_BYTE_X
 3737  0000000                   	ENDM
 3738  0000000                   ;----------------------------------------------------
 3739  0000000                   DELAY_MACRO MACRO
 3740  0000000                       	LDX #0AH
 3741  0000000                   LOOP#:	
 3742  0000000                   	NOP
 3743  0000000                   	NOP
 3744  0000000                   	DEX
 3745  0000000                       	BNE LOOP#
 3746  0000000                       	ENDM
 3747  0000000                   ;----------------------------------------------------   	
 3748  0000000                   SPI_ENTER_POWER_DOWN MACRO REG,FLAG,FLAG_REG
 3749  0000000                   .IF (WITH_SPI_GPIO .EQ. 1H)
 3750  0000000                   	SEI
 3751  0000000                   	LDA !BPnD





 3752  0000000                   	STA REG
 3753  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3754  0000000                   	LDA <BP0M_BAK
 3755  0000000                   	STA REG+1
 3756  0000000                   	.ENDIF
 3757  0000000                   
 3758  0000000                   	LDA #01010100b
 3759  0000000                   	TRB !BPnD
 3760  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3761  0000000                   	TRB <BP0M_BAK
 3762  0000000                   	.ENDIF
 3763  0000000                   	LDA !BPn
 3764  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3765  0000000                   	ORA #NEX_CS0		;CSB:1	
 3766  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3767  0000000                   	ORA !BPnD		
 3768  0000000                   	.ELSE
 3769  0000000                   	ORA <BP0M_BAK
 3770  0000000                   	.ENDIF
 3771  0000000                   	STA !BPn
 3772  0000000                   
 3773  0000000                   	NEX_ON0
 3774  0000000                   	NEX_POWER_DOWN
 3775  0000000                   	NEX_OFF0
 3776  0000000                   
 3777  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3778  0000000                   	LDA REG+1
 3779  0000000                   	STA <BP0M_BAK
 3780  0000000                   	.ENDIF
 3781  0000000                   	LDA REG
 3782  0000000                   	STA !BPnD
 3783  0000000                   	LDA #FLAG
 3784  0000000                   	TSB FLAG_REG
 3785  0000000                   .ENDIF
 3786  0000000                   	ENDM
 3787  0000000                   ;------------------------------------------------------------------------------
 3788  0000000                   SPI_RELEASE_POWER_DOWN MACRO REG,FLAG,FLAG_REG
 3789  0000000                   .IF (WITH_SPI_GPIO.EQ. 1H)
 3790  0000000                   	SEI
 3791  0000000                   	LDA #FLAG
 3792  0000000                   	BIT FLAG_REG
 3793  0000000                   	BNE 3 
 3794  0000000                   	JMP END_SPI_RELEASE_POWER_DOWN#
 3795  0000000                   	TRB FLAG_REG
 3796  0000000                   
 3797  0000000                   	LDA !BPnD
 3798  0000000                   	STA REG
 3799  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3800  0000000                   	LDA <BP0M_BAK
 3801  0000000                   	STA REG+1
 3802  0000000                   	.ENDIF
 3803  0000000                   
 3804  0000000                   	LDA #01010100b
 3805  0000000                   	TRB !BPnD
 3806  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3807  0000000                   	TRB <BP0M_BAK
 3808  0000000                   	.ENDIF





 3809  0000000                   	LDA !BPn
 3810  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3811  0000000                   	ORA #NEX_CS0		;CSB:1	
 3812  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3813  0000000                   	ORA !BPnD		
 3814  0000000                   	.ELSE
 3815  0000000                   	ORA <BP0M_BAK
 3816  0000000                   	.ENDIF
 3817  0000000                   	STA !BPn
 3818  0000000                   
 3819  0000000                   	NEX_ON0
 3820  0000000                   	NEX_RELEASE_POWER_DOWN
 3821  0000000                   	NEX_OFF0  
 3822  0000000                   
 3823  0000000                   	DELAY_MACRO 
 3824  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3825  0000000                   	LDA REG+1
 3826  0000000                   	STA <BP0M_BAK
 3827  0000000                   	.ENDIF 
 3828  0000000                   	LDA REG
 3829  0000000                   	STA !BPnD
 3830  0000000                   
 3831  0000000                   END_SPI_RELEASE_POWER_DOWN#:
 3832  0000000                   	CLI
 3833  0000000                   .ENDIF
 3834  0000000                   	ENDM
 3835  0000000                   ;------------------------------------------------------------------------------
 3836  0000000                   SPI_RELEASE_POWER_DOWN_MAIN MACRO REG,FLAG,FLAG_REG
 3837  0000000                   .IF (WITH_SPI_GPIO .EQ. 1H)
 3838  0000000                   	SEI
 3839  0000000                   	LDA #RESET_POR
 3840  0000000                   	BIT !RESET_F
 3841  0000000                   	BEQ 3
 3842  0000000                   	JMP MAIN_START_NEXT#
 3843  0000000                   	LDA #FLAG
 3844  0000000                   	BIT FLAG_REG
 3845  0000000                   	BNE 3 
 3846  0000000                   	JMP MAIN_START_NEXT#
 3847  0000000                   	TRB FLAG_REG
 3848  0000000                   
 3849  0000000                   	LDA !BPnD
 3850  0000000                   	STA REG
 3851  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3852  0000000                   	LDA <BP0M_BAK
 3853  0000000                   	STA REG+1
 3854  0000000                   	.ENDIF
 3855  0000000                   
 3856  0000000                   	LDA #01010100b
 3857  0000000                   	TRB !BPnD
 3858  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3859  0000000                   	TRB <BP0M_BAK
 3860  0000000                   	.ENDIF
 3861  0000000                   	LDA !BPn
 3862  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3863  0000000                   	ORA #NEX_CS0		;CSB:1	
 3864  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3865  0000000                   	ORA !BPnD		





 3866  0000000                   	.ELSE
 3867  0000000                   	ORA <BP0M_BAK
 3868  0000000                   	.ENDIF
 3869  0000000                   	STA !BPn
 3870  0000000                   
 3871  0000000                   	NEX_ON0
 3872  0000000                   	NEX_RELEASE_POWER_DOWN
 3873  0000000                   	NEX_OFF0  
 3874  0000000                   
 3875  0000000                   	DELAY_MACRO  
 3876  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3877  0000000                   	LDA REG+1
 3878  0000000                   	STA <BP0M_BAK
 3879  0000000                   	.ENDIF 
 3880  0000000                   	LDA REG
 3881  0000000                   	STA !BPnD
 3882  0000000                   
 3883  0000000                   MAIN_START_NEXT#:
 3884  0000000                   	LDA #RESET_POR
 3885  0000000                   	STA !RESET_F
 3886  0000000                   .ENDIF
 3887  0000000                   	ENDM
 3888  0000000                   ;------------------------------------------------------------------------------
 3889  0000000                   SPI_RELEASE_POWER_DOWN_PORT MACRO REG,FLAG,FLAG_REG
 3890  0000000                   .IF (WITH_SPI_GPIO .EQ. 1H)
 3891  0000000                   	SEI
 3892  0000000                   	LDA #FLAG
 3893  0000000                   	BIT FLAG_REG
 3894  0000000                   	BNE 3 
 3895  0000000                   	JMP END_SPI_RELEASE_POWER_DOWN_PORT#
 3896  0000000                   	TRB FLAG_REG
 3897  0000000                   
 3898  0000000                   	LDA !BPnD
 3899  0000000                   	STA REG
 3900  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3901  0000000                   	LDA <BP0M_BAK
 3902  0000000                   	STA REG+1
 3903  0000000                   	.ENDIF
 3904  0000000                   
 3905  0000000                   	LDA #01010100b
 3906  0000000                   	TRB !BPnD
 3907  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3908  0000000                   	TRB <BP0M_BAK
 3909  0000000                   	.ENDIF
 3910  0000000                   	LDA !BPn
 3911  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3912  0000000                   	ORA #NEX_CS0		;CSB:1	
 3913  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3914  0000000                   	ORA !BPnD		
 3915  0000000                   	.ELSE
 3916  0000000                   	ORA <BP0M_BAK
 3917  0000000                   	.ENDIF
 3918  0000000                   	STA !BPn
 3919  0000000                   
 3920  0000000                   	NEX_ON0
 3921  0000000                   	NEX_RELEASE_POWER_DOWN
 3922  0000000                   	NEX_OFF0 





 3923  0000000                   
 3924  0000000                   	DELAY_MACRO  
 3925  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3926  0000000                   	LDA REG+1
 3927  0000000                   	STA <BP0M_BAK
 3928  0000000                   	.ENDIF  
 3929  0000000                   	LDA REG
 3930  0000000                   	STA !BPnD
 3931  0000000                   
 3932  0000000                   END_SPI_RELEASE_POWER_DOWN_PORT#:
 3933  0000000                   .ENDIF
 3934  0000000                   	ENDM
 3935  0000000                   ;------------------------------------------------------------------------------
 3936  0000000                   ;------------------------------------------------------------------------------
 3937  0000000                   ;IEF0_FLAG: 
 3938  0000000                   ;80h:speech/other interrupt 
 3939  0000000                   ;40h:BAM in speech interrupt
 3940  0000000                   ;20H:BAM interrupt
 3941  0000000                   ;10H:speech in BAM interrupt
 3942  0000000                   ;------------------------------------------------------------------------------
 3943  0000000                   ENABLE_SPEECH_INT_EXCEPT MACRO
 3944  0000000                   .ifdef	FW_BAM_TIMER
 3945  0000000                   	LDA <UIO_TIMER_CH_FLAG				;3
 3946  0000000                   	BEQ END_ENABLE_SPEECH_INT_EXCEPT#		;2~3
 3947  0000000                   
 3948  0000000                   	LDA <IEF0_FLAG					;3
 3949  0000000                   	BIT #80H					;2
 3950  0000000                   	BEQ ENABLE_SPEECH_INT_EXCEPT_NEXT#		;2~3
 3951  0000000                   	LDA #40H					;2
 3952  0000000                   	TSB <IEF0_FLAG					;5
 3953  0000000                   	BRA END_ENABLE_SPEECH_INT_EXCEPT#		;3
 3954  0000000                   
 3955  0000000                   ENABLE_SPEECH_INT_EXCEPT_NEXT#:
 3956  0000000                   	LDA <UIO_BIT_COUNT				;3
 3957  0000000                   	AND #07H					;2
 3958  0000000                   	EXTERN BAM_INT_LONG				
 3959  0000000                   	CMP #BAM_INT_LONG				;2
 3960  0000000                   	BNE END_ENABLE_SPEECH_INT_EXCEPT#		;2~3
 3961  0000000                   	LDA #20H					;2
 3962  0000000                   	TSB <IEF0_FLAG					;5
 3963  0000000                   	LDA !IEF0					;4
 3964  0000000                   	STA <IEF0_BAK					;3
 3965  0000000                   	AND #(INT0_TM0+INT0_TM1+INT0_TMG0)		;2
 3966  0000000                   	AND #(FFH^UIO_TIMER_INT)			;2
 3967  0000000                   	STA !IEF0 					;4
 3968  0000000                   	CLI						;2
 3969  0000000                   END_ENABLE_SPEECH_INT_EXCEPT#:
 3970  0000000                   .endif
 3971  0000000                   ENDM	
 3972  0000000                   ;------------------------------------------------------------------------------
 3973  0000000                   ENABLE_BAM_INT_EXCEPT	MACRO
 3974  0000000                   .ifdef	FW_BAM_TIMER
 3975  0000000                   	LDA <UIO_TIMER_CH_FLAG				;3
 3976  0000000                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			;2~3
 3977  0000000                   
 3978  0000000                   	LDA <IEF0_FLAG					;3
 3979  0000000                   	BIT #20H					;2





 3980  0000000                   	BEQ ENABLE_BAM_INT_EXCEPT_NEXT#			;2~3
 3981  0000000                   	LDA #10H					;2
 3982  0000000                   	TSB <IEF0_FLAG					;5
 3983  0000000                   	BRA END_ENABLE_BAM_INT_EXCEPT#			;3
 3984  0000000                   
 3985  0000000                   ENABLE_BAM_INT_EXCEPT_NEXT#:
 3986  0000000                   	LDA <UIO_BIT_COUNT				;3
 3987  0000000                   	AND #07H					;2
 3988  0000000                   	EXTERN BAM_INT_LONG
 3989  0000000                   	CMP #BAM_INT_LONG				;2
 3990  0000000                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			;2~3
 3991  0000000                   	CMP #00H					;2
 3992  0000000                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			;2~3
 3993  0000000                   	LDA #80H					;2
 3994  0000000                   	TSB <IEF0_FLAG					;5
 3995  0000000                   	LDA !IEF0					;4
 3996  0000000                   	STA <IEF0_BAK					;3
 3997  0000000                   	AND #UIO_TIMER_INT				;2
 3998  0000000                   	STA !IEF0 					;4
 3999  0000000                   	CLI						;2
 4000  0000000                   END_ENABLE_BAM_INT_EXCEPT#:
 4001  0000000                   .endif
 4002  0000000                   ENDM
 4003  0000000                   ;------------------------------------------------------------------------------
 4004  0000000                   QUIT_ENABLE_BAM_INT_EXCEPT	MACRO
 4005  0000000                   .ifdef	FW_BAM_TIMER
 4006  0000000                   	LDA <IEF0_FLAG					;3
 4007  0000000                   	BIT #C0H					;2
 4008  0000000                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			;2~3
 4009  0000000                   	BIT #40H					;2
 4010  0000000                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		;2~3
 4011  0000000                   	LDA #40H					;2
 4012  0000000                   	TRB <IEF0_FLAG					;5
 4013  0000000                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		;3
 4014  0000000                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
 4015  0000000                   	SEI						;2
 4016  0000000                   	LDA <IEF0_BAK					;3
 4017  0000000                   	AND #(FFH^UIO_TIMER_INT)			;2
 4018  0000000                   	ORA !IEF0					;4
 4019  0000000                   	STA !IEF0					;4
 4020  0000000                   	LDA #80H					;2
 4021  0000000                   	TRB <IEF0_FLAG					;5
 4022  0000000                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		;3
 4023  0000000                   
 4024  0000000                   NEXT_CHECK_BAM_INT_EXCEPT#:
 4025  0000000                   	BIT #30H					;2
 4026  0000000                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		;2~3
 4027  0000000                   	BIT #10H					;2
 4028  0000000                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		;2~3
 4029  0000000                   	LDA #10H					;2
 4030  0000000                   	TRB <IEF0_FLAG					;5
 4031  0000000                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		;3
 4032  0000000                   
 4033  0000000                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
 4034  0000000                   	SEI						;2
 4035  0000000                   	LDA <IEF0_BAK					;3
 4036  0000000                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		;2





 4037  0000000                   	ORA #UIO_TIMER_INT				;2
 4038  0000000                   	ORA !IEF0					;4
 4039  0000000                   	STA !IEF0					;4
 4040  0000000                   	LDA #20H					;2
 4041  0000000                   	TRB <IEF0_FLAG					;5
 4042  0000000                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
 4043  0000000                   .endif
 4044  0000000                   ENDM
 4045  0000000                   ;------------------------------------------------------------------------------
 4046  0000000                   ENABLE_BAM_INT_EXCEPT_PSF_TIMER	MACRO
 4047  0000000                   .ifdef	FW_BAM_TIMER
 4048  0000000                   	LDA <UIO_TIMER_CH_FLAG
 4049  0000000                   	BNE END_ENABLE_BAM_INT_EXCEPT_PSF_TIMER#
 4050  0000000                   ENABLE_BAM_INT_EXCEPT#:
 4051  0000000                   .endif
 4052  0000000                   	SEI
 4053  0000000                   END_ENABLE_BAM_INT_EXCEPT_PSF_TIMER#:
 4054  0000000                   ENDM
 4055  0000000                   ;------------------------------------------------------------------------------
 4056  0000000                   ;------------------------------------------------------------------------------
 4057  0000000                   STORE_CH_ADDR_TO_BAM_REG MACRO CHANNEL_NAME
 4058  0000000                   	EXTERN BAM_EVENT_ADDR_OFFSET_TABLE
 4059  0000000                   	EXTERN BAM_EVENT_ADDR_SP1
 4060  0000000                   	LDA !BAM_EVENT_ADDR_OFFSET_TABLE,Y
 4061  0000000                   	TAY
 4062  0000000                   
 4063  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 4064  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1|CHANNEL_NAME
 4065  0000000                   	STA BAM_EVENT_ADDR_SP1+3,Y
 4066  0000000                   	.ENDIF
 4067  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK|CHANNEL_NAME
 4068  0000000                   	STA BAM_EVENT_ADDR_SP1+2,Y
 4069  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME+1
 4070  0000000                   	STA BAM_EVENT_ADDR_SP1+1,Y
 4071  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME
 4072  0000000                   	STA BAM_EVENT_ADDR_SP1,Y
 4073  0000000                   	ENDM
 4074  0000000                   ;------------------------------------------------------------------------------
 4075  0000000                   ;------------------------------------------------------------------------------
 4076  0000000                   PSF_RESPONSE_LIMIT MACRO 
 4077  0000000                   .IF (WITH_PSF_PROJECT .EQ. 1)
 4078  0000000                   .IFDEF ABANDON_STACK
 4079  0000000                   	LDA #80H
 4080  0000000                   	BIT ABANDON_STACK_FLAG
 4081  0000000                   	BEQ PSF_RESPONSE_LIMIT_END#
 4082  0000000                   	LDA #01H
 4083  0000000                   PSF_RESPONSE_LIMIT_END#:
 4084  0000000                   	TSB ABANDON_STACK_FLAG
 4085  0000000                   .ENDIF
 4086  0000000                   .ENDIF
 4087  0000000                   	ENDM
 4088  0000000                   ;------------------------------------------------------------------------------
 4089  0000000                   PSF_RESPONSE_LIMIT_RELEASE MACRO 
 4090  0000000                   .IF (WITH_PSF_PROJECT .EQ. 1)
 4091  0000000                   .IFDEF ABANDON_STACK
 4092  0000000                   	LDA #01H
 4093  0000000                   	BIT ABANDON_STACK_FLAG





 4094  0000000                   	BNE PSF_RESPONSE_LIMIT_RELEASE_END#
 4095  0000000                   	LDA #80H
 4096  0000000                   PSF_RESPONSE_LIMIT_RELEASE_END#:
 4097  0000000                   	TRB ABANDON_STACK_FLAG
 4098  0000000                   .ENDIF
 4099  0000000                   .ENDIF
 4100  0000000                   	ENDM	
 4101  0000000                   ;------------------------------------------------------------------------------	
 4102  0000000                   PSF_RESPONSE_LIMIT_JSR MACRO JSR_ADDR
 4103  0000000                   	PSF_RESPONSE_LIMIT
 4104  0000000                   	JSR JSR_ADDR
 4105  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4106  0000000                   	ENDM
 4107  0000000                   ;------------------------------------------------------------------------------
 4108  0000000                   ;------------------------------------------------------------------------------
 4109  0000000                   
 4110  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\N588H_MACRO_SYSTEM_INIT.INI.APP"
 4111  0000000                   SYSTEM_INIT_PROCEDURE MACRO
 4112  0000000                   	.IF	(CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
 4113  0000000                       	SYSTEM_INIT_PROCEDURE_N588H
 4114  0000000                       	.ENDIF
 4115  0000000                   	ENDM
 4116  0000000                   
 4117  0000000                   SYSTEM_INIT_PROCEDURE_N588H MACRO
 4118  0000000                   	.IF	 (PARTNO='N588H000')
 4119  0000000                   	SYSTEM_INIT_PROCEDURE_N588H000
 4120  0000000                   	.ELSE
 4121  0000000                   	SYSTEM_INIT_PROCEDURE_N588H340
 4122  0000000                   	.ENDIF
 4123  0000000                   	ENDM 
 4124  0000000                   
 4125  0000000                   SYSTEM_INIT_PROCEDURE_N588H000 MACRO
 4126  0000000                   	LDA #04H
 4127  0000000                   	TSB CTL_CPU
 4128  0000000                   ; for ICE chip to keep Fosc same as Rosc and it can't be changed again
 4129  0000000                   ; This bit is reserved bit for Product chip 
 4130  0000000                   	LDA #1EH
 4131  0000000                   	STA CFGF
 4132  0000000                   	LDA #FFH 
 4133  0000000                   	STA CFGE 
 4134  0000000                   ;new version
 4135  0000000                   	.IFDEF      ROSC_USER
 4136  0000000                   	    LDA #F7H        
 4137  0000000                   	.ENDIF
 4138  0000000                   	.IFDEF      ROSC_4M
 4139  0000000                   	    LDA #E7H
 4140  0000000                   	.ENDIF	
 4141  0000000                   	.IFDEF      ROSC_8M
 4142  0000000                   	    LDA #D7H
 4143  0000000                   	.ENDIF
 4144  0000000                   	.IFDEF      ROSC_6M
 4145  0000000                   	    LDA #C7H
 4146  0000000                   	.ENDIF
 4147  0000000                   	STA CFGA
 4148  0000000                   	LDA #13H
 4149  0000000                   	STA CFGD
 4150  0000000                   	LDA #12H





 4151  0000000                   	STA CFGC
 4152  0000000                   	LDA #1FH
 4153  0000000                   	.IFDEF      INN_INTERNAL
 4154  0000000                   	    ORA #20H
 4155  0000000                   	.ENDIF
 4156  0000000                   	.IFDEF      LVR_20V
 4157  0000000                   	    ORA #C0H
 4158  0000000                   	.ENDIF
 4159  0000000                   	.IFDEF      LVR_22V
 4160  0000000                   	    ORA #80H
 4161  0000000                   	.ENDIF	
 4162  0000000                   	.IFDEF      LVR_26V
 4163  0000000                   	    ORA #40H
 4164  0000000                   	.ENDIF
 4165  0000000                   	.IFDEF      LVR_28V
 4166  0000000                   	    ORA #00H
 4167  0000000                   	.ENDIF
 4168  0000000                   	STA CFGB	
 4169  0000000                   	LDA #F2H
 4170  0000000                   	STA	CFG9
 4171  0000000                   	LDA #FFH
 4172  0000000                   	STA	CFG8
 4173  0000000                   	LDA #D7H
 4174  0000000                   	STA	CFG7
 4175  0000000                   	LDA	#00H
 4176  0000000                   	STA	CFG6
 4177  0000000                   	LDA	#40H
 4178  0000000                   	STA	CFG5
 4179  0000000                   	LDA	#00H
 4180  0000000                   	STA	CFG4
 4181  0000000                   	.IFDEF	WDTIMER
 4182  0000000                   	LDA	#FFH
 4183  0000000                   	.ELSE
 4184  0000000                   	LDA	#7FH
 4185  0000000                   	.ENDIF	
 4186  0000000                   	STA	CFG3
 4187  0000000                   	LDA	#FFH
 4188  0000000                   	STA	CFG2
 4189  0000000                   	.IFDEF	PHR_150
 4190  0000000                   	LDA	#FFH
 4191  0000000                   	.ELSE
 4192  0000000                   	LDA	#BFH
 4193  0000000                   	.ENDIF
 4194  0000000                   	STA	CFG1
 4195  0000000                   	LDA	#FFH
 4196  0000000                   	STA	CFG0
 4197  0000000                   	ENDM
 4198  0000000                   
 4199  0000000                   SYSTEM_INIT_PROCEDURE_N588H340 MACRO
 4200  0000000                   	LDA #04H
 4201  0000000                   	TSB CTL_CPU
 4202  0000000                   ; for ICE chip to keep Fosc same as Rosc and it can't be changed again
 4203  0000000                   ; This bit is reserved bit for Product chip 
 4204  0000000                   	LDA #16H
 4205  0000000                   	STA CFGF
 4206  0000000                   	LDA #FFH 
 4207  0000000                   	STA CFGE 





 4208  0000000                   ;new version
 4209  0000000                   	.IFDEF      ROSC_USER
 4210  0000000                   	    LDA #75H  	        
 4211  0000000                   	.ENDIF
 4212  0000000                   	.IFDEF      ROSC_4M
 4213  0000000                   	    LDA #65H
 4214  0000000                   	.ENDIF	
 4215  0000000                   	.IFDEF      ROSC_8M
 4216  0000000                   	    LDA #55H
 4217  0000000                   	.ENDIF
 4218  0000000                   	.IFDEF      ROSC_6M
 4219  0000000                   	    LDA #45H
 4220  0000000                   	.ENDIF
 4221  0000000                   	.IF	 (PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341')
 4222  0000000                   	    ORA #00H
 4223  0000000                   	.ELSE
 4224  0000000                   	    ORA #02H	
 4225  0000000                   	.ENDIF	
 4226  0000000                   	STA CFGA
 4227  0000000                   	LDA #17H
 4228  0000000                   	STA CFGD
 4229  0000000                   	LDA #02H
 4230  0000000                   	STA CFGC
 4231  0000000                   	LDA #02H
 4232  0000000                   	.IFDEF      INN_INTERNAL
 4233  0000000                   	    ORA #20H
 4234  0000000                   	.ENDIF	
 4235  0000000                   	.IFDEF      LVR_20V
 4236  0000000                   	    ORA #C0H
 4237  0000000                   	.ENDIF
 4238  0000000                   	.IFDEF      LVR_22V
 4239  0000000                   	    ORA #80H
 4240  0000000                   	.ENDIF	
 4241  0000000                   	.IFDEF      LVR_26V
 4242  0000000                   	    ORA #40H
 4243  0000000                   	.ENDIF
 4244  0000000                   	.IFDEF      LVR_28V
 4245  0000000                   	    ORA #00H
 4246  0000000                   	.ENDIF
 4247  0000000                   	STA CFGB
 4248  0000000                   	.IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
 4249  0000000                   	    LDA #00H
 4250  0000000                   	.ENDIF
 4251  0000000                   	.IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170').OR.(PARTNO='N588JP170')
 4252  0000000                   	    LDA #00H
 4253  0000000                   	.ENDIF
 4254  0000000                   	.IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
 4255  0000000                   	    LDA #02H
 4256  0000000                   	.ENDIF
 4257  0000000                   	.IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
 4258  0000000                   	    LDA #02H
 4259  0000000                   	.ENDIF
 4260  0000000                   	STA	CFG9
 4261  0000000                   	.IF	(CHIPSERIES = 'N588H')
 4262  0000000                   	    LDA #9EH
 4263  0000000                   	.ENDIF
 4264  0000000                   	.IF	(CHIPSERIES = 'N588J')





 4265  0000000                   	    LDA #96H
 4266  0000000                   	.ENDIF
 4267  0000000                   	STA	CFG8
 4268  0000000                   	LDA 	#02H
 4269  0000000                   	STA	CFG7
 4270  0000000                   	LDA	#00H
 4271  0000000                   	STA	CFG6
 4272  0000000                   	STA	CFG5
 4273  0000000                   	STA	CFG4
 4274  0000000                   	.IFDEF	WDTIMER
 4275  0000000                   	    LDA	#F7H
 4276  0000000                   	.ELSE
 4277  0000000                   	    LDA	#77H
 4278  0000000                   	.ENDIF	
 4279  0000000                   	STA	CFG3
 4280  0000000                   	LDA	#FFH
 4281  0000000                   	STA	CFG2
 4282  0000000                   	.IFDEF	PHR_150
 4283  0000000                   	    LDA	#DFH
 4284  0000000                   	.ELSE
 4285  0000000                   	    LDA	#9FH
 4286  0000000                   	.ENDIF
 4287  0000000                   	STA	CFG1
 4288  0000000                   	.IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
 4289  0000000                   	    LDA #00H
 4290  0000000                   	.ENDIF
 4291  0000000                   	.IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170').OR.(PARTNO='N588JP170')
 4292  0000000                   	    LDA #00H
 4293  0000000                   	.ENDIF
 4294  0000000                   	.IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
 4295  0000000                   	    LDA #F0H
 4296  0000000                   	.ENDIF
 4297  0000000                   	.IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
 4298  0000000                   	    LDA #F0H
 4299  0000000                   	.ENDIF
 4300  0000000                   	STA	CFG0
 4301  0000000                   	ENDM
 4302  0000000                   ;------------------------------------------------------
 4303  0000000                   .IF(WITH_SPEAKER_SWITCH .EQ. 1)
 4304  0000000                   SET_SPEAKER_OUTPUT_TYPE_TO	MACRO	OUTPUT_TYPE
 4305  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0))
 4306  0000000                   .ELSE
 4307  0000000                    	LDA #OUTPUT_TYPE		;01H=DAC, 02H=EPWM
 4308  0000000                   	BIT #SPEN_EPWM
 4309  0000000                   	BEQ IS_DAC_OUTPUT#
 4310  0000000                   
 4311  0000000                   	STZ !SP0ALT
 4312  0000000                   	.IF	(CHIPSERIES = 'N588J')
 4313  0000000                   	.ELSE
 4314  0000000                   		STZ !SP0BLT
 4315  0000000                   		STZ !SP0CLT
 4316  0000000                   	.ENDIF
 4317  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 4318  0000000                   		STZ !SP0AL
 4319  0000000                   		.IF	(CHIPSERIES = 'N588J')
 4320  0000000                   		.ELSE
 4321  0000000                   			STZ !SP0BL





 4322  0000000                   			STZ !SP0CL
 4323  0000000                   		.ENDIF
 4324  0000000                   	.ENDIF
 4325  0000000                   
 4326  0000000                   	LDA #80H	
 4327  0000000                   	STA !SP0AT	
 4328  0000000                   	.IF	(CHIPSERIES = 'N588J')
 4329  0000000                   	.ELSE
 4330  0000000                   		STA !SP0BT	
 4331  0000000                   		STA !SP0CT
 4332  0000000                   	.ENDIF
 4333  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 4334  0000000                   		STA !SP0A
 4335  0000000                   		.IF	(CHIPSERIES = 'N588J')
 4336  0000000                   		.ELSE
 4337  0000000                   			STA !SP0B
 4338  0000000                   			STA !SP0C	
 4339  0000000                   		.ENDIF
 4340  0000000                   	.ENDIF
 4341  0000000                   
 4342  0000000                   IS_DAC_OUTPUT#:
 4343  0000000                   	LDA #OUTPUT_TYPE
 4344  0000000                   	STA <SPEN_TMP	;set the of type mixer output
 4345  0000000                   	STZ !SPEN
 4346  0000000                   .ENDIF
 4347  0000000                      	ENDM
 4348  0000000                   .ENDIF
 4349  0000000                   ;------------------------------------------------------
 4350  0000000                   ADD_CHECKSUM	MACRO
 4351  0000000                   	LDX #00 
 4352  0000000                   	TXA
 4353  0000000                   	STA	!BANK
 4354  0000000                   	LDA #.LOW.ROM_START
 4355  0000000                   	STA <CHECKSUM_ADDR
 4356  0000000                   	LDA #.HIGH.ROM_START
 4357  0000000                   	STA <CHECKSUM_ADDR1
 4358  0000000                   	STZ <CHECK_RESULT
 4359  0000000                   	STZ <CHECK_RESULT+1
 4360  0000000                   CHECK_SUM_SEC1#:	
 4361  0000000                   	.IFDEF WDTIMER
 4362  0000000                   	.IFDEF LVDEN
 4363  0000000                   		LDA #CTL_CPU_WDT
 4364  0000000                   		TSB RAM_CTL_CPU
 4365  0000000                   		LDA RAM_CTL_CPU
 4366  0000000                   		STA !CTL_CPU
 4367  0000000                   	.ELSE
 4368  0000000                   		LDA #CTL_CPU_WDT
 4369  0000000                   		TSB !CTL_CPU
 4370  0000000                   	.ENDIF 	
 4371  0000000                   	.ENDIF     
 4372  0000000                   	CLC
 4373  0000000                   	LDA	(<CHECKSUM_ADDR)	
 4374  0000000                   	ADC	<CHECK_RESULT
 4375  0000000                   	STA	<CHECK_RESULT
 4376  0000000                   	LDA	<CHECK_RESULT+1
 4377  0000000                   	ADC	#00H
 4378  0000000                   	STA	<CHECK_RESULT+1





 4379  0000000                   
 4380  0000000                   	LDA 	<CHECKSUM_ADDR
 4381  0000000                   	CMP 	#.LOW.ROM_SEC1_END
 4382  0000000                   	BEQ 	SET_START_ADDR_SEC2#
 4383  0000000                   	INC	<CHECKSUM_ADDR
 4384  0000000                   	BRA 	CHECK_SUM_SEC1#
 4385  0000000                   SET_START_ADDR_SEC2#:
 4386  0000000                   	LDA #.LOW.ROM_SEC2_START
 4387  0000000                   	STA <CHECKSUM_ADDR
 4388  0000000                   ;===============================
 4389  0000000                   ; PROCESS ROM_START - 00:7FFF DATA
 4390  0000000                   ;===============================
 4391  0000000                   ;	.IF	(CHIPBODY = '')
 4392  0000000                   ;CHECK_SUM_BANK0#:
 4393  0000000                   ;.IFDEF WDTIMER
 4394  0000000                   ;.IFDEF LVDEN
 4395  0000000                   ;	LDA #CTL_CPU_WDT
 4396  0000000                   ;	TSB RAM_CTL_CPU
 4397  0000000                   ;	LDA RAM_CTL_CPU
 4398  0000000                   ;	STA !CTL_CPU
 4399  0000000                   ;.ELSE
 4400  0000000                   ;	LDA #CTL_CPU_WDT
 4401  0000000                   ;	TSB !CTL_CPU
 4402  0000000                   ;.ENDIF 	
 4403  0000000                   ;.ENDIF     
 4404  0000000                   ;	CLC
 4405  0000000                   ;	LDA	(<CHECKSUM_ADDR)	
 4406  0000000                   ;	ADC	<CHECK_RESULT
 4407  0000000                   ;	STA	<CHECK_RESULT
 4408  0000000                   ;	LDA	<CHECK_RESULT+1
 4409  0000000                   ;	ADC	#00H
 4410  0000000                   ;	STA	<CHECK_RESULT+1	
 4411  0000000                   ;
 4412  0000000                   ;	INC	<CHECKSUM_ADDR
 4413  0000000                   ;	BNE	CHECK_SUM_BANK0#
 4414  0000000                   ;	INC	<CHECKSUM_ADDR1
 4415  0000000                   ;	LDA	<CHECKSUM_ADDR1
 4416  0000000                   ;	CMP	#60H
 4417  0000000                   ;	BNE	CHECK_SUM_BANK0#
 4418  0000000                   ;	JMP END_CHECKSUM#
 4419  0000000                   ;	.ELSE
 4420  0000000                   CHECK_SUM_BANK0#:
 4421  0000000                   	.IFDEF WDTIMER
 4422  0000000                   	.IFDEF LVDEN
 4423  0000000                   		LDA #CTL_CPU_WDT
 4424  0000000                   		TSB RAM_CTL_CPU
 4425  0000000                   		LDA RAM_CTL_CPU
 4426  0000000                   		STA !CTL_CPU
 4427  0000000                   	.ELSE
 4428  0000000                   		LDA #CTL_CPU_WDT
 4429  0000000                   		TSB !CTL_CPU
 4430  0000000                   	.ENDIF 	
 4431  0000000                   	.ENDIF     
 4432  0000000                   	CLC
 4433  0000000                   	LDA	(<CHECKSUM_ADDR)	
 4434  0000000                   	ADC	<CHECK_RESULT
 4435  0000000                   	STA	<CHECK_RESULT





 4436  0000000                   	LDA	<CHECK_RESULT+1
 4437  0000000                   	ADC	#00H
 4438  0000000                   	STA	<CHECK_RESULT+1
 4439  0000000                   
 4440  0000000                   	INC	<CHECKSUM_ADDR
 4441  0000000                   	BNE	CHECK_SUM_BANK0#
 4442  0000000                   	INC	<CHECKSUM_ADDR1
 4443  0000000                   	LDA	<CHECKSUM_ADDR1
 4444  0000000                   	CMP	#80H
 4445  0000000                   	BNE	CHECK_SUM_BANK0#
 4446  0000000                   ;	.ENDIF
 4447  0000000                   ;==================================
 4448  0000000                   ; PROCESS 01:8000 - ENDING ADDRESS
 4449  0000000                   ;==================================		
 4450  0000000                   	INX	
 4451  0000000                   	TXA
 4452  0000000                   	STA	!BANK
 4453  0000000                   CHECK_SUM_BANK1#:
 4454  0000000                   	.IFDEF WDTIMER
 4455  0000000                   	.IFDEF LVDEN
 4456  0000000                   		LDA #CTL_CPU_WDT
 4457  0000000                   		TSB RAM_CTL_CPU
 4458  0000000                   		LDA RAM_CTL_CPU
 4459  0000000                   		STA !CTL_CPU
 4460  0000000                   	.ELSE
 4461  0000000                   		LDA #CTL_CPU_WDT
 4462  0000000                   		TSB !CTL_CPU
 4463  0000000                   	.ENDIF 	
 4464  0000000                   	.ENDIF     
 4465  0000000                   	CLC
 4466  0000000                   	LDA	(<CHECKSUM_ADDR)				
 4467  0000000                   	ADC	<CHECK_RESULT
 4468  0000000                   	STA	<CHECK_RESULT
 4469  0000000                   	LDA	<CHECK_RESULT+1
 4470  0000000                   	ADC	#00H
 4471  0000000                   	STA	<CHECK_RESULT+1
 4472  0000000                   
 4473  0000000                   	LDA	<CHECKSUM_ADDR1
 4474  0000000                   	CMP	#.HIGH.BODY_END_ADDR
 4475  0000000                   	BNE	ROM_ADDR_INC#
 4476  0000000                   	LDA <CHECKSUM_ADDR
 4477  0000000                   	CMP #.LOW.BODY_END_ADDR-1
 4478  0000000                   	BEQ CHECK_ROM_BANK# 
 4479  0000000                   ROM_ADDR_INC#:
 4480  0000000                   	INC	<CHECKSUM_ADDR
 4481  0000000                   	BNE	CHECK_SUM_BANK1#
 4482  0000000                   	INC	<CHECKSUM_ADDR1
 4483  0000000                   	BNE	CHECK_SUM_BANK1#
 4484  0000000                   ROM_BANK_INC#:
 4485  0000000                   	INX	
 4486  0000000                   	TXA
 4487  0000000                   	STA	!BANK
 4488  0000000                   	LDA	#80H
 4489  0000000                   	STA <CHECKSUM_ADDR1
 4490  0000000                   	BRA CHECK_SUM_BANK1#
 4491  0000000                   CHECK_ROM_BANK#:	
 4492  0000000                   	CPX #BODY_END_BANK 





 4493  0000000                   	BNE ROM_ADDR_INC#
 4494  0000000                   END_CHECKSUM#:
 4495  0000000                   	.IFDEF WDTIMER
 4496  0000000                   	.IFDEF LVDEN
 4497  0000000                   		LDA #CTL_CPU_WDT
 4498  0000000                   		TSB RAM_CTL_CPU
 4499  0000000                   		LDA RAM_CTL_CPU
 4500  0000000                   		STA !CTL_CPU
 4501  0000000                   	.ELSE
 4502  0000000                   		LDA #CTL_CPU_WDT
 4503  0000000                   		TSB !CTL_CPU
 4504  0000000                   	.ENDIF 	
 4505  0000000                   	.ENDIF     
 4506  0000000                   	LDA	#0
 4507  0000000                   	STA	!BANK
 4508  0000000                   	ENDM
 4509  0000000                   ;------------------------------------------------------
 4510  0000000                   GET_CHECKSUM	MACRO
 4511  0000000                   	PSF_RESPONSE_LIMIT
 4512  0000000                   	PHP
 4513  0000000                   	SEI
 4514  0000000                   	LDA <CHECKSUM_ADDR
 4515  0000000                   	PHA
 4516  0000000                   	LDA <CHECKSUM_ADDR1
 4517  0000000                   	PHA
 4518  0000000                   ;	LDA <CHECK_RESULT
 4519  0000000                   ;	PHA
 4520  0000000                   	ADD_CHECKSUM
 4521  0000000                   ;	PLA
 4522  0000000                   ;	STA <CHECK_RESULT
 4523  0000000                   	PLA
 4524  0000000                   	STA <CHECKSUM_ADDR1
 4525  0000000                   	PLA
 4526  0000000                   	STA <CHECKSUM_ADDR
 4527  0000000                   	PLP
 4528  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4529  0000000                   	ENDM
 4530  0000000                   ;------------------------------------------------------
 4531  0000000                   CHECKSUM	MACRO
 4532  0000000                   	PSF_RESPONSE_LIMIT
 4533  0000000                   	PHP
 4534  0000000                   	SEI
 4535  0000000                   	LDA <CHECKSUM_ADDR
 4536  0000000                   	PHA
 4537  0000000                   	LDA <CHECKSUM_ADDR1
 4538  0000000                   	PHA
 4539  0000000                   ;	LDA <CHECK_RESULT
 4540  0000000                   ;	PHA
 4541  0000000                   	ADD_CHECKSUM
 4542  0000000                   
 4543  0000000                   	LDA	#.high.CHECKSUM_33TH
 4544  0000000                   	STA <CHECKSUM_ADDR1
 4545  0000000                   	LDA #.low.CHECKSUM_33TH
 4546  0000000                   	STA <CHECKSUM_ADDR	
 4547  0000000                   	CLC
 4548  0000000                   	LDA	(<CHECKSUM_ADDR)
 4549  0000000                   	ADC <CHECK_RESULT





 4550  0000000                   	STA <CHECK_RESULT
 4551  0000000                   	INC CHECKSUM_ADDR
 4552  0000000                   	LDA	(<CHECKSUM_ADDR)
 4553  0000000                   	ADC <CHECK_RESULT+1
 4554  0000000                   	STA <CHECK_RESULT+1
 4555  0000000                   
 4556  0000000                   ;	PLA
 4557  0000000                   ;	STA <CHECK_RESULT
 4558  0000000                   	PLA
 4559  0000000                   	STA <CHECKSUM_ADDR1
 4560  0000000                   	PLA
 4561  0000000                   	STA <CHECKSUM_ADDR
 4562  0000000                   	PLP
 4563  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4564  0000000                   	ENDM	
 4565  0000000                   
 4566  0000000                   ;------------------------------------------------------------
 4567  0000000                   BP00	EQU 00H	
 4568  0000000                   BP01	EQU 01H	
 4569  0000000                   BP02	EQU 02H	
 4570  0000000                   BP03	EQU 03H	
 4571  0000000                   BP04	EQU 04H	
 4572  0000000                   BP05	EQU 05H	
 4573  0000000                   BP06	EQU 06H	
 4574  0000000                   BP07	EQU 07H	
 4575  0000000                   BP10	EQU 10H	
 4576  0000000                   BP11	EQU 11H	
 4577  0000000                   BP12	EQU 12H	
 4578  0000000                   BP13	EQU 13H	
 4579  0000000                   BP14	EQU 14H	
 4580  0000000                   BP15	EQU 15H	
 4581  0000000                   BP16	EQU 16H	
 4582  0000000                   BP17	EQU 17H	
 4583  0000000                   BP20	EQU 20H	
 4584  0000000                   BP21	EQU 21H	
 4585  0000000                   BP22	EQU 22H	
 4586  0000000                   BP23	EQU 23H	
 4587  0000000                   BP24	EQU 24H	
 4588  0000000                   BP25	EQU 25H	
 4589  0000000                   BP26	EQU 26H	
 4590  0000000                   BP27	EQU 27H	
 4591  0000000                   ;------------------------------------------------------------
 4592  0000000                   OUT1KHZTONE MACRO	PORT, TIMES 	
 4593  0000000                   	PSF_RESPONSE_LIMIT
 4594  0000000                   	PHP
 4595  0000000                   	SEI
 4596  0000000                   	LDA <0
 4597  0000000                   	PHA
 4598  0000000                   	LDA <1
 4599  0000000                   	PHA
 4600  0000000                   	LDA <2
 4601  0000000                   	PHA
 4602  0000000                   	BRA xGET_PORTPIN#
 4603  0000000                   
 4604  0000000                   .ifndef xpintable_
 4605  0000000                   xPINOUT_TABLE:
 4606  0000000                   xPINMODE_TABLE01:





 4607  0000000                   	DB  01H
 4608  0000000                   	DB 	02H
 4609  0000000                   	DB 	04H
 4610  0000000                   	DB 	08H
 4611  0000000                   	DB 	10H
 4612  0000000                   	DB 	20H
 4613  0000000                   	DB 	40H
 4614  0000000                   	DB 	80H
 4615  0000000                   xPINMODE_TABLE2:
 4616  0000000                   	DB  01H
 4617  0000000                   	DB 	01H
 4618  0000000                   	DB 	01H
 4619  0000000                   	DB 	01H
 4620  0000000                   	DB 	02H
 4621  0000000                   	DB 	02H
 4622  0000000                   	DB 	02H
 4623  0000000                   	DB 	02H
 4624  0000000                   xpintable_:
 4625  0000000                   .endif
 4626  0000000                   
 4627  0000000                   xGET_PORTPIN#:
 4628  0000000                   	LDA #0
 4629  0000000                   	STA !TM0C
 4630  0000000                   	STA <0
 4631  0000000                   	STA <1
 4632  0000000                   	STA <2
 4633  0000000                   	LDA #PORT
 4634  0000000                   	LSR A
 4635  0000000                   	LSR A
 4636  0000000                   	LSR A
 4637  0000000                   	LSR A
 4638  0000000                   	TAX
 4639  0000000                   	LDA !BP0D,X
 4640  0000000                   	PHA
 4641  0000000                   	.IFDEF       BPXM_RAM
 4642  0000000                   	LDA BP0M_BAK,X
 4643  0000000                   	PHA
 4644  0000000                   	.ENDIF
 4645  0000000                   
 4646  0000000                   	LDA #PORT
 4647  0000000                   	AND #07H
 4648  0000000                   	TAY 
 4649  0000000                   
 4650  0000000                   	LDA xPINMODE_TABLE01,Y
 4651  0000000                       CPX #02H
 4652  0000000                   	BCC 3 					; port0 or port1	
 4653  0000000                   	LDA xPINMODE_TABLE2,Y	; port2
 4654  0000000                   
 4655  0000000                   	EOR #FFH
 4656  0000000                   	AND !BP0D,X 
 4657  0000000                   	STA !BP0D,X				; output
 4658  0000000                   	.IFDEF       BPXM_RAM
 4659  0000000                   	.IF ((PORT>>4).EQ.0 )||((PORT>>4).EQ.1)
 4660  0000000                   		LDA xPINOUT_TABLE,Y
 4661  0000000                   		EOR #FFH
 4662  0000000                   		AND !BP0M_BAK,X 
 4663  0000000                   		STA !BP0M_BAK,X





 4664  0000000                   	.ENDIF
 4665  0000000                   	.IF ((PORT>>4).EQ.2)
 4666  0000000                   		.IF	 ((PORT&0Fh).GT. 3H)
 4667  0000000                   			LDA #F0H
 4668  0000000                   		.ELSE
 4669  0000000                   			LDA #0FH
 4670  0000000                   		.ENDIF
 4671  0000000                   		TRB BP2M_BAK
 4672  0000000                   	.ENDIF
 4673  0000000                   	.ENDIF
 4674  0000000                   
 4675  0000000                   	LDA #TONE_2KHZ_TMV
 4676  0000000                   	STA !TM0V
 4677  0000000                   	LDA #02H
 4678  0000000                   	STA !EFC0
 4679  0000000                   	LDA #TONE_2KHZ_TMC
 4680  0000000                   	ORA #01H
 4681  0000000                   	STA !TM0C
 4682  0000000                   
 4683  0000000                   xPOLL_TIMEOUT#:
 4684  0000000                   	LDA !EVF0
 4685  0000000                   	AND #02H				; Timer0
 4686  0000000                   	BEQ xPOLL_TIMEOUT# 
 4687  0000000                   	STA !EFC0
 4688  0000000                   
 4689  0000000                   	.IFDEF       BPXM_RAM
 4690  0000000                   		.IF	 ((PORT>>4).EQ.0)
 4691  0000000                   			PHX
 4692  0000000                   			LDX !BP0D
 4693  0000000                   			LDA xPINOUT_TABLE,Y
 4694  0000000                   			EOR !BP0
 4695  0000000                   			EXTERN BP0D_OUTPUT_TABLE
 4696  0000000                   			AND !BP0D_OUTPUT_TABLE,X
 4697  0000000                   			ORA BP0M_BAK
 4698  0000000                   			STA !BP0
 4699  0000000                   			PLX
 4700  0000000                   		.ENDIF
 4701  0000000                   		.IF	 ((PORT>>4).EQ.1)
 4702  0000000                   			PHX
 4703  0000000                   			LDX !BP1D
 4704  0000000                   			LDA xPINOUT_TABLE,Y
 4705  0000000                   			EOR !BP1
 4706  0000000                   			EXTERN BP1D_OUTPUT_TABLE
 4707  0000000                   			AND !BP1D_OUTPUT_TABLE,X
 4708  0000000                   			ORA BP1M_BAK
 4709  0000000                   			STA !BP1
 4710  0000000                   			PLX
 4711  0000000                   		.ENDIF
 4712  0000000                   		.IF	 ((PORT>>4).EQ.2)
 4713  0000000                   			PHX
 4714  0000000                   			LDX !BP2D
 4715  0000000                   			LDA xPINOUT_TABLE,Y
 4716  0000000                   			EOR !BP2
 4717  0000000                   			EXTERN BP2D_OUTPUT_TABLE
 4718  0000000                   			AND !BP2D_OUTPUT_TABLE,X
 4719  0000000                   			ORA BP2M_BAK
 4720  0000000                   			STA !BP2





 4721  0000000                   			PLX
 4722  0000000                   		.ENDIF
 4723  0000000                   	.ELSE
 4724  0000000                   		LDA xPINOUT_TABLE,Y
 4725  0000000                   		EOR !BP0,X
 4726  0000000                   		ORA !BP0D,X
 4727  0000000                   		STA !BP0,X
 4728  0000000                   	.ENDIF
 4729  0000000                   	INC <2
 4730  0000000                   	LDA <2
 4731  0000000                   	AND #01H
 4732  0000000                   	BNE xPOLL_TIMEOUT#
 4733  0000000                   	LDA #CTL_CPU_WDT
 4734  0000000                   	TSB !CTL_CPU
 4735  0000000                   
 4736  0000000                   	LDA #.low.TIMES
 4737  0000000                   	BNE xCHECK_TIMEOUT#
 4738  0000000                   	LDA #.high.TIMES
 4739  0000000                   	BEQ xPOLL_TIMEOUT#
 4740  0000000                   
 4741  0000000                   xCHECK_TIMEOUT#:    
 4742  0000000                   	CLC
 4743  0000000                       LDA <0
 4744  0000000                   	ADC #1
 4745  0000000                   	STA <0
 4746  0000000                   	LDA <1
 4747  0000000                   	ADC #0
 4748  0000000                   	STA <1
 4749  0000000                       CMP #.high.TIMES  
 4750  0000000                   	BNE xPOLL_TIMEOUT#
 4751  0000000                   	LDA <0
 4752  0000000                   	CMP #.low.TIMES  
 4753  0000000                   	BNE xPOLL_TIMEOUT#
 4754  0000000                   	STZ !TM0C
 4755  0000000                   
 4756  0000000                   	.IFDEF       BPXM_RAM
 4757  0000000                   	PLA
 4758  0000000                   	STA BP0M_BAK,X
 4759  0000000                   	.ENDIF
 4760  0000000                   	PLA
 4761  0000000                   	STA !BP0D,X
 4762  0000000                   xDONOT_DO#:
 4763  0000000                   	PLA 
 4764  0000000                   	STA <2
 4765  0000000                   	PLA 
 4766  0000000                   	STA <1
 4767  0000000                   	PLA 
 4768  0000000                   	STA <0
 4769  0000000                   	PLP
 4770  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4771  0000000                   	ENDM	
 4772  0000000                   
 4773  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\SPI_MACROS.INI.APP"
 4774  0000000                   ;========================================================
 4775  0000000                   ;-----SPI mode define,user can change--------
 4776  0000000                   ;SPI_MODE		EQU	00H
 4777  0000000                   ;SPI mode0: SCK:LOW; 	DI:Raising; DO:Falling	





 4778  0000000                   ;SPI mode1: SCK:LOW; 	DI:Falling; DO:Raising
 4779  0000000                   ;SPI mode2: SCK:HIGH; 	DI:Falling; DO:Raising
 4780  0000000                   ;SPI mode3: SCK:HIGH; 	DI:Raising; DO:Falling
 4781  0000000                   
 4782  0000000                   ;----internal pin-----------
 4783  0000000                   SPI_IP00		EQU	00H
 4784  0000000                   SPI_IP01		EQU	01H
 4785  0000000                   SPI_IP02		EQU	02H
 4786  0000000                   SPI_IP03		EQU	03H
 4787  0000000                   SPI_IP04		EQU	04H
 4788  0000000                   SPI_IP05		EQU	05H
 4789  0000000                   SPI_IP06		EQU	06H
 4790  0000000                   SPI_IP07		EQU	07H
 4791  0000000                   
 4792  0000000                   SPI_BP00		EQU	10H
 4793  0000000                   SPI_BP01		EQU	11H
 4794  0000000                   SPI_BP02		EQU	12H
 4795  0000000                   SPI_BP03		EQU	13H
 4796  0000000                   SPI_BP04		EQU	14H
 4797  0000000                   SPI_BP05		EQU	15H
 4798  0000000                   SPI_BP06		EQU	16H
 4799  0000000                   SPI_BP07		EQU	17H
 4800  0000000                   
 4801  0000000                   SPI_BP10		EQU	20H
 4802  0000000                   SPI_BP11		EQU	21H
 4803  0000000                   SPI_BP12		EQU	22H
 4804  0000000                   SPI_BP13		EQU	23H
 4805  0000000                   SPI_BP14		EQU	24H
 4806  0000000                   SPI_BP15		EQU	25H
 4807  0000000                   SPI_BP16		EQU	26H
 4808  0000000                   SPI_BP17		EQU	27H
 4809  0000000                   
 4810  0000000                   SPI_BP20		EQU	30H
 4811  0000000                   SPI_BP21		EQU	31H
 4812  0000000                   SPI_BP22		EQU	32H
 4813  0000000                   SPI_BP23		EQU	33H
 4814  0000000                   SPI_BP24		EQU	34H
 4815  0000000                   SPI_BP25		EQU	35H
 4816  0000000                   SPI_BP26		EQU	36H
 4817  0000000                   SPI_BP27		EQU	37H
 4818  0000000                   ;========================================================
 4819  0000000                   ;IP0~BP2:   		800H~803H;
 4820  0000000                   ;IP0M: 			805H;
 4821  0000000                   ;BP0D~BP2D: 		80AH~80CH;
 4822  0000000                   ;IP0EN~BP1EN:		850H~852H;
 4823  0000000                   
 4824  0000000                   SPI_PORT_BASE		EQU	800H
 4825  0000000                   SPI_PORT_M_BASE		EQU	805H
 4826  0000000                   SPI_PORT_D_BASE		EQU	80AH
 4827  0000000                   SPI_PORT_EN_BASE	EQU	850H
 4828  0000000                   ;========================================================
 4829  0000000                   ;-----pin define,user can change--------
 4830  0000000                   SPI_X0CSB_PIN	EQU	SPI_BP04
 4831  0000000                   SPI_X0SCK_PIN	EQU	SPI_BP02
 4832  0000000                   SPI_X0MOSI_PIN	EQU	SPI_BP06
 4833  0000000                   SPI_X0MISO_PIN	EQU	SPI_BP00
 4834  0000000                   





 4835  0000000                   .IFDEF  BPXM_RAM
 4836  0000000                   SPI_X0CSB_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0CSB_PIN>>4)-1
 4837  0000000                   SPI_X0SCK_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0SCK_PIN>>4)-1
 4838  0000000                   SPI_X0MOSI_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0MOSI_PIN>>4)-1
 4839  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.0)
 4840  0000000                   .ELSE
 4841  0000000                   SPI_X0MISO_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0MISO_PIN>>4)-1
 4842  0000000                   .ENDIF
 4843  0000000                   .ENDIF
 4844  0000000                   
 4845  0000000                   ;-------------X0 4Pin parameter ------------------------
 4846  0000000                   SPI_X0CSB_PIN_VALUE		EQU	1<<(SPI_X0CSB_PIN&0FH)
 4847  0000000                   SPI_X0CSB_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0CSB_PIN>>4)
 4848  0000000                   SPI_X0CSB_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0CSB_PIN>>4)-1
 4849  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4850  0000000                   SPI_X0CSB_M_ADDR		EQU 	SPI_X0CSB_PORT_ADDR
 4851  0000000                   .ELSE
 4852  0000000                   SPI_X0CSB_M_ADDR		EQU 	SPI_PORT_M_BASE
 4853  0000000                   .ENDIF
 4854  0000000                   
 4855  0000000                   SPI_X0SCK_PIN_VALUE		EQU	1<<(SPI_X0SCK_PIN&0FH)
 4856  0000000                   SPI_X0SCK_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0SCK_PIN>>4)
 4857  0000000                   SPI_X0SCK_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0SCK_PIN>>4)-1
 4858  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4859  0000000                   SPI_X0SCK_M_ADDR		EQU 	SPI_X0SCK_PORT_ADDR
 4860  0000000                   .ELSE
 4861  0000000                   SPI_X0SCK_M_ADDR		EQU 	SPI_PORT_M_BASE
 4862  0000000                   .ENDIF
 4863  0000000                   
 4864  0000000                   SPI_X0MOSI_PIN_VALUE		EQU	1<<(SPI_X0MOSI_PIN&0FH)
 4865  0000000                   SPI_X0MOSI_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0MOSI_PIN>>4)
 4866  0000000                   SPI_X0MOSI_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0MOSI_PIN>>4)-1
 4867  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4868  0000000                   SPI_X0MOSI_M_ADDR		EQU 	SPI_X0MOSI_PORT_ADDR
 4869  0000000                   .ELSE
 4870  0000000                   SPI_X0MOSI_M_ADDR		EQU 	SPI_PORT_M_BASE
 4871  0000000                   .ENDIF
 4872  0000000                   
 4873  0000000                   SPI_X0MISO_PIN_VALUE		EQU	1<<(SPI_X0MISO_PIN&0FH)
 4874  0000000                   SPI_X0MISO_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0MISO_PIN>>4)
 4875  0000000                   SPI_X0MISO_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0MISO_PIN>>4)-1
 4876  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4877  0000000                   SPI_X0MISO_M_ADDR		EQU 	SPI_X0MISO_PORT_ADDR
 4878  0000000                   .ELSE
 4879  0000000                   SPI_X0MISO_M_ADDR		EQU 	SPI_PORT_M_BASE
 4880  0000000                   .ENDIF
 4881  0000000                   ;========================================================
 4882  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.0)
 4883  0000000                   SPI_X0CSB_M_VALUE		EQU 	1<<((SPI_X0CSB_PIN&0FH)>>1)
 4884  0000000                   SPI_X0CSB_D_VALUE		EQU 	1<<((SPI_X0CSB_PIN&0FH)>>1)
 4885  0000000                   .ENDIF
 4886  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 4887  0000000                   SPI_X0CSB_M_VALUE		EQU 	1<<(SPI_X0CSB_PIN&0FH)
 4888  0000000                   SPI_X0CSB_D_VALUE		EQU 	1<<(SPI_X0CSB_PIN&0FH)
 4889  0000000                   .ENDIF		
 4890  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 4891  0000000                   .IF ((SPI_X0CSB_PIN&0Fh).GT. 3H )





 4892  0000000                   SPI_X0CSB_M_VALUE		EQU 	F0H
 4893  0000000                   .ELSE
 4894  0000000                   SPI_X0CSB_M_VALUE		EQU 	0FH
 4895  0000000                   .ENDIF
 4896  0000000                   SPI_X0CSB_D_VALUE		EQU 	1<<((SPI_X0CSB_PIN&0FH)>>2)
 4897  0000000                   .ENDIF
 4898  0000000                   ;--------------------------------------------------------
 4899  0000000                   .IF ((SPI_X0SCK_PIN>>4).EQ.0)
 4900  0000000                   SPI_X0SCK_M_VALUE		EQU 	1<<((SPI_X0SCK_PIN&0FH)>>1)
 4901  0000000                   SPI_X0SCK_D_VALUE		EQU 	1<<((SPI_X0SCK_PIN&0FH)>>1)
 4902  0000000                   .ENDIF
 4903  0000000                   .IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 4904  0000000                   SPI_X0SCK_M_VALUE		EQU 	1<<(SPI_X0SCK_PIN&0FH)
 4905  0000000                   SPI_X0SCK_D_VALUE		EQU 	1<<(SPI_X0SCK_PIN&0FH)
 4906  0000000                   .ENDIF		
 4907  0000000                   .IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 4908  0000000                   .IF ((SPI_X0SCK_PIN&0Fh).GT. 3H )
 4909  0000000                   SPI_X0SCK_M_VALUE		EQU 	F0H
 4910  0000000                   .ELSE
 4911  0000000                   SPI_X0SCK_M_VALUE		EQU 	0FH
 4912  0000000                   .ENDIF
 4913  0000000                   SPI_X0SCK_D_VALUE		EQU 	1<<((SPI_X0SCK_PIN&0FH)>>2)
 4914  0000000                   .ENDIF
 4915  0000000                   ;--------------------------------------------------------
 4916  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.0)
 4917  0000000                   SPI_X0MOSI_M_VALUE		EQU 	1<<((SPI_X0MOSI_PIN&0FH)>>1)
 4918  0000000                   SPI_X0MOSI_D_VALUE		EQU 	1<<((SPI_X0MOSI_PIN&0FH)>>1)
 4919  0000000                   .ENDIF
 4920  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.1 )||((SPI_X0MOSI_PIN>>4).EQ.2)
 4921  0000000                   SPI_X0MOSI_M_VALUE		EQU 	1<<(SPI_X0MOSI_PIN&0FH)
 4922  0000000                   SPI_X0MOSI_D_VALUE		EQU 	1<<(SPI_X0MOSI_PIN&0FH)
 4923  0000000                   .ENDIF		
 4924  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.3 )
 4925  0000000                   .IF ((SPI_X0MOSI_PIN&0Fh).GT. 3H )
 4926  0000000                   SPI_X0MOSI_M_VALUE		EQU 	F0H
 4927  0000000                   .ELSE
 4928  0000000                   SPI_X0MOSI_M_VALUE		EQU 	0FH
 4929  0000000                   .ENDIF
 4930  0000000                   SPI_X0MOSI_D_VALUE		EQU 	1<<((SPI_X0MOSI_PIN&0FH)>>2)
 4931  0000000                   .ENDIF
 4932  0000000                   ;--------------------------------------------------------
 4933  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.0)
 4934  0000000                   SPI_X0MISO_M_VALUE		EQU 	1<<((SPI_X0MISO_PIN&0FH)>>1)
 4935  0000000                   SPI_X0MISO_D_VALUE		EQU 	1<<((SPI_X0MISO_PIN&0FH)>>1)
 4936  0000000                   .ENDIF
 4937  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.1 )||((SPI_X0MISO_PIN>>4).EQ.2)
 4938  0000000                   SPI_X0MISO_M_VALUE		EQU 	1<<(SPI_X0MISO_PIN&0FH)
 4939  0000000                   SPI_X0MISO_D_VALUE		EQU 	1<<(SPI_X0MISO_PIN&0FH)
 4940  0000000                   .ENDIF		
 4941  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.3 )
 4942  0000000                   .IF ((SPI_X0MISO_PIN&0Fh).GT. 3H )
 4943  0000000                   SPI_X0MISO_M_VALUE		EQU 	F0H
 4944  0000000                   .ELSE
 4945  0000000                   SPI_X0MISO_M_VALUE		EQU 	0FH
 4946  0000000                   .ENDIF
 4947  0000000                   SPI_X0MISO_D_VALUE		EQU 	1<<((SPI_X0MISO_PIN&0FH)>>2)
 4948  0000000                   .ENDIF





 4949  0000000                   ;========================================================
 4950  0000000                   
 4951  0000000                   ;================================================================================
 4952  0000000                   ; 	USER MACRO - Drive Macro
 4953  0000000                   ;================================================================================
 4954  0000000                   SPI_BP2_OUTPUT_MASK MACRO
 4955  0000000                   	CMP #00H
 4956  0000000                   	BNE SPI_BP2_OUTPUT_MASK_01#
 4957  0000000                   	LDA #FFH
 4958  0000000                   	BRA SPI_BP2_OUTPUT_MASK_END#
 4959  0000000                   SPI_BP2_OUTPUT_MASK_01#:
 4960  0000000                   	CMP #01H
 4961  0000000                   	BNE SPI_BP2_OUTPUT_MASK_02#
 4962  0000000                   	LDA #F0H
 4963  0000000                   	BRA SPI_BP2_OUTPUT_MASK_END#
 4964  0000000                   SPI_BP2_OUTPUT_MASK_02#:
 4965  0000000                   	CMP #02H
 4966  0000000                   	BNE SPI_BP2_OUTPUT_MASK_03#
 4967  0000000                   	LDA #0FH
 4968  0000000                   	BRA SPI_BP2_OUTPUT_MASK_END#
 4969  0000000                   SPI_BP2_OUTPUT_MASK_03#:
 4970  0000000                   	LDA #00H
 4971  0000000                   SPI_BP2_OUTPUT_MASK_END#:
 4972  0000000                   	ENDM
 4973  0000000                   ;--------------------------------------------------------	
 4974  0000000                   SPI_X0_INIT_PIN MACRO
 4975  0000000                   ;CSB: cmos output,init value 1
 4976  0000000                   	LDA #SPI_X0CSB_D_VALUE
 4977  0000000                   	TRB !SPI_X0CSB_D_ADDR	
 4978  0000000                   	.IFDEF  BPXM_RAM
 4979  0000000                   		LDA #SPI_X0CSB_M_VALUE
 4980  0000000                   		TRB SPI_X0CSB_BAKM_ADDR
 4981  0000000                   	.ENDIF		
 4982  0000000                   ;	TSB !SPI_X0CSB_M_ADDR	
 4983  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 4984  0000000                   		LDA !SPI_X0CSB_D_ADDR
 4985  0000000                   		EOR #FFH
 4986  0000000                   	.ENDIF
 4987  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 4988  0000000                   		LDA !SPI_X0CSB_D_ADDR
 4989  0000000                   		SPI_BP2_OUTPUT_MASK
 4990  0000000                   	.ENDIF			
 4991  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 4992  0000000                   	ORA #SPI_X0CSB_PIN_VALUE
 4993  0000000                   	.IFDEF  BPXM_RAM
 4994  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 4995  0000000                   	.ELSE
 4996  0000000                   		ORA !SPI_X0CSB_D_ADDR
 4997  0000000                   	.ENDIF
 4998  0000000                   	STA !SPI_X0CSB_PORT_ADDR	
 4999  0000000                   
 5000  0000000                   
 5001  0000000                   ;SCK: cmos output
 5002  0000000                   	LDA #SPI_X0SCK_D_VALUE
 5003  0000000                   	TRB !SPI_X0SCK_D_ADDR
 5004  0000000                   	.IFDEF  BPXM_RAM
 5005  0000000                   		LDA #SPI_X0SCK_M_VALUE





 5006  0000000                   		TRB SPI_X0SCK_BAKM_ADDR
 5007  0000000                   	.ENDIF
 5008  0000000                   ;	TSB !SPI_X0SCK_M_ADDR	
 5009  0000000                   .IF (SPI_MODE.EQ.0)||(SPI_MODE.EQ.1)
 5010  0000000                   ;SCK: init value 0
 5011  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5012  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5013  0000000                   		EOR #FFH
 5014  0000000                   	.ENDIF
 5015  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5016  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5017  0000000                   		SPI_BP2_OUTPUT_MASK
 5018  0000000                   	.ENDIF	
 5019  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5020  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5021  0000000                   	.IFDEF  BPXM_RAM
 5022  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5023  0000000                   	.ELSE
 5024  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5025  0000000                   	.ENDIF
 5026  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5027  0000000                   .ELSE
 5028  0000000                   ;SCK: init value 1
 5029  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5030  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5031  0000000                   		EOR #FFH
 5032  0000000                   	.ENDIF
 5033  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5034  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5035  0000000                   		SPI_BP2_OUTPUT_MASK
 5036  0000000                   	.ENDIF	
 5037  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5038  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5039  0000000                   	.IFDEF  BPXM_RAM
 5040  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5041  0000000                   	.ELSE
 5042  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5043  0000000                   	.ENDIF
 5044  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5045  0000000                   .ENDIF
 5046  0000000                   
 5047  0000000                   ;MOSI: cmos output,init value 1
 5048  0000000                   	LDA #SPI_X0MOSI_D_VALUE
 5049  0000000                   	TRB !SPI_X0MOSI_D_ADDR
 5050  0000000                   	.IFDEF  BPXM_RAM
 5051  0000000                   		LDA #SPI_X0MOSI_M_VALUE
 5052  0000000                   		TRB SPI_X0MOSI_BAKM_ADDR
 5053  0000000                   	.ENDIF
 5054  0000000                   ;	TSB !SPI_X0MOSI_M_ADDR
 5055  0000000                   	.IF ((SPI_X0MOSI_PIN>>4).EQ.1 )||((SPI_X0MOSI_PIN>>4).EQ.2)
 5056  0000000                   		LDA !SPI_X0MOSI_D_ADDR
 5057  0000000                   		EOR #FFH
 5058  0000000                   	.ENDIF
 5059  0000000                   	.IF ((SPI_X0MOSI_PIN>>4).EQ.3 )
 5060  0000000                   		LDA !SPI_X0MOSI_D_ADDR
 5061  0000000                   		SPI_BP2_OUTPUT_MASK
 5062  0000000                   	.ENDIF	





 5063  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5064  0000000                   	ORA #SPI_X0MOSI_PIN_VALUE
 5065  0000000                   	.IFDEF  BPXM_RAM
 5066  0000000                   		ORA SPI_X0MOSI_BAKM_ADDR
 5067  0000000                   	.ELSE
 5068  0000000                   		ORA !SPI_X0MOSI_D_ADDR
 5069  0000000                   	.ENDIF
 5070  0000000                   	STA !SPI_X0MOSI_PORT_ADDR	
 5071  0000000                   
 5072  0000000                   ;MISO: pull high input,init value 1
 5073  0000000                   	LDA #SPI_X0MISO_D_VALUE
 5074  0000000                   	TSB !SPI_X0MISO_D_ADDR
 5075  0000000                   	.IF ((SPI_X0MOSI_PIN>>4).EQ.0)
 5076  0000000                   		TSB !SPI_X0MISO_M_ADDR
 5077  0000000                   		LDA #SPI_X0MISO_PIN_VALUE
 5078  0000000                   		TSB !SPI_X0MISO_PORT_ADDR
 5079  0000000                   	.ELSE
 5080  0000000                   		.IFDEF  BPXM_RAM
 5081  0000000                   			LDA #SPI_X0MISO_M_VALUE
 5082  0000000                   			TSB SPI_X0MISO_BAKM_ADDR
 5083  0000000                   		.ENDIF
 5084  0000000                   		.IF ((SPI_X0MISO_PIN>>4).EQ.1 )||((SPI_X0MISO_PIN>>4).EQ.2)
 5085  0000000                   			LDA !SPI_X0MOSI_D_ADDR
 5086  0000000                   			EOR #FFH
 5087  0000000                   		.ENDIF
 5088  0000000                   		.IF ((SPI_X0MISO_PIN>>4).EQ.3 )
 5089  0000000                   			LDA !SPI_X0MOSI_D_ADDR
 5090  0000000                   			SPI_BP2_OUTPUT_MASK
 5091  0000000                   		.ENDIF	
 5092  0000000                   		AND !SPI_X0MISO_PORT_ADDR
 5093  0000000                   		ORA #SPI_X0MISO_PIN_VALUE
 5094  0000000                   		.IFDEF  BPXM_RAM
 5095  0000000                   			ORA SPI_X0MISO_BAKM_ADDR
 5096  0000000                   		.ELSE
 5097  0000000                   			ORA !SPI_X0MISO_D_ADDR
 5098  0000000                   		.ENDIF
 5099  0000000                   		STA !SPI_X0MISO_PORT_ADDR
 5100  0000000                   	.ENDIF
 5101  0000000                   
 5102  0000000                   SPI_X0_INIT_PIN_END#:
 5103  0000000                   	ENDM
 5104  0000000                   ;================================================================================
 5105  0000000                   ; 	SPI SUBROUTINE
 5106  0000000                   ;================================================================================
 5107  0000000                   SPI_X0_ON MACRO 
 5108  0000000                   ;CSB:1->0
 5109  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 5110  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5111  0000000                   		EOR #FFH
 5112  0000000                   	.ENDIF
 5113  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 5114  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5115  0000000                   		SPI_BP2_OUTPUT_MASK
 5116  0000000                   	.ENDIF		
 5117  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 5118  0000000                   	ORA #SPI_X0CSB_PIN_VALUE
 5119  0000000                   	.IFDEF  BPXM_RAM





 5120  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 5121  0000000                   	.ELSE
 5122  0000000                   		ORA !SPI_X0CSB_D_ADDR
 5123  0000000                   	.ENDIF
 5124  0000000                   	STA !SPI_X0CSB_PORT_ADDR
 5125  0000000                   
 5126  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 5127  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5128  0000000                   		EOR #FFH
 5129  0000000                   	.ENDIF
 5130  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 5131  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5132  0000000                   		SPI_BP2_OUTPUT_MASK
 5133  0000000                   	.ENDIF		
 5134  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 5135  0000000                   	AND #(FFH^SPI_X0CSB_PIN_VALUE)
 5136  0000000                   	.IFDEF  BPXM_RAM
 5137  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 5138  0000000                   	.ELSE
 5139  0000000                   		ORA !SPI_X0CSB_D_ADDR
 5140  0000000                   	.ENDIF
 5141  0000000                   	STA !SPI_X0CSB_PORT_ADDR
 5142  0000000                   	ENDM
 5143  0000000                   ;--------------------------------------------------------
 5144  0000000                   SPI_X0_OFF MACRO
 5145  0000000                   ;CSB£º1
 5146  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 5147  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5148  0000000                   		EOR #FFH
 5149  0000000                   	.ENDIF
 5150  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 5151  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5152  0000000                   		SPI_BP2_OUTPUT_MASK
 5153  0000000                   	.ENDIF		
 5154  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 5155  0000000                   	ORA #SPI_X0CSB_PIN_VALUE
 5156  0000000                   	.IFDEF  BPXM_RAM
 5157  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 5158  0000000                   	.ELSE
 5159  0000000                   		ORA !SPI_X0CSB_D_ADDR
 5160  0000000                   	.ENDIF
 5161  0000000                   	STA !SPI_X0CSB_PORT_ADDR
 5162  0000000                   	ENDM
 5163  0000000                   ;========================================================
 5164  0000000                   ;SCL pin
 5165  0000000                   ;mode0: idle:0;	DO:falling edge;	DI:rising edge
 5166  0000000                   ;mode1: idle:0;	DO:rising edge;		DI:falling edge
 5167  0000000                   ;mode2: idle:1;	DO:rising edge;		DI:falling edge
 5168  0000000                   ;mode3: idle:1;	DO:falling edge;	DI:rising edge
 5169  0000000                   
 5170  0000000                   SPI_X0_CLK_READY MACRO
 5171  0000000                   .IF (SPI_MODE.EQ.1)
 5172  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5173  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5174  0000000                   		EOR #FFH
 5175  0000000                   	.ENDIF
 5176  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )





 5177  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5178  0000000                   		SPI_BP2_OUTPUT_MASK
 5179  0000000                   	.ENDIF	
 5180  0000000                   	AND !SPI_X0SCK_PORT_ADDR
 5181  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5182  0000000                   	.IFDEF  BPXM_RAM
 5183  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5184  0000000                   	.ELSE
 5185  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5186  0000000                   	.ENDIF
 5187  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5188  0000000                   .ENDIF
 5189  0000000                   .IF (SPI_MODE.EQ.3)
 5190  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5191  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5192  0000000                   		EOR #FFH
 5193  0000000                   	.ENDIF
 5194  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5195  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5196  0000000                   		SPI_BP2_OUTPUT_MASK
 5197  0000000                   	.ENDIF	
 5198  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5199  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5200  0000000                   	.IFDEF  BPXM_RAM
 5201  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5202  0000000                   	.ELSE
 5203  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5204  0000000                   	.ENDIF
 5205  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5206  0000000                   .ENDIF
 5207  0000000                   	ENDM
 5208  0000000                   ;--------------------------------------------------------
 5209  0000000                   SPI_X0_CLK_OUT MACRO
 5210  0000000                   .IF (SPI_MODE.EQ.0)
 5211  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5212  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5213  0000000                   		EOR #FFH
 5214  0000000                   	.ENDIF
 5215  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5216  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5217  0000000                   		SPI_BP2_OUTPUT_MASK
 5218  0000000                   	.ENDIF	
 5219  0000000                   	AND !SPI_X0SCK_PORT_ADDR
 5220  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5221  0000000                   	.IFDEF  BPXM_RAM
 5222  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5223  0000000                   	.ELSE
 5224  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5225  0000000                   	.ENDIF
 5226  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5227  0000000                   .ENDIF
 5228  0000000                   .IF (SPI_MODE.EQ.0)||(SPI_MODE.EQ.1)	
 5229  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5230  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5231  0000000                   		EOR #FFH
 5232  0000000                   	.ENDIF
 5233  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )





 5234  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5235  0000000                   		SPI_BP2_OUTPUT_MASK
 5236  0000000                   	.ENDIF	
 5237  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5238  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5239  0000000                   	.IFDEF  BPXM_RAM
 5240  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5241  0000000                   	.ELSE
 5242  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5243  0000000                   	.ENDIF
 5244  0000000                   	STA !SPI_X0SCK_PORT_ADDR	
 5245  0000000                   .ENDIF
 5246  0000000                   .IF (SPI_MODE.EQ.2)
 5247  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5248  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5249  0000000                   		EOR #FFH
 5250  0000000                   	.ENDIF
 5251  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5252  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5253  0000000                   		SPI_BP2_OUTPUT_MASK
 5254  0000000                   	.ENDIF	
 5255  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5256  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5257  0000000                   	.IFDEF  BPXM_RAM
 5258  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5259  0000000                   	.ELSE
 5260  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5261  0000000                   	.ENDIF
 5262  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5263  0000000                   .ENDIF	
 5264  0000000                   .IF (SPI_MODE.EQ.2)||(SPI_MODE.EQ.3)	
 5265  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5266  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5267  0000000                   		EOR #FFH
 5268  0000000                   	.ENDIF
 5269  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5270  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5271  0000000                   		SPI_BP2_OUTPUT_MASK
 5272  0000000                   	.ENDIF	
 5273  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5274  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5275  0000000                   	.IFDEF  BPXM_RAM
 5276  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5277  0000000                   	.ELSE
 5278  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5279  0000000                   	.ENDIF
 5280  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5281  0000000                   .ENDIF
 5282  0000000                   	ENDM
 5283  0000000                   ;--------------------------------------------------------
 5284  0000000                   SPI_X0_MOSI_Y MACRO
 5285  0000000                   	TYA
 5286  0000000                   	ASL A
 5287  0000000                   	TAY
 5288  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.1 )||((SPI_X0MOSI_PIN>>4).EQ.2)
 5289  0000000                   	LDA !SPI_X0MOSI_D_ADDR
 5290  0000000                   	EOR #FFH





 5291  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5292  0000000                   	BCC SPI_X0_MOSI_SET_0#
 5293  0000000                   SPI_X0_MOSI_SET_1#:
 5294  0000000                   	ORA #SPI_X0MOSI_PIN_VALUE
 5295  0000000                   	BRA SPI_X0_MOSI_NEXT#
 5296  0000000                   SPI_X0_MOSI_SET_0#:
 5297  0000000                   	AND #(FFH^SPI_X0MOSI_PIN_VALUE)
 5298  0000000                   SPI_X0_MOSI_NEXT#:
 5299  0000000                   .ENDIF
 5300  0000000                   
 5301  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.3 )
 5302  0000000                   	BCC SPI_X0_MOSI_SET_0#
 5303  0000000                   SPI_X0_MOSI_SET_1#:
 5304  0000000                   	LDA !SPI_X0MOSI_D_ADDR
 5305  0000000                   	SPI_BP2_OUTPUT_MASK
 5306  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5307  0000000                   	ORA #SPI_X0MOSI_PIN_VALUE
 5308  0000000                   	BRA SPI_X0_MOSI_NEXT#
 5309  0000000                   SPI_X0_MOSI_SET_0#:
 5310  0000000                   	LDA !SPI_X0MOSI_D_ADDR
 5311  0000000                   	SPI_BP2_OUTPUT_MASK
 5312  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5313  0000000                   	AND #(FFH^SPI_X0MOSI_PIN_VALUE)
 5314  0000000                   SPI_X0_MOSI_NEXT#:
 5315  0000000                   .ENDIF
 5316  0000000                   	.IFDEF  BPXM_RAM
 5317  0000000                   		ORA SPI_X0MOSI_BAKM_ADDR
 5318  0000000                   	.ELSE
 5319  0000000                   		ORA !SPI_X0MOSI_D_ADDR
 5320  0000000                   	.ENDIF
 5321  0000000                   	STA !SPI_X0MOSI_PORT_ADDR
 5322  0000000                   	ENDM
 5323  0000000                   ;--------------------------------------------------------
 5324  0000000                   SPI_X0_MOSI_Y_1BIT MACRO
 5325  0000000                   	SPI_X0_CLK_READY
 5326  0000000                   	SPI_X0_MOSI_Y
 5327  0000000                   	SPI_X0_CLK_OUT
 5328  0000000                   	ENDM
 5329  0000000                   ;--------------------------------------------------------
 5330  0000000                   SPI_X0_MOSI MACRO
 5331  0000000                   	TAY
 5332  0000000                   	SPI_X0_MOSI_Y_1BIT
 5333  0000000                   	SPI_X0_MOSI_Y_1BIT
 5334  0000000                   	SPI_X0_MOSI_Y_1BIT
 5335  0000000                   	SPI_X0_MOSI_Y_1BIT
 5336  0000000                   	SPI_X0_MOSI_Y_1BIT
 5337  0000000                   	SPI_X0_MOSI_Y_1BIT
 5338  0000000                   	SPI_X0_MOSI_Y_1BIT
 5339  0000000                   	SPI_X0_MOSI_Y_1BIT	
 5340  0000000                   	ENDM
 5341  0000000                   ;--------------------------------------------------------
 5342  0000000                   SPI_X0_MISO_Y MACRO
 5343  0000000                   	LDA !SPI_X0MISO_PORT_ADDR
 5344  0000000                   	BIT #SPI_X0MISO_PIN_VALUE
 5345  0000000                   	BEQ SPI_X0_MISO_0#	
 5346  0000000                   SPI_X0_MISO_1#:
 5347  0000000                   	TYA





 5348  0000000                   	SEC
 5349  0000000                   	ROL A
 5350  0000000                   	TAY
 5351  0000000                   	BRA SPI_X0_MISO_NEXT#
 5352  0000000                   SPI_X0_MISO_0#:
 5353  0000000                   	TYA
 5354  0000000                   	CLC
 5355  0000000                   	ROL A
 5356  0000000                   	TAY
 5357  0000000                   SPI_X0_MISO_NEXT#:
 5358  0000000                   	ENDM
 5359  0000000                   ;--------------------------------------------------------
 5360  0000000                   SPI_X0_MISO_Y_1BIT MACRO
 5361  0000000                   	SPI_X0_CLK_READY
 5362  0000000                   	SPI_X0_MISO_Y
 5363  0000000                   	SPI_X0_CLK_OUT
 5364  0000000                   	ENDM
 5365  0000000                   ;--------------------------------------------------------
 5366  0000000                   SPI_X0_MISO MACRO
 5367  0000000                   	LDY #00H
 5368  0000000                   	SPI_X0_MISO_Y_1BIT
 5369  0000000                   	SPI_X0_MISO_Y_1BIT
 5370  0000000                   	SPI_X0_MISO_Y_1BIT
 5371  0000000                   	SPI_X0_MISO_Y_1BIT
 5372  0000000                   	SPI_X0_MISO_Y_1BIT
 5373  0000000                   	SPI_X0_MISO_Y_1BIT
 5374  0000000                   	SPI_X0_MISO_Y_1BIT
 5375  0000000                   	SPI_X0_MISO_Y_1BIT
 5376  0000000                   	ENDM
 5377  0000000                   ;--------------------------------------------------------
 5378  0000000                   ;--------------------------------------------------------
 5379  0000000                   SPI_X0_WRITE_NB_RAM MACRO NUM,REG
 5380  0000000                   	LDX #00H
 5381  0000000                   SPI_X0_WRITE_NB_RAM_LOOP#:
 5382  0000000                   	CPX #NUM
 5383  0000000                   	BNE 3
 5384  0000000                   	JMP END_SPI_X0_WRITE_NB_RAM#
 5385  0000000                   	LDA REG,X
 5386  0000000                   	SPI_X0_MOSI
 5387  0000000                   	INX
 5388  0000000                   	JMP SPI_X0_WRITE_NB_RAM_LOOP#
 5389  0000000                   END_SPI_X0_WRITE_NB_RAM#:
 5390  0000000                   	ENDM
 5391  0000000                   ;--------------------------------------------------------
 5392  0000000                   SPI_X0_WRITE_NB_RAM2 MACRO REG
 5393  0000000                   	LDX #00H
 5394  0000000                   SPI_X0_WRITE_NB_RAM2_LOOP#:
 5395  0000000                   	CPX REG
 5396  0000000                   	BNE 3
 5397  0000000                   	JMP END_SPI_X0_WRITE_NB_RAM2#
 5398  0000000                   	LDA REG+1,X
 5399  0000000                   	SPI_X0_MOSI
 5400  0000000                   	INX
 5401  0000000                   	JMP SPI_X0_WRITE_NB_RAM2_LOOP#
 5402  0000000                   END_SPI_X0_WRITE_NB_RAM2#:
 5403  0000000                   	ENDM
 5404  0000000                   ;--------------------------------------------------------





 5405  0000000                   SPI_X0_READ_NB_RAM MACRO NUM,REG
 5406  0000000                   	LDX #00H
 5407  0000000                   SPI_X0_READ_NB_RAM_LOOP#:
 5408  0000000                   	CPX #NUM
 5409  0000000                   	BNE 3
 5410  0000000                   	JMP END_SPI_X0_READ_NB_RAM#
 5411  0000000                   	SPI_X0_MISO
 5412  0000000                   	TYA
 5413  0000000                   	STA REG,X
 5414  0000000                   	INX
 5415  0000000                   	JMP SPI_X0_READ_NB_RAM_LOOP#
 5416  0000000                   END_SPI_X0_READ_NB_RAM#:
 5417  0000000                   	ENDM
 5418  0000000                   ;--------------------------------------------------------
 5419  0000000                   SPI_X0_READ_NB_RAM2 MACRO REG
 5420  0000000                   	LDX #00H
 5421  0000000                   SPI_X0_READ_NB_RAM2_LOOP#:
 5422  0000000                   	CPX REG
 5423  0000000                   	BNE 3
 5424  0000000                   	JMP END_SPI_X0_READ_NB_RAM2#
 5425  0000000                   	SPI_X0_MISO
 5426  0000000                   	TYA
 5427  0000000                   	STA REG+1,X
 5428  0000000                   	INX
 5429  0000000                   	JMP SPI_X0_READ_NB_RAM2_LOOP#
 5430  0000000                   END_SPI_X0_READ_NB_RAM2#:
 5431  0000000                   	ENDM
 5432  0000000                   ;=====================================================================================
 5433  0000000                   ;=====================================================================================
 5434  0000000                   .IF (SPI_COMMAND_ENABLE .EQ. 1H)
 5435  0000000                   SPI_INIT MACRO 
 5436  0000000                   	SPI_X0_INIT_PIN
 5437  0000000                   	ENDM
 5438  0000000                   ;------------------------------------------------------------------------------
 5439  0000000                   SPI_ON	MACRO 
 5440  0000000                   	SPI_X0_ON
 5441  0000000                   	ENDM
 5442  0000000                   ;------------------------------------------------------------------------------
 5443  0000000                   SPI_OFF	MACRO 
 5444  0000000                   	SPI_X0_OFF
 5445  0000000                   	ENDM
 5446  0000000                   ;------------------------------------------------------------------------------
 5447  0000000                   SPI_WRITE MACRO DATA
 5448  0000000                   	LDA #DATA
 5449  0000000                   	SPI_X0_MOSI
 5450  0000000                   	ENDM
 5451  0000000                   ;------------------------------------------------------------------------------
 5452  0000000                   SPI_WRITE_RAM MACRO REG
 5453  0000000                   	LDA REG
 5454  0000000                   	SPI_X0_MOSI
 5455  0000000                   	ENDM
 5456  0000000                   ;------------------------------------------------------------------------------
 5457  0000000                   SPI_WRITE_NB_RAM MACRO NUM,REG
 5458  0000000                   	SPI_X0_WRITE_NB_RAM NUM,REG
 5459  0000000                   	ENDM
 5460  0000000                   ;------------------------------------------------------------------------------
 5461  0000000                   SPI_WRITE_NB_RAM2 MACRO REG





 5462  0000000                   	SPI_X0_WRITE_NB_RAM2 REG
 5463  0000000                   	ENDM
 5464  0000000                   ;------------------------------------------------------------------------------
 5465  0000000                   SPI_READ MACRO 
 5466  0000000                   	SPI_X0_MISO
 5467  0000000                   	TYA
 5468  0000000                   	ENDM
 5469  0000000                   ;------------------------------------------------------------------------------
 5470  0000000                   SPI_READ_RAM MACRO REG
 5471  0000000                   	SPI_X0_MISO
 5472  0000000                   	STY REG
 5473  0000000                   	ENDM
 5474  0000000                   ;------------------------------------------------------------------------------
 5475  0000000                   SPI_READ_NB_RAM MACRO NUM,REG
 5476  0000000                   	SPI_X0_READ_NB_RAM NUM,REG
 5477  0000000                   	ENDM
 5478  0000000                   ;------------------------------------------------------------------------------
 5479  0000000                   SPI_READ_NB_RAM2 MACRO REG
 5480  0000000                   	SPI_X0_READ_NB_RAM2 REG
 5481  0000000                   	ENDM
 5482  0000000                   .ENDIF
 5483  0000000                   ;=====================================================================================
 5484  0000000                   ;=====================================================================================	
 5485  0000000                   
 5486  0000000                   
 5487  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\I2C_MACROS.INI.APP"
 5488  0000000                   ;========================================================
 5489  0000000                   ;----internal pin-----------
 5490  0000000                   I2C_IP00		EQU	00H
 5491  0000000                   I2C_IP01		EQU	01H
 5492  0000000                   I2C_IP02		EQU	02H
 5493  0000000                   I2C_IP03		EQU	03H
 5494  0000000                   I2C_IP04		EQU	04H
 5495  0000000                   I2C_IP05		EQU	05H
 5496  0000000                   I2C_IP06		EQU	06H
 5497  0000000                   I2C_IP07		EQU	07H
 5498  0000000                   
 5499  0000000                   I2C_BP00		EQU	10H
 5500  0000000                   I2C_BP01		EQU	11H
 5501  0000000                   I2C_BP02		EQU	12H
 5502  0000000                   I2C_BP03		EQU	13H
 5503  0000000                   I2C_BP04		EQU	14H
 5504  0000000                   I2C_BP05		EQU	15H
 5505  0000000                   I2C_BP06		EQU	16H
 5506  0000000                   I2C_BP07		EQU	17H
 5507  0000000                   
 5508  0000000                   I2C_BP10		EQU	20H
 5509  0000000                   I2C_BP11		EQU	21H
 5510  0000000                   I2C_BP12		EQU	22H
 5511  0000000                   I2C_BP13		EQU	23H
 5512  0000000                   I2C_BP14		EQU	24H
 5513  0000000                   I2C_BP15		EQU	25H
 5514  0000000                   I2C_BP16		EQU	26H
 5515  0000000                   I2C_BP17		EQU	27H
 5516  0000000                   
 5517  0000000                   I2C_BP20		EQU	30H
 5518  0000000                   I2C_BP21		EQU	31H





 5519  0000000                   I2C_BP22		EQU	32H
 5520  0000000                   I2C_BP23		EQU	33H
 5521  0000000                   I2C_BP24		EQU	34H
 5522  0000000                   I2C_BP25		EQU	35H
 5523  0000000                   I2C_BP26		EQU	36H
 5524  0000000                   I2C_BP27		EQU	37H
 5525  0000000                   ;========================================================
 5526  0000000                   ;IP0~BP2:   		800H~803H;
 5527  0000000                   ;IP0M: 			805H;
 5528  0000000                   ;BP0D~BP2D: 		80AH~80CH;
 5529  0000000                   ;IP0EN~BP1EN:		850H~852H;
 5530  0000000                   
 5531  0000000                   I2C_PORT_BASE		EQU	800H
 5532  0000000                   I2C_PORT_M_BASE		EQU	805H
 5533  0000000                   I2C_PORT_D_BASE		EQU	80AH
 5534  0000000                   I2C_PORT_EN_BASE	EQU	850H
 5535  0000000                   ;========================================================
 5536  0000000                   ;-----pin define,user can change--------
 5537  0000000                   I2C_X0SCL_PIN	EQU	I2C_BP02
 5538  0000000                   I2C_X0SDA_PIN	EQU	I2C_BP00
 5539  0000000                   
 5540  0000000                   .IFDEF  BPXM_RAM
 5541  0000000                   I2C_X0SCL_BAKM_ADDR		EQU 	BP0M_BAK+(I2C_X0SCL_PIN>>4)-1
 5542  0000000                   I2C_X0SDA_BAKM_ADDR		EQU 	BP0M_BAK+(I2C_X0SDA_PIN>>4)-1
 5543  0000000                   .ENDIF
 5544  0000000                   
 5545  0000000                   ;-------------X0 2Pin parameter ------------------------
 5546  0000000                   I2C_X0SCL_PIN_VALUE		EQU	1<<(I2C_X0SCL_PIN&0FH)
 5547  0000000                   I2C_X0SCL_PORT_ADDR 		EQU 	I2C_PORT_BASE+(I2C_X0SCL_PIN>>4)
 5548  0000000                   I2C_X0SCL_D_ADDR		EQU 	I2C_PORT_D_BASE+(I2C_X0SCL_PIN>>4)-1
 5549  0000000                   I2C_X0SCL_M_ADDR		EQU 	I2C_X0SCL_PORT_ADDR
 5550  0000000                   
 5551  0000000                   I2C_X0SDA_PIN_VALUE		EQU	1<<(I2C_X0SDA_PIN&0FH)
 5552  0000000                   I2C_X0SDA_PORT_ADDR 		EQU 	I2C_PORT_BASE+(I2C_X0SDA_PIN>>4)
 5553  0000000                   I2C_X0SDA_D_ADDR		EQU 	I2C_PORT_D_BASE+(I2C_X0SDA_PIN>>4)-1
 5554  0000000                   I2C_X0SDA_M_ADDR		EQU 	I2C_X0SDA_PORT_ADDR
 5555  0000000                   ;========================================================
 5556  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.1 )||((I2C_X0SCL_PIN>>4).EQ.2)
 5557  0000000                   I2C_X0SCL_M_VALUE		EQU 	1<<(I2C_X0SCL_PIN&0FH)
 5558  0000000                   I2C_X0SCL_D_VALUE		EQU 	1<<(I2C_X0SCL_PIN&0FH)
 5559  0000000                   .ENDIF		
 5560  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.3 )
 5561  0000000                   .IF ((I2C_X0SCL_PIN&0Fh).GT. 3H )
 5562  0000000                   I2C_X0SCL_M_VALUE		EQU 	F0H
 5563  0000000                   .ELSE
 5564  0000000                   I2C_X0SCL_M_VALUE		EQU 	0FH
 5565  0000000                   .ENDIF
 5566  0000000                   I2C_X0SCL_D_VALUE		EQU 	1<<((I2C_X0SCL_PIN&0FH)>>2)
 5567  0000000                   .ENDIF
 5568  0000000                   ;--------------------------------------------------------
 5569  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5570  0000000                   I2C_X0SDA_M_VALUE		EQU 	1<<(I2C_X0SDA_PIN&0FH)
 5571  0000000                   I2C_X0SDA_D_VALUE		EQU 	1<<(I2C_X0SDA_PIN&0FH)
 5572  0000000                   .ENDIF		
 5573  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5574  0000000                   .IF ((I2C_X0SDA_PIN&0Fh).GT. 3H )
 5575  0000000                   I2C_X0SDA_M_VALUE		EQU 	F0H





 5576  0000000                   .ELSE
 5577  0000000                   I2C_X0SDA_M_VALUE		EQU 	0FH
 5578  0000000                   .ENDIF
 5579  0000000                   I2C_X0SDA_D_VALUE		EQU 	1<<((I2C_X0SDA_PIN&0FH)>>2)
 5580  0000000                   .ENDIF
 5581  0000000                   ;========================================================
 5582  0000000                   
 5583  0000000                   ;================================================================================
 5584  0000000                   ; 	I2C SUBROUTINE
 5585  0000000                   ;================================================================================
 5586  0000000                   I2C_DELAY MACRO
 5587  0000000                   	NOP
 5588  0000000                   	NOP
 5589  0000000                   	NOP
 5590  0000000                   	NOP
 5591  0000000                   	NOP
 5592  0000000                   .IF (SYSTEMCLK.GT.4096000 )
 5593  0000000                   	NOP
 5594  0000000                   	NOP
 5595  0000000                   	NOP
 5596  0000000                   	NOP
 5597  0000000                   	NOP
 5598  0000000                   .IF (SYSTEMCLK.GT.6144000 )	
 5599  0000000                   	NOP
 5600  0000000                   	NOP
 5601  0000000                   	NOP
 5602  0000000                   	NOP
 5603  0000000                   	NOP
 5604  0000000                   .ENDIF
 5605  0000000                   .ENDIF
 5606  0000000                   ENDM
 5607  0000000                   ;--------------------------------------------------------
 5608  0000000                   BP2_OUTPUT_MASK MACRO
 5609  0000000                   	CMP #00H
 5610  0000000                   	BNE BP2_OUTPUT_MASK_01#
 5611  0000000                   	LDA #FFH
 5612  0000000                   	BRA BP2_OUTPUT_MASK_END#
 5613  0000000                   BP2_OUTPUT_MASK_01#:
 5614  0000000                   	CMP #01H
 5615  0000000                   	BNE BP2_OUTPUT_MASK_02#
 5616  0000000                   	LDA #F0H
 5617  0000000                   	BRA BP2_OUTPUT_MASK_END#
 5618  0000000                   BP2_OUTPUT_MASK_02#:
 5619  0000000                   	CMP #02H
 5620  0000000                   	BNE BP2_OUTPUT_MASK_03#
 5621  0000000                   	LDA #0FH
 5622  0000000                   	BRA BP2_OUTPUT_MASK_END#
 5623  0000000                   BP2_OUTPUT_MASK_03#:
 5624  0000000                   	LDA #00H
 5625  0000000                   BP2_OUTPUT_MASK_END#:
 5626  0000000                   	ENDM
 5627  0000000                   ;--------------------------------------------------------
 5628  0000000                   I2C_X0_SCL_1 MACRO 
 5629  0000000                   ;SCL:0->1
 5630  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.1 )||((I2C_X0SCL_PIN>>4).EQ.2)
 5631  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5632  0000000                   	EOR #FFH





 5633  0000000                   .ENDIF
 5634  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.3 )
 5635  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5636  0000000                   	BP2_OUTPUT_MASK
 5637  0000000                   .ENDIF
 5638  0000000                   	AND !I2C_X0SCL_PORT_ADDR
 5639  0000000                   	ORA #I2C_X0SCL_PIN_VALUE
 5640  0000000                   	.IFDEF  BPXM_RAM
 5641  0000000                   		ORA I2C_X0SCL_BAKM_ADDR
 5642  0000000                   	.ELSE
 5643  0000000                   		ORA !I2C_X0SCL_D_ADDR
 5644  0000000                   	.ENDIF
 5645  0000000                   	STA !I2C_X0SCL_PORT_ADDR
 5646  0000000                   	ENDM
 5647  0000000                   ;--------------------------------------------------------
 5648  0000000                   I2C_X0_SCL_0 MACRO
 5649  0000000                   ;SCL:1->0
 5650  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.1 )||((I2C_X0SCL_PIN>>4).EQ.2)
 5651  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5652  0000000                   	EOR #FFH
 5653  0000000                   .ENDIF
 5654  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.3 )
 5655  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5656  0000000                   	BP2_OUTPUT_MASK
 5657  0000000                   .ENDIF
 5658  0000000                   	AND !I2C_X0SCL_PORT_ADDR		
 5659  0000000                   	AND #(FFH^I2C_X0SCL_PIN_VALUE)
 5660  0000000                   	.IFDEF  BPXM_RAM
 5661  0000000                   		ORA I2C_X0SCL_BAKM_ADDR
 5662  0000000                   	.ELSE
 5663  0000000                   		ORA !I2C_X0SCL_D_ADDR
 5664  0000000                   	.ENDIF
 5665  0000000                   	STA !I2C_X0SCL_PORT_ADDR 
 5666  0000000                   	ENDM
 5667  0000000                   ;--------------------------------------------------------
 5668  0000000                   I2C_X0_SDA_OUTPUT MACRO
 5669  0000000                   ;SDA: output
 5670  0000000                   	LDA #I2C_X0SDA_D_VALUE
 5671  0000000                   	TRB !I2C_X0SDA_D_ADDR
 5672  0000000                   	.IFDEF  BPXM_RAM
 5673  0000000                   		LDA #I2C_X0SDA_M_VALUE
 5674  0000000                   		TRB I2C_X0SDA_BAKM_ADDR
 5675  0000000                   	.ENDIF
 5676  0000000                   	ENDM
 5677  0000000                   ;--------------------------------------------------------
 5678  0000000                   I2C_X0_SDA_0 MACRO
 5679  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5680  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5681  0000000                   	EOR #FFH
 5682  0000000                   .ENDIF
 5683  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5684  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5685  0000000                   	BP2_OUTPUT_MASK
 5686  0000000                   .ENDIF
 5687  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5688  0000000                   	AND #(FFH^I2C_X0SDA_PIN_VALUE)
 5689  0000000                   	.IFDEF  BPXM_RAM





 5690  0000000                   		ORA I2C_X0SDA_BAKM_ADDR
 5691  0000000                   	.ELSE
 5692  0000000                   		ORA !I2C_X0SDA_D_ADDR
 5693  0000000                   	.ENDIF
 5694  0000000                   	STA !I2C_X0SDA_PORT_ADDR
 5695  0000000                   	ENDM
 5696  0000000                   ;--------------------------------------------------------
 5697  0000000                   I2C_X0_SDA_1 MACRO
 5698  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5699  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5700  0000000                   	EOR #FFH
 5701  0000000                   .ENDIF
 5702  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5703  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5704  0000000                   	BP2_OUTPUT_MASK
 5705  0000000                   .ENDIF
 5706  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5707  0000000                   	ORA #I2C_X0SDA_PIN_VALUE
 5708  0000000                   	.IFDEF  BPXM_RAM
 5709  0000000                   		ORA I2C_X0SDA_BAKM_ADDR
 5710  0000000                   	.ELSE
 5711  0000000                   		ORA !I2C_X0SDA_D_ADDR
 5712  0000000                   	.ENDIF
 5713  0000000                   	STA !I2C_X0SDA_PORT_ADDR
 5714  0000000                   	ENDM
 5715  0000000                   ;--------------------------------------------------------
 5716  0000000                   I2C_X0_SDA_OUTPUT_0 MACRO
 5717  0000000                   	I2C_X0_SDA_OUTPUT
 5718  0000000                   	I2C_X0_SDA_0
 5719  0000000                   	ENDM
 5720  0000000                   ;--------------------------------------------------------
 5721  0000000                   I2C_X0_SDA_OUTPUT_1 MACRO
 5722  0000000                   	I2C_X0_SDA_OUTPUT
 5723  0000000                   	I2C_X0_SDA_1
 5724  0000000                   	ENDM
 5725  0000000                   ;--------------------------------------------------------
 5726  0000000                   I2C_X0_SDA_PULL_HIGH_1	MACRO
 5727  0000000                   ;SDA:pull high input, value 1
 5728  0000000                   	LDA #I2C_X0SDA_D_VALUE
 5729  0000000                   	TSB !I2C_X0SDA_D_ADDR
 5730  0000000                   	.IFDEF  BPXM_RAM
 5731  0000000                   		LDA #I2C_X0SDA_M_VALUE
 5732  0000000                   		TSB I2C_X0SDA_BAKM_ADDR
 5733  0000000                   	.ENDIF
 5734  0000000                   	I2C_X0_SDA_1
 5735  0000000                   	ENDM
 5736  0000000                   ;========================================================
 5737  0000000                   ;output: SCL output
 5738  0000000                   I2C_X0_INIT_PIN MACRO
 5739  0000000                   ;SCL:  output,init value 1
 5740  0000000                   	LDA #I2C_X0SCL_D_VALUE
 5741  0000000                   	TRB !I2C_X0SCL_D_ADDR
 5742  0000000                   	.IFDEF  BPXM_RAM
 5743  0000000                   		LDA #I2C_X0SCL_M_VALUE
 5744  0000000                   		TRB I2C_X0SCL_BAKM_ADDR
 5745  0000000                   	.ENDIF
 5746  0000000                   	ENDM





 5747  0000000                   ;--------------------------------------------------------
 5748  0000000                   ;output: SDA output low,SCL output low
 5749  0000000                   I2C_X0_START MACRO
 5750  0000000                   ;SDA:  output,init value 1
 5751  0000000                   	I2C_X0_SDA_OUTPUT_1
 5752  0000000                   
 5753  0000000                   ;SCL:  output,init value 1
 5754  0000000                   	I2C_X0_SCL_1
 5755  0000000                   	I2C_DELAY
 5756  0000000                   
 5757  0000000                   ;SDA:1->0
 5758  0000000                   	I2C_X0_SDA_0
 5759  0000000                   	I2C_DELAY
 5760  0000000                   
 5761  0000000                   ;SCL:1->0 
 5762  0000000                   	I2C_X0_SCL_0
 5763  0000000                   	ENDM
 5764  0000000                   ;--------------------------------------------------------
 5765  0000000                   ;output: SDA output high,SCL output high
 5766  0000000                   I2C_X0_STOP MACRO
 5767  0000000                   ;SDA: output,0
 5768  0000000                   	I2C_X0_SDA_OUTPUT_0
 5769  0000000                   
 5770  0000000                   ;SCL: output value 1
 5771  0000000                   	I2C_X0_SCL_1
 5772  0000000                   	I2C_DELAY	
 5773  0000000                   
 5774  0000000                   ;SDA:0->1
 5775  0000000                   	I2C_X0_SDA_1
 5776  0000000                   	I2C_DELAY
 5777  0000000                   	ENDM
 5778  0000000                   ;========================================================
 5779  0000000                   ;--------------------------------------------------------
 5780  0000000                   I2C_X0_MOSI_Y MACRO
 5781  0000000                   	TYA
 5782  0000000                   	ASL A
 5783  0000000                   	TAY
 5784  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5785  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5786  0000000                   	EOR #FFH
 5787  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5788  0000000                   	BCC I2C_X0_MOSI_SET_0#
 5789  0000000                   I2C_X0_MOSI_SET_1#:
 5790  0000000                   	ORA #I2C_X0SDA_PIN_VALUE
 5791  0000000                   	BRA I2C_X0_MOSI_NEXT#
 5792  0000000                   I2C_X0_MOSI_SET_0#:
 5793  0000000                   	AND #(FFH^I2C_X0SDA_PIN_VALUE)
 5794  0000000                   I2C_X0_MOSI_NEXT#:
 5795  0000000                   .ENDIF
 5796  0000000                   
 5797  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5798  0000000                   	BCC I2C_X0_MOSI_SET_0#
 5799  0000000                   I2C_X0_MOSI_SET_1#:
 5800  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5801  0000000                   	BP2_OUTPUT_MASK
 5802  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5803  0000000                   	ORA #I2C_X0SDA_PIN_VALUE





 5804  0000000                   	BRA I2C_X0_MOSI_NEXT#
 5805  0000000                   I2C_X0_MOSI_SET_0#:
 5806  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5807  0000000                   	BP2_OUTPUT_MASK
 5808  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5809  0000000                   	AND #(FFH^I2C_X0SDA_PIN_VALUE)
 5810  0000000                   I2C_X0_MOSI_NEXT#:
 5811  0000000                   .ENDIF
 5812  0000000                   	.IFDEF  BPXM_RAM
 5813  0000000                   		ORA I2C_X0SDA_BAKM_ADDR
 5814  0000000                   	.ELSE
 5815  0000000                   		ORA !I2C_X0SDA_D_ADDR
 5816  0000000                   	.ENDIF
 5817  0000000                   	STA !I2C_X0SDA_PORT_ADDR
 5818  0000000                   	ENDM
 5819  0000000                   ;--------------------------------------------------------
 5820  0000000                   I2C_X0_MOSI_Y_1BIT MACRO
 5821  0000000                   	I2C_X0_MOSI_Y
 5822  0000000                   	I2C_DELAY
 5823  0000000                   
 5824  0000000                   	I2C_X0_SCL_1 	
 5825  0000000                   	I2C_DELAY	
 5826  0000000                   	I2C_X0_SCL_0	
 5827  0000000                   	ENDM
 5828  0000000                   ;--------------------------------------------------------
 5829  0000000                   ;input: SCL output low,
 5830  0000000                   ;output:SCL output low, SDA input
 5831  0000000                   ;	ack:acc=01;nack:acc=00
 5832  0000000                   
 5833  0000000                   I2C_X0_MOSI MACRO
 5834  0000000                   	TAY
 5835  0000000                   	I2C_X0_SDA_OUTPUT
 5836  0000000                   
 5837  0000000                   	I2C_X0_MOSI_Y_1BIT
 5838  0000000                   	I2C_X0_MOSI_Y_1BIT
 5839  0000000                   	I2C_X0_MOSI_Y_1BIT
 5840  0000000                   	I2C_X0_MOSI_Y_1BIT
 5841  0000000                   	I2C_X0_MOSI_Y_1BIT
 5842  0000000                   	I2C_X0_MOSI_Y_1BIT
 5843  0000000                   	I2C_X0_MOSI_Y_1BIT
 5844  0000000                   	I2C_X0_MOSI_Y_1BIT
 5845  0000000                   
 5846  0000000                   I2C_X0_MOSI_ACK#:
 5847  0000000                   	I2C_X0_SDA_PULL_HIGH_1
 5848  0000000                   	I2C_DELAY
 5849  0000000                   
 5850  0000000                   ;SCL:9th:0->1
 5851  0000000                   	I2C_X0_SCL_1
 5852  0000000                   	I2C_DELAY
 5853  0000000                   
 5854  0000000                   ;SDA:check ACK
 5855  0000000                   	LDA !I2C_X0SDA_PORT_ADDR
 5856  0000000                   	BIT #I2C_X0SDA_PIN_VALUE
 5857  0000000                   	BNE I2C_X0_MOSI_NACK#
 5858  0000000                   
 5859  0000000                   	I2C_X0_SCL_0
 5860  0000000                   	LDA #01H





 5861  0000000                   	BRA I2C_X0_MOSI_END#
 5862  0000000                   
 5863  0000000                   I2C_X0_MOSI_NACK#:
 5864  0000000                   	I2C_X0_SCL_0	
 5865  0000000                   	LDA #00H
 5866  0000000                   
 5867  0000000                   I2C_X0_MOSI_END#:		
 5868  0000000                   	ENDM	
 5869  0000000                   ;--------------------------------------------------------
 5870  0000000                   I2C_X0_MISO_Y	MACRO
 5871  0000000                   	LDA !I2C_X0SDA_PORT_ADDR
 5872  0000000                   	BIT #I2C_X0SDA_PIN_VALUE
 5873  0000000                   	BEQ I2C_X0_MISO_0#	
 5874  0000000                   I2C_X0_MISO_1#:
 5875  0000000                   	TYA
 5876  0000000                   	SEC
 5877  0000000                   	ROL A
 5878  0000000                   	TAY
 5879  0000000                   	BRA I2C_X0_MISO_NEXT#
 5880  0000000                   I2C_X0_MISO_0#:
 5881  0000000                   	TYA
 5882  0000000                   	CLC
 5883  0000000                   	ROL A
 5884  0000000                   	TAY
 5885  0000000                   I2C_X0_MISO_NEXT#:	
 5886  0000000                   	ENDM
 5887  0000000                   ;--------------------------------------------------------
 5888  0000000                   I2C_X0_MISO_Y_1BIT	MACRO
 5889  0000000                   	I2C_X0_SCL_0
 5890  0000000                   	I2C_DELAY
 5891  0000000                   	I2C_X0_SCL_1
 5892  0000000                   	I2C_DELAY
 5893  0000000                   
 5894  0000000                   	I2C_X0_MISO_Y
 5895  0000000                   	ENDM
 5896  0000000                   ;--------------------------------------------------------
 5897  0000000                   ;input: SCL output low,
 5898  0000000                   ;output:SCL output low, SDA output 1
 5899  0000000                   
 5900  0000000                   I2C_X0_MISO MACRO
 5901  0000000                   	I2C_X0_SDA_PULL_HIGH_1
 5902  0000000                   
 5903  0000000                   	LDY #00H
 5904  0000000                   	I2C_X0_MISO_Y_1BIT
 5905  0000000                   	I2C_X0_MISO_Y_1BIT
 5906  0000000                   	I2C_X0_MISO_Y_1BIT
 5907  0000000                   	I2C_X0_MISO_Y_1BIT
 5908  0000000                   	I2C_X0_MISO_Y_1BIT
 5909  0000000                   	I2C_X0_MISO_Y_1BIT
 5910  0000000                   	I2C_X0_MISO_Y_1BIT
 5911  0000000                   	I2C_X0_MISO_Y_1BIT
 5912  0000000                   
 5913  0000000                   	ENDM
 5914  0000000                   ;--------------------------------------------------------
 5915  0000000                   I2C_X0_MISO_ACK MACRO
 5916  0000000                   	I2C_X0_SCL_0
 5917  0000000                   





 5918  0000000                   ;SDA: output0
 5919  0000000                   	I2C_X0_SDA_OUTPUT_0	
 5920  0000000                   	I2C_DELAY
 5921  0000000                   
 5922  0000000                   ;SCL:0->1
 5923  0000000                   	I2C_X0_SCL_1
 5924  0000000                   	I2C_DELAY
 5925  0000000                   
 5926  0000000                   ;SCL:1->0
 5927  0000000                   	I2C_X0_SCL_0
 5928  0000000                   	ENDM
 5929  0000000                   ;--------------------------------------------------------
 5930  0000000                   I2C_X0_MISO_NACK MACRO
 5931  0000000                   ;SCL:1->0
 5932  0000000                   	I2C_X0_SCL_0
 5933  0000000                   
 5934  0000000                   ;SDA: output1
 5935  0000000                   	I2C_X0_SDA_OUTPUT_1
 5936  0000000                   	I2C_DELAY
 5937  0000000                   
 5938  0000000                   ;SCL:0->1
 5939  0000000                   	I2C_X0_SCL_1
 5940  0000000                   	I2C_DELAY
 5941  0000000                   
 5942  0000000                   ;SCL:1->0
 5943  0000000                   	I2C_X0_SCL_0
 5944  0000000                   	ENDM
 5945  0000000                   ;--------------------------------------------------------
 5946  0000000                   ;	ack:acc=01;nack:acc=00
 5947  0000000                   I2C_X0_WRITE_NB_RAM MACRO NUM,REG
 5948  0000000                   	LDX #00H
 5949  0000000                   I2C_X0_WRITE_NB_RAM_LOOP#:
 5950  0000000                   	CPX #NUM
 5951  0000000                   	BNE 3
 5952  0000000                   	JMP I2C_X0_WRITE_NB_RAM_DONE#
 5953  0000000                   	LDA REG,X
 5954  0000000                   	I2C_X0_MOSI
 5955  0000000                   	BEQ I2C_X0_WRITE_NB_RAM_NACK#
 5956  0000000                   	INX
 5957  0000000                   	JMP I2C_X0_WRITE_NB_RAM_LOOP#
 5958  0000000                   I2C_X0_WRITE_NB_RAM_DONE#:
 5959  0000000                   	LDA #01H
 5960  0000000                   	BRA END_I2C_X0_WRITE_NB_RAM#
 5961  0000000                   
 5962  0000000                   I2C_X0_WRITE_NB_RAM_NACK#:
 5963  0000000                   	LDA #00H
 5964  0000000                   
 5965  0000000                   END_I2C_X0_WRITE_NB_RAM#:
 5966  0000000                   	ENDM
 5967  0000000                   ;--------------------------------------------------------
 5968  0000000                   ;	ack:acc=01;nack:acc=00
 5969  0000000                   I2C_X0_WRITE_NB_RAM2 MACRO REG
 5970  0000000                   	LDX #00H
 5971  0000000                   I2C_X0_WRITE_NB_RAM2_LOOP#:
 5972  0000000                   	CPX REG
 5973  0000000                   	BNE 3
 5974  0000000                   	JMP I2C_X0_WRITE_NB_RAM2_DONE#





 5975  0000000                   	LDA REG+1,X
 5976  0000000                   	I2C_X0_MOSI
 5977  0000000                   	BEQ I2C_X0_WRITE_NB_RAM2_NACK#
 5978  0000000                   	INX
 5979  0000000                   	JMP I2C_X0_WRITE_NB_RAM2_LOOP#
 5980  0000000                   I2C_X0_WRITE_NB_RAM2_DONE#:
 5981  0000000                   	LDA #01H
 5982  0000000                   	BRA END_I2C_X0_WRITE_NB_RAM2#
 5983  0000000                   
 5984  0000000                   I2C_X0_WRITE_NB_RAM2_NACK#:
 5985  0000000                   	LDA #00H
 5986  0000000                   
 5987  0000000                   END_I2C_X0_WRITE_NB_RAM2#:
 5988  0000000                   	ENDM
 5989  0000000                   ;--------------------------------------------------------
 5990  0000000                   I2C_X0_READ_NB_RAM MACRO NUM,REG
 5991  0000000                   	LDX #00H
 5992  0000000                   I2C_X0_READ_NB_RAM_LOOP#:
 5993  0000000                   	CPX #NUM-1
 5994  0000000                   	BNE 3
 5995  0000000                   	JMP END_I2C_X0_READ_NB_RAM#
 5996  0000000                   	I2C_X0_MISO
 5997  0000000                   	I2C_X0_MISO_ACK
 5998  0000000                   	TYA
 5999  0000000                   	STA REG,X
 6000  0000000                   	INX
 6001  0000000                   	JMP I2C_X0_READ_NB_RAM_LOOP#
 6002  0000000                   END_I2C_X0_READ_NB_RAM#:
 6003  0000000                   	I2C_X0_MISO
 6004  0000000                   	I2C_X0_MISO_NACK
 6005  0000000                   	TYA
 6006  0000000                   	STA REG,X
 6007  0000000                   	ENDM
 6008  0000000                   ;--------------------------------------------------------
 6009  0000000                   I2C_X0_READ_NB_RAM2 MACRO REG
 6010  0000000                   	LDX #00H
 6011  0000000                   I2C_X0_READ_NB_RAM2_LOOP#:
 6012  0000000                   	INX
 6013  0000000                   	CPX REG
 6014  0000000                   	BNE 3
 6015  0000000                   	JMP END_I2C_X0_READ_NB_RAM2#
 6016  0000000                   	DEX
 6017  0000000                   	I2C_X0_MISO
 6018  0000000                   	I2C_X0_MISO_ACK
 6019  0000000                   	TYA
 6020  0000000                   	STA REG+1,X
 6021  0000000                   	INX
 6022  0000000                   	JMP I2C_X0_READ_NB_RAM2_LOOP#
 6023  0000000                   END_I2C_X0_READ_NB_RAM2#:
 6024  0000000                   	DEX
 6025  0000000                   	I2C_X0_MISO
 6026  0000000                   	I2C_X0_MISO_NACK
 6027  0000000                   	TYA
 6028  0000000                   	STA REG+1,X
 6029  0000000                   	ENDM
 6030  0000000                   ;=====================================================================================
 6031  0000000                   ;=====================================================================================





 6032  0000000                   .IF (I2C_COMMAND_ENABLE .EQ. 1H)
 6033  0000000                   ;output: SCL output
 6034  0000000                   I2C_INIT MACRO
 6035  0000000                    	I2C_X0_INIT_PIN
 6036  0000000                    	ENDM
 6037  0000000                   ;------------------------------------------------------------------------------
 6038  0000000                   ;output: SDA output low,SCL output low
 6039  0000000                   I2C_ON	MACRO 
 6040  0000000                   	I2C_X0_START
 6041  0000000                   	ENDM
 6042  0000000                   ;------------------------------------------------------------------------------
 6043  0000000                   ;output: SDA output high,SCL output high
 6044  0000000                   I2C_OFF	MACRO 
 6045  0000000                   	I2C_X0_STOP
 6046  0000000                   	ENDM
 6047  0000000                   ;------------------------------------------------------------------------------
 6048  0000000                   ;input: SCL output low,
 6049  0000000                   ;output:SCL output low, SDA input
 6050  0000000                   ;	ack:acc=01;nack:acc=00
 6051  0000000                   I2C_WRITE MACRO DATA
 6052  0000000                   	LDA #DATA
 6053  0000000                   	I2C_X0_MOSI
 6054  0000000                   	ENDM
 6055  0000000                   ;------------------------------------------------------------------------------
 6056  0000000                   I2C_WRITE_RAM MACRO REG
 6057  0000000                   	LDA REG
 6058  0000000                   	I2C_X0_MOSI
 6059  0000000                   	ENDM
 6060  0000000                   ;------------------------------------------------------------------------------
 6061  0000000                   I2C_WRITE_NB_RAM MACRO NUM,REG
 6062  0000000                   	I2C_X0_WRITE_NB_RAM NUM,REG
 6063  0000000                   	ENDM
 6064  0000000                   ;------------------------------------------------------------------------------
 6065  0000000                   I2C_WRITE_NB_RAM2 MACRO REG
 6066  0000000                   	I2C_X0_WRITE_NB_RAM2 REG
 6067  0000000                   	ENDM
 6068  0000000                   ;------------------------------------------------------------------------------
 6069  0000000                   ;input: SCL output low,
 6070  0000000                   ;output:SCL output low, SDA output 1
 6071  0000000                   
 6072  0000000                   I2C_READ_NACK MACRO 
 6073  0000000                   	I2C_X0_MISO
 6074  0000000                   	I2C_X0_MISO_NACK
 6075  0000000                   	TYA
 6076  0000000                   	ENDM
 6077  0000000                   ;------------------------------------------------------------------------------
 6078  0000000                   I2C_READ MACRO 
 6079  0000000                   	I2C_READ_NACK
 6080  0000000                   	ENDM
 6081  0000000                   ;------------------------------------------------------------------------------
 6082  0000000                   I2C_READ_NACK_RAM MACRO REG
 6083  0000000                   	I2C_X0_MISO
 6084  0000000                   	I2C_X0_MISO_NACK
 6085  0000000                   	STY REG
 6086  0000000                   	ENDM
 6087  0000000                   ;------------------------------------------------------------------------------
 6088  0000000                   I2C_READ_RAM MACRO REG





 6089  0000000                   	I2C_READ_NACK_RAM REG
 6090  0000000                   	ENDM
 6091  0000000                   ;------------------------------------------------------------------------------
 6092  0000000                   I2C_READ_ACK MACRO 
 6093  0000000                   	I2C_X0_MISO
 6094  0000000                   	I2C_X0_MISO_ACK
 6095  0000000                   	TYA
 6096  0000000                   	ENDM
 6097  0000000                   ;------------------------------------------------------------------------------
 6098  0000000                   I2C_READ_ACK_RAM MACRO REG
 6099  0000000                   	I2C_X0_MISO
 6100  0000000                   	I2C_X0_MISO_ACK
 6101  0000000                   	STY REG
 6102  0000000                   	ENDM
 6103  0000000                   ;------------------------------------------------------------------------------
 6104  0000000                   I2C_READ_NB_RAM MACRO NUM,REG
 6105  0000000                   	I2C_X0_READ_NB_RAM NUM,REG
 6106  0000000                   	ENDM
 6107  0000000                   ;------------------------------------------------------------------------------
 6108  0000000                   I2C_READ_NB_RAM2 MACRO REG
 6109  0000000                   	I2C_X0_READ_NB_RAM2 REG
 6110  0000000                   	ENDM
 6111  0000000                   .ENDIF
 6112  0000000                   ;=====================================================================================
 6113  0000000                   ;=====================================================================================	
 6114  0000000                   
 6115  0000000                   
 6116  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\MACRO_INSTRUCTION.INI.APP"
 6117  0000000                   ;==============================================================================
 6118  0000000                   ;==============================================================================
 6119  0000000                   SET_STACK_POINTER_TO	MACRO	STACK_START_VALUE
 6120  0000000                   	LDX	#STACK_START_VALUE
 6121  0000000                   	TXS
 6122  0000000                   	ENDM
 6123  0000000                   ;------------------------------------------------------------------------------
 6124  0000000                   CLEAR_RAM_FROM_00H_TO	MACRO	CLEAR_RAM_END
 6125  0000000                   ;=== CLEAR RAMS ===
 6126  0000000                   	LDA	#.LOW.CLEAR_RAM_END
 6127  0000000                   	STA	<RR0			;keep the end address low byte
 6128  0000000                   	LDA	#.HIGH.CLEAR_RAM_END	
 6129  0000000                   	STA	<RR1			;keep the end address high byte
 6130  0000000                   CLEAR_LOOP#:
 6131  0000000                   	LDA	#00
 6132  0000000                   	STA	(<RR0)
 6133  0000000                   	LDA	<RR1
 6134  0000000                   	BNE	DEC_ADDR#
 6135  0000000                   	LDA	<RR0
 6136  0000000                   	CMP	#02H
 6137  0000000                   	BEQ	END_CLEAR#
 6138  0000000                   DEC_ADDR#:
 6139  0000000                   	SEC
 6140  0000000                   	LDA	<RR0
 6141  0000000                   	SBC	#01H
 6142  0000000                   	STA	<RR0
 6143  0000000                   	LDA	<RR1
 6144  0000000                   	SBC	#00H
 6145  0000000                   	STA	<RR1





 6146  0000000                   	.IF	 (CHIPBODY!='N588H000')
 6147  0000000                   	CMP	#01h
 6148  0000000                   	BNE	NOT_IN_01#	;I-f address is 01xx, change to 00xx
 6149  0000000                   	DEC	<RR1
 6150  0000000                   	.ENDIF
 6151  0000000                   NOT_IN_01#:
 6152  0000000                   	JMP	CLEAR_LOOP#
 6153  0000000                   END_CLEAR#:
 6154  0000000                   	LDA	#00h
 6155  0000000                   	STA	<RR0	;Clear address 00H and 01H
 6156  0000000                   	STA	<RR1
 6157  0000000                   	ENDM
 6158  0000000                   ;--------------------------------------------------------------
 6159  0000000                   CLEAR_RAM_RANGE MACRO CLEAR_RAM_BEGIN,CLEAR_RAM_END
 6160  0000000                   ;=== CLEAR RAMS ===
 6161  0000000                   	LDA	#.LOW.CLEAR_RAM_END
 6162  0000000                   	STA	<CLEAR_RAM_BEGIN			;keep the end address low byte
 6163  0000000                   	LDA	#.HIGH.CLEAR_RAM_END	
 6164  0000000                   	STA	<CLEAR_RAM_BEGIN+1			;keep the end address high byte
 6165  0000000                   CLEAR_LOOP_1#:
 6166  0000000                   	LDA	#00
 6167  0000000                   	STA	(<CLEAR_RAM_BEGIN)
 6168  0000000                   	LDA	<CLEAR_RAM_BEGIN+1
 6169  0000000                   	CMP 	#(.HIGH.CLEAR_RAM_BEGIN+2)
 6170  0000000                   	BNE 	DEC_ADDR_1#
 6171  0000000                   	LDA	<CLEAR_RAM_BEGIN
 6172  0000000                   	CMP	#(.LOW.CLEAR_RAM_BEGIN+2)
 6173  0000000                   	BEQ	END_CLEAR_1#
 6174  0000000                   DEC_ADDR_1#:
 6175  0000000                   	SEC
 6176  0000000                   	LDA	<CLEAR_RAM_BEGIN
 6177  0000000                   	SBC	#01H
 6178  0000000                   	STA	<CLEAR_RAM_BEGIN
 6179  0000000                   	LDA	<CLEAR_RAM_BEGIN+1
 6180  0000000                   	SBC	#00H
 6181  0000000                   	STA	<CLEAR_RAM_BEGIN+1
 6182  0000000                   	.IF	 (CHIPBODY!='N588H000')
 6183  0000000                   	CMP	#01h
 6184  0000000                   	BNE	NOT_IN_01#	;I-f address is 01xx, change to 00xx
 6185  0000000                   	DEC	<CLEAR_RAM_BEGIN+1
 6186  0000000                   	.ENDIF
 6187  0000000                   NOT_IN_01#:
 6188  0000000                   	JMP	CLEAR_LOOP_1#
 6189  0000000                   END_CLEAR_1#:
 6190  0000000                   	LDA	#00h
 6191  0000000                   	STA	<CLEAR_RAM_BEGIN	;Clear address 00H and 01H
 6192  0000000                   	STA	<CLEAR_RAM_BEGIN+1
 6193  0000000                   	ENDM
 6194  0000000                   ;===============================================================================
 6195  0000000                   ;===============================================================================
 6196  0000000                   EN_BP0X_PWM MACRO BP0X_VALUE,PWV_INDEX,DUTY,DIVISION,PAIR_PWM,BP0C_MODE
 6197  0000000                   	LDA !BP0D
 6198  0000000                   	BIT #BP0X_VALUE
 6199  0000000                   	BNE BP0X_PWM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6200  0000000                   
 6201  0000000                   	LDA !BP0
 6202  0000000                   	BIT #BP0X_VALUE





 6203  0000000                   	BNE BP0X_PWM_INIT_NEXT#
 6204  0000000                   
 6205  0000000                   	LDA #DUTY
 6206  0000000                   	EOR #FFH
 6207  0000000                   	BRA BP0X_PWM_INIT_CONST#
 6208  0000000                   
 6209  0000000                   BP0X_PWM_INIT#:	
 6210  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin
 6211  0000000                   	TRB !BP0D
 6212  0000000                   
 6213  0000000                   	.IFDEF       BPXM_RAM
 6214  0000000                   		TRB BP0M_BAK
 6215  0000000                   		LDA !BP0D
 6216  0000000                   		EOR #FFH
 6217  0000000                   		AND !BP0
 6218  0000000                   		ORA #BP0X_VALUE
 6219  0000000                   		ORA BP0M_BAK
 6220  0000000                   	.ELSE
 6221  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High
 6222  0000000                   		ORA !BP0
 6223  0000000                   		ORA !BP0D
 6224  0000000                   	.ENDIF
 6225  0000000                   	STA !BP0
 6226  0000000                   BP0X_PWM_INIT_NEXT#:
 6227  0000000                   	LDA #DUTY		;duty,low level
 6228  0000000                   BP0X_PWM_INIT_CONST#:
 6229  0000000                   	STA !(PWV0+PWV_INDEX)
 6230  0000000                   	LDA !PWMC
 6231  0000000                   	AND #3FH
 6232  0000000                   	ORA #(DIVISION-1)*64	;division type
 6233  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6234  0000000                   	STA !PWMC
 6235  0000000                   
 6236  0000000                   	LDA !PWMC
 6237  0000000                   	BIT #PAIR_PWM
 6238  0000000                   	BEQ EN_BP0X_PWM_END#
 6239  0000000                   	LDA #BP0C_MODE
 6240  0000000                   	TRB !BP0C
 6241  0000000                   
 6242  0000000                   EN_BP0X_PWM_END#:
 6243  0000000                   	ENDM
 6244  0000000                   ;------------------------------------------------------------------------------	
 6245  0000000                   EN_BP0X_PWM_RAM MACRO BP0X_VALUE,PWV_INDEX,DUTY_RAM,DIVISION,PAIR_PWM,BP0C_MODE
 6246  0000000                   	LDA !BP0D
 6247  0000000                   	BIT #BP0X_VALUE
 6248  0000000                   	BNE BP0X_PWM_RAM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6249  0000000                   
 6250  0000000                   	LDA !BP0
 6251  0000000                   	BIT #BP0X_VALUE
 6252  0000000                   	BNE BP0X_PWM_RAM_INIT_NEXT#
 6253  0000000                   
 6254  0000000                   	LDA !DUTY_RAM
 6255  0000000                   	EOR #FFH
 6256  0000000                   	BRA BP0X_PWM_RAM_INIT_CONST#
 6257  0000000                   
 6258  0000000                   BP0X_PWM_RAM_INIT#:
 6259  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin





 6260  0000000                   	TRB !BP0D
 6261  0000000                   	.IFDEF       BPXM_RAM
 6262  0000000                   		TRB BP0M_BAK
 6263  0000000                   		LDA !BP0D
 6264  0000000                   		EOR #FFH
 6265  0000000                   		AND !BP0
 6266  0000000                   		ORA #BP0X_VALUE
 6267  0000000                   		ORA BP0M_BAK
 6268  0000000                   	.ELSE
 6269  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High
 6270  0000000                   		ORA !BP0
 6271  0000000                   		ORA !BP0D
 6272  0000000                   	.ENDIF
 6273  0000000                   	STA !BP0
 6274  0000000                   BP0X_PWM_RAM_INIT_NEXT#:
 6275  0000000                   	LDA !DUTY_RAM		;duty,low level
 6276  0000000                   BP0X_PWM_RAM_INIT_CONST#:
 6277  0000000                   	STA !(PWV0+PWV_INDEX)
 6278  0000000                   	LDA !PWMC
 6279  0000000                   	AND #3FH
 6280  0000000                   	ORA #(DIVISION-1)*64	;division type
 6281  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6282  0000000                   	STA !PWMC
 6283  0000000                   
 6284  0000000                   	LDA !PWMC
 6285  0000000                   	BIT #PAIR_PWM
 6286  0000000                   	BEQ EN_BP0X_PWM_RAM_END#
 6287  0000000                   	LDA #BP0C_MODE
 6288  0000000                   	TRB !BP0C
 6289  0000000                   
 6290  0000000                   EN_BP0X_PWM_RAM_END#:
 6291  0000000                   	ENDM
 6292  0000000                   ;------------------------------------------------------------------------------		
 6293  0000000                   EN_BP0X_H_PWM MACRO BP0X_VALUE,PWV_INDEX,DUTY,DIVISION,PAIR_PWM,BP0C_MODE
 6294  0000000                   	LDA !BP0D
 6295  0000000                   	BIT #BP0X_VALUE
 6296  0000000                   	BNE BP0X_H_PWM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6297  0000000                   
 6298  0000000                   	LDA !BP0
 6299  0000000                   	BIT #BP0X_VALUE
 6300  0000000                   	BNE BP0X_H_PWM_INIT_NEXT#
 6301  0000000                   
 6302  0000000                   	LDA #DUTY
 6303  0000000                   	BRA BP0X_H_PWM_INIT_CONST#
 6304  0000000                   
 6305  0000000                   BP0X_H_PWM_INIT#:
 6306  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin
 6307  0000000                   	TRB !BP0D
 6308  0000000                   	.IFDEF       BPXM_RAM
 6309  0000000                   		TRB BP0M_BAK
 6310  0000000                   		LDA !BP0D
 6311  0000000                   		EOR #FFH
 6312  0000000                   		AND !BP0
 6313  0000000                   		ORA #BP0X_VALUE
 6314  0000000                   		ORA BP0M_BAK
 6315  0000000                   	.ELSE
 6316  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High





 6317  0000000                   		ORA !BP0
 6318  0000000                   		ORA !BP0D
 6319  0000000                   	.ENDIF
 6320  0000000                   	STA !BP0
 6321  0000000                   BP0X_H_PWM_INIT_NEXT#:
 6322  0000000                   	LDA #DUTY		;duty,low level
 6323  0000000                   	EOR #FFH
 6324  0000000                   BP0X_H_PWM_INIT_CONST#:
 6325  0000000                   	STA !(PWV0+PWV_INDEX)
 6326  0000000                   	LDA !PWMC
 6327  0000000                   	AND #3FH
 6328  0000000                   	ORA #(DIVISION-1)*64	;division type
 6329  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6330  0000000                   	STA !PWMC	
 6331  0000000                   
 6332  0000000                   	LDA !PWMC
 6333  0000000                   	BIT #PAIR_PWM
 6334  0000000                   	BEQ EN_BP0X_H_PWM_END#
 6335  0000000                   	LDA #BP0C_MODE
 6336  0000000                   	TRB !BP0C
 6337  0000000                   
 6338  0000000                   EN_BP0X_H_PWM_END#:
 6339  0000000                   	ENDM
 6340  0000000                   ;------------------------------------------------------------------------------	
 6341  0000000                   EN_BP0X_H_PWM_RAM MACRO BP0X_VALUE,PWV_INDEX,DUTY_RAM,DIVISION,PAIR_PWM,BP0C_MODE
 6342  0000000                   	LDA !BP0D
 6343  0000000                   	BIT #BP0X_VALUE
 6344  0000000                   	BNE BP0X_H_PWM_RAM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6345  0000000                   
 6346  0000000                   	LDA !BP0
 6347  0000000                   	BIT #BP0X_VALUE
 6348  0000000                   	BNE BP0X_H_PWM_RAM_INIT_NEXT#
 6349  0000000                   
 6350  0000000                   	LDA !DUTY_RAM
 6351  0000000                   	BRA BP0X_H_PWM_RAM_INIT_CONST#
 6352  0000000                   
 6353  0000000                   BP0X_H_PWM_RAM_INIT#:
 6354  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin
 6355  0000000                   	TRB !BP0D
 6356  0000000                   	.IFDEF       BPXM_RAM
 6357  0000000                   		TRB BP0M_BAK
 6358  0000000                   		LDA !BP0D
 6359  0000000                   		EOR #FFH
 6360  0000000                   		AND !BP0
 6361  0000000                   		ORA #BP0X_VALUE
 6362  0000000                   		ORA BP0M_BAK
 6363  0000000                   	.ELSE
 6364  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High
 6365  0000000                   		ORA !BP0
 6366  0000000                   		ORA !BP0D
 6367  0000000                   	.ENDIF
 6368  0000000                   	STA !BP0
 6369  0000000                   BP0X_H_PWM_RAM_INIT_NEXT#:
 6370  0000000                   	LDA !DUTY_RAM		;duty,low level
 6371  0000000                   	EOR #FFH
 6372  0000000                   BP0X_H_PWM_RAM_INIT_CONST#:
 6373  0000000                   	STA !(PWV0+PWV_INDEX)





 6374  0000000                   	LDA !PWMC
 6375  0000000                   	AND #3FH
 6376  0000000                   	ORA #(DIVISION-1)*64	;division type
 6377  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6378  0000000                   	STA !PWMC	
 6379  0000000                   
 6380  0000000                   	LDA !PWMC
 6381  0000000                   	BIT #PAIR_PWM
 6382  0000000                   	BEQ EN_BP0X_H_PWM_RAM_END#
 6383  0000000                   	LDA #BP0C_MODE
 6384  0000000                   	TRB !BP0C
 6385  0000000                   
 6386  0000000                   EN_BP0X_H_PWM_RAM_END#:
 6387  0000000                   	ENDM
 6388  0000000                   ;------------------------------------------------------------------------------	
 6389  0000000                   ;------------------------------------------------------------------------------	
 6390  0000000                   EN_BP00_PWM MACRO DUTY, DIVISION
 6391  0000000                   	EN_BP0X_PWM BP00_PWM,0,DUTY,DIVISION,BP01_PWM,BP00_MOTOR
 6392  0000000                   	ENDM
 6393  0000000                   ;------------------------------------------------------------------------------
 6394  0000000                   EN_BP00_H_PWM MACRO DUTY, DIVISION
 6395  0000000                   	EN_BP0X_H_PWM BP00_PWM,0,DUTY,DIVISION,BP01_PWM,BP00_MOTOR
 6396  0000000                   	ENDM
 6397  0000000                   ;------------------------------------------------------------------------------
 6398  0000000                   EN_BP00_PWM_RAM MACRO DUTY_RAM, DIVISION
 6399  0000000                   	EN_BP0X_PWM_RAM BP00_PWM,0,DUTY_RAM,DIVISION,BP01_PWM,BP00_MOTOR
 6400  0000000                   	ENDM
 6401  0000000                   ;-------------------------------------------------------------	
 6402  0000000                   EN_BP00_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6403  0000000                   	EN_BP0X_H_PWM_RAM BP00_PWM,0,DUTY_RAM,DIVISION,BP01_PWM,BP00_MOTOR
 6404  0000000                   	ENDM
 6405  0000000                   ;------------------------------------------------------------------------------	
 6406  0000000                   DIS_BP00_PWM MACRO
 6407  0000000                   	LDA #BP00_PWM		
 6408  0000000                   	TRB !PWMC
 6409  0000000                   	ENDM
 6410  0000000                   ;------------------------------------------------------------------------------	
 6411  0000000                   ;------------------------------------------------------------------------------	
 6412  0000000                   EN_BP01_PWM MACRO DUTY, DIVISION
 6413  0000000                   	EN_BP0X_PWM BP01_PWM,0,DUTY,DIVISION,BP00_PWM,BP01_MOTOR
 6414  0000000                   	ENDM
 6415  0000000                   ;------------------------------------------------------------------------------
 6416  0000000                   EN_BP01_H_PWM MACRO DUTY, DIVISION
 6417  0000000                   	EN_BP0X_H_PWM BP01_PWM,0,DUTY,DIVISION,BP00_PWM,BP01_MOTOR
 6418  0000000                   	ENDM
 6419  0000000                   ;------------------------------------------------------------------------------
 6420  0000000                   EN_BP01_PWM_RAM MACRO DUTY_RAM, DIVISION
 6421  0000000                   	EN_BP0X_PWM_RAM BP01_PWM,0,DUTY_RAM,DIVISION,BP00_PWM,BP01_MOTOR
 6422  0000000                   	ENDM
 6423  0000000                   ;-------------------------------------------------------------	
 6424  0000000                   EN_BP01_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6425  0000000                   	EN_BP0X_H_PWM_RAM BP01_PWM,0,DUTY_RAM,DIVISION,BP00_PWM,BP01_MOTOR
 6426  0000000                   	ENDM
 6427  0000000                   ;-------------------------------------------------------------		
 6428  0000000                   DIS_BP01_PWM MACRO
 6429  0000000                   	LDA #BP01_PWM		
 6430  0000000                   	TRB !PWMC





 6431  0000000                   	ENDM
 6432  0000000                   ;------------------------------------------------------------------------------	
 6433  0000000                   ;------------------------------------------------------------------------------	
 6434  0000000                   EN_BP02_PWM MACRO DUTY, DIVISION
 6435  0000000                   	EN_BP0X_PWM BP02_PWM,1,DUTY,DIVISION,BP03_PWM,BP02_MOTOR
 6436  0000000                   	ENDM
 6437  0000000                   ;------------------------------------------------------------------------------
 6438  0000000                   EN_BP02_H_PWM MACRO DUTY, DIVISION
 6439  0000000                   	EN_BP0X_H_PWM BP02_PWM,1,DUTY,DIVISION,BP03_PWM,BP02_MOTOR
 6440  0000000                   	ENDM
 6441  0000000                   ;------------------------------------------------------------------------------
 6442  0000000                   EN_BP02_PWM_RAM MACRO DUTY_RAM, DIVISION
 6443  0000000                   	EN_BP0X_PWM_RAM BP02_PWM,1,DUTY_RAM,DIVISION,BP03_PWM,BP02_MOTOR
 6444  0000000                   	ENDM
 6445  0000000                   ;-------------------------------------------------------------	
 6446  0000000                   EN_BP02_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6447  0000000                   	EN_BP0X_H_PWM_RAM BP02_PWM,1,DUTY_RAM,DIVISION,BP03_PWM,BP02_MOTOR
 6448  0000000                   	ENDM
 6449  0000000                   ;-------------------------------------------------------------		
 6450  0000000                   DIS_BP02_PWM MACRO
 6451  0000000                   	LDA #BP02_PWM		
 6452  0000000                   	TRB !PWMC
 6453  0000000                   	ENDM
 6454  0000000                   ;------------------------------------------------------------------------------	
 6455  0000000                   ;------------------------------------------------------------------------------	
 6456  0000000                   EN_BP03_PWM MACRO DUTY, DIVISION
 6457  0000000                   	EN_BP0X_PWM BP03_PWM,1,DUTY,DIVISION,BP02_PWM,BP03_MOTOR
 6458  0000000                   	ENDM
 6459  0000000                   ;------------------------------------------------------------------------------
 6460  0000000                   EN_BP03_H_PWM MACRO DUTY, DIVISION
 6461  0000000                   	EN_BP0X_H_PWM BP03_PWM,1,DUTY,DIVISION,BP02_PWM,BP03_MOTOR
 6462  0000000                   	ENDM
 6463  0000000                   ;------------------------------------------------------------------------------
 6464  0000000                   EN_BP03_PWM_RAM MACRO DUTY_RAM, DIVISION
 6465  0000000                   	EN_BP0X_PWM_RAM BP03_PWM,1,DUTY_RAM,DIVISION,BP02_PWM,BP03_MOTOR
 6466  0000000                   	ENDM
 6467  0000000                   ;-------------------------------------------------------------	
 6468  0000000                   EN_BP03_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6469  0000000                   	EN_BP0X_H_PWM_RAM BP03_PWM,1,DUTY_RAM,DIVISION,BP02_PWM,BP03_MOTOR
 6470  0000000                   	ENDM
 6471  0000000                   ;-------------------------------------------------------------		
 6472  0000000                   DIS_BP03_PWM MACRO
 6473  0000000                   	LDA #BP03_PWM		
 6474  0000000                   	TRB !PWMC
 6475  0000000                   	ENDM
 6476  0000000                   ;------------------------------------------------------------------------------	
 6477  0000000                   ;------------------------------------------------------------------------------	
 6478  0000000                   EN_BP04_PWM MACRO DUTY, DIVISION
 6479  0000000                   	EN_BP0X_PWM BP04_PWM,2,DUTY,DIVISION,BP05_PWM,BP04_MOTOR
 6480  0000000                   	ENDM
 6481  0000000                   ;------------------------------------------------------------------------------
 6482  0000000                   EN_BP04_H_PWM MACRO DUTY, DIVISION
 6483  0000000                   	EN_BP0X_H_PWM BP04_PWM,2,DUTY,DIVISION,BP05_PWM,BP04_MOTOR
 6484  0000000                   	ENDM
 6485  0000000                   ;------------------------------------------------------------------------------
 6486  0000000                   EN_BP04_PWM_RAM MACRO DUTY_RAM, DIVISION
 6487  0000000                   	EN_BP0X_PWM_RAM BP04_PWM,2,DUTY_RAM,DIVISION,BP05_PWM,BP04_MOTOR





 6488  0000000                   	ENDM
 6489  0000000                   ;-------------------------------------------------------------	
 6490  0000000                   EN_BP04_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6491  0000000                   	EN_BP0X_H_PWM_RAM BP04_PWM,2,DUTY_RAM,DIVISION,BP05_PWM,BP04_MOTOR
 6492  0000000                   	ENDM
 6493  0000000                   ;-------------------------------------------------------------		
 6494  0000000                   DIS_BP04_PWM MACRO
 6495  0000000                   	LDA #BP04_PWM		
 6496  0000000                   	TRB !PWMC
 6497  0000000                   	ENDM
 6498  0000000                   ;------------------------------------------------------------------------------	
 6499  0000000                   ;------------------------------------------------------------------------------	
 6500  0000000                   EN_BP05_PWM MACRO DUTY, DIVISION
 6501  0000000                   	EN_BP0X_PWM BP05_PWM,2,DUTY,DIVISION,BP04_PWM,BP05_MOTOR
 6502  0000000                   	ENDM
 6503  0000000                   ;------------------------------------------------------------------------------
 6504  0000000                   EN_BP05_H_PWM MACRO DUTY, DIVISION
 6505  0000000                   	EN_BP0X_H_PWM BP05_PWM,2,DUTY,DIVISION,BP04_PWM,BP05_MOTOR
 6506  0000000                   	ENDM
 6507  0000000                   ;------------------------------------------------------------------------------
 6508  0000000                   EN_BP05_PWM_RAM MACRO DUTY_RAM, DIVISION
 6509  0000000                   	EN_BP0X_PWM_RAM BP05_PWM,2,DUTY_RAM,DIVISION,BP04_PWM,BP05_MOTOR
 6510  0000000                   	ENDM
 6511  0000000                   ;-------------------------------------------------------------	
 6512  0000000                   EN_BP05_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6513  0000000                   	EN_BP0X_H_PWM_RAM BP05_PWM,2,DUTY_RAM,DIVISION,BP04_PWM,BP05_MOTOR
 6514  0000000                   	ENDM
 6515  0000000                   ;-------------------------------------------------------------		
 6516  0000000                   DIS_BP05_PWM MACRO
 6517  0000000                   	LDA #BP05_PWM		
 6518  0000000                   	TRB !PWMC
 6519  0000000                   	ENDM
 6520  0000000                   ;===============================================================================
 6521  0000000                   ;===============================================================================
 6522  0000000                   RAMP_UP MACRO
 6523  0000000                   	STZ !SP0ALT
 6524  0000000                   	.IF	(CHIPSERIES = 'N588J')
 6525  0000000                   	.ELSE
 6526  0000000                   		STZ !SP0BLT
 6527  0000000                   		STZ !SP0CLT
 6528  0000000                   	.ENDIF
 6529  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 6530  0000000                   		STZ !SP0AL
 6531  0000000                   		.IF	(CHIPSERIES = 'N588J')
 6532  0000000                   		.ELSE
 6533  0000000                   			STZ !SP0BL
 6534  0000000                   			STZ !SP0CL
 6535  0000000                   		.ENDIF
 6536  0000000                   	.ENDIF
 6537  0000000                   
 6538  0000000                   	LDA #80H	
 6539  0000000                   	STA !SP0AT	
 6540  0000000                   	.IF	(CHIPSERIES = 'N588J')
 6541  0000000                   	.ELSE
 6542  0000000                   		STA !SP0BT	
 6543  0000000                   		STA !SP0CT
 6544  0000000                   	.ENDIF





 6545  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 6546  0000000                   		STA !SP0A
 6547  0000000                   		.IF	(CHIPSERIES = 'N588J')
 6548  0000000                   		.ELSE
 6549  0000000                   			STA !SP0B
 6550  0000000                   			STA !SP0C	
 6551  0000000                   		.ENDIF
 6552  0000000                   	.ENDIF
 6553  0000000                   
 6554  0000000                   	OPEN_SPEN
 6555  0000000                   
 6556  0000000                   .IF	 (WITH_DAC_ENABLE .EQ. 1)
 6557  0000000                   	LDA !SPEN
 6558  0000000                   	AND #WITH_SPEN_EFFECTIVE_BITS
 6559  0000000                   	BIT #SPEN_DAC
 6560  0000000                   	BEQ RAMP_UP_END#
 6561  0000000                   
 6562  0000000                   RAMP_UP_NEXT#:
 6563  0000000                   	LDA !RAMP			
 6564  0000000                   	BMI RAMP_UP_END#
 6565  0000000                   
 6566  0000000                   	.IFDEF WDTIMER
 6567  0000000                   	.IFDEF LVDEN
 6568  0000000                   		LDA #CTL_CPU_WDT
 6569  0000000                   		TSB RAM_CTL_CPU
 6570  0000000                   		LDA RAM_CTL_CPU
 6571  0000000                   		STA !CTL_CPU
 6572  0000000                   	.ELSE
 6573  0000000                   		LDA #CTL_CPU_WDT
 6574  0000000                   		TSB !CTL_CPU
 6575  0000000                   	.ENDIF 	
 6576  0000000                   	.ENDIF
 6577  0000000                   	LDY #60H
 6578  0000000                   	DEY
 6579  0000000                   	BNE -3
 6580  0000000                   
 6581  0000000                   	INC !RAMP
 6582  0000000                   	BRA RAMP_UP_NEXT#
 6583  0000000                   .ENDIF
 6584  0000000                   RAMP_UP_END#:
 6585  0000000                   	ENDM
 6586  0000000                   ;------------------------------------------------------------------------------
 6587  0000000                   RAMP_DOWN MACRO
 6588  0000000                   .IF	 (WITH_DAC_ENABLE .EQ. 1)
 6589  0000000                   	LDA !SPEN			;only pwm
 6590  0000000                   	AND #WITH_SPEN_EFFECTIVE_BITS
 6591  0000000                   	BIT #SPEN_DAC
 6592  0000000                   	BEQ RAMP_DOWN_END#
 6593  0000000                   
 6594  0000000                   RAMP_DOWN_NEXT#:
 6595  0000000                   	LDA !RAMP
 6596  0000000                   	BEQ RAMP_DOWN_END#
 6597  0000000                   
 6598  0000000                   	.IFDEF WDTIMER
 6599  0000000                   	.IFDEF LVDEN
 6600  0000000                   		LDA #CTL_CPU_WDT
 6601  0000000                   		TSB RAM_CTL_CPU





 6602  0000000                   		LDA RAM_CTL_CPU
 6603  0000000                   		STA !CTL_CPU
 6604  0000000                   	.ELSE
 6605  0000000                   		LDA #CTL_CPU_WDT
 6606  0000000                   		TSB !CTL_CPU
 6607  0000000                   	.ENDIF 	
 6608  0000000                   	.ENDIF	
 6609  0000000                   	LDY #60H
 6610  0000000                   	DEY
 6611  0000000                   	BNE -3
 6612  0000000                   
 6613  0000000                   	DEC !RAMP
 6614  0000000                   	BRA RAMP_DOWN_NEXT#
 6615  0000000                   .ENDIF
 6616  0000000                   RAMP_DOWN_END#:
 6617  0000000                   	CLOSE_SPEN
 6618  0000000                   	ENDM
 6619  0000000                   ;===============================================================================
 6620  0000000                   ;===============================================================================
 6621  0000000                   .IFDEF WITH_USER_PLAY
 6622  0000000                   INIT_DECODE_SPEECH8	MACRO	SPEECH_START
 6623  0000000                   	PSF_RESPONSE_LIMIT
 6624  0000000                   ;	PHP
 6625  0000000                   	PHA
 6626  0000000                   	PHX
 6627  0000000                   	PHY
 6628  0000000                   ;	SEI	
 6629  0000000                   
 6630  0000000                   	LDA	#.LOW.SPEECH_START
 6631  0000000                   	STA <USER_PLAY_DATA_ADDR
 6632  0000000                   	LDA	#.HIGH.SPEECH_START
 6633  0000000                   	STA <USER_PLAY_DATA_ADDR+1	
 6634  0000000                   	LDA	#.HIGH8.SPEECH_START
 6635  0000000                   	STA <USER_PLAY_BANK_ADDR
 6636  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6637  0000000                   	LDA	#.SEGHIGH.SPEECH_START
 6638  0000000                   	STA  <USER_PLAY_BANK_ADDR+1
 6639  0000000                   	.ENDIF
 6640  0000000                   	.IF (WITH_USER_PLAY_VOL_ADJ .EQ. 1H)
 6641  0000000                   	LDA #10H
 6642  0000000                   	STA <USER_PLAY_SP_VOLUME
 6643  0000000                   	.ENDIF
 6644  0000000                   
 6645  0000000                   	JSR PLAY_PHRASE_PROCEDURE
 6646  0000000                   
 6647  0000000                   	PLY
 6648  0000000                   	PLX
 6649  0000000                   	PLA
 6650  0000000                   ;	PLP
 6651  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6652  0000000                   	ENDM
 6653  0000000                   ;------------------------------------------------------------------------------	
 6654  0000000                   DECODE_ONE_SAMPLE MACRO
 6655  0000000                   	EXTERN	DECODE_ONE_SAMPLE_CH1
 6656  0000000                   	PSF_RESPONSE_LIMIT_JSR DECODE_ONE_SAMPLE_CH1
 6657  0000000                   	ENDM
 6658  0000000                   ;------------------------------------------------------------------------------





 6659  0000000                   SET_DECODE_VOL MACRO VOLUME_VALUE
 6660  0000000                   .IF (WITH_USER_PLAY_VOL_ADJ .EQ. 1)
 6661  0000000                   	LDA #VOLUME_VALUE
 6662  0000000                   	ASL A
 6663  0000000                   	STA <CH_R_FINAL_VOLUME_SP+VS0A_START
 6664  0000000                   .ENDIF
 6665  0000000                   	ENDM
 6666  0000000                   ;------------------------------------------------------------------------------
 6667  0000000                   SET_DECODE_VOL_RAM MACRO VOLUME_RAM
 6668  0000000                   .IF (WITH_USER_PLAY_VOL_ADJ .EQ. 1)
 6669  0000000                   	LDA VOLUME_RAM
 6670  0000000                   	ASL A
 6671  0000000                   	STA <CH_R_FINAL_VOLUME_SP+VS0A_START
 6672  0000000                   .ENDIF
 6673  0000000                   	ENDM
 6674  0000000                   .ELSE
 6675  0000000                   ;==============================================================================
 6676  0000000                   ;==============================================================================
 6677  0000000                   FXF13_ISR_PROC MACRO 
 6678  0000000                   ;------------------EVO PROC----------------------------
 6679  0000000                   	.IF (WITH_EVO .EQ. 1)
 6680  0000000                   			LDA <GLOBAL_PLAY
 6681  0000000                   			BIT #(EVO1_BZ+EVO2_BZ+EVO3_BZ)
 6682  0000000                   			BEQ FXF13_ISR_PROC_EVO_END#
 6683  0000000                   
 6684  0000000                   			EXTERN ISR_EVO_PROC
 6685  0000000                   			JMP ISR_EVO_PROC
 6686  0000000                   FXF13_ISR_PROC_EVO_END#:			
 6687  0000000                   	.ENDIF
 6688  0000000                   
 6689  0000000                   	PUBLIC FXF13_ISR_PROC_NEXT
 6690  0000000                   FXF13_ISR_PROC_NEXT:
 6691  0000000                   ;------------------MS PROC-----------------------------
 6692  0000000                   	.IF (WITH_MS .EQ. 1H)
 6693  0000000                   		EXTERN		RELOAD_FXF_ISR_DELAY_COUNT
 6694  0000000                   		LDA <GLOBAL_PLAY
 6695  0000000                   		BIT #MS_EXT
 6696  0000000                   		BNE FXF13_ISR_PROC_MS_CONT#
 6697  0000000                   		LDA <MS_START+CH_STATUS_MS
 6698  0000000                   		BIT #MS_BZ
 6699  0000000                   		BEQ FXF13_ISR_PROC_MS_END#		
 6700  0000000                   ;BIT #MS_PS
 6701  0000000                   ;BNE FXF13_ISR_PROC_MS_END#
 6702  0000000                   FXF13_ISR_PROC_MS_CONT#:
 6703  0000000                   		JMP RELOAD_FXF_ISR_DELAY_COUNT
 6704  0000000                   FXF13_ISR_PROC_MS_END#:		
 6705  0000000                   	.ENDIF	
 6706  0000000                   	ENDM
 6707  0000000                   ;------------------------------------------------------------------------------
 6708  0000000                   
 6709  0000000                   
 6710  0000000                   QUIT_LIB_FXF_ISR_CONT  MACRO
 6711  0000000                   ;------------------CHECK EVO BUSY----------------------
 6712  0000000                   	.IF (WITH_EVO .EQ. 1)
 6713  0000000                   			LDA <GLOBAL_PLAY
 6714  0000000                   			BIT #(EVO1_BZ+EVO2_BZ+EVO3_BZ)
 6715  0000000                   			BNE QUIT_LIB_FXF_ISR_CONT_END#





 6716  0000000                   	.ENDIF
 6717  0000000                   ;------------------CHECK MS_EXT BUSY-------------------
 6718  0000000                   	.IF (WITH_MS .EQ. 1H)	
 6719  0000000                   			LDA <GLOBAL_PLAY
 6720  0000000                   			BIT #MS_EXT
 6721  0000000                   			BNE QUIT_LIB_FXF_ISR_CONT_END#
 6722  0000000                   			LDA <MS_START+CH_STATUS_MS	
 6723  0000000                   			BIT #MS_BZ
 6724  0000000                   			BNE QUIT_LIB_FXF_ISR_CONT_END#
 6725  0000000                   	.ENDIF 
 6726  0000000                   
 6727  0000000                   	LDA #INT0_FXF13
 6728  0000000                   	TRB !IEF0
 6729  0000000                   	STA !EFC0
 6730  0000000                   
 6731  0000000                   QUIT_LIB_FXF_ISR_CONT_END#:
 6732  0000000                   	ENDM
 6733  0000000                   ;==============================================================================
 6734  0000000                   ;==============================================================================
 6735  0000000                   SP_VOLUME_REDUCE MACRO
 6736  0000000                   	.IF (WITH_VOL_REDUCE .EQ. 1)
 6737  0000000                   ;timer index
 6738  0000000                   	PLY 
 6739  0000000                   ;
 6740  0000000                   ;;update by angela 2006.03.03 for bug 0001117,0001142
 6741  0000000                   ;	EXTERN SP_TM_CH_MAP_TABLE
 6742  0000000                   ;	LDX !SP_TM_CH_MAP_TABLE,Y
 6743  0000000                   ;	TXA
 6744  0000000                   ;	TAY	
 6745  0000000                   ;	LDA !SP_CHANNEL_ADDR_TABLE, Y
 6746  0000000                   ;;update by angela 2006.03.03 for bug 0001117,0001142
 6747  0000000                   ;	BEQ END_VOL#
 6748  0000000                   ;	TAX
 6749  0000000                   ;	LDA <CH_STATUS_SP,X
 6750  0000000                   ;	BIT #(SP_DC_RAMP_UP+SP_DC_RAMP_DOWN+SP_ADSR)
 6751  0000000                   ;	BNE END_VOL#
 6752  0000000                   ;		
 6753  0000000                   ;	TYA		
 6754  0000000                   ;	INC A
 6755  0000000                   ;	BIT <COMMON_FLAG
 6756  0000000                   ;	BEQ END_VOL#
 6757  0000000                   ;		
 6758  0000000                   ;	.IF (WITH_T_BUFFER .EQ. 0)
 6759  0000000                   ;	LDA <CH_SP_PCM_TEMP_SP+1,X
 6760  0000000                   ;	.ELSE
 6761  0000000                   ;	EXTERN SP_HI_T_INDEX_TABLE
 6762  0000000                   ;	LDX !SP_HI_T_INDEX_TABLE,Y
 6763  0000000                   ;	LDA !SP_HI_T_START_ADDR,X
 6764  0000000                   ;	.ENDIF
 6765  0000000                   ;	EOR #80H
 6766  0000000                   ;
 6767  0000000                   ;	BMI NEG_PCM#
 6768  0000000                   ;	CLC
 6769  0000000                   ;	BRA STORE_REDUCE_VOL#
 6770  0000000                   ;NEG_PCM#:
 6771  0000000                   ;	SEC
 6772  0000000                   ;





 6773  0000000                   ;STORE_REDUCE_VOL#:
 6774  0000000                   ;	ROR A
 6775  0000000                   ;	EOR #80H
 6776  0000000                   ;	.IF (WITH_T_BUFFER .EQ. 0)
 6777  0000000                   ;	STA <CH_SP_PCM_TEMP_SP+1,X
 6778  0000000                   ;	.ELSE
 6779  0000000                   ;	STA !SP_HI_T_START_ADDR,X
 6780  0000000                   ;	.ENDIF
 6781  0000000                   ;
 6782  0000000                   ;	.IF (WITH_PCM_OUTPUT_SIZE .EQ. 2)
 6783  0000000                   ;	.IF(WITH_T_BUFFER .EQ. 0)
 6784  0000000                   ;	ROR <CH_SP_PCM_TEMP_SP,X
 6785  0000000                   ;	.ELSE
 6786  0000000                   ;	EXTERN SP_LO_T_INDEX_TABLE
 6787  0000000                   ;	LDX !SP_LO_T_INDEX_TABLE,Y
 6788  0000000                   ;	.IF (WITH_SP0XL_RESOLUTION .EQ. 1)
 6789  0000000                   ;		ROR !SP_LO_T_START_ADDR,X
 6790  0000000                   ;	.ENDIF
 6791  0000000                   ;	.IF (WITH_SP0XL_RESOLUTION .EQ. 2)
 6792  0000000                   ;		LDA !SP_LO_T_START_ADDR,X
 6793  0000000                   ;		ROR A
 6794  0000000                   ;		AND #FCH
 6795  0000000                   ;		STA !SP_LO_T_START_ADDR,X
 6796  0000000                   ;	.ENDIF
 6797  0000000                   ;	.IF (WITH_SP0XL_RESOLUTION .EQ. 3)
 6798  0000000                   ;		LDA !SP_LO_T_START_ADDR,X
 6799  0000000                   ;		ROR A
 6800  0000000                   ;		AND #F0H
 6801  0000000                   ;		STA !SP_LO_T_START_ADDR,X
 6802  0000000                   ;	.ENDIF
 6803  0000000                   ;	.ENDIF
 6804  0000000                   ;	.ENDIF
 6805  0000000                   ;END_VOL#:	
 6806  0000000                   	.ENDIF
 6807  0000000                   	ENDM
 6808  0000000                   ;==============================================================================
 6809  0000000                   ;==============================================================================
 6810  0000000                   TAIL_ON MACRO                                                                   
 6811  0000000                   	.IF (WITH_SP .EQ. 1) .OR. (WITH_MS .EQ. 1)
 6812  0000000                   	LDA #TAIL_OFF_DAC	
 6813  0000000                   	TRB <COMMON_FLAG
 6814  0000000                   	.ENDIF
 6815  0000000                   	ENDM
 6816  0000000                   ;------------------------------------------------------------------------------
 6817  0000000                   TAIL_OFF MACRO
 6818  0000000                   	.IF (WITH_SP .EQ. 1).OR.(WITH_MS .EQ. 1)
 6819  0000000                   	LDA #TAIL_OFF_DAC
 6820  0000000                   	TSB <COMMON_FLAG
 6821  0000000                   	.ENDIF
 6822  0000000                   	ENDM	
 6823  0000000                   ;==============================================================================
 6824  0000000                   ;==============================================================================
 6825  0000000                   .IF ((WITH_NOISE_SHAPING .EQ. 1)||(WITH_NOISE_SHAPING .EQ. 2))
 6826  0000000                   NOISE_SHAPING_ON MACRO SP_SR                           
 6827  0000000                   ;	SET_PWM_MODE_SP SP_SR
 6828  0000000                   ;	EXTERN OPEN_NOISE_SHAPING
 6829  0000000                   ;	JSR OPEN_NOISE_SHAPING		





 6830  0000000                   	ENDM
 6831  0000000                   ;------------------------------------------------------------------------------
 6832  0000000                   NOISE_SHAPING_OFF MACRO
 6833  0000000                   ;	EXTERN CLOSE_NOISE_SHAPING
 6834  0000000                   ;	JSR CLOSE_NOISE_SHAPING
 6835  0000000                   	ENDM
 6836  0000000                   .ENDIF	
 6837  0000000                   ;==============================================================================
 6838  0000000                   ;==============================================================================
 6839  0000000                   PLAY8	MACRO	SENTENCE_START
 6840  0000000                   	PSF_RESPONSE_LIMIT
 6841  0000000                   	PHP
 6842  0000000                   	SEI
 6843  0000000                   	PHA
 6844  0000000                   	PHX
 6845  0000000                   	PHY
 6846  0000000                   
 6847  0000000                   	LDA	#.LOW.SENTENCE_START
 6848  0000000                   	STA <TEMP_REG1
 6849  0000000                   	LDA	#.HIGH.SENTENCE_START
 6850  0000000                   	STA <TEMP_REG1+1
 6851  0000000                   
 6852  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6853  0000000                   	STA <TEMP_REG2
 6854  0000000                   
 6855  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6856  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6857  0000000                   	STA  <TEMP_REG2+1
 6858  0000000                   	.ENDIF
 6859  0000000                   
 6860  0000000                   	JSR PLAY_PHRASE_PROCEDURE;_IOSPI
 6861  0000000                   
 6862  0000000                   	PLY
 6863  0000000                   	PLX
 6864  0000000                   	PLA
 6865  0000000                   	PLP
 6866  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6867  0000000                   	ENDM
 6868  0000000                   ;------------------------------------------------------------------------------
 6869  0000000                   PLAY8_EXT_SPI	MACRO	SENTENCE_START
 6870  0000000                   	PSF_RESPONSE_LIMIT
 6871  0000000                   	PHP
 6872  0000000                   	SEI
 6873  0000000                   	PHA
 6874  0000000                   	PHX
 6875  0000000                   	PHY
 6876  0000000                   
 6877  0000000                   	.IFDEF       BPXM_RAM
 6878  0000000                   	LDA <BP0M_BAK
 6879  0000000                   	AND #BPn_SPI_MASK_1
 6880  0000000                   	ORA #BPn_SPI_MASK_2
 6881  0000000                   	STA <BP0M_BAK
 6882  0000000                   	.ENDIF
 6883  0000000                   
 6884  0000000                   	LDA	#.LOW.SENTENCE_START
 6885  0000000                   	STA <TEMP_REG1
 6886  0000000                   	LDA	#.HIGH.SENTENCE_START





 6887  0000000                   	STA <TEMP_REG1+1
 6888  0000000                   
 6889  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6890  0000000                   	STA <TEMP_REG2
 6891  0000000                   
 6892  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6893  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6894  0000000                   	STA  <TEMP_REG2+1
 6895  0000000                   	.ENDIF
 6896  0000000                   
 6897  0000000                   	JSR PLAY_PHRASE_PROCEDURE_IOSPI
 6898  0000000                   
 6899  0000000                   	PLY
 6900  0000000                   	PLX
 6901  0000000                   	PLA
 6902  0000000                   	PLP
 6903  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6904  0000000                   	ENDM
 6905  0000000                   ;------------------------------------------------------------------------------
 6906  0000000                   PLAY8TAILON	MACRO	SENTENCE_START
 6907  0000000                   	PSF_RESPONSE_LIMIT
 6908  0000000                   	PHP
 6909  0000000                   	SEI
 6910  0000000                   	PHA
 6911  0000000                   	PHX
 6912  0000000                   	PHY
 6913  0000000                   
 6914  0000000                   	LDA	#.LOW.SENTENCE_START
 6915  0000000                   	STA <TEMP_REG1
 6916  0000000                   	LDA	#.HIGH.SENTENCE_START
 6917  0000000                   	STA <TEMP_REG1+1
 6918  0000000                   
 6919  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6920  0000000                   	STA <TEMP_REG2
 6921  0000000                   
 6922  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6923  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6924  0000000                   	STA  <TEMP_REG2+1
 6925  0000000                   	.ENDIF
 6926  0000000                   
 6927  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 6928  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_ON
 6929  0000000                   	JSR PRE_PLAY_PHRASE_TAIL_ON
 6930  0000000                   
 6931  0000000                   	PLY
 6932  0000000                   	PLX
 6933  0000000                   	PLA
 6934  0000000                   	PLP
 6935  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6936  0000000                   	ENDM	
 6937  0000000                   ;------------------------------------------------------------------------------
 6938  0000000                   PLAY8TAILOFF	MACRO	SENTENCE_START
 6939  0000000                   	PSF_RESPONSE_LIMIT
 6940  0000000                   	PHP
 6941  0000000                   	SEI
 6942  0000000                   	PHA
 6943  0000000                   	PHX





 6944  0000000                   	PHY
 6945  0000000                   
 6946  0000000                   	LDA	#.LOW.SENTENCE_START
 6947  0000000                   	STA <TEMP_REG1
 6948  0000000                   	LDA	#.HIGH.SENTENCE_START
 6949  0000000                   	STA <TEMP_REG1+1
 6950  0000000                   
 6951  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6952  0000000                   	STA <TEMP_REG2
 6953  0000000                   
 6954  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6955  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6956  0000000                   	STA  <TEMP_REG2+1
 6957  0000000                   	.ENDIF
 6958  0000000                   
 6959  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 6960  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_OFF
 6961  0000000                   	JSR PRE_PLAY_PHRASE_TAIL_OFF
 6962  0000000                   
 6963  0000000                   	PLY
 6964  0000000                   	PLX
 6965  0000000                   	PLA
 6966  0000000                   	PLP
 6967  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6968  0000000                   	ENDM	
 6969  0000000                   ;------------------------------------------------------------------------------
 6970  0000000                   .IF(WITH_PLAYE .EQ. 1)
 6971  0000000                   PLAY8E	MACRO	SENTENCE_START
 6972  0000000                   	PSF_RESPONSE_LIMIT
 6973  0000000                   	PHP
 6974  0000000                   	SEI
 6975  0000000                   	PHA
 6976  0000000                   	PHX
 6977  0000000                   	PHY
 6978  0000000                   
 6979  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)	
 6980  0000000                   	LDA <TEMP_REG1
 6981  0000000                   	PHA
 6982  0000000                   	LDA <TEMP_REG1+1
 6983  0000000                   	PHA
 6984  0000000                   	LDA <TEMP_REG2
 6985  0000000                   	PHA
 6986  0000000                   	LDA <TEMP_REG2+1
 6987  0000000                   	PHA
 6988  0000000                   	.ENDIF
 6989  0000000                   
 6990  0000000                   	LDA	#.LOW.SENTENCE_START
 6991  0000000                   	STA <TEMP_REG1
 6992  0000000                   	LDA	#.HIGH.SENTENCE_START
 6993  0000000                   	STA <TEMP_REG1+1
 6994  0000000                   
 6995  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6996  0000000                   	STA <TEMP_REG2
 6997  0000000                   
 6998  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6999  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 7000  0000000                   	STA  <TEMP_REG2+1





 7001  0000000                   	.ENDIF
 7002  0000000                   
 7003  0000000                   	JSR PLAY_PHRASE_PROCEDURE
 7004  0000000                   
 7005  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)
 7006  0000000                   	PLA
 7007  0000000                   	STA <TEMP_REG2+1
 7008  0000000                   	PLA
 7009  0000000                   	STA <TEMP_REG2
 7010  0000000                   	PLA
 7011  0000000                   	STA <TEMP_REG1+1
 7012  0000000                   	PLA
 7013  0000000                   	STA <TEMP_REG1
 7014  0000000                   	.ENDIF
 7015  0000000                   
 7016  0000000                   	PLY
 7017  0000000                   	PLX
 7018  0000000                   	PLA
 7019  0000000                   	PLP
 7020  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7021  0000000                   	ENDM
 7022  0000000                   ;------------------------------------------------------------------------------	
 7023  0000000                   PLAY8ETAILON	MACRO	SENTENCE_START
 7024  0000000                   	PSF_RESPONSE_LIMIT
 7025  0000000                   	PHP
 7026  0000000                   	SEI
 7027  0000000                   	PHA
 7028  0000000                   	PHX
 7029  0000000                   	PHY
 7030  0000000                   
 7031  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)	
 7032  0000000                   	LDA <TEMP_REG1
 7033  0000000                   	PHA
 7034  0000000                   	LDA <TEMP_REG1+1
 7035  0000000                   	PHA
 7036  0000000                   	LDA <TEMP_REG2
 7037  0000000                   	PHA
 7038  0000000                   	LDA <TEMP_REG2+1
 7039  0000000                   	PHA
 7040  0000000                   	.ENDIF
 7041  0000000                   
 7042  0000000                   	LDA	#.LOW.SENTENCE_START
 7043  0000000                   	STA <TEMP_REG1
 7044  0000000                   	LDA	#.HIGH.SENTENCE_START
 7045  0000000                   	STA <TEMP_REG1+1
 7046  0000000                   
 7047  0000000                   	LDA	#.HIGH8.SENTENCE_START
 7048  0000000                   	STA <TEMP_REG2
 7049  0000000                   
 7050  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 7051  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 7052  0000000                   	STA  <TEMP_REG2+1
 7053  0000000                   	.ENDIF
 7054  0000000                   
 7055  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 7056  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_ON
 7057  0000000                   	JSR  PRE_PLAY_PHRASE_TAIL_ON





 7058  0000000                   
 7059  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)
 7060  0000000                   	PLA
 7061  0000000                   	STA <TEMP_REG2+1
 7062  0000000                   	PLA
 7063  0000000                   	STA <TEMP_REG2
 7064  0000000                   	PLA
 7065  0000000                   	STA <TEMP_REG1+1
 7066  0000000                   	PLA
 7067  0000000                   	STA <TEMP_REG1
 7068  0000000                   	.ENDIF
 7069  0000000                   
 7070  0000000                   	PLY
 7071  0000000                   	PLX
 7072  0000000                   	PLA
 7073  0000000                   	PLP
 7074  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7075  0000000                   	ENDM
 7076  0000000                   ;------------------------------------------------------------------------------
 7077  0000000                   PLAY8ETAILOFF	MACRO	SENTENCE_START
 7078  0000000                   	PSF_RESPONSE_LIMIT
 7079  0000000                   	PHP
 7080  0000000                   	SEI
 7081  0000000                   	PHA
 7082  0000000                   	PHX
 7083  0000000                   	PHY
 7084  0000000                   
 7085  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)	
 7086  0000000                   	LDA <TEMP_REG1
 7087  0000000                   	PHA
 7088  0000000                   	LDA <TEMP_REG1+1
 7089  0000000                   	PHA
 7090  0000000                   	LDA <TEMP_REG2
 7091  0000000                   	PHA
 7092  0000000                   	LDA <TEMP_REG2+1
 7093  0000000                   	PHA
 7094  0000000                   	.ENDIF
 7095  0000000                   
 7096  0000000                   	LDA	#.LOW.SENTENCE_START
 7097  0000000                   	STA <TEMP_REG1
 7098  0000000                   	LDA	#.HIGH.SENTENCE_START
 7099  0000000                   	STA <TEMP_REG1+1
 7100  0000000                   
 7101  0000000                   	LDA	#.HIGH8.SENTENCE_START
 7102  0000000                   	STA <TEMP_REG2
 7103  0000000                   
 7104  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 7105  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 7106  0000000                   	STA  <TEMP_REG2+1
 7107  0000000                   	.ENDIF
 7108  0000000                   
 7109  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 7110  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_OFF
 7111  0000000                   	JSR  PRE_PLAY_PHRASE_TAIL_OFF
 7112  0000000                   
 7113  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)
 7114  0000000                   	PLA





 7115  0000000                   	STA <TEMP_REG2+1
 7116  0000000                   	PLA
 7117  0000000                   	STA <TEMP_REG2
 7118  0000000                   	PLA
 7119  0000000                   	STA <TEMP_REG1+1
 7120  0000000                   	PLA
 7121  0000000                   	STA <TEMP_REG1
 7122  0000000                   	.ENDIF
 7123  0000000                   
 7124  0000000                   	PLY
 7125  0000000                   	PLX
 7126  0000000                   	PLA
 7127  0000000                   	PLP
 7128  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7129  0000000                   	ENDM
 7130  0000000                   .ENDIF
 7131  0000000                   ;==============================================================================
 7132  0000000                   ;==============================================================================
 7133  0000000                   STOP_PLAY_SP_CHANNEL MACRO CHANNEL
 7134  0000000                   .IF(WITH_SP .EQ. 1)
 7135  0000000                   	PSF_RESPONSE_LIMIT
 7136  0000000                   	LDY #CHANNEL
 7137  0000000                   	EXTERNAL SP_CHANNEL_ADDR_TABLE
 7138  0000000                   	EXTERN STOP_PLAY_Y_SP_API
 7139  0000000                   	JSR STOP_PLAY_Y_SP_API 
 7140  0000000                   
 7141  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7142  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7143  0000000                   .ENDIF	
 7144  0000000                   	ENDM	
 7145  0000000                   ;------------------------------------------------------------------------------
 7146  0000000                   STOP_PLAY_EVO_CHANNEL MACRO CHANNEL
 7147  0000000                   .IF(WITH_EVO .EQ. 1)
 7148  0000000                   	PSF_RESPONSE_LIMIT
 7149  0000000                   	LDY #CHANNEL
 7150  0000000                   	EXTERNAL EVO_CHANNEL_ADDR_TABLE
 7151  0000000                   	EXTERN STOP_PLAY_Y_EVO_API
 7152  0000000                   	JSR STOP_PLAY_Y_EVO_API
 7153  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7154  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7155  0000000                   .ENDIF	
 7156  0000000                   	ENDM	
 7157  0000000                   ;------------------------------------------------------------------------------
 7158  0000000                   STOP_PLAY_MS MACRO
 7159  0000000                   .IF(WITH_MS .EQ. 1)
 7160  0000000                   	PSF_RESPONSE_LIMIT
 7161  0000000                   	EXTERN MS_CHANNEL_ADDR_TABLE
 7162  0000000                   	EXTERN STOP_PLAY_ALL_MS_API
 7163  0000000                   	JSR STOP_PLAY_ALL_MS_API
 7164  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7165  0000000                   .ENDIF	
 7166  0000000                   	ENDM
 7167  0000000                   ;------------------------------------------------------------------------------
 7168  0000000                   STOP_PLAY_ALL MACRO
 7169  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 7170  0000000                   .ELSE
 7171  0000000                   	PSF_RESPONSE_LIMIT





 7172  0000000                   	EXTERNAL SP_CHANNEL_ADDR_TABLE
 7173  0000000                   	EXTERNAL EVO_CHANNEL_ADDR_TABLE
 7174  0000000                   	EXTERNAL MS_MLDY_START_ADDR_TABLE
 7175  0000000                   	EXTERN STOP_PLAY_ALL_API
 7176  0000000                   	JSR STOP_PLAY_ALL_API
 7177  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7178  0000000                   .ENDIF	
 7179  0000000                   	ENDM
 7180  0000000                   ;==============================================================================
 7181  0000000                   ; Play Pause for Speech Channel: To set SP_PAUSE bit in 
 7182  0000000                   ; Check if speech channel, if not don't pause 
 7183  0000000                   ;==============================================================================
 7184  0000000                   .IF (WITH_PAUSE_RESUME .EQ. 1H)
 7185  0000000                   PAUSE_PLAY_Y_SP MACRO 
 7186  0000000                   	.IF (WITH_SP .EQ. 1H)
 7187  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7188  0000000                   		BEQ _@PAUSE_SP_END_#
 7189  0000000                   		LDA <CH_STATUS_SP,X
 7190  0000000                   		BIT #SP_BZ
 7191  0000000                   		BEQ _@PAUSE_SP_END_#
 7192  0000000                   ; check if play speech
 7193  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7194  0000000                   		BNE _@PAUSE_SP_END_#
 7195  0000000                   _@PAUSE_SPEECH_#:
 7196  0000000                   		BIT #SP_RESUME
 7197  0000000                   		BNE _@PAUSE_SPEECH_RESUME_DOING	
 7198  0000000                   		ORA #SP_PAUSE
 7199  0000000                   		STA <CH_STATUS_SP,X
 7200  0000000                   
 7201  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
 7202  0000000                   		LDA <CH_PREVIOUS_PCM_SP,X
 7203  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7204  0000000                   		LDA <CH_PREVIOUS_PCM_SP+1,X
 7205  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7206  0000000                   		.ELSE
 7207  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP,X
 7208  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7209  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP+1,X
 7210  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7211  0000000                   		.ENDIF
 7212  0000000                   		BRA _@PAUSE_SP_END_#
 7213  0000000                   
 7214  0000000                   _@PAUSE_SPEECH_RESUME_DOING:
 7215  0000000                   		AND #(FFH^SP_RESUME)
 7216  0000000                   		ORA #SP_PAUSE
 7217  0000000                   		STA <CH_STATUS_SP,X
 7218  0000000                   
 7219  0000000                   _@PAUSE_SP_END_#:
 7220  0000000                   	.ENDIF
 7221  0000000                   	ENDM
 7222  0000000                   ;------------------------------------------------------------------------------
 7223  0000000                   PAUSE_PLAY_ALL_SP MACRO 
 7224  0000000                   	.IF (WITH_SP .EQ. 1H)
 7225  0000000                   		LDY #FFh
 7226  0000000                   _@PAUSE_NEXT_SP#:
 7227  0000000                   		INY	
 7228  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y





 7229  0000000                   		BEQ _@PAUSE_ALL_SP_END#
 7230  0000000                   		LDA <CH_STATUS_SP,X
 7231  0000000                   		BIT #SP_BZ
 7232  0000000                   		BEQ _@PAUSE_NEXT_SP#
 7233  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7234  0000000                   		BNE _@PAUSE_NEXT_SP#
 7235  0000000                   _@TO_PAUSE_SP_#:
 7236  0000000                   		BIT #SP_RESUME
 7237  0000000                   		BNE _@PAUSE_SPEECH_RESUME_DOING_NEXT	
 7238  0000000                   		ORA #SP_PAUSE
 7239  0000000                   		STA <CH_STATUS_SP,X
 7240  0000000                   
 7241  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
 7242  0000000                   		LDA <CH_PREVIOUS_PCM_SP,X
 7243  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7244  0000000                   		LDA <CH_PREVIOUS_PCM_SP+1,X
 7245  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7246  0000000                   		.ELSE
 7247  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP,X
 7248  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7249  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP+1,X
 7250  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7251  0000000                   		.ENDIF	
 7252  0000000                   		BRA _@PAUSE_NEXT_SP#
 7253  0000000                   
 7254  0000000                   _@PAUSE_SPEECH_RESUME_DOING_NEXT:
 7255  0000000                   		AND #(FFH^SP_RESUME)
 7256  0000000                   		ORA #SP_PAUSE
 7257  0000000                   		STA <CH_STATUS_SP,X
 7258  0000000                   		BRA _@PAUSE_NEXT_SP#
 7259  0000000                   
 7260  0000000                   _@PAUSE_ALL_SP_END#:
 7261  0000000                   	.ENDIF
 7262  0000000                   	ENDM
 7263  0000000                   ;------------------------------------------------------------------------------
 7264  0000000                   PAUSE_PLAY_SP_CHANNEL MACRO CHANNEL_ID
 7265  0000000                   	.IF (WITH_SP .EQ. 1H)
 7266  0000000                   		PHP
 7267  0000000                   		SEI
 7268  0000000                   		LDY #CHANNEL_ID
 7269  0000000                   		PAUSE_PLAY_Y_SP
 7270  0000000                   		PLP	
 7271  0000000                   		N55P_EXPANDER_PROCESS_RUNTIME
 7272  0000000                   	.ENDIF
 7273  0000000                   	ENDM
 7274  0000000                   ;------------------------------------------------------------------------------
 7275  0000000                   .IF (WITH_SP .EQ. 1)
 7276  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7277  0000000                   PAUSE_CH1 MACRO
 7278  0000000                   	PAUSE_PLAY_SP_CHANNEL 00H
 7279  0000000                   ENDM
 7280  0000000                   	.ENDIF
 7281  0000000                   ;------------------------------------------------------------------------------
 7282  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7283  0000000                   PAUSE_CH2 MACRO
 7284  0000000                   	PAUSE_PLAY_SP_CHANNEL 01H
 7285  0000000                   ENDM





 7286  0000000                   	.ENDIF
 7287  0000000                   ;------------------------------------------------------------------------------
 7288  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7289  0000000                   PAUSE_CH3 MACRO
 7290  0000000                   	PAUSE_PLAY_SP_CHANNEL 02H
 7291  0000000                   ENDM
 7292  0000000                   	.ENDIF
 7293  0000000                   .ENDIF
 7294  0000000                   ;==============================================================================
 7295  0000000                   PAUSE_PLAY_Y_EVO MACRO                                                                           
 7296  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7297  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE
 7298  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7299  0000000                   		BEQ _@PAUSE_EVO_END_#
 7300  0000000                   		LDA <CH_STATUS_EVO,X
 7301  0000000                   		BIT #EVO_BZ
 7302  0000000                   		BEQ _@PAUSE_EVO_END_#	
 7303  0000000                   _@PAUSE_EVO_#:		
 7304  0000000                   		ORA #EVO_PAUSE
 7305  0000000                   		STA <CH_STATUS_EVO,X
 7306  0000000                   _@PAUSE_EVO_END_#:
 7307  0000000                   	.ENDIF
 7308  0000000                   	ENDM
 7309  0000000                   ;------------------------------------------------------------------------------
 7310  0000000                   PAUSE_PLAY_ALL_EVO MACRO 
 7311  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7312  0000000                   		LDY #FFh
 7313  0000000                   _@PAUSE_NEXT_EVO#:
 7314  0000000                   		INY
 7315  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE		
 7316  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7317  0000000                   		BEQ _@PAUSE_ALL_EVO_END#
 7318  0000000                   		LDA <CH_STATUS_EVO,X
 7319  0000000                   		BIT #EVO_BZ
 7320  0000000                   		BEQ _@PAUSE_NEXT_EVO#
 7321  0000000                   _@TO_PAUSE_EVO_#:			
 7322  0000000                   		ORA #EVO_PAUSE
 7323  0000000                   		STA <CH_STATUS_EVO,X
 7324  0000000                   		BRA _@PAUSE_NEXT_EVO#
 7325  0000000                   _@PAUSE_ALL_EVO_END#:
 7326  0000000                   	.ENDIF
 7327  0000000                   	ENDM
 7328  0000000                   ;------------------------------------------------------------------------------
 7329  0000000                   PAUSE_PLAY_EVO_CHANNEL MACRO CHANNEL
 7330  0000000                   .IF(WITH_EVO .EQ. 1)
 7331  0000000                   	PHP
 7332  0000000                   	SEI
 7333  0000000                   	LDY #CHANNEL
 7334  0000000                   	PAUSE_PLAY_Y_EVO
 7335  0000000                   	PLP
 7336  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7337  0000000                   .ENDIF	
 7338  0000000                   	ENDM	
 7339  0000000                   ;------------------------------------------------------------------------------
 7340  0000000                   	.IF (WITH_EVO .EQ. 1)
 7341  0000000                   	.IF (WITH_CH0_EVO .EQ. 1)
 7342  0000000                   PAUSE_EVO1 MACRO





 7343  0000000                   	PAUSE_PLAY_EVO_CHANNEL 00H
 7344  0000000                   ENDM
 7345  0000000                   	.ENDIF
 7346  0000000                   	.ENDIF
 7347  0000000                   ;------------------------------------------------------------------------------
 7348  0000000                   	.IF (WITH_EVO .EQ. 1)
 7349  0000000                   	.IF (WITH_CH1_EVO .EQ. 1)
 7350  0000000                   PAUSE_EVO2 MACRO
 7351  0000000                   	PAUSE_PLAY_EVO_CHANNEL 01H
 7352  0000000                   ENDM
 7353  0000000                   	.ENDIF
 7354  0000000                   	.ENDIF
 7355  0000000                   ;------------------------------------------------------------------------------
 7356  0000000                   	.IF (WITH_EVO .EQ. 1)
 7357  0000000                   	.IF (WITH_CH2_EVO .EQ. 1)
 7358  0000000                   PAUSE_EVO3 MACRO
 7359  0000000                   	PAUSE_PLAY_EVO_CHANNEL 02H
 7360  0000000                   ENDM
 7361  0000000                   	.ENDIF
 7362  0000000                   	.ENDIF
 7363  0000000                   ;==============================================================================
 7364  0000000                   	.IF (WITH_MS .EQ. 1)
 7365  0000000                   PAUSE_MS MACRO
 7366  0000000                   	PSF_RESPONSE_LIMIT
 7367  0000000                   	PHP
 7368  0000000                   	SEI
 7369  0000000                   	EXTERN PAUSE_PLAY_ALL_MS_API
 7370  0000000                   	JSR PAUSE_PLAY_ALL_MS_API
 7371  0000000                   	PLP
 7372  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7373  0000000                   ENDM
 7374  0000000                   	.ENDIF
 7375  0000000                   ;==============================================================================
 7376  0000000                   PAUSE_PLAY_ALL_CHANNEL MACRO
 7377  0000000                   		PAUSE_PLAY_ALL_EVO
 7378  0000000                   		EXTERN PAUSE_PLAY_ALL_MS_API
 7379  0000000                   		JSR PAUSE_PLAY_ALL_MS_API
 7380  0000000                   		PAUSE_PLAY_ALL_SP
 7381  0000000                   ENDM
 7382  0000000                   ;------------------------------------------------------------------------------
 7383  0000000                   PAUSE_ALL MACRO
 7384  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 7385  0000000                   .ELSE
 7386  0000000                   	PHP
 7387  0000000                   	SEI
 7388  0000000                   	PAUSE_PLAY_ALL_CHANNEL	
 7389  0000000                   	PLP
 7390  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7391  0000000                   .ENDIF
 7392  0000000                   ENDM
 7393  0000000                   ;==============================================================================
 7394  0000000                   ; Play Pause: To set SP_PAUSE bit in 
 7395  0000000                   ;==============================================================================
 7396  0000000                   RESUME_PLAY_Y_SP MACRO 
 7397  0000000                   	.IF (WITH_SP .EQ. 1H)
 7398  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7399  0000000                   		BEQ _@END_RESEME_PLAY_Y_SP#





 7400  0000000                   		LDA <CH_STATUS_SP,X
 7401  0000000                   		BIT #SP_ADSR+SP_DC_RAMP_UP_FOR_MS
 7402  0000000                   		BNE _@END_RESEME_PLAY_Y_SP#
 7403  0000000                   		BIT #SP_PAUSE
 7404  0000000                   		BEQ END_RESEME_PLAY_Y_SP#
 7405  0000000                   		AND #FFh^(SP_PAUSE)
 7406  0000000                   		ORA #SP_RESUME
 7407  0000000                   		STA <CH_STATUS_SP,X 
 7408  0000000                   _@END_RESEME_PLAY_Y_SP#:
 7409  0000000                   	.ENDIF
 7410  0000000                   	ENDM
 7411  0000000                   ;------------------------------------------------------------------------------
 7412  0000000                   RESUME_PLAY_ALL_SP MACRO
 7413  0000000                   	.IF (WITH_SP .EQ. 1H)
 7414  0000000                   		LDY #FFh
 7415  0000000                   _@RESUME_NEXT_SP#:
 7416  0000000                   		INY
 7417  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7418  0000000                   		BEQ _@END_RESUME_ALL_SP#
 7419  0000000                   		LDA <CH_STATUS_SP,X
 7420  0000000                   		BIT #SP_ADSR+SP_DC_RAMP_UP_FOR_MS
 7421  0000000                   		BNE _@RESUME_NEXT_SP#
 7422  0000000                   		BIT #SP_PAUSE
 7423  0000000                   		BEQ _@RESUME_NEXT_SP#
 7424  0000000                   		AND #FFh^(SP_PAUSE)
 7425  0000000                   		ORA #SP_RESUME
 7426  0000000                   		STA <CH_STATUS_SP,X 
 7427  0000000                   		BRA _@RESUME_NEXT_SP#
 7428  0000000                   _@END_RESUME_ALL_SP#:		
 7429  0000000                   	.ENDIF
 7430  0000000                   	ENDM
 7431  0000000                   ;------------------------------------------------------------------------------
 7432  0000000                   RESUME_PLAY_SP_CHANNEL MACRO CHANNEL_ID
 7433  0000000                   	.IF (WITH_SP .EQ. 1H)
 7434  0000000                   		PHP
 7435  0000000                   		SEI
 7436  0000000                   		LDY #CHANNEL_ID
 7437  0000000                   		RESUME_PLAY_Y_SP
 7438  0000000                   		PLP
 7439  0000000                   	.ENDIF
 7440  0000000                   	ENDM
 7441  0000000                   ;------------------------------------------------------------------------------
 7442  0000000                   .IF (WITH_SP .EQ. 1)
 7443  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7444  0000000                   RESUME_CH1 MACRO
 7445  0000000                   	RESUME_PLAY_SP_CHANNEL 00H
 7446  0000000                   ENDM
 7447  0000000                   	.ENDIF
 7448  0000000                   ;------------------------------------------------------------------------------
 7449  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7450  0000000                   RESUME_CH2 MACRO
 7451  0000000                   	RESUME_PLAY_SP_CHANNEL 01H
 7452  0000000                   ENDM		
 7453  0000000                   	.ENDIF
 7454  0000000                   ;------------------------------------------------------------------------------
 7455  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7456  0000000                   RESUME_CH3 MACRO





 7457  0000000                   	RESUME_PLAY_SP_CHANNEL 02H
 7458  0000000                   ENDM		
 7459  0000000                   	.ENDIF
 7460  0000000                   .ENDIF
 7461  0000000                   ;==============================================================================
 7462  0000000                   ; Play Resume for Melody  To set ^MS_STOP bit in 
 7463  0000000                   ; Resume all melody polyphnote
 7464  0000000                   ;==============================================================================
 7465  0000000                   RESUME_PLAY_ALL_MS MACRO
 7466  0000000                   	.IF (WITH_MS .EQ. 1H)
 7467  0000000                   		LDA #MS_PS	
 7468  0000000                   		BIT <MS_START+CH_STATUS_MS
 7469  0000000                   		BEQ _@RESUME_END_ALL_MS#
 7470  0000000                   		TRB <MS_START+CH_STATUS_MS
 7471  0000000                   _@RESUME_END_ALL_MS#:
 7472  0000000                     	.ENDIF
 7473  0000000                   ENDM
 7474  0000000                   ;------------------------------------------------------------------------------
 7475  0000000                   	.IF (WITH_MS .EQ. 1)
 7476  0000000                   RESUME_MS MACRO
 7477  0000000                   	PSF_RESPONSE_LIMIT
 7478  0000000                   	PHP
 7479  0000000                   	SEI
 7480  0000000                   	EXTERN RESUME_PLAY_ALL_MS_API
 7481  0000000                   	JSR RESUME_PLAY_ALL_MS_API
 7482  0000000                   	PLP
 7483  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7484  0000000                   ENDM
 7485  0000000                   	.ENDIF
 7486  0000000                   ;==============================================================================
 7487  0000000                   RESUME_PLAY_Y_EVO MACRO 
 7488  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7489  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE
 7490  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7491  0000000                   		BEQ _@END_RESEME_PLAY_Y_EVO#
 7492  0000000                   		LDA <CH_STATUS_EVO,X
 7493  0000000                   		AND #FFh^(EVO_PAUSE)
 7494  0000000                   		STA <CH_STATUS_EVO,X 
 7495  0000000                   _@END_RESEME_PLAY_Y_EVO#:
 7496  0000000                   	.ENDIF
 7497  0000000                   	ENDM
 7498  0000000                   ;------------------------------------------------------------------------------
 7499  0000000                   RESUME_PLAY_ALL_EVO MACRO 
 7500  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7501  0000000                   		LDY #FFh
 7502  0000000                   _@RESUME_NEXT_EVO#:
 7503  0000000                   		INY
 7504  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE
 7505  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7506  0000000                   		BEQ _@END_RESEME_PLAY_ALL_EVO#
 7507  0000000                   		LDA <CH_STATUS_EVO,X
 7508  0000000                   		AND #FFh^(EVO_PAUSE)
 7509  0000000                   		STA <CH_STATUS_EVO,X 
 7510  0000000                   		BRA _@RESUME_NEXT_EVO#
 7511  0000000                   _@END_RESEME_PLAY_ALL_EVO#:
 7512  0000000                   	.ENDIF
 7513  0000000                   	ENDM





 7514  0000000                   ;------------------------------------------------------------------------------
 7515  0000000                   RESUME_PLAY_EVO_CHANNEL MACRO CHANNEL
 7516  0000000                   .IF(WITH_EVO .EQ. 1)
 7517  0000000                   	PHP
 7518  0000000                   	SEI
 7519  0000000                   	LDY #CHANNEL
 7520  0000000                   	RESUME_PLAY_Y_EVO
 7521  0000000                   	PLP
 7522  0000000                   .ENDIF		
 7523  0000000                   	ENDM
 7524  0000000                   ;------------------------------------------------------------------------------
 7525  0000000                   	.IF (WITH_EVO .EQ. 1)
 7526  0000000                   	.IF (WITH_CH0_EVO .EQ. 1)
 7527  0000000                   RESUME_EVO1 MACRO
 7528  0000000                   	RESUME_PLAY_EVO_CHANNEL 00H
 7529  0000000                   ENDM
 7530  0000000                   	.ENDIF
 7531  0000000                   	.ENDIF
 7532  0000000                   ;------------------------------------------------------------------------------
 7533  0000000                   	.IF (WITH_EVO .EQ. 1)
 7534  0000000                   	.IF (WITH_CH1_EVO .EQ. 1)
 7535  0000000                   RESUME_EVO2 MACRO
 7536  0000000                   	RESUME_PLAY_EVO_CHANNEL 01H
 7537  0000000                   ENDM
 7538  0000000                   	.ENDIF
 7539  0000000                   	.ENDIF
 7540  0000000                   ;------------------------------------------------------------------------------
 7541  0000000                   	.IF (WITH_EVO .EQ. 1)
 7542  0000000                   	.IF (WITH_CH2_EVO .EQ. 1)
 7543  0000000                   RESUME_EVO3 MACRO
 7544  0000000                   	RESUME_PLAY_EVO_CHANNEL 02H
 7545  0000000                   ENDM
 7546  0000000                   	.ENDIF
 7547  0000000                   	.ENDIF
 7548  0000000                   ;==============================================================================
 7549  0000000                   RESUME_PLAY_ALL_CHANNEL MACRO
 7550  0000000                   		RESUME_PLAY_ALL_EVO
 7551  0000000                   		EXTERN RESUME_PLAY_ALL_MS_API
 7552  0000000                   		JSR RESUME_PLAY_ALL_MS_API
 7553  0000000                   		RESUME_PLAY_ALL_SP
 7554  0000000                   ENDM
 7555  0000000                   ;------------------------------------------------------------------------------
 7556  0000000                   RESUME_ALL MACRO
 7557  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 7558  0000000                   .ELSE
 7559  0000000                   	PHP
 7560  0000000                   	SEI
 7561  0000000                   	RESUME_PLAY_ALL_CHANNEL
 7562  0000000                   	PLP
 7563  0000000                   .ENDIF
 7564  0000000                   ENDM
 7565  0000000                   .ENDIF ;(WITH_PAUSE_RESUME .EQ. 1H)
 7566  0000000                   ;==============================================================================
 7567  0000000                   ; Set TMV of specified speech channel.
 7568  0000000                   ;==============================================================================
 7569  0000000                   SET_SP_SAMPLE_RATE_Y MACRO NEW_TMV
 7570  0000000                   	.IF (WITH_SP .EQ. 1H)	





 7571  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 7572  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 7573  0000000                   		PSF_RESPONSE_LIMIT
 7574  0000000                   		LDA #NEW_TMV
 7575  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 7576  0000000                   		PHP
 7577  0000000                   		SEI
 7578  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 7579  0000000                   		PLP
 7580  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 7581  0000000                   	.ENDIF
 7582  0000000                   	ENDM
 7583  0000000                   ;------------------------------------------------------------------------------
 7584  0000000                   SET_SP_SAMPLE_RATE MACRO NEW_TMV,CHANNEL_ID
 7585  0000000                   	.IF (WITH_SP .EQ. 1H)
 7586  0000000                   		LDY #CHANNEL_ID
 7587  0000000                   		SET_SP_SAMPLE_RATE_Y NEW_TMV
 7588  0000000                   	.ENDIF
 7589  0000000                   	ENDM
 7590  0000000                   ;------------------------------------------------------------------------------
 7591  0000000                   .IF (WITH_SP .EQ. 1)
 7592  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7593  0000000                   SET_SR1 MACRO NEW_TMV
 7594  0000000                   	SET_SP_SAMPLE_RATE NEW_TMV, 00H 
 7595  0000000                   ENDM		
 7596  0000000                   	.ENDIF
 7597  0000000                   ;------------------------------------------------------------------------------
 7598  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7599  0000000                   SET_SR2 MACRO NEW_TMV
 7600  0000000                   	SET_SP_SAMPLE_RATE NEW_TMV, 01H
 7601  0000000                   ENDM		
 7602  0000000                   	.ENDIF
 7603  0000000                   ;------------------------------------------------------------------------------
 7604  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7605  0000000                   SET_SR3 MACRO NEW_TMV
 7606  0000000                   	SET_SP_SAMPLE_RATE NEW_TMV, 02H
 7607  0000000                   ENDM
 7608  0000000                   	.ENDIF	
 7609  0000000                   .ENDIF	
 7610  0000000                   ;==============================================================================
 7611  0000000                   SET_SP_SAMPLE_RATE_Y_BY_RAM MACRO NEW_TMV_RAM
 7612  0000000                   	.IF (WITH_SP .EQ. 1H)
 7613  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 7614  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 7615  0000000                   		PSF_RESPONSE_LIMIT
 7616  0000000                   		LDA !NEW_TMV_RAM
 7617  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 7618  0000000                   		PHP
 7619  0000000                   		SEI
 7620  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 7621  0000000                   		PLP
 7622  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 7623  0000000                   	.ENDIF
 7624  0000000                   	ENDM
 7625  0000000                   ;------------------------------------------------------------------------------
 7626  0000000                   SET_SP_SAMPLE_RATE_BY_RAM MACRO NEW_TMV_RAM,CHANNEL_ID
 7627  0000000                   	.IF (WITH_SP .EQ. 1H)





 7628  0000000                   		LDY #CHANNEL_ID
 7629  0000000                   		SET_SP_SAMPLE_RATE_Y_BY_RAM NEW_TMV_RAM
 7630  0000000                   	.ENDIF
 7631  0000000                   	ENDM
 7632  0000000                   ;------------------------------------------------------------------------------
 7633  0000000                   .IF (WITH_SP .EQ. 1)
 7634  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7635  0000000                   SET_SR1_RAM MACRO NEW_TMV_RAM
 7636  0000000                   	SET_SP_SAMPLE_RATE_BY_RAM NEW_TMV_RAM, 00H
 7637  0000000                   ENDM		
 7638  0000000                   	.ENDIF
 7639  0000000                   ;------------------------------------------------------------------------------
 7640  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7641  0000000                   SET_SR2_RAM MACRO NEW_TMV_RAM
 7642  0000000                   	SET_SP_SAMPLE_RATE_BY_RAM NEW_TMV_RAM, 01H
 7643  0000000                   ENDM		
 7644  0000000                   	.ENDIF
 7645  0000000                   ;------------------------------------------------------------------------------
 7646  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7647  0000000                   SET_SR3_RAM MACRO NEW_TMV_RAM
 7648  0000000                   	SET_SP_SAMPLE_RATE_BY_RAM NEW_TMV_RAM, 02H
 7649  0000000                   ENDM		
 7650  0000000                   	.ENDIF
 7651  0000000                   .ENDIF
 7652  0000000                   ;==============================================================================
 7653  0000000                   ; Set delta-time decrease amount.             
 7654  0000000                   ; There are 2 parameters, amount and it's fraction.
 7655  0000000                   ;==============================================================================
 7656  0000000                   SET_TEMPO MACRO DT_DEC_AMOUNT,DT_DEC_FRACTION
 7657  0000000                   	.IF (WITH_MS .EQ. 1H)	              
 7658  0000000                   	.IF (WITH_CHANGE_TEMPO .EQ. 1)        
 7659  0000000                   		LDA #DT_DEC_AMOUNT            
 7660  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_MS
 7661  0000000                   		LDA #DT_DEC_FRACTION          
 7662  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_FRACTION_MS
 7663  0000000                   	.ENDIF                                
 7664  0000000                   	.ENDIF                                
 7665  0000000                   	ENDM                                 
 7666  0000000                   ;==============================================================================
 7667  0000000                   ; DT_DEC_AMOUNT_RAM : xxxxx111:integer  11111xxx:fraction
 7668  0000000                   ;==============================================================================
 7669  0000000                   SET_TEMPO_RAM MACRO DT_DEC_AMOUNT_RAM
 7670  0000000                   	.IF (WITH_MS .EQ. 1H)	              
 7671  0000000                   	.IF (WITH_CHANGE_TEMPO .EQ. 1)        
 7672  0000000                   		LDA !DT_DEC_AMOUNT_RAM        
 7673  0000000                   		AND #0000111b						
 7674  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_MS
 7675  0000000                   ; FRACTION
 7676  0000000                   		LDA !DT_DEC_AMOUNT_RAM
 7677  0000000                   		AND #11111000b			
 7678  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_FRACTION_MS
 7679  0000000                   	.ENDIF
 7680  0000000                   	.ENDIF
 7681  0000000                   	ENDM	
 7682  0000000                   ;===============================================================================
 7683  0000000                   ; SET SPEECH VOLUME by Y Channel
 7684  0000000                   ;===============================================================================





 7685  0000000                   SET_LP8_VOLUME_Y MACRO VOLUME_VALUE
 7686  0000000                   	.IF (WITH_LP8 .EQ. 1H)
 7687  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7688  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7689  0000000                   		LDA 0,X
 7690  0000000                   		AND #GLOBAL_VOL_FLAG
 7691  0000000                   		ORA #VOLUME_VALUE
 7692  0000000                   		STA 0,X
 7693  0000000                   
 7694  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7695  0000000                   		LDA <CH_STATUS_SP,X
 7696  0000000                   		BIT #SP_BZ 
 7697  0000000                   		BEQ SET_LP8_VOLUME_Y_END_#
 7698  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7699  0000000                   		BNE SET_LP8_VOLUME_Y_END_#
 7700  0000000                   
 7701  0000000                   		LDA #VOLUME_VALUE
 7702  0000000                   		ASL A
 7703  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7704  0000000                   
 7705  0000000                   SET_LP8_VOLUME_Y_END_#:
 7706  0000000                   		SET_LP8_VOL_MUL_8X3_SP_ADDR _SP
 7707  0000000                   	.ENDIF
 7708  0000000                   	.ENDIF
 7709  0000000                   ENDM
 7710  0000000                   ;------------------------------------------------------------------------------
 7711  0000000                   ;update by angela for en/dis GLOBALVOL feature
 7712  0000000                   SET_SP_VOLUME_DELAY MACRO
 7713  0000000                   	LDY #FFH
 7714  0000000                   LOOP_#:
 7715  0000000                   	.IFDEF WDTIMER
 7716  0000000                   	.IFDEF LVDEN
 7717  0000000                   		LDA #CTL_CPU_WDT
 7718  0000000                   		TSB RAM_CTL_CPU
 7719  0000000                   		LDA RAM_CTL_CPU
 7720  0000000                   		STA !CTL_CPU
 7721  0000000                   	.ELSE
 7722  0000000                   		LDA #CTL_CPU_WDT
 7723  0000000                   		TSB !CTL_CPU
 7724  0000000                   	.ENDIF 	
 7725  0000000                   	.ENDIF
 7726  0000000                   	NOP
 7727  0000000                   	NOP
 7728  0000000                   	NOP
 7729  0000000                   	NOP
 7730  0000000                   	NOP
 7731  0000000                   	NOP
 7732  0000000                   	NOP
 7733  0000000                   	NOP
 7734  0000000                   	NOP
 7735  0000000                   	NOP
 7736  0000000                   	NOP
 7737  0000000                   	NOP
 7738  0000000                   	NOP
 7739  0000000                   	NOP
 7740  0000000                   	NOP
 7741  0000000                   	NOP





 7742  0000000                   	NOP
 7743  0000000                   	NOP
 7744  0000000                   	NOP
 7745  0000000                   	NOP
 7746  0000000                   	DEY
 7747  0000000                   	BNE LOOP_#
 7748  0000000                   ENDM
 7749  0000000                   ;------------------------------------------------------------------------------
 7750  0000000                   	EXTERN SP_GLOBAL_VOLUME_TABLE
 7751  0000000                   SET_SP_VOLUME_Y  MACRO VOLUME_VALUE	
 7752  0000000                   	.IF (WITH_SP .EQ. 1H)
 7753  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7754  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7755  0000000                   		LDA 0,X
 7756  0000000                   		AND #GLOBAL_VOL_FLAG
 7757  0000000                   		ORA #VOLUME_VALUE
 7758  0000000                   		STA 0,X
 7759  0000000                   
 7760  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y	
 7761  0000000                   		LDA <CH_STATUS_SP,X
 7762  0000000                   		BIT #SP_BZ 
 7763  0000000                   		BEQ SET_SP_VOLUME_Y_END_#
 7764  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7765  0000000                   		BNE SET_SP_VOLUME_Y_END_#
 7766  0000000                   
 7767  0000000                   COMPARE_VOLUME#:		
 7768  0000000                   		LDA <CH_R_FINAL_VOLUME_SP,X
 7769  0000000                   		LSR A
 7770  0000000                   		AND #FH
 7771  0000000                   		CMP #VOLUME_VALUE
 7772  0000000                   		BEQ SET_SP_VOLUME_Y_END_#
 7773  0000000                   		BCC INCREASE_#
 7774  0000000                   DECREASE_#:
 7775  0000000                   		SEC
 7776  0000000                   		SBC #1H
 7777  0000000                   		JMP SET_SP_VOLUME_Y_CONTINUE#
 7778  0000000                   INCREASE_#:
 7779  0000000                   		CLC 
 7780  0000000                   		ADC #1H
 7781  0000000                   SET_SP_VOLUME_Y_CONTINUE#:
 7782  0000000                   		ASL A
 7783  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7784  0000000                   		SET_SP_VOLUME_DELAY
 7785  0000000                   		JMP COMPARE_VOLUME#
 7786  0000000                   SET_SP_VOLUME_Y_END_#:
 7787  0000000                   	.ENDIF
 7788  0000000                   	.ENDIF
 7789  0000000                   ENDM
 7790  0000000                   ;------------------------------------------------------------------------------
 7791  0000000                   SET_SP_VOLUME MACRO VOLUME_VALUE,CHANNEL_ID
 7792  0000000                   	.IF (WITH_SP .EQ. 1H)
 7793  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7794  0000000                   		LDY #CHANNEL_ID
 7795  0000000                   		SET_SP_VOLUME_Y VOLUME_VALUE
 7796  0000000                   	.ENDIF
 7797  0000000                   	.ENDIF
 7798  0000000                   ENDM





 7799  0000000                   ;------------------------------------------------------------------------------
 7800  0000000                   .IF (WITH_SP .EQ. 1)
 7801  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7802  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7803  0000000                   SET_VOL1 MACRO NEW_VOL
 7804  0000000                   	SET_SP_VOLUME NEW_VOL, 00H
 7805  0000000                   ENDM		
 7806  0000000                   	.ENDIF
 7807  0000000                   ;------------------------------------------------------------------------------
 7808  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7809  0000000                   SET_VOL2 MACRO NEW_VOL
 7810  0000000                   	SET_SP_VOLUME NEW_VOL, 01H
 7811  0000000                   ENDM			
 7812  0000000                   	.ENDIF
 7813  0000000                   ;------------------------------------------------------------------------------
 7814  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7815  0000000                   SET_VOL3 MACRO NEW_VOL
 7816  0000000                   	SET_SP_VOLUME  NEW_VOL, 02H
 7817  0000000                   ENDM			
 7818  0000000                   	.ENDIF
 7819  0000000                   .ENDIF	
 7820  0000000                   .ENDIF
 7821  0000000                   ;------------------------------------------------------------------------------
 7822  0000000                   .IF (WITH_SP .EQ. 1)
 7823  0000000                   .IF (WITH_LP8 .EQ. 1H)
 7824  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7825  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7826  0000000                   SET_VOL1_LP8 MACRO NEW_VOL
 7827  0000000                   	LDY #00H
 7828  0000000                   	SET_LP8_VOLUME_Y NEW_VOL
 7829  0000000                   ENDM		
 7830  0000000                   	.ENDIF
 7831  0000000                   ;------------------------------------------------------------------------------
 7832  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7833  0000000                   SET_VOL2_LP8 MACRO NEW_VOL
 7834  0000000                   	LDY #01H
 7835  0000000                   	SET_LP8_VOLUME_Y NEW_VOL
 7836  0000000                   ENDM			
 7837  0000000                   	.ENDIF
 7838  0000000                   ;------------------------------------------------------------------------------
 7839  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7840  0000000                   SET_VOL3_LP8 MACRO NEW_VOL
 7841  0000000                   	LDY #02H
 7842  0000000                   	SET_LP8_VOLUME_Y NEW_VOL
 7843  0000000                   ENDM			
 7844  0000000                   	.ENDIF
 7845  0000000                   .ENDIF	
 7846  0000000                   .ENDIF
 7847  0000000                   .ENDIF
 7848  0000000                   ;===============================================================================
 7849  0000000                   SET_LP8_VOLUME_Y_BY_RAM MACRO VOLUME_RAM
 7850  0000000                   	.IF (WITH_LP8 .EQ. 1H)
 7851  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7852  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7853  0000000                   		LDA 0,X
 7854  0000000                   		AND #GLOBAL_VOL_FLAG
 7855  0000000                   		ORA VOLUME_RAM





 7856  0000000                   		STA 0,X
 7857  0000000                   
 7858  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7859  0000000                   		LDA <CH_STATUS_SP,X
 7860  0000000                   		BIT #SP_BZ 
 7861  0000000                   		BEQ SET_LP8_VOLUME_Y_BY_RAM_END_#
 7862  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7863  0000000                   		BNE SET_LP8_VOLUME_Y_BY_RAM_END_#
 7864  0000000                   
 7865  0000000                   		LDA VOLUME_RAM
 7866  0000000                   		ASL A
 7867  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7868  0000000                   
 7869  0000000                   SET_LP8_VOLUME_Y_BY_RAM_END_#:
 7870  0000000                   		SET_LP8_VOL_MUL_8X3_SP_ADDR _SP
 7871  0000000                   	.ENDIF
 7872  0000000                   	.ENDIF
 7873  0000000                   ENDM
 7874  0000000                   ;------------------------------------------------------------------------------
 7875  0000000                   SET_SP_VOLUME_Y_BY_RAM MACRO VOLUME_RAM	
 7876  0000000                   	.IF (WITH_SP .EQ. 1H)
 7877  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7878  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7879  0000000                   		LDA 0,X
 7880  0000000                   		AND #GLOBAL_VOL_FLAG
 7881  0000000                   		ORA !VOLUME_RAM
 7882  0000000                   		STA 0,X
 7883  0000000                   
 7884  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7885  0000000                   		LDA <CH_STATUS_SP,X
 7886  0000000                   		BIT #SP_BZ 
 7887  0000000                   		BEQ SET_SP_VOLUME_Y_BY_RAM_END_#	
 7888  0000000                   		BIT  #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7889  0000000                   		BNE SET_SP_VOLUME_Y_BY_RAM_END_#
 7890  0000000                   
 7891  0000000                   COMPARE_VOLUME_RAM#:		
 7892  0000000                   		LDA <CH_R_FINAL_VOLUME_SP,X
 7893  0000000                   		LSR A
 7894  0000000                   		AND #FH
 7895  0000000                   		CMP !VOLUME_RAM
 7896  0000000                   		BEQ SET_SP_VOLUME_Y_BY_RAM_END_#
 7897  0000000                   		BCC INCREASE_RAM#
 7898  0000000                   DECREASE_RAM#:
 7899  0000000                   		SEC
 7900  0000000                   		SBC #1H
 7901  0000000                   		JMP SET_SP_VOLUME_Y_BY_RAM_CONTINUE#
 7902  0000000                   INCREASE_RAM#:
 7903  0000000                   		CLC 
 7904  0000000                   		ADC #1H
 7905  0000000                   SET_SP_VOLUME_Y_BY_RAM_CONTINUE#:
 7906  0000000                   		ASL A
 7907  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7908  0000000                   		SET_SP_VOLUME_DELAY
 7909  0000000                   		JMP COMPARE_VOLUME_RAM#
 7910  0000000                   SET_SP_VOLUME_Y_BY_RAM_END_#:
 7911  0000000                   	.ENDIF
 7912  0000000                   	.ENDIF





 7913  0000000                   ENDM	
 7914  0000000                   ;------------------------------------------------------------------------------
 7915  0000000                   SET_SP_VOLUME_BY_RAM MACRO VOLUME_RAM, CHANNEL_ID
 7916  0000000                   	.IF (WITH_SP .EQ. 1H)
 7917  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7918  0000000                   		LDY #CHANNEL_ID
 7919  0000000                   		SET_SP_VOLUME_Y_BY_RAM VOLUME_RAM
 7920  0000000                   	.ENDIF
 7921  0000000                   	.ENDIF
 7922  0000000                   ENDM	
 7923  0000000                   ;------------------------------------------------------------------------------
 7924  0000000                   .IF (WITH_SP .EQ. 1)
 7925  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7926  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7927  0000000                   SET_VOL1_RAM MACRO NEW_VOL_RAM
 7928  0000000                   	SET_SP_VOLUME_BY_RAM NEW_VOL_RAM, 00H
 7929  0000000                   ENDM			
 7930  0000000                   	.ENDIF
 7931  0000000                   ;------------------------------------------------------------------------------
 7932  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7933  0000000                   SET_VOL2_RAM MACRO NEW_VOL_RAM
 7934  0000000                   	SET_SP_VOLUME_BY_RAM NEW_VOL_RAM, 01H
 7935  0000000                   ENDM
 7936  0000000                   	.ENDIF
 7937  0000000                   ;------------------------------------------------------------------------------
 7938  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7939  0000000                   SET_VOL3_RAM MACRO NEW_VOL_RAM
 7940  0000000                   	SET_SP_VOLUME_BY_RAM  NEW_VOL_RAM, 02H
 7941  0000000                   ENDM			
 7942  0000000                   	.ENDIF
 7943  0000000                   .ENDIF
 7944  0000000                   .ENDIF	
 7945  0000000                   ;------------------------------------------------------------------------------
 7946  0000000                   .IF (WITH_SP .EQ. 1)
 7947  0000000                   .IF (WITH_LP8 .EQ. 1H)
 7948  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7949  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7950  0000000                   SET_VOL1_RAM_LP8 MACRO NEW_VOL_RAM
 7951  0000000                   	LDY #00H
 7952  0000000                   	SET_LP8_VOLUME_Y_BY_RAM NEW_VOL_RAM
 7953  0000000                   ENDM			
 7954  0000000                   	.ENDIF
 7955  0000000                   ;------------------------------------------------------------------------------
 7956  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7957  0000000                   SET_VOL2_RAM_LP8 MACRO NEW_VOL_RAM
 7958  0000000                   	LDY #01H
 7959  0000000                   	SET_LP8_VOLUME_Y_BY_RAM NEW_VOL_RAM
 7960  0000000                   ENDM
 7961  0000000                   	.ENDIF
 7962  0000000                   ;------------------------------------------------------------------------------
 7963  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7964  0000000                   SET_VOL3_RAM_LP8 MACRO NEW_VOL_RAM
 7965  0000000                   	LDY #02H
 7966  0000000                   	SET_LP8_VOLUME_Y_BY_RAM  NEW_VOL_RAM
 7967  0000000                   ENDM			
 7968  0000000                   	.ENDIF
 7969  0000000                   .ENDIF





 7970  0000000                   .ENDIF	
 7971  0000000                   .ENDIF
 7972  0000000                   ;==============================================================================
 7973  0000000                   	EXTERN SP_GLOBAL_VOLUME_TABLE
 7974  0000000                   SET_SP_VOLUME_Y_RT  MACRO VOLUME_VALUE	
 7975  0000000                   	.IF (WITH_SP .EQ. 1H)
 7976  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7977  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7978  0000000                   		LDA 0,X
 7979  0000000                   		AND #GLOBAL_VOL_FLAG
 7980  0000000                   		ORA #VOLUME_VALUE
 7981  0000000                   		STA 0,X
 7982  0000000                   
 7983  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7984  0000000                   		LDA <CH_STATUS_SP,X
 7985  0000000                   		BIT #SP_BZ 
 7986  0000000                   		BEQ SET_SP_VOLUME_Y_RT_END_#
 7987  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 7988  0000000                   		BNE SET_SP_VOLUME_Y_RT_END_#
 7989  0000000                   
 7990  0000000                   		LDA #VOLUME_VALUE
 7991  0000000                   		ASL A
 7992  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7993  0000000                   SET_SP_VOLUME_Y_RT_END_#:
 7994  0000000                   	.ENDIF
 7995  0000000                   	.ENDIF
 7996  0000000                   ENDM
 7997  0000000                   ;------------------------------------------------------------------------------
 7998  0000000                   SET_SP_VOLUME_RT MACRO VOLUME_VALUE,CHANNEL_ID
 7999  0000000                   	.IF (WITH_SP .EQ. 1H)
 8000  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 8001  0000000                   		LDY #CHANNEL_ID
 8002  0000000                   		SET_SP_VOLUME_Y_RT VOLUME_VALUE
 8003  0000000                   	.ENDIF
 8004  0000000                   	.ENDIF
 8005  0000000                   ENDM
 8006  0000000                   ;------------------------------------------------------------------------------
 8007  0000000                   .IF (WITH_SP .EQ. 1)
 8008  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8009  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8010  0000000                   SET_VOL1_RT MACRO NEW_VOL
 8011  0000000                   	SET_SP_VOLUME_RT NEW_VOL, 00H
 8012  0000000                   ENDM		
 8013  0000000                   	.ENDIF
 8014  0000000                   ;------------------------------------------------------------------------------
 8015  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8016  0000000                   SET_VOL2_RT MACRO NEW_VOL
 8017  0000000                   	SET_SP_VOLUME_RT NEW_VOL, 01H
 8018  0000000                   ENDM			
 8019  0000000                   	.ENDIF
 8020  0000000                   ;------------------------------------------------------------------------------
 8021  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8022  0000000                   SET_VOL3_RT MACRO NEW_VOL
 8023  0000000                   	SET_SP_VOLUME_RT  NEW_VOL, 02H
 8024  0000000                   ENDM			
 8025  0000000                   	.ENDIF
 8026  0000000                   .ENDIF	





 8027  0000000                   .ENDIF
 8028  0000000                   ;------------------------------------------------------------------------------
 8029  0000000                   SET_SP_VOLUME_Y_BY_RAM_RT MACRO VOLUME_RAM	
 8030  0000000                   	.IF (WITH_SP .EQ. 1H)
 8031  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 8032  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 8033  0000000                   		LDA 0,X
 8034  0000000                   		AND #GLOBAL_VOL_FLAG
 8035  0000000                   		ORA !VOLUME_RAM
 8036  0000000                   		STA 0,X
 8037  0000000                   
 8038  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8039  0000000                   		LDA <CH_STATUS_SP,X
 8040  0000000                   		BIT #SP_BZ 
 8041  0000000                   		BEQ SET_SP_VOLUME_Y_BY_RAM_RT_END_#
 8042  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8043  0000000                   		BNE SET_SP_VOLUME_Y_BY_RAM_RT_END_#
 8044  0000000                   
 8045  0000000                   		LDA VOLUME_RAM
 8046  0000000                   		ASL A
 8047  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8048  0000000                   
 8049  0000000                   SET_SP_VOLUME_Y_BY_RAM_RT_END_#:
 8050  0000000                   	.ENDIF
 8051  0000000                   	.ENDIF
 8052  0000000                   ENDM	
 8053  0000000                   ;------------------------------------------------------------------------------
 8054  0000000                   SET_SP_VOLUME_BY_RAM_RT MACRO VOLUME_RAM, CHANNEL_ID
 8055  0000000                   	.IF (WITH_SP .EQ. 1H)
 8056  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 8057  0000000                   		LDY #CHANNEL_ID
 8058  0000000                   		SET_SP_VOLUME_Y_BY_RAM_RT VOLUME_RAM
 8059  0000000                   	.ENDIF
 8060  0000000                   	.ENDIF
 8061  0000000                   ENDM	
 8062  0000000                   ;------------------------------------------------------------------------------
 8063  0000000                   .IF (WITH_SP .EQ. 1)
 8064  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8065  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8066  0000000                   SET_VOL1_RAM_RT MACRO NEW_VOL_RAM
 8067  0000000                   	SET_SP_VOLUME_BY_RAM_RT NEW_VOL_RAM, 00H
 8068  0000000                   ENDM			
 8069  0000000                   	.ENDIF
 8070  0000000                   ;------------------------------------------------------------------------------
 8071  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8072  0000000                   SET_VOL2_RAM_RT MACRO NEW_VOL_RAM
 8073  0000000                   	SET_SP_VOLUME_BY_RAM_RT NEW_VOL_RAM, 01H
 8074  0000000                   ENDM
 8075  0000000                   	.ENDIF
 8076  0000000                   ;------------------------------------------------------------------------------
 8077  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8078  0000000                   SET_VOL3_RAM_RT MACRO NEW_VOL_RAM
 8079  0000000                   	SET_SP_VOLUME_BY_RAM_RT  NEW_VOL_RAM, 02H
 8080  0000000                   ENDM			
 8081  0000000                   	.ENDIF
 8082  0000000                   .ENDIF
 8083  0000000                   .ENDIF	





 8084  0000000                   ;==============================================================================
 8085  0000000                   ;==============================================================================
 8086  0000000                   DIS_SP_EQU_VOL_Y MACRO                                                         
 8087  0000000                   	.IF(WITH_SP .EQ. 1H)                                                   
 8088  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)                                              
 8089  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8090  0000000                   		LDA 0,X                                                        
 8091  0000000                   		ORA #GLOBAL_VOL_FLAG                                                      
 8092  0000000                   		STA 0,X                                                        
 8093  0000000                   
 8094  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8095  0000000                   		LDA <CH_STATUS_SP,X
 8096  0000000                   		BIT #SP_BZ 
 8097  0000000                   		BEQ DIS_SP_EQU_VOL_Y_END_#
 8098  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8099  0000000                   		BNE DIS_SP_EQU_VOL_Y_END_#
 8100  0000000                   
 8101  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8102  0000000                   		LDA 0,X                                                             
 8103  0000000                   		AND #7FH                                                       
 8104  0000000                   		ASL A                                                          
 8105  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y                                   
 8106  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8107  0000000                   DIS_SP_EQU_VOL_Y_END_#:                                    
 8108  0000000                   	.ENDIF                                                                 
 8109  0000000                   	.ENDIF                                                                 
 8110  0000000                   ENDM   
 8111  0000000                   ;------------------------------------------------------------------------------
 8112  0000000                   DIS_SP_EQU_VOL MACRO CHANNEL
 8113  0000000                   	.IF(WITH_SP .EQ. 1H)
 8114  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)    
 8115  0000000                   		LDY #CHANNEL
 8116  0000000                   		DIS_SP_EQU_VOL_Y 
 8117  0000000                   	.ENDIF
 8118  0000000                   	.ENDIF   
 8119  0000000                   ENDM
 8120  0000000                   ;------------------------------------------------------------------------------
 8121  0000000                   .IF (WITH_SP .EQ. 1)
 8122  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8123  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8124  0000000                   EN_GLOBALVOL_VOL1 MACRO
 8125  0000000                   	DIS_SP_EQU_VOL 00H
 8126  0000000                   ENDM
 8127  0000000                   	.ENDIF
 8128  0000000                   ;------------------------------------------------------------------------------
 8129  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8130  0000000                   EN_GLOBALVOL_VOL2 MACRO
 8131  0000000                   	DIS_SP_EQU_VOL 01H
 8132  0000000                   ENDM
 8133  0000000                   	.ENDIF
 8134  0000000                   ;------------------------------------------------------------------------------	
 8135  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8136  0000000                   EN_GLOBALVOL_VOL3 MACRO
 8137  0000000                   	DIS_SP_EQU_VOL 02H
 8138  0000000                   ENDM
 8139  0000000                   	.ENDIF
 8140  0000000                   .ENDIF





 8141  0000000                   .ENDIF		                                                                       
 8142  0000000                   ;==============================================================================
 8143  0000000                   EN_SP_EQU_VOL_Y MACRO                                                          
 8144  0000000                   	.IF(WITH_SP .EQ. 1H)                                                   
 8145  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)                                              
 8146  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8147  0000000                   		LDA 0,X                                                        
 8148  0000000                   		AND #7FH                                                       
 8149  0000000                   		STA 0,X                                                        
 8150  0000000                   	.ENDIF                                                                 
 8151  0000000                   	.ENDIF                                                                 
 8152  0000000                   ENDM	
 8153  0000000                   ;------------------------------------------------------------------------------	
 8154  0000000                   EN_SP_EQU_VOL MACRO CHANNEL
 8155  0000000                   	.IF(WITH_SP .EQ. 1H)
 8156  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)
 8157  0000000                   		LDY #CHANNEL
 8158  0000000                   		EN_SP_EQU_VOL_Y
 8159  0000000                   	.ENDIF
 8160  0000000                   	.ENDIF 
 8161  0000000                   ENDM
 8162  0000000                   ;------------------------------------------------------------------------------	
 8163  0000000                   .IF (WITH_SP .EQ. 1)
 8164  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8165  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8166  0000000                   DIS_GLOBALVOL_VOL1 MACRO
 8167  0000000                   	EN_SP_EQU_VOL 00H	
 8168  0000000                   ENDM
 8169  0000000                   	.ENDIF
 8170  0000000                   ;------------------------------------------------------------------------------
 8171  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8172  0000000                   DIS_GLOBALVOL_VOL2 MACRO
 8173  0000000                   	EN_SP_EQU_VOL 01H
 8174  0000000                   ENDM
 8175  0000000                   	.ENDIF
 8176  0000000                   ;------------------------------------------------------------------------------
 8177  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8178  0000000                   DIS_GLOBALVOL_VOL3 MACRO
 8179  0000000                   	EN_SP_EQU_VOL 02H
 8180  0000000                   ENDM
 8181  0000000                   	.ENDIF
 8182  0000000                   .ENDIF
 8183  0000000                   .ENDIF                                                                                                                                                                                                                                                                                                                                                     
 8184  0000000                   ;update by angela for en/dis GLOBALVOL feature
 8185  0000000                   ;===============================================================================
 8186  0000000                   ;===============================================================================
 8187  0000000                   SET_VOLM MACRO NEW_MS_VOL
 8188  0000000                   	.IF (WITH_MS .EQ. 1H)
 8189  0000000                   	.IF (WITH_VOL_ADJ_MS .EQ. 1H)
 8190  0000000                   		LDA <GLOBAL_MASTER_VOL_MS
 8191  0000000                   		AND #GLOBAL_VOL_MS_FLAG
 8192  0000000                   		ORA #NEW_MS_VOL
 8193  0000000                   		STA <GLOBAL_MASTER_VOL_MS
 8194  0000000                   	.ENDIF
 8195  0000000                   	.ENDIF
 8196  0000000                   	ENDM
 8197  0000000                   ;------------------------------------------------------------------------------





 8198  0000000                   SET_VOLM_RAM MACRO VOL_RAM
 8199  0000000                   	.IF (WITH_MS .EQ. 1H)
 8200  0000000                   	.IF (WITH_VOL_ADJ_MS .EQ. 1H)
 8201  0000000                   		LDA <GLOBAL_MASTER_VOL_MS
 8202  0000000                   		AND #GLOBAL_VOL_MS_FLAG
 8203  0000000                   		ORA !VOL_RAM
 8204  0000000                   		STA <GLOBAL_MASTER_VOL_MS
 8205  0000000                   	.ENDIF
 8206  0000000                   	.ENDIF
 8207  0000000                   	ENDM
 8208  0000000                   ;===============================================================================
 8209  0000000                   ;===============================================================================	
 8210  0000000                   EN_GLOBALVOL_VOLM MACRO
 8211  0000000                   	.IF(WITH_MS .EQ. 1H)
 8212  0000000                   	.IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8213  0000000                   		LDA #GLOBAL_VOL_MS_FLAG
 8214  0000000                   		TSB <GLOBAL_MASTER_VOL_MS
 8215  0000000                   	.ENDIF
 8216  0000000                   	.ENDIF	
 8217  0000000                   	ENDM
 8218  0000000                   ;------------------------------------------------------------------------------	
 8219  0000000                   DIS_GLOBALVOL_VOLM MACRO
 8220  0000000                   	.IF(WITH_MS .EQ. 1H)
 8221  0000000                   	.IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8222  0000000                   		LDA #GLOBAL_VOL_MS_FLAG
 8223  0000000                   		TRB <GLOBAL_MASTER_VOL_MS
 8224  0000000                   	.ENDIF
 8225  0000000                   	.ENDIF	
 8226  0000000                   	ENDM
 8227  0000000                   ;===============================================================================
 8228  0000000                   ;===============================================================================
 8229  0000000                   SET_VOL_ALL MACRO NEW_VOL
 8230  0000000                   .IF (WITH_SP .EQ. 1)
 8231  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8232  0000000                   		LDY #FFh
 8233  0000000                   SET_VOL_ALL_SP_NEXT#:
 8234  0000000                   		INY	
 8235  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8236  0000000                   		BEQ SET_VOL_ALL_SP_END#
 8237  0000000                   
 8238  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 8239  0000000                   		LDA 0,X
 8240  0000000                   		AND #GLOBAL_VOL_FLAG
 8241  0000000                   		ORA #NEW_VOL
 8242  0000000                   		STA 0,X
 8243  0000000                   
 8244  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8245  0000000                   		LDA <CH_STATUS_SP,X
 8246  0000000                   		BIT #SP_BZ 
 8247  0000000                   		BEQ SET_VOL_ALL_SP_NEXT#
 8248  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8249  0000000                   		BNE SET_VOL_ALL_SP_NEXT#
 8250  0000000                   
 8251  0000000                   		LDA #NEW_VOL
 8252  0000000                   		ASL A
 8253  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8254  0000000                   		BRA SET_VOL_ALL_SP_NEXT#





 8255  0000000                   
 8256  0000000                   SET_VOL_ALL_SP_END#:
 8257  0000000                   .ENDIF
 8258  0000000                   .ENDIF
 8259  0000000                   
 8260  0000000                   .IF(WITH_MS .EQ. 1H)
 8261  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8262  0000000                   	SET_VOLM NEW_VOL
 8263  0000000                   .ENDIF
 8264  0000000                   .ENDIF
 8265  0000000                   ENDM
 8266  0000000                   ;------------------------------------------------------------------------------
 8267  0000000                   SET_VOL_ALL_RAM MACRO VOLUME_RAM
 8268  0000000                   .IF (WITH_SP .EQ. 1)
 8269  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8270  0000000                   		LDY #FFh
 8271  0000000                   SET_VOL_ALL_RAM_SP_NEXT#:
 8272  0000000                   		INY	
 8273  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8274  0000000                   		BEQ SET_VOL_ALL_RAM_SP_END#
 8275  0000000                   
 8276  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 8277  0000000                   		LDA 0,X
 8278  0000000                   		AND #GLOBAL_VOL_FLAG
 8279  0000000                   		ORA !VOLUME_RAM
 8280  0000000                   		STA 0,X
 8281  0000000                   
 8282  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8283  0000000                   		LDA <CH_STATUS_SP,X
 8284  0000000                   		BIT #SP_BZ 
 8285  0000000                   		BEQ SET_VOL_ALL_RAM_SP_NEXT#
 8286  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8287  0000000                   		BNE SET_VOL_ALL_RAM_SP_NEXT#
 8288  0000000                   
 8289  0000000                   		LDA !VOLUME_RAM
 8290  0000000                   		ASL A
 8291  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8292  0000000                   		BRA SET_VOL_ALL_RAM_SP_NEXT#	
 8293  0000000                   
 8294  0000000                   SET_VOL_ALL_RAM_SP_END#:
 8295  0000000                   .ENDIF
 8296  0000000                   .ENDIF
 8297  0000000                   
 8298  0000000                   .IF(WITH_MS .EQ. 1H)
 8299  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8300  0000000                   	SET_VOLM_RAM VOLUME_RAM
 8301  0000000                   .ENDIF
 8302  0000000                   .ENDIF
 8303  0000000                   ENDM
 8304  0000000                   ;------------------------------------------------------------------------------
 8305  0000000                   EN_GLOBALVOL_VOL_ALL MACRO
 8306  0000000                   .IF (WITH_SP .EQ. 1)
 8307  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8308  0000000                   		LDY #FFh
 8309  0000000                   EN_GLOBALVOL_VOL_ALL_SP_NEXT#:
 8310  0000000                   		INY	
 8311  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y





 8312  0000000                   		BEQ EN_GLOBALVOL_VOL_ALL_SP_END#
 8313  0000000                   
 8314  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8315  0000000                   		LDA 0,X                                                        
 8316  0000000                   		ORA #GLOBAL_VOL_FLAG                                                      
 8317  0000000                   		STA 0,X                                         
 8318  0000000                   
 8319  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8320  0000000                   		LDA <CH_STATUS_SP,X
 8321  0000000                   		BIT #SP_BZ 
 8322  0000000                   		BEQ EN_GLOBALVOL_VOL_ALL_SP_NEXT#
 8323  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8324  0000000                   		BNE EN_GLOBALVOL_VOL_ALL_SP_NEXT#
 8325  0000000                   
 8326  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8327  0000000                   		LDA 0,X                                                             
 8328  0000000                   		AND #7FH                                                       
 8329  0000000                   		ASL A                                                          
 8330  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y                                   
 8331  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8332  0000000                   EN_GLOBALVOL_VOL_ALL_SP_END#:                        
 8333  0000000                   .ENDIF
 8334  0000000                   .ENDIF
 8335  0000000                   
 8336  0000000                   .IF(WITH_MS .EQ. 1H)
 8337  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8338  0000000                   	EN_GLOBALVOL_VOLM
 8339  0000000                   .ENDIF
 8340  0000000                   .ENDIF
 8341  0000000                   ENDM
 8342  0000000                   ;------------------------------------------------------------------------------
 8343  0000000                   DIS_GLOBALVOL_VOL_ALL MACRO
 8344  0000000                   .IF (WITH_SP .EQ. 1)
 8345  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8346  0000000                   	LDY #FFh
 8347  0000000                   DIS_GLOBALVOL_VOL_ALL_SP_NEXT#:
 8348  0000000                   		INY	
 8349  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8350  0000000                   		BEQ DIS_GLOBALVOL_VOL_ALL_SP_END#
 8351  0000000                   
 8352  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8353  0000000                   		LDA 0,X                                                        
 8354  0000000                   		AND #7FH                                                       
 8355  0000000                   		STA 0,X  
 8356  0000000                   DIS_GLOBALVOL_VOL_ALL_SP_END#:     
 8357  0000000                   .ENDIF
 8358  0000000                   .ENDIF
 8359  0000000                   
 8360  0000000                   .IF(WITH_MS .EQ. 1H)
 8361  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8362  0000000                   	DIS_GLOBALVOL_VOLM
 8363  0000000                   .ENDIF
 8364  0000000                   .ENDIF
 8365  0000000                   ENDM
 8366  0000000                   ;===============================================================================
 8367  0000000                   ;===============================================================================
 8368  0000000                   SET_MS_CHANNEL_VOLUME MACRO VOLUME_VALUE, CHANNEL





 8369  0000000                   	.IF (WITH_MS .EQ. 1H)
 8370  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8371  0000000                   		LDX #CHANNEL
 8372  0000000                   		EXTERN MS_CHANNEL_TABLE
 8373  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8374  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME#
 8375  0000000                   
 8376  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8377  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8378  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8379  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8380  0000000                   			AND #80H
 8381  0000000                   			ORA #VOLUME_VALUE
 8382  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8383  0000000                   		.ENDIF
 8384  0000000                   
 8385  0000000                   		LDA <GLOBAL_PLAY
 8386  0000000                   		BIT #MIDI_BZ+MS_EXT
 8387  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME#
 8388  0000000                   
 8389  0000000                   		LDA #VOLUME_VALUE
 8390  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8391  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME#
 8392  0000000                   
 8393  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8394  0000000                   		PSF_RESPONSE_LIMIT
 8395  0000000                   		TXA
 8396  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC
 8397  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8398  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8399  0000000                   
 8400  0000000                   END_SET_MS_CHANNEL_VOLUME#:
 8401  0000000                   	.ENDIF
 8402  0000000                   	.ENDIF
 8403  0000000                   	ENDM
 8404  0000000                   ;------------------------------------------------------------------------------
 8405  0000000                   	.IF (WITH_MS .EQ. 1H)
 8406  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8407  0000000                   SET_VOLM1 MACRO VOLUME_VALUE 
 8408  0000000                   	SET_MS_CHANNEL_VOLUME VOLUME_VALUE, 00
 8409  0000000                   ENDM
 8410  0000000                   ;------------------------------------------------------------------------------
 8411  0000000                   SET_VOLM2 MACRO VOLUME_VALUE 
 8412  0000000                   	SET_MS_CHANNEL_VOLUME VOLUME_VALUE, 01
 8413  0000000                   ENDM
 8414  0000000                   ;------------------------------------------------------------------------------
 8415  0000000                   SET_VOLM3 MACRO VOLUME_VALUE 
 8416  0000000                   	SET_MS_CHANNEL_VOLUME VOLUME_VALUE, 02
 8417  0000000                   ENDM
 8418  0000000                   	.ENDIF
 8419  0000000                   	.ENDIF
 8420  0000000                   ;===============================================================================
 8421  0000000                   SET_MS_CHANNEL_VOLUME_RAM MACRO VOLUME_RAM, CHANNEL
 8422  0000000                   	.IF (WITH_MS .EQ. 1H)
 8423  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8424  0000000                   		LDX #CHANNEL
 8425  0000000                   		EXTERN MS_CHANNEL_TABLE





 8426  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8427  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME_RAM#
 8428  0000000                   
 8429  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8430  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8431  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8432  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8433  0000000                   			AND #80H
 8434  0000000                   			ORA VOLUME_RAM
 8435  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8436  0000000                   		.ENDIF
 8437  0000000                   
 8438  0000000                   		LDA <GLOBAL_PLAY
 8439  0000000                   		BIT #MIDI_BZ+MS_EXT
 8440  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME_RAM#
 8441  0000000                   
 8442  0000000                   		LDA VOLUME_RAM
 8443  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8444  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME_RAM#
 8445  0000000                   
 8446  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8447  0000000                   		PSF_RESPONSE_LIMIT
 8448  0000000                   		TXA
 8449  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC
 8450  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8451  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8452  0000000                   
 8453  0000000                   END_SET_MS_CHANNEL_VOLUME_RAM#:
 8454  0000000                   	.ENDIF
 8455  0000000                   	.ENDIF
 8456  0000000                   	ENDM
 8457  0000000                   ;------------------------------------------------------------------------------
 8458  0000000                   	.IF (WITH_MS .EQ. 1H)
 8459  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8460  0000000                   SET_VOLM1_RAM MACRO VOLUME_RAM 
 8461  0000000                   	SET_MS_CHANNEL_VOLUME_RAM VOLUME_RAM, 00
 8462  0000000                   ENDM
 8463  0000000                   ;------------------------------------------------------------------------------
 8464  0000000                   SET_VOLM2_RAM MACRO VOLUME_RAM 
 8465  0000000                   	SET_MS_CHANNEL_VOLUME_RAM VOLUME_RAM, 01
 8466  0000000                   ENDM
 8467  0000000                   ;------------------------------------------------------------------------------
 8468  0000000                   SET_VOLM3_RAM MACRO VOLUME_RAM 
 8469  0000000                   	SET_MS_CHANNEL_VOLUME_RAM VOLUME_RAM, 02
 8470  0000000                   ENDM
 8471  0000000                   	.ENDIF
 8472  0000000                   	.ENDIF
 8473  0000000                   ;===============================================================================
 8474  0000000                   ;===============================================================================	
 8475  0000000                   EN_GLOBAL_CHANNEL_VOLM MACRO CHANNEL
 8476  0000000                   	.IF (WITH_MS .EQ. 1H)
 8477  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8478  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8479  0000000                   		LDX #CHANNEL
 8480  0000000                   		EXTERN MS_CHANNEL_TABLE
 8481  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8482  0000000                   		BEQ END_EN_GLOBAL_CHANNEL_VOLM#





 8483  0000000                   
 8484  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8485  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8486  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8487  0000000                   		ORA #80H
 8488  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8489  0000000                   
 8490  0000000                   		LDA <GLOBAL_PLAY
 8491  0000000                   		BIT #MIDI_BZ+MS_EXT
 8492  0000000                   		BEQ END_EN_GLOBAL_CHANNEL_VOLM#
 8493  0000000                   
 8494  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8495  0000000                   		AND #7FH
 8496  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8497  0000000                   
 8498  0000000                   END_EN_GLOBAL_CHANNEL_VOLM#:		
 8499  0000000                   	.ENDIF
 8500  0000000                   	.ENDIF	
 8501  0000000                   	.ENDIF	
 8502  0000000                   	ENDM
 8503  0000000                   ;------------------------------------------------------------------------------
 8504  0000000                   	.IF (WITH_MS .EQ. 1H)
 8505  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8506  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8507  0000000                   
 8508  0000000                   EN_GLOBALVOL_VOLM1 MACRO
 8509  0000000                   	EN_GLOBAL_CHANNEL_VOLM 00
 8510  0000000                   ENDM
 8511  0000000                   ;------------------------------------------------------------------------------
 8512  0000000                   EN_GLOBALVOL_VOLM2 MACRO
 8513  0000000                   	EN_GLOBAL_CHANNEL_VOLM 01
 8514  0000000                   ENDM
 8515  0000000                   ;------------------------------------------------------------------------------
 8516  0000000                   EN_GLOBALVOL_VOLM3 MACRO
 8517  0000000                   	EN_GLOBAL_CHANNEL_VOLM 02
 8518  0000000                   ENDM
 8519  0000000                   	.ENDIF
 8520  0000000                   	.ENDIF	
 8521  0000000                   	.ENDIF
 8522  0000000                   ;===============================================================================	
 8523  0000000                   DIS_GLOBAL_CHANNEL_VOLM MACRO CHANNEL
 8524  0000000                   	.IF (WITH_MS .EQ. 1H)
 8525  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8526  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8527  0000000                   		LDX #CHANNEL
 8528  0000000                   		EXTERN MS_CHANNEL_TABLE
 8529  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8530  0000000                   		BEQ END_DIS_GLOBAL_CHANNEL_VOLM#
 8531  0000000                   
 8532  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8533  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8534  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8535  0000000                   		AND #7FH
 8536  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8537  0000000                   END_DIS_GLOBAL_CHANNEL_VOLM#:		
 8538  0000000                   	.ENDIF
 8539  0000000                   	.ENDIF	





 8540  0000000                   	.ENDIF	
 8541  0000000                   	ENDM
 8542  0000000                   ;------------------------------------------------------------------------------
 8543  0000000                   	.IF (WITH_MS .EQ. 1H)
 8544  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8545  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8546  0000000                   
 8547  0000000                   DIS_GLOBALVOL_VOLM1 MACRO
 8548  0000000                   	DIS_GLOBAL_CHANNEL_VOLM 00
 8549  0000000                   ENDM
 8550  0000000                   ;------------------------------------------------------------------------------
 8551  0000000                   DIS_GLOBALVOL_VOLM2 MACRO
 8552  0000000                   	DIS_GLOBAL_CHANNEL_VOLM 01
 8553  0000000                   ENDM
 8554  0000000                   ;------------------------------------------------------------------------------
 8555  0000000                   DIS_GLOBALVOL_VOLM3 MACRO
 8556  0000000                   	DIS_GLOBAL_CHANNEL_VOLM 02
 8557  0000000                   ENDM
 8558  0000000                   	.ENDIF	
 8559  0000000                   	.ENDIF
 8560  0000000                   	.ENDIF
 8561  0000000                   ;==============================================================================
 8562  0000000                   SET_VOLMX_ALL MACRO VOLUME_VALUE 
 8563  0000000                   .IF (WITH_MS .EQ. 1H)
 8564  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8565  0000000                   		LDX #FFh
 8566  0000000                   SET_VOLMX_ALL_NEXT#:
 8567  0000000                   		INX
 8568  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8569  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8570  0000000                   		BEQ SET_VOLMX_ALL_END#
 8571  0000000                   
 8572  0000000                   		EXTERN MS_CHANNEL_TABLE
 8573  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8574  0000000                   		BEQ SET_VOLMX_ALL_NEXT#
 8575  0000000                   
 8576  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8577  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8578  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8579  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8580  0000000                   			AND #80H
 8581  0000000                   			ORA #VOLUME_VALUE
 8582  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8583  0000000                   		.ENDIF
 8584  0000000                   
 8585  0000000                   		LDA <GLOBAL_PLAY
 8586  0000000                   		BIT #MIDI_BZ+MS_EXT
 8587  0000000                   		BEQ SET_VOLMX_ALL_NEXT#
 8588  0000000                   
 8589  0000000                   		LDA #VOLUME_VALUE
 8590  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8591  0000000                   		BEQ SET_VOLMX_ALL_NEXT#
 8592  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8593  0000000                   
 8594  0000000                   		PSF_RESPONSE_LIMIT
 8595  0000000                   		TXA
 8596  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC





 8597  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8598  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8599  0000000                   		BRA SET_VOLMX_ALL_NEXT#
 8600  0000000                   
 8601  0000000                   SET_VOLMX_ALL_END#:
 8602  0000000                   .ENDIF
 8603  0000000                   .ENDIF
 8604  0000000                   ENDM
 8605  0000000                   ;------------------------------------------------------------------------------
 8606  0000000                   SET_VOLMX_ALL_RAM MACRO VOLUME_RAM
 8607  0000000                   .IF (WITH_MS .EQ. 1H)
 8608  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8609  0000000                   		LDX #FFh
 8610  0000000                   SET_VOLMX_ALL_RAM_NEXT#:
 8611  0000000                   		INX
 8612  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8613  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8614  0000000                   		BEQ SET_VOLMX_ALL_RAM_END#
 8615  0000000                   
 8616  0000000                   		EXTERN MS_CHANNEL_TABLE
 8617  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8618  0000000                   		BEQ SET_VOLMX_ALL_RAM_NEXT#
 8619  0000000                   
 8620  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8621  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8622  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8623  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8624  0000000                   			AND #80H
 8625  0000000                   			ORA VOLUME_RAM
 8626  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8627  0000000                   		.ENDIF
 8628  0000000                   
 8629  0000000                   		LDA <GLOBAL_PLAY
 8630  0000000                   		BIT #MIDI_BZ+MS_EXT
 8631  0000000                   		BEQ SET_VOLMX_ALL_RAM_NEXT#
 8632  0000000                   
 8633  0000000                   		LDA VOLUME_RAM
 8634  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8635  0000000                   		BEQ SET_VOLMX_ALL_RAM_NEXT#
 8636  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8637  0000000                   
 8638  0000000                   		PSF_RESPONSE_LIMIT
 8639  0000000                   		TXA
 8640  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC
 8641  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8642  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8643  0000000                   		BRA SET_VOLMX_ALL_RAM_NEXT#
 8644  0000000                   
 8645  0000000                   SET_VOLMX_ALL_RAM_END#:
 8646  0000000                   .ENDIF
 8647  0000000                   .ENDIF
 8648  0000000                   ENDM
 8649  0000000                   ;------------------------------------------------------------------------------
 8650  0000000                   EN_GLOBALVOL_VOLMX_ALL MACRO
 8651  0000000                   .IF (WITH_MS .EQ. 1H)
 8652  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8653  0000000                   .IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)	





 8654  0000000                   		LDX #FFh
 8655  0000000                   EN_GLOBALVOL_VOLMX_ALL_NEXT#:
 8656  0000000                   		INX
 8657  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8658  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8659  0000000                   		BEQ EN_GLOBALVOL_VOLMX_ALL_END#
 8660  0000000                   
 8661  0000000                   		EXTERN MS_CHANNEL_TABLE
 8662  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8663  0000000                   		BEQ EN_GLOBALVOL_VOLMX_ALL_NEXT#
 8664  0000000                   
 8665  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8666  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8667  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8668  0000000                   		ORA #80H
 8669  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8670  0000000                   
 8671  0000000                   		LDA <GLOBAL_PLAY
 8672  0000000                   		BIT #MIDI_BZ+MS_EXT
 8673  0000000                   		BEQ EN_GLOBALVOL_VOLMX_ALL_NEXT#
 8674  0000000                   
 8675  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8676  0000000                   		AND #7FH
 8677  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8678  0000000                   		BRA EN_GLOBALVOL_VOLMX_ALL_NEXT#
 8679  0000000                   
 8680  0000000                   EN_GLOBALVOL_VOLMX_ALL_END#:		
 8681  0000000                   .ENDIF
 8682  0000000                   .ENDIF
 8683  0000000                   .ENDIF
 8684  0000000                   ENDM
 8685  0000000                   ;------------------------------------------------------------------------------
 8686  0000000                   DIS_GLOBALVOL_VOLMX_ALL MACRO
 8687  0000000                   .IF (WITH_MS .EQ. 1H)
 8688  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8689  0000000                   .IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8690  0000000                   		LDX #FFh
 8691  0000000                   DIS_GLOBALVOL_VOLMX_ALL_NEXT#:
 8692  0000000                   		INX
 8693  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8694  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8695  0000000                   		BEQ DIS_GLOBALVOL_VOLMX_ALL_END#
 8696  0000000                   
 8697  0000000                   		EXTERN MS_CHANNEL_TABLE
 8698  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8699  0000000                   		BEQ DIS_GLOBALVOL_VOLMX_ALL_NEXT#
 8700  0000000                   
 8701  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8702  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8703  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8704  0000000                   		AND #7FH
 8705  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8706  0000000                   		BRA DIS_GLOBALVOL_VOLMX_ALL_NEXT#
 8707  0000000                   DIS_GLOBALVOL_VOLMX_ALL_END#:
 8708  0000000                   .ENDIF
 8709  0000000                   .ENDIF
 8710  0000000                   .ENDIF





 8711  0000000                   ENDM
 8712  0000000                   ;==============================================================================
 8713  0000000                   ; Set pitch offset
 8714  0000000                   ;==============================================================================
 8715  0000000                   	.IF (WITH_MS .EQ. 1H)
 8716  0000000                   	.IF (WITH_NOTE_OFFSET .EQ. 1H)
 8717  0000000                   SET_PITCH_OFFSET MACRO PITCH_OFFSET	
 8718  0000000                   	LDA #PITCH_OFFSET
 8719  0000000                   	STA <MS_START+CH_NOTE_OFFSET_MS
 8720  0000000                   ENDM		
 8721  0000000                   	.ENDIF
 8722  0000000                   	.ENDIF
 8723  0000000                   ;------------------------------------------------------------------------------
 8724  0000000                   	.IF (WITH_MS .EQ. 1H)
 8725  0000000                   	.IF (WITH_NOTE_OFFSET .EQ. 1H)
 8726  0000000                   SET_PITCH_OFFSET_RAM MACRO PITCH_OFFSET_RAM	
 8727  0000000                   		LDA !PITCH_OFFSET_RAM
 8728  0000000                   		STA <MS_START+CH_NOTE_OFFSET_MS
 8729  0000000                   ENDM		
 8730  0000000                   	.ENDIF
 8731  0000000                   	.ENDIF	
 8732  0000000                   
 8733  0000000                   ;==============================================================================
 8734  0000000                   ; Set instrument of specific MIDI channel
 8735  0000000                   ;==============================================================================
 8736  0000000                   SET_CHANNEL_INSTRUMENT_Y MACRO INSTRUMENT_ID
 8737  0000000                   	.IF (WITH_MS .EQ. 1H)				
 8738  0000000                   		LDX #INSTRUMENT_ID
 8739  0000000                   		EXTERN INS_MAX_INDEX
 8740  0000000                   		CPX #(INS_MAX_INDEX+1)
 8741  0000000                   		BCS INVALID_GO_OUT_#
 8742  0000000                   
 8743  0000000                   		EXTERN INSTRUMENT_TYPE_LIST_TABLE
 8744  0000000                   		LDA !INSTRUMENT_TYPE_LIST_TABLE,X
 8745  0000000                   		CMP #FFH
 8746  0000000                   		BEQ INVALID_GO_OUT_#
 8747  0000000                   
 8748  0000000                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8749  0000000                   			EXTERN MS_CHANNEL_TABLE
 8750  0000000                   			LDA !MS_CHANNEL_TABLE,Y
 8751  0000000                   			BEQ INVALID_GO_OUT_#
 8752  0000000                   
 8753  0000000                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8754  0000000                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
 8755  0000000                   			LDA GLOBAL_CHANNEL_INS0,X
 8756  0000000                   			AND #80H
 8757  0000000                   			ORA #INSTRUMENT_ID
 8758  0000000                   			STA GLOBAL_CHANNEL_INS0,X
 8759  0000000                   		.ENDIF
 8760  0000000                   
 8761  0000000                   		LDA #INSTRUMENT_ID
 8762  0000000                   		STA !CH_CHANNEL_INSTRUMENT,Y
 8763  0000000                   INVALID_GO_OUT_#:
 8764  0000000                   	.ENDIF
 8765  0000000                   	ENDM
 8766  0000000                   ;------------------------------------------------------------------------------
 8767  0000000                   SET_CHANNEL_INSTRUMENT MACRO CHANNEL_ID,INSTRUMENT_ID





 8768  0000000                   	.IF (WITH_MS .EQ. 1H)
 8769  0000000                   		LDY #CHANNEL_ID
 8770  0000000                   		SET_CHANNEL_INSTRUMENT_Y INSTRUMENT_ID
 8771  0000000                   	.ENDIF
 8772  0000000                   	ENDM
 8773  0000000                   ;------------------------------------------------------------------------------
 8774  0000000                   .IF (WITH_MS .EQ. 1)
 8775  0000000                   	.IF (WITH_POLYPHONY .GT. 0H)
 8776  0000000                   SET_EVP1 MACRO NEW_EVP
 8777  0000000                   	SET_CHANNEL_INSTRUMENT 00H, NEW_EVP
 8778  0000000                   ENDM
 8779  0000000                   	.ENDIF		
 8780  0000000                   ;------------------------------------------------------------------------------
 8781  0000000                   	.IF (WITH_POLYPHONY .GT. 1H || WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8782  0000000                   SET_EVP2 MACRO NEW_EVP
 8783  0000000                   	SET_CHANNEL_INSTRUMENT 01H, NEW_EVP
 8784  0000000                   ENDM
 8785  0000000                   	.ENDIF
 8786  0000000                   ;------------------------------------------------------------------------------
 8787  0000000                   	.IF (WITH_POLYPHONY .GT. 2H ||WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8788  0000000                   SET_EVP3 MACRO NEW_EVP
 8789  0000000                   	SET_CHANNEL_INSTRUMENT 02H, NEW_EVP
 8790  0000000                   ENDM
 8791  0000000                   	.ENDIF
 8792  0000000                   .ENDIF
 8793  0000000                   ;==============================================================================
 8794  0000000                   SET_CHANNEL_INSTRUMENT_Y_BY_RAM MACRO INSTRUMENT_RAM
 8795  0000000                   	.IF (WITH_MS .EQ. 1H)
 8796  0000000                   		LDX INSTRUMENT_RAM
 8797  0000000                   		EXTERN INS_MAX_INDEX
 8798  0000000                   		CPX #(INS_MAX_INDEX+1)
 8799  0000000                   		BCS INVALID_GO_OUT_RAM_#
 8800  0000000                   
 8801  0000000                   		EXTERN INSTRUMENT_TYPE_LIST_TABLE
 8802  0000000                   		LDA !INSTRUMENT_TYPE_LIST_TABLE,X
 8803  0000000                   		CMP #FFH
 8804  0000000                   		BEQ INVALID_GO_OUT_RAM_#
 8805  0000000                   
 8806  0000000                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8807  0000000                   			EXTERN MS_CHANNEL_TABLE
 8808  0000000                   			LDA !MS_CHANNEL_TABLE,Y
 8809  0000000                   			BEQ INVALID_GO_OUT_RAM_#
 8810  0000000                   
 8811  0000000                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8812  0000000                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
 8813  0000000                   			LDA GLOBAL_CHANNEL_INS0,X
 8814  0000000                   			AND #80H
 8815  0000000                   			ORA INSTRUMENT_RAM
 8816  0000000                   			STA GLOBAL_CHANNEL_INS0,X
 8817  0000000                   		.ENDIF
 8818  0000000                   
 8819  0000000                   		LDA INSTRUMENT_RAM
 8820  0000000                   		STA !CH_CHANNEL_INSTRUMENT,Y
 8821  0000000                   INVALID_GO_OUT_RAM_#:
 8822  0000000                   	.ENDIF
 8823  0000000                   	ENDM
 8824  0000000                   ;------------------------------------------------------------------------------





 8825  0000000                   SET_CHANNEL_INSTRUMENT_BY_RAM MACRO CHANNEL_ID, INSTRUMENT_RAM
 8826  0000000                   	.IF (WITH_MS .EQ. 1H)
 8827  0000000                   		LDY #CHANNEL_ID
 8828  0000000                   		SET_CHANNEL_INSTRUMENT_Y_BY_RAM INSTRUMENT_RAM
 8829  0000000                   	.ENDIF
 8830  0000000                   	ENDM
 8831  0000000                   ;------------------------------------------------------------------------------
 8832  0000000                   .IF (WITH_MS .EQ. 1)
 8833  0000000                   	.IF (WITH_POLYPHONY .GT. 0H)
 8834  0000000                   SET_EVP1_RAM MACRO NEW_EVP_RAM
 8835  0000000                   	SET_CHANNEL_INSTRUMENT_BY_RAM 00H, NEW_EVP_RAM
 8836  0000000                   ENDM		
 8837  0000000                   	.ENDIF
 8838  0000000                   ;------------------------------------------------------------------------------
 8839  0000000                   	.IF (WITH_POLYPHONY .GT. 1H || WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8840  0000000                   SET_EVP2_RAM MACRO NEW_EVP_RAM	
 8841  0000000                   	SET_CHANNEL_INSTRUMENT_BY_RAM 01H, NEW_EVP_RAM
 8842  0000000                   ENDM		
 8843  0000000                   	.ENDIF
 8844  0000000                   ;------------------------------------------------------------------------------
 8845  0000000                   	.IF (WITH_POLYPHONY .GT. 2H || WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8846  0000000                   SET_EVP3_RAM MACRO NEW_EVP_RAM	
 8847  0000000                   	SET_CHANNEL_INSTRUMENT_BY_RAM 02H, NEW_EVP_RAM
 8848  0000000                   ENDM		
 8849  0000000                   	.ENDIF	
 8850  0000000                   .ENDIF
 8851  0000000                   ;===============================================================================
 8852  0000000                   ;===============================================================================	
 8853  0000000                   EN_GLOBAL_CHANNEL_INS MACRO CHANNEL
 8854  0000000                   	.IF (WITH_MS .EQ. 1H)
 8855  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8856  0000000                   		LDX #CHANNEL
 8857  0000000                   		EXTERN MS_CHANNEL_TABLE
 8858  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8859  0000000                   		BEQ END_EN_GLOBAL_CHANNEL_INS#
 8860  0000000                   
 8861  0000000                   		EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8862  0000000                   		LDY MS_GLOBAL_CHANNEL_INS_TABLE,X
 8863  0000000                   		LDA GLOBAL_CHANNEL_INS0,Y
 8864  0000000                   		ORA #80H
 8865  0000000                   		STA GLOBAL_CHANNEL_INS0,Y
 8866  0000000                   
 8867  0000000                   		AND #7FH
 8868  0000000                   		STA !CH_CHANNEL_INSTRUMENT,X
 8869  0000000                   END_EN_GLOBAL_CHANNEL_INS#:		
 8870  0000000                   	.ENDIF
 8871  0000000                   	.ENDIF	
 8872  0000000                   	ENDM
 8873  0000000                   ;------------------------------------------------------------------------------
 8874  0000000                   	.IF (WITH_MS .EQ. 1H)
 8875  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8876  0000000                   
 8877  0000000                   EN_GLOBALINS_M1 MACRO
 8878  0000000                   	EN_GLOBAL_CHANNEL_INS 00
 8879  0000000                   ENDM
 8880  0000000                   ;------------------------------------------------------------------------------
 8881  0000000                   EN_GLOBALINS_M2 MACRO





 8882  0000000                   	EN_GLOBAL_CHANNEL_INS 01
 8883  0000000                   ENDM
 8884  0000000                   ;------------------------------------------------------------------------------
 8885  0000000                   EN_GLOBALINS_M3 MACRO
 8886  0000000                   	EN_GLOBAL_CHANNEL_INS 02
 8887  0000000                   ENDM
 8888  0000000                   	.ENDIF
 8889  0000000                   	.ENDIF
 8890  0000000                   ;===============================================================================	
 8891  0000000                   DIS_GLOBAL_CHANNEL_INS MACRO CHANNEL
 8892  0000000                   	.IF (WITH_MS .EQ. 1H)
 8893  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8894  0000000                   		LDX #CHANNEL
 8895  0000000                   		EXTERN MS_CHANNEL_TABLE
 8896  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8897  0000000                   		BEQ END_DIS_GLOBAL_CHANNEL_INS#
 8898  0000000                   
 8899  0000000                   		EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8900  0000000                   		LDY MS_GLOBAL_CHANNEL_INS_TABLE,X
 8901  0000000                   		LDA GLOBAL_CHANNEL_INS0,Y
 8902  0000000                   		AND #7FH
 8903  0000000                   		STA GLOBAL_CHANNEL_INS0,Y
 8904  0000000                   END_DIS_GLOBAL_CHANNEL_INS#:		
 8905  0000000                   	.ENDIF
 8906  0000000                   	.ENDIF	
 8907  0000000                   	ENDM
 8908  0000000                   ;------------------------------------------------------------------------------
 8909  0000000                   	.IF (WITH_MS .EQ. 1H)
 8910  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8911  0000000                   DIS_GLOBALINS_M1 MACRO
 8912  0000000                   	DIS_GLOBAL_CHANNEL_INS 00
 8913  0000000                   ENDM
 8914  0000000                   ;------------------------------------------------------------------------------
 8915  0000000                   DIS_GLOBALINS_M2 MACRO
 8916  0000000                   	DIS_GLOBAL_CHANNEL_INS 01
 8917  0000000                   ENDM
 8918  0000000                   ;------------------------------------------------------------------------------
 8919  0000000                   DIS_GLOBALINS_M3 MACRO
 8920  0000000                   	DIS_GLOBAL_CHANNEL_INS 02
 8921  0000000                   ENDM
 8922  0000000                   	.ENDIF
 8923  0000000                   	.ENDIF
 8924  0000000                   ;===============================================================================
 8925  0000000                   ; For external midi note on/off
 8926  0000000                   ;===============================================================================		
 8927  0000000                   EXT_NOTE_ON_WCF1 MACRO CHANNEL,NOTE,VELOCITY
 8928  0000000                   	.IF (WITH_MS .EQ. 1H)
 8929  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 8930  0000000                   		PSF_RESPONSE_LIMIT
 8931  0000000                   		PHP
 8932  0000000                   		SEI
 8933  0000000                   		EXTERNAL INIT_EXT_MIDI_API
 8934  0000000                   		JSR INIT_EXT_MIDI_API
 8935  0000000                   	.IF (WITH_MULTI_CHANNEL .EQ. 0H)
 8936  0000000                   		LDA #CHANNEL
 8937  0000000                   	.ELSE
 8938  0000000                   		LDY #CHANNEL





 8939  0000000                   		EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 8940  0000000                   		LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 8941  0000000                   		LDA CH_SYNTH_CHANNEL0,X
 8942  0000000                   	.ENDIF
 8943  0000000                   		STA <MS_START+CH_EXT_MIDI_STATUS_MS
 8944  0000000                   		LDA #NOTE
 8945  0000000                   		STA <MS_START+CH_EXT_MIDI_DATA1_MS
 8946  0000000                   		LDA #VELOCITY
 8947  0000000                   		ASL A
 8948  0000000                   		ASL A
 8949  0000000                   		ASL A
 8950  0000000                   	    	ASL A
 8951  0000000                   		ASL A
 8952  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8953  0000000                   		ASL A
 8954  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8955  0000000                   		ROL <MS_START+CH_EXT_MIDI_STATUS_MS
 8956  0000000                   		ASL A
 8957  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8958  0000000                   		ROL <MS_START+CH_EXT_MIDI_STATUS_MS
 8959  0000000                   		ASL A
 8960  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8961  0000000                   		ROL <MS_START+CH_EXT_MIDI_STATUS_MS
 8962  0000000                   		PLP
 8963  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8964  0000000                   	.ENDIF
 8965  0000000                   	.ENDIF
 8966  0000000                   	ENDM
 8967  0000000                   ;------------------------------------------------------------------------------
 8968  0000000                   	.IF (WITH_MS .EQ. 1H)
 8969  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 8970  0000000                   NOTE_ON MACRO CHANNEL,NOTE,VELOCITY
 8971  0000000                   	EXT_NOTE_ON_WCF1 CHANNEL-1,NOTE,VELOCITY
 8972  0000000                   ENDM
 8973  0000000                   	.ENDIF
 8974  0000000                   	.ENDIF
 8975  0000000                   ;===============================================================================
 8976  0000000                   EXT_NOTE_OFF_WCF1 MACRO CHANNEL,NOTE
 8977  0000000                   	.IF (WITH_MS .EQ. 1H)
 8978  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 8979  0000000                   		PSF_RESPONSE_LIMIT
 8980  0000000                   		PHP
 8981  0000000                   		SEI
 8982  0000000                   	.IF (WITH_MULTI_CHANNEL .EQ. 0H)
 8983  0000000                   		LDA #CHANNEL
 8984  0000000                   	.ELSE
 8985  0000000                   		LDY #CHANNEL
 8986  0000000                   		EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 8987  0000000                   		LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 8988  0000000                   		LDA CH_SYNTH_CHANNEL0,X
 8989  0000000                   	.ENDIF
 8990  0000000                   		ASL A
 8991  0000000                   		ASL A
 8992  0000000                   		ASL A
 8993  0000000                   		ORA #85H	;10nnn101
 8994  0000000                   		STA <MS_START+CH_EXT_MIDI_STATUS_MS
 8995  0000000                   		PLP





 8996  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8997  0000000                   	.ENDIF
 8998  0000000                   	.ENDIF
 8999  0000000                   	ENDM
 9000  0000000                   ;------------------------------------------------------------------------------
 9001  0000000                   	.IF (WITH_MS .EQ. 1H)
 9002  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 9003  0000000                   NOTE_OFF MACRO CHANNEL,NOTE
 9004  0000000                   	EXT_NOTE_OFF_WCF1 CHANNEL-1,NOTE
 9005  0000000                   ENDM
 9006  0000000                   	.ENDIF
 9007  0000000                   	.ENDIF	
 9008  0000000                   ;===============================================================================
 9009  0000000                   ;===============================================================================
 9010  0000000                   	.IF (WITH_SP .EQ. 1)
 9011  0000000                   EN_ULTRAIO_EVENT MACRO CHANNEL
 9012  0000000                   	LDY #CHANNEL-1
 9013  0000000                   	EXTERN DIS_UIO_EVENT_FLAG
 9014  0000000                   	LDA !DIS_UIO_EVENT_FLAG,Y
 9015  0000000                   	TRB <COMMON_FLAG2 
 9016  0000000                   
 9017  0000000                   	PSF_RESPONSE_LIMIT
 9018  0000000                   	LDA #SPEECH_TYPE
 9019  0000000                   	EXTERN UIO_START
 9020  0000000                   	JSR UIO_START
 9021  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 9022  0000000                   	ENDM
 9023  0000000                   ;------------------------------------------------------------------------------		
 9024  0000000                   DIS_ULTRAIO_EVENT MACRO CHANNEL
 9025  0000000                   	LDY #CHANNEL-1
 9026  0000000                   	EXTERN DIS_UIO_EVENT_FLAG
 9027  0000000                   	LDA !DIS_UIO_EVENT_FLAG,Y
 9028  0000000                   	TSB <COMMON_FLAG2 
 9029  0000000                   
 9030  0000000                   	PSF_RESPONSE_LIMIT
 9031  0000000                   	LDA #SPEECH_TYPE
 9032  0000000                   	EXTERN UIO_STOP
 9033  0000000                   	JSR UIO_STOP
 9034  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 9035  0000000                   	ENDM
 9036  0000000                   	.ENDIF	
 9037  0000000                   ;===============================================================================
 9038  0000000                   ;===============================================================================
 9039  0000000                   .IF (WITH_MS .EQ. 1)
 9040  0000000                   GET_NOTE MACRO
 9041  0000000                            LDA <MS_START+CH_MIDI_NOTE_MS
 9042  0000000                            ENDM
 9043  0000000                   ;------------------------------------------------------------------------------	 
 9044  0000000                   GET_NOTE_BY_RAM MACRO NOTE_RAM        
 9045  0000000                            LDA <MS_START+CH_MIDI_NOTE_MS
 9046  0000000                            STA NOTE_RAM
 9047  0000000                            ENDM
 9048  0000000                   
 9049  0000000                   .ENDIF   
 9050  0000000                   ;===============================================================================
 9051  0000000                   ;===============================================================================
 9052  0000000                   EN_ULTRAIO_PIN MACRO INDEX





 9053  0000000                   	EXTERN UIO_PIN_NUM
 9054  0000000                   	EXTERN UIO_USED_PIN_|INDEX
 9055  0000000                   	LDA #INDEX-1
 9056  0000000                   	CMP #UIO_PIN_NUM
 9057  0000000                   	BCS EN_ULTRAIO_PIN_END#
 9058  0000000                   	LDA #UIO_USED_PIN_|INDEX
 9059  0000000                   	BEQ EN_ULTRAIO_PIN_END#
 9060  0000000                   .ifndef	FW_BAM_TIMER
 9061  0000000                   	EXTERN UIO_PIN_CH_FLAG_|INDEX
 9062  0000000                   	EXTERN UIO_SET_PIN_ENABLE_VALUE_|INDEX
 9063  0000000                   	LDA #7FH
 9064  0000000                   	AND !UIO_PIN_CH_FLAG_|INDEX
 9065  0000000                   	STA !UIO_PIN_CH_FLAG_|INDEX
 9066  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_SET_PIN_ENABLE_VALUE_|INDEX
 9067  0000000                   .else
 9068  0000000                   	EXTERN UIO_ENABLE_PIN_|INDEX
 9069  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_ENABLE_PIN_|INDEX
 9070  0000000                   .endif
 9071  0000000                   
 9072  0000000                   EN_ULTRAIO_PIN_END#:
 9073  0000000                   	ENDM
 9074  0000000                   ;------------------------------------------------------------------------------		
 9075  0000000                   DIS_ULTRAIO_PIN MACRO INDEX
 9076  0000000                   	EXTERN UIO_PIN_NUM
 9077  0000000                   	EXTERN UIO_USED_PIN_|INDEX
 9078  0000000                   	EXTERN UIO_SET_PIN_DISABLE_VALUE_|INDEX
 9079  0000000                   	LDA #INDEX-1	
 9080  0000000                   	CMP #UIO_PIN_NUM
 9081  0000000                   	BCS DIS_ULTRAIO_PIN_END#
 9082  0000000                   	LDA #UIO_USED_PIN_|INDEX
 9083  0000000                   	BEQ DIS_ULTRAIO_PIN_END#
 9084  0000000                   .ifndef	FW_BAM_TIMER
 9085  0000000                   	EXTERN UIO_PIN_CH_FLAG_|INDEX
 9086  0000000                   	LDA #80H
 9087  0000000                   	ORA !UIO_PIN_CH_FLAG_|INDEX
 9088  0000000                   	STA !UIO_PIN_CH_FLAG_|INDEX
 9089  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_SET_PIN_DISABLE_VALUE_|INDEX
 9090  0000000                   .else
 9091  0000000                   	EXTERN UIO_DISABLE_PIN_|INDEX
 9092  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_DISABLE_PIN_|INDEX
 9093  0000000                   .endif
 9094  0000000                   
 9095  0000000                   DIS_ULTRAIO_PIN_END#:
 9096  0000000                   	ENDM
 9097  0000000                   ;------------------------------------------------------------------------------	
 9098  0000000                   EN_ULTRAIO_CURVE MACRO INDEX	
 9099  0000000                   	EN_ULTRAIO_PIN INDEX
 9100  0000000                   	ENDM
 9101  0000000                   
 9102  0000000                   DIS_ULTRAIO_CURVE MACRO INDEX
 9103  0000000                   	DIS_ULTRAIO_PIN INDEX
 9104  0000000                   	ENDM
 9105  0000000                   ;------------------------------------------------------------------------------	
 9106  0000000                   SET_ULTRAIO_CURVE_PIN MACRO INDEX, PIN_MAPPING
 9107  0000000                   	EXTERN UIO_PIN_NUM
 9108  0000000                   	EXTERN UIO_MULTI_PIN_|INDEX
 9109  0000000                   	EXTERN UIO_PIN_|INDEX





 9110  0000000                   	EXTERN UIO_EN_MULTI_PIN_|INDEX
 9111  0000000                   	EXTERN UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9112  0000000                   	LDA #INDEX-1
 9113  0000000                   	CMP #UIO_PIN_NUM
 9114  0000000                   	BCS SET_ULTRAIO_CURVE_PIN_END#
 9115  0000000                   	LDA #UIO_MULTI_PIN_|INDEX
 9116  0000000                   	BEQ SET_ULTRAIO_CURVE_PIN_END#
 9117  0000000                   
 9118  0000000                   	LDA #PIN_MAPPING
 9119  0000000                   	AND #UIO_PIN_|INDEX
 9120  0000000                   	STA !UIO_EN_MULTI_PIN_|INDEX
 9121  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9122  0000000                   SET_ULTRAIO_CURVE_PIN_END#:
 9123  0000000                   	ENDM
 9124  0000000                   ;------------------------------------------------------------------------------	
 9125  0000000                   ;SET_ULTRAIO_CURVE_PIN_RAM MACRO INDEX, PIN_MAPPING_RAM
 9126  0000000                   ;	EXTERN UIO_PIN_NUM
 9127  0000000                   ;	EXTERN UIO_MULTI_PIN_|INDEX
 9128  0000000                   ;	EXTERN UIO_PIN_|INDEX
 9129  0000000                   ;	EXTERN UIO_EN_MULTI_PIN_|INDEX
 9130  0000000                   ;	EXTERN UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9131  0000000                   ;	LDA #INDEX-1
 9132  0000000                   ;	CMP #UIO_PIN_NUM
 9133  0000000                   ;	BCS SET_ULTRAIO_CURVE_PIN_RAM_END#
 9134  0000000                   ;	LDA #UIO_MULTI_PIN_|INDEX
 9135  0000000                   ;	BEQ SET_ULTRAIO_CURVE_PIN_RAM_END#
 9136  0000000                   ;	
 9137  0000000                   ;	LDA !PIN_MAPPING_RAM
 9138  0000000                   ;	AND #UIO_PIN_|INDEX
 9139  0000000                   ;	STA !UIO_EN_MULTI_PIN_|INDEX
 9140  0000000                   ;	PSF_RESPONSE_LIMIT_JSR UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9141  0000000                   ;SET_ULTRAIO_CURVE_PIN_RAM_END#:
 9142  0000000                   ;	ENDM
 9143  0000000                   ;------------------------------------------------------------------------------	
 9144  0000000                   STOP_KEEP_LEVEL_PIN MACRO INDEX
 9145  0000000                   	EXTERN UIO_PIN_NUM
 9146  0000000                   	EXTERN UIO_USED_PIN_|INDEX
 9147  0000000                   	EXTERN UIO_STOP_KEEP_LEVEL_PIN_|INDEX
 9148  0000000                   	LDA #INDEX-1
 9149  0000000                   	CMP #UIO_PIN_NUM
 9150  0000000                   	BCS STOP_KEEP_LEVEL_PIN_END#
 9151  0000000                   	LDA #UIO_USED_PIN_|INDEX
 9152  0000000                   	BEQ STOP_KEEP_LEVEL_PIN_END#
 9153  0000000                   
 9154  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_STOP_KEEP_LEVEL_PIN_|INDEX
 9155  0000000                   STOP_KEEP_LEVEL_PIN_END#:	
 9156  0000000                   	ENDM
 9157  0000000                   ;------------------------------------------------------------------------------	
 9158  0000000                   STOP_ALL_KEEP_LEVEL_PIN MACRO
 9159  0000000                   	EXTERN UIO_STOP_ALL_KEEP_LEVEL_PIN
 9160  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_STOP_ALL_KEEP_LEVEL_PIN
 9161  0000000                   	ENDM
 9162  0000000                   ;===============================================================================
 9163  0000000                   ;===============================================================================
 9164  0000000                   ASSIGN_MELODY_CHANNEL MACRO MIDI_CHANNEL, NEW_MIDI_CHANNEL
 9165  0000000                   .IF (WITH_MULTI_CHANNEL .EQ. 1H)
 9166  0000000                   .IF (WITH_MS .EQ. 1H)





 9167  0000000                   	LDY #MIDI_CHANNEL
 9168  0000000                   	EXTERN MS_CHANNEL_TABLE
 9169  0000000                   	LDA !MS_CHANNEL_TABLE,Y
 9170  0000000                   	BEQ END_ASSIGN_MELODY_CHANNEL#
 9171  0000000                   
 9172  0000000                   	LDA #NEW_MIDI_CHANNEL
 9173  0000000                   	CMP #09H
 9174  0000000                   	BNE ASSIGN_MELODY_CHANNEL_CONTINUE#	
 9175  0000000                   
 9176  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 9177  0000000                   		CPY #MS_CH2	;PERCUSSION CHANNEL
 9178  0000000                   	.ELSE
 9179  0000000                   		CPY #MS_CH1
 9180  0000000                   	.ENDIF
 9181  0000000                   	BNE END_ASSIGN_MELODY_CHANNEL#
 9182  0000000                   
 9183  0000000                   ASSIGN_MELODY_CHANNEL_CONTINUE#:
 9184  0000000                   	EXTERN NOTE_OFF_ASSIGN_MELODY_CHANNEL_API	
 9185  0000000                   	PSF_RESPONSE_LIMIT_JSR NOTE_OFF_ASSIGN_MELODY_CHANNEL_API
 9186  0000000                   
 9187  0000000                   	EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 9188  0000000                   	LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 9189  0000000                   	LDA #NEW_MIDI_CHANNEL
 9190  0000000                   	STA CH_SYNTH_CHANNEL0,X
 9191  0000000                   END_ASSIGN_MELODY_CHANNEL#:
 9192  0000000                   .ENDIF	
 9193  0000000                   .ENDIF	
 9194  0000000                   ENDM
 9195  0000000                   ;------------------------------------------------------------------------------	
 9196  0000000                   .IF (WITH_MULTI_CHANNEL .EQ. 1H)
 9197  0000000                   ASSIGN_MELODY_CH1 MACRO NEW_MIDI_CHANNEL
 9198  0000000                   	ASSIGN_MELODY_CHANNEL 00,NEW_MIDI_CHANNEL-1
 9199  0000000                   ENDM
 9200  0000000                   ;------------------------------------------------------------------------------	
 9201  0000000                   ASSIGN_MELODY_CH2 MACRO NEW_MIDI_CHANNEL
 9202  0000000                   	ASSIGN_MELODY_CHANNEL 01,NEW_MIDI_CHANNEL-1
 9203  0000000                   ENDM
 9204  0000000                   ;------------------------------------------------------------------------------	
 9205  0000000                   ASSIGN_MELODY_CH3 MACRO NEW_MIDI_CHANNEL
 9206  0000000                   	ASSIGN_MELODY_CHANNEL 02,NEW_MIDI_CHANNEL-1
 9207  0000000                   ENDM
 9208  0000000                   .ENDIF
 9209  0000000                   
 9210  0000000                   
 9211  0000000                   ;===============================================================================
 9212  0000000                   ;===============================================================================
 9213  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9214  0000000                   CHK_BUSY_CH1 MACRO 
 9215  0000000                   	LDA <GLOBAL_PLAY
 9216  0000000                   	BIT #SP1_BZ
 9217  0000000                   	ENDM
 9218  0000000                   	.ENDIF
 9219  0000000                   ;------------------------------------------------------------------------------	
 9220  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9221  0000000                   CHK_BUSY_CH2 MACRO 
 9222  0000000                   	LDA <GLOBAL_PLAY
 9223  0000000                   	BIT #SP2_BZ





 9224  0000000                   	ENDM
 9225  0000000                   	.ENDIF
 9226  0000000                   ;------------------------------------------------------------------------------	
 9227  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9228  0000000                   CHK_BUSY_CH3 MACRO 
 9229  0000000                   	LDA <GLOBAL_PLAY
 9230  0000000                   	BIT #SP3_BZ
 9231  0000000                   	ENDM
 9232  0000000                   	.ENDIF
 9233  0000000                   ;------------------------------------------------------------------------------	
 9234  0000000                   ;------------------------------------------------------------------------------
 9235  0000000                   .IF (WITH_MS .EQ. 1H)
 9236  0000000                   CHK_BUSY_MS MACRO
 9237  0000000                   	LDA <GLOBAL_PLAY
 9238  0000000                   	BIT #(MIDI_BZ+MS_EXT)	
 9239  0000000                   	ENDM
 9240  0000000                   .ENDIF
 9241  0000000                   ;------------------------------------------------------------------------------	
 9242  0000000                   ;------------------------------------------------------------------------------	
 9243  0000000                   .IF (WITH_CH0_EVO .EQ. 1)
 9244  0000000                   CHK_BUSY_EVO1 MACRO
 9245  0000000                   	LDA <GLOBAL_PLAY
 9246  0000000                   	BIT #EVO1_BZ
 9247  0000000                   	ENDM
 9248  0000000                   .ENDIF
 9249  0000000                   ;------------------------------------------------------------------------------	
 9250  0000000                   .IF (WITH_CH1_EVO .EQ. 1)
 9251  0000000                   CHK_BUSY_EVO2 MACRO
 9252  0000000                   	LDA <GLOBAL_PLAY
 9253  0000000                   	BIT #EVO2_BZ
 9254  0000000                   	ENDM
 9255  0000000                   .ENDIF
 9256  0000000                   ;------------------------------------------------------------------------------
 9257  0000000                   .IF (WITH_CH2_EVO .EQ. 1)
 9258  0000000                   CHK_BUSY_EVO3 MACRO
 9259  0000000                   	LDA <GLOBAL_PLAY
 9260  0000000                   	BIT #EVO3_BZ
 9261  0000000                   	ENDM
 9262  0000000                   .ENDIF
 9263  0000000                   ;------------------------------------------------------------------------------	
 9264  0000000                   ;------------------------------------------------------------------------------	
 9265  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 9266  0000000                   .ELSE
 9267  0000000                   CHK_BUSY_ALL MACRO
 9268  0000000                   	LDA <GLOBAL_PLAY
 9269  0000000                   	ENDM
 9270  0000000                   .ENDIF
 9271  0000000                   ;===============================================================================
 9272  0000000                   ;===============================================================================
 9273  0000000                   .IF((WITH_SP .EQ. 1) && (WITH_MDR .EQ. 1))
 9274  0000000                   EN_PLAY_REVERSE MACRO CHANNEL
 9275  0000000                   	LDX #CHANNEL-1
 9276  0000000                   	EXTERN PLAY_BACK_FLAG_TABLE
 9277  0000000                   	LDA !PLAY_BACK_FLAG_TABLE,X
 9278  0000000                   	TSB <COMMON_FLAG2
 9279  0000000                   	ENDM
 9280  0000000                   ;------------------------------------------------------------------------------	





 9281  0000000                   DIS_PLAY_REVERSE MACRO CHANNEL
 9282  0000000                   	LDX #CHANNEL-1
 9283  0000000                   	EXTERN PLAY_BACK_FLAG_TABLE
 9284  0000000                   	LDA !PLAY_BACK_FLAG_TABLE,X
 9285  0000000                   	TRB <COMMON_FLAG2
 9286  0000000                   	ENDM
 9287  0000000                   .ENDIF
 9288  0000000                   ;===============================================================================
 9289  0000000                   ;===============================================================================
 9290  0000000                   .IF (WITH_MS_CODA .EQ. 1)
 9291  0000000                   SET_START MACRO 
 9292  0000000                   	LDA <CH_DATA_ADDR_MS+MS_START
 9293  0000000                   	STA CODA_START_ADDR
 9294  0000000                   	LDA <CH_DATA_ADDR_MS+1+MS_START
 9295  0000000                   	STA CODA_START_ADDR+1
 9296  0000000                   	LDA <CH_DATA_BANK_MS+MS_START
 9297  0000000                   	STA CODA_START_BANK
 9298  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 9299  0000000                   		LDA <CH_DATA_BANK1_MS+MS_START
 9300  0000000                   		STA CODA_START_BANK1
 9301  0000000                   	.ENDIF
 9302  0000000                   	ENDM 
 9303  0000000                   ;----------------------------------------------------------------
 9304  0000000                   GOTO_START MACRO 
 9305  0000000                   	EXTERN MIDI_NOTE_OFF_API
 9306  0000000                   	PSF_RESPONSE_LIMIT_JSR MIDI_NOTE_OFF_API
 9307  0000000                   
 9308  0000000                   	LDA CODA_START_ADDR
 9309  0000000                   	STA <CH_DATA_ADDR_MS+MS_START
 9310  0000000                   	LDA CODA_START_ADDR+1
 9311  0000000                   	STA <CH_DATA_ADDR_MS+1+MS_START
 9312  0000000                   	LDA CODA_START_BANK
 9313  0000000                   	STA <CH_DATA_BANK_MS+MS_START
 9314  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 9315  0000000                   		LDA CODA_START_BANK1
 9316  0000000                   		STA <CH_DATA_BANK1_MS+MS_START
 9317  0000000                   	.ENDIF
 9318  0000000                   	ENDM 	
 9319  0000000                   .ENDIF
 9320  0000000                   
 9321  0000000                   ;===============================================================================
 9322  0000000                   ;===============================================================================
 9323  0000000                   .IF (WITH_SP_SKIP .EQ. 1)	
 9324  0000000                   SET_PLAY_SEGMENT_CH MACRO CHANNEL_ID,INDEX
 9325  0000000                   	LDY #CHANNEL_ID-1
 9326  0000000                   	EXTERN SPEECH_PLAY_SEGMENT_ENABLE_TABLE
 9327  0000000                   	LDA !SPEECH_PLAY_SEGMENT_ENABLE_TABLE,Y
 9328  0000000                   	BEQ END_SET_PLAY_SEGMENT_CH#
 9329  0000000                   
 9330  0000000                   	LDA #INDEX
 9331  0000000                   	STA CH|CHANNEL_ID|_PLAY_SEGMENT
 9332  0000000                   
 9333  0000000                   	EXTERN GOTO_PLAY_SEGMENT
 9334  0000000                   	PSF_RESPONSE_LIMIT_JSR GOTO_PLAY_SEGMENT
 9335  0000000                   END_SET_PLAY_SEGMENT_CH#:
 9336  0000000                   ENDM
 9337  0000000                   ;----------------------------------------------------------------	





 9338  0000000                   SET_PLAY_SEGMENT_CH_RAM MACRO CHANNEL_ID,INDEX_RAM
 9339  0000000                   	LDY #CHANNEL_ID-1
 9340  0000000                   	EXTERN SPEECH_PLAY_SEGMENT_ENABLE_TABLE
 9341  0000000                   	LDA !SPEECH_PLAY_SEGMENT_ENABLE_TABLE,Y
 9342  0000000                   	BEQ END_SET_PLAY_SEGMENT_CH_RAM#
 9343  0000000                   
 9344  0000000                   	LDA INDEX_RAM
 9345  0000000                   	STA CH|CHANNEL_ID|_PLAY_SEGMENT
 9346  0000000                   
 9347  0000000                   	EXTERN GOTO_PLAY_SEGMENT
 9348  0000000                   	PSF_RESPONSE_LIMIT_JSR GOTO_PLAY_SEGMENT
 9349  0000000                   END_SET_PLAY_SEGMENT_CH_RAM#:
 9350  0000000                   ENDM
 9351  0000000                   ;----------------------------------------------------------------		
 9352  0000000                   .IF (WITH_SP_NUM .GT. 0)
 9353  0000000                   SET_PLAY_SEGMENT_CH1 MACRO INDEX
 9354  0000000                   	SET_PLAY_SEGMENT_CH 1,INDEX
 9355  0000000                   ENDM
 9356  0000000                   .ENDIF
 9357  0000000                   ;----------------------------------------------------------------
 9358  0000000                   .IF (WITH_SP_NUM .GT. 1)
 9359  0000000                   SET_PLAY_SEGMENT_CH2 MACRO INDEX
 9360  0000000                   	SET_PLAY_SEGMENT_CH 2,INDEX
 9361  0000000                   ENDM
 9362  0000000                   .ENDIF
 9363  0000000                   ;----------------------------------------------------------------
 9364  0000000                   .IF (WITH_SP_NUM .GT. 2)
 9365  0000000                   SET_PLAY_SEGMENT_CH3 MACRO INDEX
 9366  0000000                   	SET_PLAY_SEGMENT_CH 3,INDEX
 9367  0000000                   ENDM
 9368  0000000                   .ENDIF
 9369  0000000                   ;----------------------------------------------------------------		
 9370  0000000                   .IF (WITH_SP_NUM .GT. 0)
 9371  0000000                   SET_PLAY_SEGMENT_CH1_RAM MACRO INDEX_RAM
 9372  0000000                   	SET_PLAY_SEGMENT_CH_RAM 1,INDEX_RAM
 9373  0000000                   ENDM
 9374  0000000                   .ENDIF
 9375  0000000                   ;----------------------------------------------------------------
 9376  0000000                   .IF (WITH_SP_NUM .GT. 1)
 9377  0000000                   SET_PLAY_SEGMENT_CH2_RAM MACRO INDEX_RAM
 9378  0000000                   	SET_PLAY_SEGMENT_CH_RAM 2,INDEX_RAM
 9379  0000000                   ENDM
 9380  0000000                   .ENDIF
 9381  0000000                   ;----------------------------------------------------------------
 9382  0000000                   .IF (WITH_SP_NUM .GT. 2)
 9383  0000000                   SET_PLAY_SEGMENT_CH3_RAM MACRO INDEX_RAM
 9384  0000000                   	SET_PLAY_SEGMENT_CH_RAM 3,INDEX_RAM
 9385  0000000                   ENDM
 9386  0000000                   .ENDIF
 9387  0000000                   .ENDIF
 9388  0000000                   ;==============================================================================
 9389  0000000                   ; Set TMC/TMV of specified speech channel.
 9390  0000000                   ;==============================================================================
 9391  0000000                   SET_SP_SR_HZ_Y MACRO NEW_TMC,NEW_TMV
 9392  0000000                   	.IF (WITH_SP .EQ. 1H)
 9393  0000000                   	.IF (WITH_SP_GLOBAL_SR .EQ. 1H)
 9394  0000000                   		EXTERN 	SPEECH_GLOBAL_SR_TMC_TABLE





 9395  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y
 9396  0000000                   		LDA CH1_GLOBAL_TMC,X
 9397  0000000                   		AND #GLOBAL_SR_FLAG
 9398  0000000                   		ORA #NEW_TMC
 9399  0000000                   		STA CH1_GLOBAL_TMC,X
 9400  0000000                   		LDA #NEW_TMV
 9401  0000000                   		STA CH1_GLOBAL_TMV,X
 9402  0000000                   
 9403  0000000                   		EXTERN SET_SP_SR_HZ_PROC
 9404  0000000                   		PSF_RESPONSE_LIMIT_JSR SET_SP_SR_HZ_PROC
 9405  0000000                   	.ELSE
 9406  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 9407  0000000                   		LDA <CH_STATUS_SP,X
 9408  0000000                   		BIT #SP_BZ 
 9409  0000000                   		BNE 3
 9410  0000000                   		JMP SET_SP_SR_HZ_Y_END_#
 9411  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR)
 9412  0000000                   		BEQ 3
 9413  0000000                   		JMP SET_SP_SR_HZ_Y_END_#
 9414  0000000                   
 9415  0000000                   		PSF_RESPONSE_LIMIT
 9416  0000000                   		STORE_SW_CS
 9417  0000000                   		LDA   !BANK
 9418  0000000                   	     	PHA
 9419  0000000                   ;		LDA <TEMP_REG1
 9420  0000000                   ;		PHA
 9421  0000000                   ;	    	LDA <TEMP_REG1+1
 9422  0000000                   ;		PHA
 9423  0000000                   ;		LDA <TEMP_REG2
 9424  0000000                   ;		PHA
 9425  0000000                   ;	   	LDA <TEMP_REG2+1
 9426  0000000                   ;		PHA
 9427  0000000                   
 9428  0000000                   		SET_SENTENCE_BANK1 CH_DATA_BANK_SP
 9429  0000000                   ;-------- REWIND CH_DATA_ADDR/BANK -------------------
 9430  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP,X
 9431  0000000                   		STA <TEMP_REG1
 9432  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP+1,X
 9433  0000000                   		STA <TEMP_REG1+1
 9434  0000000                   		LDA <CH_SENTENCE_START_BANK_SP,X
 9435  0000000                   		STA <TEMP_REG2
 9436  0000000                   
 9437  0000000                   		LDA_DP_ILI_SIM TEMP_REG1
 9438  0000000                   		AND #38H
 9439  0000000                   		.IF (WITH_SIL .EQ. 1)
 9440  0000000                   		CMP #RESTYPE_SIL<<3
 9441  0000000                   		BNE 3 
 9442  0000000                   		JMP SET_SP_SR_HZ_Y_CHANGE_END_#
 9443  0000000                   		.ENDIF
 9444  0000000                   		.IF (WITH_VC4 .EQ. 1)
 9445  0000000                   		CMP #RESTYPE_VC4<<3
 9446  0000000                   		BNE 3 
 9447  0000000                   		JMP SET_SP_SR_HZ_Y_CHANGE_END_#
 9448  0000000                   		.ENDIF
 9449  0000000                   
 9450  0000000                   		.IF (WITH_NM4S .EQ. 1)
 9451  0000000                   		CMP #RESTYPE_NM4S<<3





 9452  0000000                   		BEQ SET_SP_SR_HZ_2#
 9453  0000000                   		.ENDIF
 9454  0000000                   		.IF (WITH_NM4 .EQ. 1)
 9455  0000000                   		CMP #RESTYPE_NM4<<3
 9456  0000000                   		BEQ SET_SP_SR_HZ_2#
 9457  0000000                   		.ENDIF
 9458  0000000                   
 9459  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 9460  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9461  0000000                   		EXTERN SP_STZ_TMC_PROC_TABLE
 9462  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 9463  0000000                   		EXTERN SP_SET_TMC_PROC_TABLE
 9464  0000000                   		PHP
 9465  0000000                   		SEI
 9466  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9467  0000000                   		LDA #NEW_TMV
 9468  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9469  0000000                   SET_SP_SR_HZ_TMC#:
 9470  0000000                   		LDA #NEW_TMC
 9471  0000000                   		AND #07H
 9472  0000000                   		ASL A
 9473  0000000                   		ORA #01H
 9474  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9475  0000000                   		PLP
 9476  0000000                   		BRA SET_SP_SR_HZ_Y_CHANGE_END_#
 9477  0000000                   
 9478  0000000                   SET_SP_SR_HZ_2#:
 9479  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9480  0000000                   		PHP
 9481  0000000                   		SEI
 9482  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9483  0000000                   		LDA #NEW_TMV
 9484  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9485  0000000                   		LDA #NEW_TMC
 9486  0000000                   		AND #38H
 9487  0000000                   		CMP #38H
 9488  0000000                   		BNE SET_SP_SR_HZ_2_NOTDIV2#
 9489  0000000                   SET_SP_SR_HZ_2_DIV2#:	
 9490  0000000                   		LDA #NEW_TMV
 9491  0000000                   		LSR A
 9492  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9493  0000000                   		BRA SET_SP_SR_HZ_TMC#
 9494  0000000                   
 9495  0000000                   SET_SP_SR_HZ_2_NOTDIV2#:
 9496  0000000                   		LSR A
 9497  0000000                   		LSR A
 9498  0000000                   		ORA #01H
 9499  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9500  0000000                   		PLP
 9501  0000000                   
 9502  0000000                   SET_SP_SR_HZ_Y_CHANGE_END_#:		
 9503  0000000                   ;		PLA 
 9504  0000000                   ;		STA <TEMP_REG2+1
 9505  0000000                   ;		PLA 
 9506  0000000                   ;		STA <TEMP_REG2
 9507  0000000                   ;		PLA 
 9508  0000000                   ;		STA <TEMP_REG1+1





 9509  0000000                   ;		PLA 
 9510  0000000                   ;		STA <TEMP_REG1
 9511  0000000                   		PLA
 9512  0000000                   	     	STA   !BANK
 9513  0000000                   	     	RELOAD_SW_CS
 9514  0000000                   	     	PSF_RESPONSE_LIMIT_RELEASE
 9515  0000000                   
 9516  0000000                   SET_SP_SR_HZ_Y_END_#:
 9517  0000000                   	.ENDIF
 9518  0000000                   	.ENDIF
 9519  0000000                   	ENDM
 9520  0000000                   ;------------------------------------------------------------------------------
 9521  0000000                   SET_SP_SR_HZ MACRO NEW_TMC,NEW_TMV,CHANNEL_ID
 9522  0000000                   	.IF (WITH_SP .EQ. 1H)
 9523  0000000                   		LDY #CHANNEL_ID
 9524  0000000                   		SET_SP_SR_HZ_Y NEW_TMC,NEW_TMV
 9525  0000000                   	.ENDIF
 9526  0000000                   	ENDM
 9527  0000000                   ;------------------------------------------------------------------------------
 9528  0000000                   .IF (WITH_SP .EQ. 1)
 9529  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9530  0000000                   SET_SR1_HZ MACRO NEW_TMC,NEW_TMV
 9531  0000000                   	SET_SP_SR_HZ NEW_TMC,NEW_TMV, 00H 
 9532  0000000                   ENDM		
 9533  0000000                   	.ENDIF
 9534  0000000                   ;------------------------------------------------------------------------------
 9535  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9536  0000000                   SET_SR2_HZ MACRO NEW_TMC,NEW_TMV
 9537  0000000                   	SET_SP_SR_HZ NEW_TMC,NEW_TMV, 01H
 9538  0000000                   ENDM		
 9539  0000000                   	.ENDIF
 9540  0000000                   ;------------------------------------------------------------------------------
 9541  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9542  0000000                   SET_SR3_HZ MACRO NEW_TMC,NEW_TMV
 9543  0000000                   	SET_SP_SR_HZ NEW_TMC,NEW_TMV, 02H
 9544  0000000                   ENDM
 9545  0000000                   	.ENDIF	
 9546  0000000                   .ENDIF	
 9547  0000000                   ;==============================================================================
 9548  0000000                   SET_SP_SR_HZ_Y_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9549  0000000                   	.IF (WITH_SP .EQ. 1H)
 9550  0000000                   	.IF (WITH_SP_GLOBAL_SR .EQ. 1H)
 9551  0000000                   		EXTERN 	SPEECH_GLOBAL_SR_TMC_TABLE
 9552  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y
 9553  0000000                   		LDA CH1_GLOBAL_TMC,X
 9554  0000000                   		AND #GLOBAL_SR_FLAG
 9555  0000000                   		ORA NEW_TMC_RAM
 9556  0000000                   		STA CH1_GLOBAL_TMC,X
 9557  0000000                   		LDA NEW_TMV_RAM
 9558  0000000                   		STA CH1_GLOBAL_TMV,X
 9559  0000000                   
 9560  0000000                   		EXTERN SET_SP_SR_HZ_PROC
 9561  0000000                   		PSF_RESPONSE_LIMIT_JSR SET_SP_SR_HZ_PROC
 9562  0000000                   	.ELSE
 9563  0000000                   
 9564  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 9565  0000000                   		LDA <CH_STATUS_SP,X





 9566  0000000                   		BIT #SP_BZ 
 9567  0000000                   		BNE 3
 9568  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_END_#
 9569  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR)
 9570  0000000                   		BEQ 3
 9571  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_END_#
 9572  0000000                   
 9573  0000000                   		PSF_RESPONSE_LIMIT
 9574  0000000                   		STORE_SW_CS
 9575  0000000                   		LDA   !BANK
 9576  0000000                   	     	PHA
 9577  0000000                   ;		LDA <TEMP_REG1
 9578  0000000                   ;		PHA
 9579  0000000                   ;	    	LDA <TEMP_REG1+1
 9580  0000000                   ;		PHA
 9581  0000000                   ;		LDA <TEMP_REG2
 9582  0000000                   ;		PHA
 9583  0000000                   ;	   	LDA <TEMP_REG2+1
 9584  0000000                   ;		PHA
 9585  0000000                   
 9586  0000000                   		SET_SENTENCE_BANK1 CH_DATA_BANK_SP
 9587  0000000                   ;-------- REWIND CH_DATA_ADDR/BANK -------------------
 9588  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP,X
 9589  0000000                   		STA <TEMP_REG1
 9590  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP+1,X
 9591  0000000                   		STA <TEMP_REG1+1
 9592  0000000                   		LDA <CH_SENTENCE_START_BANK_SP,X
 9593  0000000                   		STA <TEMP_REG2
 9594  0000000                   
 9595  0000000                   		LDA_DP_ILI_SIM TEMP_REG1
 9596  0000000                   		AND #38H
 9597  0000000                   		.IF (WITH_SIL .EQ. 1)
 9598  0000000                   		CMP #RESTYPE_SIL<<3
 9599  0000000                   		BNE 3 
 9600  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_CHANGE_END_#
 9601  0000000                   		.ENDIF
 9602  0000000                   		.IF (WITH_VC4 .EQ. 1)
 9603  0000000                   		CMP #RESTYPE_VC4<<3
 9604  0000000                   		BNE 3 
 9605  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_CHANGE_END_#
 9606  0000000                   		.ENDIF
 9607  0000000                   
 9608  0000000                   		.IF (WITH_NM4S .EQ. 1)
 9609  0000000                   		CMP #RESTYPE_NM4S<<3
 9610  0000000                   		BEQ SET_SP_SR_HZ_RAM_2#
 9611  0000000                   		.ENDIF
 9612  0000000                   		.IF (WITH_NM4 .EQ. 1)
 9613  0000000                   		CMP #RESTYPE_NM4<<3
 9614  0000000                   		BEQ SET_SP_SR_HZ_RAM_2#
 9615  0000000                   		.ENDIF
 9616  0000000                   
 9617  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 9618  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9619  0000000                   		EXTERN SP_STZ_TMC_PROC_TABLE
 9620  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 9621  0000000                   		EXTERN SP_SET_TMC_PROC_TABLE
 9622  0000000                   		PHP





 9623  0000000                   		SEI
 9624  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9625  0000000                   		LDA NEW_TMV_RAM
 9626  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9627  0000000                   SET_SP_SR_HZ_RAM_TMC#:
 9628  0000000                   		LDA NEW_TMC_RAM
 9629  0000000                   		AND #07H
 9630  0000000                   		ASL A
 9631  0000000                   		ORA #01H
 9632  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9633  0000000                   		PLP
 9634  0000000                   		BRA SET_SP_SR_HZ_Y_RAM_CHANGE_END_#
 9635  0000000                   
 9636  0000000                   SET_SP_SR_HZ_RAM_2#:
 9637  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9638  0000000                   		PHP
 9639  0000000                   		SEI
 9640  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9641  0000000                   		LDA NEW_TMV_RAM
 9642  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9643  0000000                   		LDA NEW_TMC_RAM
 9644  0000000                   		AND #38H
 9645  0000000                   		CMP #38H
 9646  0000000                   		BNE SET_SP_SR_HZ_RAM_2_NOTDIV2#
 9647  0000000                   SET_SP_SR_HZ_RAM_2_DIV2#:	
 9648  0000000                   		LDA NEW_TMV_RAM
 9649  0000000                   		LSR A
 9650  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9651  0000000                   		BRA SET_SP_SR_HZ_RAM_TMC#
 9652  0000000                   
 9653  0000000                   SET_SP_SR_HZ_RAM_2_NOTDIV2#:
 9654  0000000                   		LSR A
 9655  0000000                   		LSR A
 9656  0000000                   		ORA #01H
 9657  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9658  0000000                   		PLP
 9659  0000000                   
 9660  0000000                   SET_SP_SR_HZ_Y_RAM_CHANGE_END_#:		
 9661  0000000                   ;		PLA 
 9662  0000000                   ;		STA <TEMP_REG2+1
 9663  0000000                   ;		PLA 
 9664  0000000                   ;		STA <TEMP_REG2
 9665  0000000                   ;		PLA 
 9666  0000000                   ;		STA <TEMP_REG1+1
 9667  0000000                   ;		PLA 
 9668  0000000                   ;		STA <TEMP_REG1
 9669  0000000                   		PLA
 9670  0000000                   	     	STA   !BANK
 9671  0000000                   	     	RELOAD_SW_CS
 9672  0000000                   	     	PSF_RESPONSE_LIMIT_RELEASE
 9673  0000000                   
 9674  0000000                   SET_SP_SR_HZ_Y_RAM_END_#:
 9675  0000000                   	.ENDIF
 9676  0000000                   	.ENDIF
 9677  0000000                   	ENDM
 9678  0000000                   ;------------------------------------------------------------------------------
 9679  0000000                   SET_SP_SR_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM,CHANNEL_ID





 9680  0000000                   	.IF (WITH_SP .EQ. 1H)
 9681  0000000                   		LDY #CHANNEL_ID
 9682  0000000                   		SET_SP_SR_HZ_Y_RAM NEW_TMC_RAM,NEW_TMV_RAM
 9683  0000000                   	.ENDIF
 9684  0000000                   	ENDM
 9685  0000000                   ;------------------------------------------------------------------------------
 9686  0000000                   .IF (WITH_SP .EQ. 1)
 9687  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9688  0000000                   SET_SR1_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9689  0000000                   	SET_SP_SR_HZ_RAM NEW_TMC_RAM,NEW_TMV_RAM, 00H
 9690  0000000                   ENDM		
 9691  0000000                   	.ENDIF
 9692  0000000                   ;------------------------------------------------------------------------------
 9693  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9694  0000000                   SET_SR2_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9695  0000000                   	SET_SP_SR_HZ_RAM NEW_TMC_RAM,NEW_TMV_RAM, 01H
 9696  0000000                   ENDM		
 9697  0000000                   	.ENDIF
 9698  0000000                   ;------------------------------------------------------------------------------
 9699  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9700  0000000                   SET_SR3_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9701  0000000                   	SET_SP_SR_HZ_RAM NEW_TMC_RAM,NEW_TMV_RAM, 02H
 9702  0000000                   ENDM		
 9703  0000000                   	.ENDIF
 9704  0000000                   .ENDIF
 9705  0000000                   ;==============================================================================
 9706  0000000                   ;==============================================================================
 9707  0000000                   DIS_SP_EQU_SR_Y MACRO                                                         
 9708  0000000                   	.IF(WITH_SP .EQ. 1H)  
 9709  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)  
 9710  0000000                   		EXTERN 	SPEECH_GLOBAL_SR_TMC_TABLE                                                                                          
 9711  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y                                  
 9712  0000000                   		LDA CH1_GLOBAL_TMC,X                                                        
 9713  0000000                   		ORA #GLOBAL_SR_FLAG                                                     
 9714  0000000                   		STA CH1_GLOBAL_TMC,X                                                        
 9715  0000000                   
 9716  0000000                   DIS_SP_EQU_SR_Y_END_#:
 9717  0000000                   	.ENDIF    
 9718  0000000                   	.ENDIF                                                                 
 9719  0000000                   ENDM   
 9720  0000000                   ;------------------------------------------------------------------------------
 9721  0000000                   DIS_SP_EQU_SR MACRO CHANNEL
 9722  0000000                   	.IF(WITH_SP .EQ. 1H) 
 9723  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)  
 9724  0000000                   		LDY #CHANNEL
 9725  0000000                   		DIS_SP_EQU_SR_Y 
 9726  0000000                   	.ENDIF
 9727  0000000                   	.ENDIF       
 9728  0000000                   ENDM
 9729  0000000                   ;------------------------------------------------------------------------------
 9730  0000000                   .IF (WITH_SP .EQ. 1)
 9731  0000000                   .IF(WITH_SP_GLOBAL_SR .EQ. 1H)  
 9732  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9733  0000000                   EN_GLOBALSR_SR1 MACRO
 9734  0000000                   	DIS_SP_EQU_SR 00H
 9735  0000000                   ENDM
 9736  0000000                   	.ENDIF





 9737  0000000                   ;------------------------------------------------------------------------------
 9738  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9739  0000000                   EN_GLOBALSR_SR2 MACRO
 9740  0000000                   	DIS_SP_EQU_SR 01H
 9741  0000000                   ENDM
 9742  0000000                   	.ENDIF
 9743  0000000                   ;------------------------------------------------------------------------------	
 9744  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9745  0000000                   EN_GLOBALSR_SR3 MACRO
 9746  0000000                   	DIS_SP_EQU_SR 02H
 9747  0000000                   ENDM
 9748  0000000                   	.ENDIF
 9749  0000000                   .ENDIF
 9750  0000000                   .ENDIF  		                                                                       
 9751  0000000                   ;==============================================================================
 9752  0000000                   EN_SP_EQU_SR_Y MACRO                                                          
 9753  0000000                   	.IF(WITH_SP .EQ. 1H) 
 9754  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)
 9755  0000000                   		EXTERN SPEECH_GLOBAL_SR_TMC_TABLE                                                                                      
 9756  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y                                  
 9757  0000000                   		LDA CH1_GLOBAL_TMC,X                                                        
 9758  0000000                   		AND #(FFH^GLOBAL_SR_FLAG)                                                    
 9759  0000000                   		STA CH1_GLOBAL_TMC,X                                                                                                                   
 9760  0000000                   	.ENDIF  
 9761  0000000                   	.ENDIF                                                                
 9762  0000000                   ENDM	
 9763  0000000                   ;------------------------------------------------------------------------------	
 9764  0000000                   EN_SP_EQU_SR MACRO CHANNEL
 9765  0000000                   	.IF(WITH_SP .EQ. 1H)
 9766  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)
 9767  0000000                   		LDY #CHANNEL
 9768  0000000                   		EN_SP_EQU_SR_Y
 9769  0000000                   	.ENDIF 
 9770  0000000                   	.ENDIF 
 9771  0000000                   ENDM
 9772  0000000                   ;------------------------------------------------------------------------------	
 9773  0000000                   .IF (WITH_SP .EQ. 1)
 9774  0000000                   .IF(WITH_SP_GLOBAL_SR .EQ. 1H)
 9775  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9776  0000000                   DIS_GLOBALSR_SR1 MACRO
 9777  0000000                   	EN_SP_EQU_SR 00H	
 9778  0000000                   ENDM
 9779  0000000                   	.ENDIF
 9780  0000000                   ;------------------------------------------------------------------------------
 9781  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9782  0000000                   DIS_GLOBALSR_SR2 MACRO
 9783  0000000                   	EN_SP_EQU_SR 01H
 9784  0000000                   ENDM
 9785  0000000                   	.ENDIF
 9786  0000000                   ;------------------------------------------------------------------------------
 9787  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9788  0000000                   DIS_GLOBALSR_SR3 MACRO
 9789  0000000                   	EN_SP_EQU_SR 02H
 9790  0000000                   ENDM
 9791  0000000                   	.ENDIF
 9792  0000000                   .ENDIF 
 9793  0000000                   .ENDIF                                                                                                                                                                                                                                                                                                                                                 





 9794  0000000                   ;update by angela for en/dis GLOBALSR feature
 9795  0000000                   ;===============================================================================
 9796  0000000                   ;===============================================================================
 9797  0000000                   .IF (N55P_DEVICE_NUM .GT. 0H)
 9798  0000000                   	EXTERN N55P_X0_INIT_PIN
 9799  0000000                   	EXTERN N55P_X0_ON
 9800  0000000                   	EXTERN N55P_X0_OFF
 9801  0000000                   	EXTERN N55P_X0_MISO
 9802  0000000                   	EXTERN N55P_X0_MOSI
 9803  0000000                   ;--------------------------------------------------------	
 9804  0000000                   N55P_INIT MACRO 
 9805  0000000                   	JSR N55P_X0_INIT_PIN
 9806  0000000                   	ENDM
 9807  0000000                   ;--------------------------------------------------------
 9808  0000000                   N55P_COMMAND_WRITE_CONST MACRO COMMAND,DATA
 9809  0000000                   	JSR N55P_X0_ON
 9810  0000000                   	LDA #COMMAND+80H
 9811  0000000                   	JSR N55P_X0_MOSI
 9812  0000000                   	LDA #DATA
 9813  0000000                   	JSR N55P_X0_MOSI
 9814  0000000                   	JSR N55P_X0_OFF
 9815  0000000                   	ENDM
 9816  0000000                   ;--------------------------------------------------------
 9817  0000000                   N55P_COMMAND_WRITE_RAM MACRO COMMAND,DATA_ADDR
 9818  0000000                   	JSR N55P_X0_ON
 9819  0000000                   	LDA #COMMAND+80H
 9820  0000000                   	JSR N55P_X0_MOSI
 9821  0000000                   	LDA DATA_ADDR
 9822  0000000                   	JSR N55P_X0_MOSI
 9823  0000000                   	JSR N55P_X0_OFF
 9824  0000000                   	ENDM
 9825  0000000                   ;--------------------------------------------------------
 9826  0000000                   N55P_COMMAND_READ MACRO COMMAND
 9827  0000000                   	JSR N55P_X0_ON
 9828  0000000                   	LDA #COMMAND&7Fh
 9829  0000000                   	JSR N55P_X0_MOSI
 9830  0000000                   	JSR N55P_X0_MISO
 9831  0000000                   	JSR N55P_X0_OFF
 9832  0000000                   	TYA
 9833  0000000                   	ENDM
 9834  0000000                   ;--------------------------------------------------------
 9835  0000000                   N55P_COMMAND_READ_RAM MACRO COMMAND,RAM
 9836  0000000                   	JSR N55P_X0_ON
 9837  0000000                   	LDA #COMMAND&7Fh
 9838  0000000                   	JSR N55P_X0_MOSI
 9839  0000000                   	JSR N55P_X0_MISO
 9840  0000000                   	JSR N55P_X0_OFF
 9841  0000000                   	STY RAM
 9842  0000000                   	ENDM	
 9843  0000000                   ;--------------------------------------------------------
 9844  0000000                   N55P_COMMAND_WRITE_UPDATE MACRO ADDR,BIT_MASK,DATA
 9845  0000000                   	N55P_COMMAND_READ ADDR
 9846  0000000                   
 9847  0000000                   	PHA		
 9848  0000000                   	JSR N55P_X0_ON
 9849  0000000                   	LDA #ADDR+80H
 9850  0000000                   	JSR N55P_X0_MOSI





 9851  0000000                   	PLA
 9852  0000000                   	AND #(FFH^BIT_MASK)
 9853  0000000                   	ORA #DATA
 9854  0000000                   	JSR N55P_X0_MOSI
 9855  0000000                   	JSR N55P_X0_OFF
 9856  0000000                   	ENDM
 9857  0000000                   ;--------------------------------------------------------	
 9858  0000000                   ;--------------------------------------------------------
 9859  0000000                   N55P_DEVICE_0 MACRO
 9860  0000000                   	N55P_COMMAND_WRITE_CONST 4Ch, FFh   
 9861  0000000                   	ENDM
 9862  0000000                   ;--------------------------------------------------------	
 9863  0000000                   N55P_DEVICE_1 MACRO
 9864  0000000                   	N55P_COMMAND_WRITE_CONST 4Dh, FFh
 9865  0000000                   	ENDM
 9866  0000000                   
 9867  0000000                   ;--------------------------------------------------------
 9868  0000000                   N55P_RESET MACRO
 9869  0000000                   	N55P_COMMAND_WRITE_CONST 4Fh, FFH
 9870  0000000                   	ENDM
 9871  0000000                   ;--------------------------------------------------------	
 9872  0000000                   ;--------------------------------------------------------		
 9873  0000000                   N55P_SET_PORT_CONST_CURRENT MACRO XPORT,XPINS
 9874  0000000                   	N55P_COMMAND_WRITE_CONST P242CNST_BPA+XPORT,XPINS
 9875  0000000                   	ENDM
 9876  0000000                   ;--------------------------------------------------------
 9877  0000000                   N55P_SET_STATUS MACRO XPORT,XPORT_MASK,B_VALUE,D_VALUE,A_VALUE
 9878  0000000                   	N55P_COMMAND_WRITE_CONST P242BPA_B+XPORT,B_VALUE
 9879  0000000                   	N55P_COMMAND_WRITE_CONST P242BPA_D+XPORT,D_VALUE
 9880  0000000                   	N55P_COMMAND_WRITE_CONST P242BPA_A+XPORT,A_VALUE
 9881  0000000                   	ENDM
 9882  0000000                   ;--------------------------------------------------------
 9883  0000000                   N55P_AND_BUFFER MACRO XPORT,B_VALUE
 9884  0000000                   	N55P_COMMAND_WRITE_CONST P242AND_BPA_B+XPORT,B_VALUE
 9885  0000000                   	ENDM	
 9886  0000000                   ;--------------------------------------------------------
 9887  0000000                   N55P_AND_BUFFER_RAM MACRO XPORT,B_VALUE_RAM
 9888  0000000                   	N55P_COMMAND_WRITE_RAM P242AND_BPA_B+XPORT,B_VALUE_RAM
 9889  0000000                   	ENDM	
 9890  0000000                   ;--------------------------------------------------------
 9891  0000000                   N55P_OR_BUFFER MACRO XPORT,B_VALUE
 9892  0000000                   	N55P_COMMAND_WRITE_CONST P242OR_BPA_B+XPORT,B_VALUE
 9893  0000000                   	ENDM	
 9894  0000000                   ;--------------------------------------------------------
 9895  0000000                   N55P_OR_BUFFER_RAM MACRO XPORT,B_VALUE_RAM
 9896  0000000                   	N55P_COMMAND_WRITE_RAM P242OR_BPA_B+XPORT,B_VALUE_RAM
 9897  0000000                   	ENDM		
 9898  0000000                   ;--------------------------------------------------------
 9899  0000000                   N55P_SET_BPAB_PWM_RATE MACRO PCKAB_MASK,PCKAB_VALUE
 9900  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMCK_BPA,PCKAB_MASK,PCKAB_VALUE
 9901  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMCK_BPA,PCKAB_VALUE
 9902  0000000                   	ENDM
 9903  0000000                   ;--------------------------------------------------------
 9904  0000000                   N55P_SET_BPC_PWM_RATE MACRO PCKC_MASK,PCKC_VALUE
 9905  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMCK_BPC,PCKC_MASK,PCKC_VALUE
 9906  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMCK_BPC,PCKC_VALUE
 9907  0000000                   	ENDM





 9908  0000000                   ;--------------------------------------------------------
 9909  0000000                   N55P_EN_PWM_PIN MACRO XPORT,XPWMX	
 9910  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMEN_BPA+XPORT,XPWMX,XPWMX
 9911  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMEN_BPA+XPORT,XPWMX
 9912  0000000                   	ENDM
 9913  0000000                   ;--------------------------------------------------------
 9914  0000000                   N55P_DIS_PWM_PIN MACRO XPORT,XPWMX
 9915  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMEN_BPA+XPORT,XPWMX,XPWMX
 9916  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMEN_BPA+XPORT,0	
 9917  0000000                   	ENDM
 9918  0000000                   ;--------------------------------------------------------	
 9919  0000000                   ;--------------------------------------------------------
 9920  0000000                   N55P_SET_PWM_VALUE MACRO XPORT, XPWMX,VALUE
 9921  0000000                   	N55P_COMMAND_WRITE_CONST P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,VALUE
 9922  0000000                   	ENDM
 9923  0000000                   ;--------------------------------------------------------
 9924  0000000                   N55P_SET_PWM_VALUE_RAM MACRO XPORT,XPWMX_RAM,RAM
 9925  0000000                   ;	N55P_COMMAND_WRITE_RAM P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,RAM
 9926  0000000                   	JSR N55P_X0_ON
 9927  0000000                   	CLC
 9928  0000000                   	LDA #80H+P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)
 9929  0000000                   	ADC XPWMX_RAM
 9930  0000000                   	JSR N55P_X0_MOSI
 9931  0000000                   	LDA RAM
 9932  0000000                   	JSR N55P_X0_MOSI
 9933  0000000                   	JSR N55P_X0_OFF
 9934  0000000                   	ENDM
 9935  0000000                   ;--------------------------------------------------------
 9936  0000000                   N55P_SET_PWM_VALUE_RAM2 MACRO XPORT,XPWMX_RAM,VALUE
 9937  0000000                   ;	N55P_COMMAND_WRITE_RAM P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,RAM
 9938  0000000                   	JSR N55P_X0_ON
 9939  0000000                   	CLC
 9940  0000000                   	LDA #80H+P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)
 9941  0000000                   	ADC XPWMX_RAM
 9942  0000000                   	JSR N55P_X0_MOSI
 9943  0000000                   	LDA #VALUE
 9944  0000000                   	JSR N55P_X0_MOSI
 9945  0000000                   	JSR N55P_X0_OFF
 9946  0000000                   	ENDM
 9947  0000000                   ;--------------------------------------------------------
 9948  0000000                   N55P_SET_PWM_VALUE_RAM3 MACRO XPORT,XPWMX,RAM
 9949  0000000                   	N55P_COMMAND_WRITE_RAM P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,RAM
 9950  0000000                   	ENDM
 9951  0000000                   .ENDIF
 9952  0000000                   ;--------------------------------------------------------
 9953  0000000                   N55P_EXPANDER_PROCESS_RUNTIME MACRO
 9954  0000000                   .IF (N55P_DEVICE_UIO_USED .GT. 0H)
 9955  0000000                   .IFDEF WDTIMER
 9956  0000000                   .IFDEF LVDEN
 9957  0000000                   	LDA #CTL_CPU_WDT
 9958  0000000                   	TSB RAM_CTL_CPU
 9959  0000000                   	LDA RAM_CTL_CPU
 9960  0000000                   	STA !CTL_CPU
 9961  0000000                   .ELSE
 9962  0000000                   	LDA #CTL_CPU_WDT
 9963  0000000                   	TSB !CTL_CPU
 9964  0000000                   .ENDIF 	





 9965  0000000                   .ENDIF  
 9966  0000000                   
 9967  0000000                   	EXTERN UIO_N55P_PROCESS_NEXT
 9968  0000000                   	JSR UIO_N55P_PROCESS_NEXT
 9969  0000000                   .ENDIF
 9970  0000000                   	ENDM 	
 9971  0000000                   ;--------------------------------------------------------
 9972  0000000                   N55P_EXPANDER_PROCESS MACRO 
 9973  0000000                   .IF (N55P_DEVICE_UIO_USED .GT. 0H)
 9974  0000000                   .IFDEF WDTIMER
 9975  0000000                   .IFDEF LVDEN
 9976  0000000                   	LDA #CTL_CPU_WDT
 9977  0000000                   	TSB RAM_CTL_CPU
 9978  0000000                   	LDA RAM_CTL_CPU
 9979  0000000                   	STA !CTL_CPU
 9980  0000000                   .ELSE
 9981  0000000                   	LDA #CTL_CPU_WDT
 9982  0000000                   	TSB !CTL_CPU
 9983  0000000                   .ENDIF 	
 9984  0000000                   .ENDIF   
 9985  0000000                   
 9986  0000000                   .IF (WITH_PSF_PROJECT .EQ. 1)
 9987  0000000                   .IFDEF ABANDON_STACK
 9988  0000000                   	LDA ABANDON_STACK_FLAG
 9989  0000000                   	BIT #6CH
 9990  0000000                   	BNE N55P_EXPANDER_PROCESS_END#
 9991  0000000                   .ENDIF
 9992  0000000                   .ENDIF
 9993  0000000                   	EXTERN UIO_N55P_PROCESS
 9994  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_N55P_PROCESS
 9995  0000000                   N55P_EXPANDER_PROCESS_END#:
 9996  0000000                   .ENDIF
 9997  0000000                   	ENDM
 9998  0000000                   ;===============================================================================
 9999  0000000                   ;===============================================================================
10000  0000000                   SET_PORT_FLOATING MACRO PORT_INDEX,PIN_MASK
10001  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10002  0000000                   		LDA #PIN_MASK
10003  0000000                   		TSB !BP0D	;set input
10004  0000000                   		.IFDEF       BPXM_RAM
10005  0000000                   			TRB BP0M_BAK	;set floating
10006  0000000                   			LDA !BP0D
10007  0000000                   			EOR #FFH
10008  0000000                   			AND !BP0
10009  0000000                   			ORA BP0M_BAK
10010  0000000                   			STA !BP0
10011  0000000                   		.ELSE	
10012  0000000                   			LDA !BP0
10013  0000000                   			ORA !BP0D
10014  0000000                   			AND #(FFH^ PIN_MASK)
10015  0000000                   			STA !BP0	
10016  0000000                   		.ENDIF	
10017  0000000                   	.ENDIF
10018  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10019  0000000                   		LDA #PIN_MASK
10020  0000000                   		TSB !BP1D	;set input
10021  0000000                   		.IFDEF       BPXM_RAM





10022  0000000                   			TRB BP1M_BAK	;set floating
10023  0000000                   			LDA !BP1D
10024  0000000                   			EOR #FFH
10025  0000000                   			AND !BP1
10026  0000000                   			ORA BP1M_BAK
10027  0000000                   			STA !BP1
10028  0000000                   		.ELSE	
10029  0000000                   			LDA !BP1
10030  0000000                   			ORA !BP1D
10031  0000000                   			AND #(FFH^ PIN_MASK)
10032  0000000                   			STA !BP1	
10033  0000000                   		.ENDIF	
10034  0000000                   	.ENDIF
10035  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10036  0000000                   		LDA #00H
10037  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10038  0000000                   			ORA #01H
10039  0000000                   		.ENDIF
10040  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)
10041  0000000                   			ORA #02H
10042  0000000                   		.ENDIF
10043  0000000                   		CMP !BP2D
10044  0000000                   		BEQ SET_PORT_FLOATING_BP2_NEXT#
10045  0000000                   		TSB !BP2D	;set input
10046  0000000                   		.IFDEF       BPXM_RAM
10047  0000000                   			 LDA #00H
10048  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10049  0000000                   				ORA #0FH
10050  0000000                   			.ENDIF
10051  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10052  0000000                   				ORA #F0H
10053  0000000                   			.ENDIF
10054  0000000                   			TSB BP2M_BAK	;set pull-high
10055  0000000                   SET_PORT_FLOATING_BP2_NEXT#:
10056  0000000                   			LDA #PIN_MASK
10057  0000000                   			TRB BP2M_BAK	;set floating
10058  0000000                   			LDX !BP2D
10059  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10060  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10061  0000000                   			AND !BP2
10062  0000000                   			ORA BP2M_BAK
10063  0000000                   			STA !BP2
10064  0000000                   		.ELSE
10065  0000000                   SET_PORT_FLOATING_BP2_NEXT#:	
10066  0000000                   			LDX !BP2D
10067  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10068  0000000                   			LDA !BP2
10069  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10070  0000000                   			AND #(FFH^ PIN_MASK)
10071  0000000                   			STA !BP2	
10072  0000000                   		.ENDIF	
10073  0000000                   	.ENDIF
10074  0000000                   	ENDM 	
10075  0000000                   ;--------------------------------------------------------
10076  0000000                   SET_PORT_PULL_HIGH MACRO PORT_INDEX,PIN_MASK
10077  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10078  0000000                   		LDA #PIN_MASK





10079  0000000                   		TSB !BP0D	;set input
10080  0000000                   		.IFDEF       BPXM_RAM
10081  0000000                   			TSB BP0M_BAK	;set pull-high
10082  0000000                   			LDA !BP0D
10083  0000000                   			EOR #FFH
10084  0000000                   			AND !BP0
10085  0000000                   			ORA BP0M_BAK
10086  0000000                   			STA !BP0
10087  0000000                   		.ELSE	
10088  0000000                   			LDA !BP0
10089  0000000                   			ORA !BP0D
10090  0000000                   			STA !BP0	
10091  0000000                   		.ENDIF	
10092  0000000                   	.ENDIF
10093  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10094  0000000                   		LDA #PIN_MASK
10095  0000000                   		TSB !BP1D	;set input
10096  0000000                   		.IFDEF       BPXM_RAM
10097  0000000                   			TSB BP1M_BAK	;set pull-high
10098  0000000                   			LDA !BP1D
10099  0000000                   			EOR #FFH
10100  0000000                   			AND !BP1
10101  0000000                   			ORA BP1M_BAK
10102  0000000                   			STA !BP1
10103  0000000                   		.ELSE	
10104  0000000                   			LDA !BP1
10105  0000000                   			ORA !BP1D
10106  0000000                   			STA !BP1
10107  0000000                   		.ENDIF	
10108  0000000                   	.ENDIF
10109  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10110  0000000                   		LDA #00H
10111  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10112  0000000                   			ORA #01H
10113  0000000                   		.ENDIF
10114  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)
10115  0000000                   			ORA #02H
10116  0000000                   		.ENDIF
10117  0000000                   		CMP !BP2D
10118  0000000                   		BEQ SET_PORT_PULL_HIGH_BP2_NEXT#
10119  0000000                   		TSB !BP2D	;set input
10120  0000000                   		.IFDEF       BPXM_RAM
10121  0000000                   			LDA #00H
10122  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10123  0000000                   				ORA #0FH
10124  0000000                   			.ENDIF
10125  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10126  0000000                   				ORA #F0H
10127  0000000                   			.ENDIF
10128  0000000                   			TSB BP2M_BAK	;set pull-high
10129  0000000                   SET_PORT_PULL_HIGH_BP2_NEXT#:
10130  0000000                   			LDA #PIN_MASK
10131  0000000                   			TSB BP2M_BAK	;set pull-high
10132  0000000                   			LDX !BP2D
10133  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10134  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10135  0000000                   			AND !BP2





10136  0000000                   			ORA BP2M_BAK
10137  0000000                   			STA !BP2
10138  0000000                   		.ELSE	
10139  0000000                   SET_PORT_PULL_HIGH_BP2_NEXT#:
10140  0000000                   			LDX !BP2D
10141  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10142  0000000                   			LDA !BP2
10143  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10144  0000000                   			ORA #PIN_MASK
10145  0000000                   			STA !BP2	
10146  0000000                   		.ENDIF	
10147  0000000                   	.ENDIF
10148  0000000                   	ENDM 	
10149  0000000                   ;--------------------------------------------------------
10150  0000000                   SET_PORT_OUTPUT_0  MACRO PORT_INDEX,PIN_MASK
10151  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10152  0000000                   		LDA #PIN_MASK
10153  0000000                   		TRB !BP0D	;set output
10154  0000000                   		.IFDEF       BPXM_RAM
10155  0000000                   			TRB BP0M_BAK
10156  0000000                   			LDA !BP0D
10157  0000000                   			EOR #FFH
10158  0000000                   			AND !BP0
10159  0000000                   			ORA BP0M_BAK
10160  0000000                   			AND #(FFH^ PIN_MASK)
10161  0000000                   			STA !BP0
10162  0000000                   		.ELSE	
10163  0000000                   			LDA !BP0
10164  0000000                   			AND #(FFH^ PIN_MASK)
10165  0000000                   			ORA !BP0D
10166  0000000                   			STA !BP0	
10167  0000000                   		.ENDIF	
10168  0000000                   	.ENDIF
10169  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10170  0000000                   		LDA #PIN_MASK
10171  0000000                   		TRB !BP1D	;set output
10172  0000000                   		.IFDEF       BPXM_RAM
10173  0000000                   			TRB BP1M_BAK
10174  0000000                   			LDA !BP1D
10175  0000000                   			EOR #FFH
10176  0000000                   			AND !BP1
10177  0000000                   			ORA BP1M_BAK
10178  0000000                   			AND #(FFH^ PIN_MASK)
10179  0000000                   			STA !BP1
10180  0000000                   		.ELSE	
10181  0000000                   			LDA !BP1
10182  0000000                   			AND #(FFH^ PIN_MASK)
10183  0000000                   			ORA !BP1D
10184  0000000                   			STA !BP1	
10185  0000000                   		.ENDIF	
10186  0000000                   	.ENDIF
10187  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10188  0000000                   		LDA #00H
10189  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10190  0000000                   			ORA #01H
10191  0000000                   		.ENDIF
10192  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)





10193  0000000                   			ORA #02H
10194  0000000                   		.ENDIF
10195  0000000                   		TRB !BP2D	;set output
10196  0000000                   		.IFDEF       BPXM_RAM
10197  0000000                   			LDA #00H
10198  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10199  0000000                   				ORA #0FH
10200  0000000                   			.ENDIF
10201  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10202  0000000                   				ORA #F0H
10203  0000000                   			.ENDIF
10204  0000000                   			TRB BP2M_BAK
10205  0000000                   			LDX !BP2D
10206  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10207  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10208  0000000                   			AND !BP2
10209  0000000                   			ORA BP2M_BAK
10210  0000000                   			AND #(FFH^ PIN_MASK)
10211  0000000                   			STA !BP2
10212  0000000                   		.ELSE	
10213  0000000                   			LDX !BP2D
10214  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10215  0000000                   			LDA !BP2
10216  0000000                   			AND #(FFH^ PIN_MASK)
10217  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10218  0000000                   			STA !BP2	
10219  0000000                   		.ENDIF	
10220  0000000                   	.ENDIF
10221  0000000                   	ENDM 	
10222  0000000                   ;--------------------------------------------------------
10223  0000000                   SET_PORT_OUTPUT_1  MACRO PORT_INDEX,PIN_MASK
10224  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10225  0000000                   		LDA #PIN_MASK
10226  0000000                   		TRB !BP0D	;set output
10227  0000000                   		.IFDEF       BPXM_RAM
10228  0000000                   			TRB BP0M_BAK
10229  0000000                   			LDA !BP0D
10230  0000000                   			EOR #FFH
10231  0000000                   			AND !BP0
10232  0000000                   			ORA #PIN_MASK
10233  0000000                   			ORA BP0M_BAK
10234  0000000                   			STA !BP0
10235  0000000                   		.ELSE	
10236  0000000                   			LDA !BP0
10237  0000000                   			ORA #PIN_MASK
10238  0000000                   			ORA !BP0D
10239  0000000                   			STA !BP0	
10240  0000000                   		.ENDIF	
10241  0000000                   	.ENDIF
10242  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10243  0000000                   		LDA #PIN_MASK
10244  0000000                   		TRB !BP1D	;set output
10245  0000000                   		.IFDEF       BPXM_RAM
10246  0000000                   			TRB BP1M_BAK	
10247  0000000                   			LDA !BP1D
10248  0000000                   			EOR #FFH
10249  0000000                   			AND !BP1





10250  0000000                   			ORA #PIN_MASK
10251  0000000                   			ORA BP1M_BAK
10252  0000000                   			STA !BP1
10253  0000000                   		.ELSE	
10254  0000000                   			LDA !BP1
10255  0000000                   			ORA #PIN_MASK
10256  0000000                   			ORA !BP1D
10257  0000000                   			STA !BP1
10258  0000000                   		.ENDIF	
10259  0000000                   	.ENDIF
10260  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10261  0000000                   		LDA #00H
10262  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10263  0000000                   			ORA #01H
10264  0000000                   		.ENDIF
10265  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)
10266  0000000                   			ORA #02H
10267  0000000                   		.ENDIF
10268  0000000                   		TRB !BP2D	;set output
10269  0000000                   		.IFDEF       BPXM_RAM
10270  0000000                   			LDA #00H
10271  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10272  0000000                   				ORA #0FH
10273  0000000                   			.ENDIF
10274  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10275  0000000                   				ORA #F0H
10276  0000000                   			.ENDIF
10277  0000000                   			TRB BP2M_BAK
10278  0000000                   			LDX !BP2D
10279  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10280  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10281  0000000                   			AND !BP2
10282  0000000                   			ORA #PIN_MASK
10283  0000000                   			ORA BP2M_BAK
10284  0000000                   			STA !BP2
10285  0000000                   		.ELSE	
10286  0000000                   			LDX !BP2D
10287  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10288  0000000                   			LDA !BP2
10289  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10290  0000000                   			ORA #PIN_MASK
10291  0000000                   			STA !BP2	
10292  0000000                   		.ENDIF	
10293  0000000                   	.ENDIF
10294  0000000                   	ENDM 	
10295  0000000                   ;--------------------------------------------------------
10296  0000000                   ;===============================================================================
10297  0000000                   ;===============================================================================
10298  0000000                   .ENDIF
10299  0000000                   ;(WITH_USER_PLAY)
10300  0000000                   
10301  0000000                   
10302  0000000                       .IF (WITH_FW_CAP_SENSOR_KEYS .GT. 0)
10303  0000000                       .IF (WITH_PSF_PROJECT .EQ. 0)
10304  0000000                   ;---------------------------------
10305  0000000                   ; Cap Include File
10306  0000000                   ;---------------------------------





10307  0000000                       	.IF (CAP_SENSOR_IMPLEMENTATION .EQ. 1)
10308  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\CAP_SENSOR_MACROS_1.INI.APP"
10309  0000000                       	.ENDIF
10310  0000000                       	.IF (CAP_SENSOR_IMPLEMENTATION .EQ. 2)
10311  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\CAP_SENSOR_MACROS_2.INI.APP"
10312  0000000                       	.ENDIF
10313  0000000                       .ENDIF
10314  0000000                       .ENDIF
10315  0000000                   
10316  0000000                   RR0	EQU	00H
10317  0000000                   RR1	EQU	01H
10318  0000000                   ;-------------------------------------------------------------------------------------------------------
10319  0000000                   	.IF (WITH_SP .EQ. 1H)
10320  0000000                   ; [Add] N588J chip series
10321  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
10322  0000000                   	.IF	(CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
10323  0000000                   		.IF (((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 0))||(WITH_SP_MIDI_SIMUL .EQ. 0))
10324  0000000                   			.IF (WITH_ISR_VS1A .EQ. 1)
10325  0000000                   CH1_STATUS EQU VS1A_START
10326  0000000                   			.ENDIF	
10327  0000000                   			.IF (WITH_ISR_VS2A .EQ. 1)		
10328  0000000                   CH2_STATUS EQU VS2A_START
10329  0000000                   			.ENDIF
10330  0000000                   			.IF (WITH_ISR_VS0A .EQ. 1)
10331  0000000                   CH3_STATUS EQU VS0A_START
10332  0000000                   			.ENDIF		
10333  0000000                   		.ELSE
10334  0000000                   			.IF (WITH_ISR_VS0A .EQ. 1)
10335  0000000                   CH1_STATUS EQU VS0A_START
10336  0000000                   			.ENDIF
10337  0000000                   			.IF (WITH_ISR_VS1A .EQ. 1)		
10338  0000000                   CH2_STATUS EQU VS1A_START
10339  0000000                   			.ENDIF
10340  0000000                   			.IF (WITH_ISR_VS2A .EQ. 1)		
10341  0000000                   CH3_STATUS EQU VS2A_START	
10342  0000000                   			.ENDIF	
10343  0000000                   		.ENDIF
10344  0000000                   	.ENDIF
10345  0000000                   	.ENDIF
10346  0000000                   ;-------------------------------------------------------------------------------------------------------
10347  0000000                   	.IF (WITH_MS .EQ. 1H)
10348  0000000                   MS_STATUS  EQU MS_START+CH_STATUS_MS
10349  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
10350  0000000                   EXT_MIDI_STATUS  EQU MS_START+CH_EXT_MIDI_STATUS_MS
10351  0000000                   	.ENDIF
10352  0000000                   	.ENDIF
10353  0000000                   
10354  0000000                   .IF (WITH_MS .EQ. 1H)
10355  0000000                   ; [Add] N588J chip series
10356  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
10357  0000000                       .IF (CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
10358  0000000                            .IF  (((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 0)&&(WITH_SP .EQ. 0))||((WITH_SP_MIDI_SIMUL .EQ. 0)&&(WITH_TONE .EQ. 0)))              
10359  0000000                                     .IF (WITH_VS0A_TONE .EQ. 1) .OR. (WITH_VS0A_HQPC8 .EQ. 1) .OR. (WITH_VS0A_VMDPC8 .EQ. 1) .OR. (WITH_VS0A_PCSPC8 .EQ. 1)
10360  0000000                   MS_CH1_STATUS EQU VS0A_START
10361  0000000                                     .ENDIF
10362  0000000                                     .IF (WITH_VS2A_TONE .EQ. 1) .OR. (WITH_VS2A_HQPC8 .EQ. 1) .OR. (WITH_VS2A_VMDPC8 .EQ. 1) .OR. (WITH_VS2A_PCSPC8 .EQ. 1)
10363  0000000                   MS_CH2_STATUS EQU VS2A_START





10364  0000000                                     .ENDIF
10365  0000000                                     .IF (WITH_VS1A_TONE .EQ. 1) .OR. (WITH_VS1A_HQPC8 .EQ. 1) .OR. (WITH_VS1A_VMDPC8 .EQ. 1) .OR. (WITH_VS1A_PCSPC8 .EQ. 1)
10366  0000000                   MS_CH3_STATUS EQU VS1A_START   
10367  0000000                                     .ENDIF 
10368  0000000                            .ENDIF
10369  0000000                            .IF (((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 0)&&(WITH_SP .EQ. 1))||((WITH_SP_MIDI_SIMUL .EQ. 0)&&(WITH_TONE .EQ. 1)))
10370  0000000                                     .IF (WITH_VS1A_TONE .EQ. 1) .OR. (WITH_VS1A_HQPC8 .EQ. 1) .OR. (WITH_VS1A_VMDPC8 .EQ. 1) .OR. (WITH_VS1A_PCSPC8 .EQ. 1)
10371  0000000                   MS_CH1_STATUS EQU VS1A_START
10372  0000000                                     .ENDIF
10373  0000000                                     .IF (WITH_VS2A_TONE .EQ. 1) .OR. (WITH_VS2A_HQPC8 .EQ. 1) .OR. (WITH_VS2A_VMDPC8 .EQ. 1) .OR. (WITH_VS2A_PCSPC8 .EQ. 1) 
10374  0000000                   MS_CH2_STATUS EQU VS2A_START
10375  0000000                                     .ENDIF
10376  0000000                                     .IF (WITH_VS0A_TONE .EQ. 1) .OR. (WITH_VS0A_HQPC8 .EQ. 1) .OR. (WITH_VS0A_VMDPC8 .EQ. 1) .OR. (WITH_VS0A_PCSPC8 .EQ. 1)
10377  0000000                   MS_CH3_STATUS EQU VS0A_START   
10378  0000000                                     .ENDIF  
10379  0000000                            .ENDIF
10380  0000000                            .IF  ((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 1))
10381  0000000                                .IF (WITH_VS2A_TONE .EQ. 1) .OR. (WITH_VS2A_HQPC8 .EQ. 1) .OR. (WITH_VS2A_VMDPC8 .EQ. 1) .OR. (WITH_VS2A_PCSPC8 .EQ. 1)
10382  0000000                   MS_CH1_STATUS EQU VS2A_START
10383  0000000                                .ENDIF   
10384  0000000                                .IF (WITH_VS1A_TONE .EQ. 1) .OR. (WITH_VS1A_HQPC8 .EQ. 1) .OR. (WITH_VS1A_VMDPC8 .EQ. 1) .OR. (WITH_VS1A_PCSPC8 .EQ. 1) 
10385  0000000                   MS_CH2_STATUS EQU VS1A_START
10386  0000000                                .ENDIF
10387  0000000                                .IF (WITH_VS0A_TONE .EQ. 1) .OR. (WITH_VS0A_HQPC8 .EQ. 1) .OR. (WITH_VS0A_VMDPC8 .EQ. 1) .OR. (WITH_VS0A_PCSPC8 .EQ. 1) 
10388  0000000                   MS_CH3_STATUS EQU VS0A_START
10389  0000000                                .ENDIF                  
10390  0000000                            .ENDIF
10391  0000000                       .ENDIF
10392  0000000                   .ENDIF
10393  0000000                   ;-------------------------------------------------------------------------------------------------------	
10394  0000000                   	.IF (WITH_EVO .EQ. 1H)
10395  0000000                   		.IF (WITH_CH0_EVO .EQ. 1)
10396  0000000                   EVO1_STATUS  EQU EVO0_START
10397  0000000                   		.ENDIF	
10398  0000000                   		.IF (WITH_CH1_EVO .EQ. 1)
10399  0000000                   EVO2_STATUS  EQU EVO1_START
10400  0000000                   		.ENDIF	
10401  0000000                   		.IF (WITH_CH2_EVO .EQ. 1)
10402  0000000                   EVO3_STATUS  EQU EVO2_START
10403  0000000                   		.ENDIF	
10404  0000000                   	.ENDIF
10405  0000000                   ;--------------------------------------------------------------------------------------------------------
10406  0000000                   
10407  0000000                   DAC_5mA			EQU	01H
10408  0000000                   DAC_3mA			EQU 	05H
10409  0000000                   DAC_5MA			EQU	01H
10410  0000000                   DAC_3MA			EQU 	05H
10411  0000000                   EPWM			EQU	02H
10412  0000000                   PWM			EQU	02H
10413  0000000                   
10414  0000000                   ;;=== FOR COMMON USE ===
10415  0000000                   .EXTERNAL		PLAY_PHRASE_PROCEDURE
10416  0000000                   .EXTERNAL		PLAY_PHRASE_PROCEDURE_IOSPI
10417  0000000                   .EXTERNAL		SP_CHANNEL_QUIT_TABLE
10418  0000000                   .EXTERN			SP_CHANNEL_ADDR_TABLE
10419  0000000                   .EXTERN			STOP_SP_CHANNEL_PROC
10420  0000000                   .EXTERN			SP_CHANNEL_ID_TABLE_2





10421  0000000                   .EXTERN			SP_TM_CH_MAP_TABLE
10422  0000000                   
10423  0000000                   .EXTERNAL		STOP_ALL_SP
10424  0000000                   .EXTERNAL		STOP_MS
10425  0000000                   .EXTERNAL		STOP_ALL
10426  0000000                   .EXTERNAL		STOP_PLAY_Y_EVO_API
10427  0000000                   .EXTERNAL		STOP_PLAY_Y_SP_API
10428  0000000                   .EXTERNAL		STOP_PLAY_ALL_MS_API
10429  0000000                   .EXTERNAL		STOP_PLAY_ALL_API
10430  0000000                   
10431  0000000                   .EXTERNAL		PAUSE_PLAY_Y_SP_API
10432  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_SP_API
10433  0000000                   .EXTERNAL		PAUSE_PLAY_Y_EVO_API
10434  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_EVO_API
10435  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_MS_API
10436  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_API	
10437  0000000                   .EXTERNAL		RESUME_PLAY_Y_SP_API
10438  0000000                   .EXTERNAL		RESUME_PLAY_ALL_SP_API
10439  0000000                   .EXTERNAL		RESUME_PLAY_Y_EVO_API
10440  0000000                   .EXTERNAL		RESUME_PLAY_ALL_EVO_API
10441  0000000                   .EXTERNAL		RESUME_PLAY_ALL_MS_API
10442  0000000                   .EXTERNAL		RESUME_PLAY_ALL_API
10443  0000000                   
10444  0000000                   .EXTERNAL		NOTE_OFF_ASSIGN_MELODY_CHANNEL_API
10445  0000000                   
10446  0000000                   .EXTERNAL		CH1_SPEED_UP
10447  0000000                   .EXTERNAL		CH1_PITCH_UP
10448  0000000                   .EXTERNAL		CH1_SPEED_DOWN
10449  0000000                   .EXTERNAL		CH1_PITCH_DOWN
10450  0000000                   .EXTERNAL		CH1_SPEED_MODE
10451  0000000                   .EXTERNAL		CH1_PITCH_MODE
10452  0000000                   .EXTERNAL		CH1_PAM_NORMAL
10453  0000000                   
10454  0000000                   
10455  0000000                   .EXTERNAL		CH2_SPEED_UP
10456  0000000                   .EXTERNAL		CH2_PITCH_UP
10457  0000000                   .EXTERNAL		CH2_SPEED_DOWN
10458  0000000                   .EXTERNAL		CH2_PITCH_DOWN
10459  0000000                   .EXTERNAL		CH2_SPEED_MODE
10460  0000000                   .EXTERNAL		CH2_PITCH_MODE
10461  0000000                   .EXTERNAL		CH2_PAM_NORMAL
10462  0000000                   
10463  0000000                   
10464  0000000                   .EXTERNAL		CH3_SPEED_UP
10465  0000000                   .EXTERNAL		CH3_PITCH_UP
10466  0000000                   .EXTERNAL		CH3_SPEED_DOWN
10467  0000000                   .EXTERNAL		CH3_PITCH_DOWN
10468  0000000                   .EXTERNAL		CH3_SPEED_MODE
10469  0000000                   .EXTERNAL		CH3_PITCH_MODE
10470  0000000                   .EXTERNAL		CH3_PAM_NORMAL
10471  0000000                   
10472  0000000                   .EXTERNAL		STOP_CH1
10473  0000000                   .EXTERNAL		STOP_CH2
10474  0000000                   .EXTERNAL		STOP_CH3
10475  0000000                   .EXTERNAL		STOP_EVO1
10476  0000000                   .EXTERNAL		STOP_EVO2
10477  0000000                   .EXTERNAL		STOP_EVO3





10478  0000000                   
10479  0000000                   ;----------------------------------------------------------------------------------------------
10480  0000000                   SPECIAL_REGISTERS_INIT MACRO
10481  0000000                   	.IF (WITH_SIM_SP .EQ. 1H)
10482  0000000                   		LDA #RDPC_WSC+WITH_RDPC_VALUE
10483  0000000                   		STA !RDPC
10484  0000000                   		.IF (WITH_SIM_TYPE .EQ. 0)
10485  0000000                   	      		LDA #SIC_EN
10486  0000000                   	      		STA !SIC
10487  0000000                   	      		.IF (WITH_EXT32MBIT .EQ. 1)
10488  0000000                   	      			LDA #01H
10489  0000000                   	      			TRB !BP2D
10490  0000000                   	        	.ENDIF
10491  0000000                   	        .ENDIF
10492  0000000                   		.IF (WITH_SIM_TYPE .EQ. 1)
10493  0000000                   		        LDA #(SIC_EN+SIC_SPI)
10494  0000000                   		      	STA !SIC
10495  0000000                   		.ENDIF
10496  0000000                   	.ENDIF		
10497  0000000                   
10498  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0))
10499  0000000                   .ELSE
10500  0000000                   	.IF(WITH_SPEAKER_SWITCH .EQ. 1)
10501  0000000                   		LDA <SPEN_TMP
10502  0000000                   		BNE END_STORE_SPEAKER#
10503  0000000                   		LDA #WITH_SPEAKER_OUTPUT_TYPE
10504  0000000                   		STA <SPEN_TMP	;set the of type mixer output
10505  0000000                   END_STORE_SPEAKER#:
10506  0000000                   	.ENDIF
10507  0000000                   		STZ !SPEN
10508  0000000                   
10509  0000000                   .ENDIF
10510  0000000                   
10511  0000000                   .IF(WITH_PSF_PROJECT .EQ. 0)
10512  0000000                   	LDA #FFH
10513  0000000                   	STA !BP0
10514  0000000                   	STA !BP1
10515  0000000                   	.IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
10516  0000000                   		STA !BP2
10517  0000000                   	.ENDIF
10518  0000000                   .ENDIF
10519  0000000                   
10520  0000000                   	EXTERN	UIO_INIT
10521  0000000                   	JSR 	UIO_INIT
10522  0000000                   
10523  0000000                   	.IF (N55P_DEVICE_NUM .GT. 0H)
10524  0000000                   	EXTERN	UIO_N55P_INIT
10525  0000000                   	JSR 	UIO_N55P_INIT
10526  0000000                   	.ENDIF
10527  0000000                   
10528  0000000                   .IF(WITH_PSF_PROJECT .EQ. 0)
10529  0000000                   .IFDEF       BPXM_RAM	
10530  0000000                   	.IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
10531  0000000                   	LDX !BP2D
10532  0000000                   	EXTERN BP2M_BAK_TABLE
10533  0000000                   	LDA !BP2M_BAK_TABLE,X
10534  0000000                   	STA <BP2M_BAK





10535  0000000                   	.ENDIF
10536  0000000                   
10537  0000000                   	LDX !BP1D
10538  0000000                   	EXTERN BP1M_BAK_TABLE
10539  0000000                   	LDA !BP1M_BAK_TABLE,X
10540  0000000                   	STA <BP1M_BAK
10541  0000000                   
10542  0000000                   	LDX !BP0D
10543  0000000                   	EXTERN BP0M_BAK_TABLE
10544  0000000                   	LDA !BP0M_BAK_TABLE,X
10545  0000000                   	STA <BP0M_BAK
10546  0000000                   .ENDIF
10547  0000000                   .ENDIF
10548  0000000                   
10549  0000000                   ; for Drum Table used and not used now, but current library will acess thes table name	
10550  0000000                   	PUBLIC		DRUM_LIST_TABLE_LOW
10551  0000000                   	PUBLIC		DRUM_LIST_TABLE_HIGH
10552  0000000                   	PUBLIC		DRUM_LIST_TABLE_HIGH8
10553  0000000                   DRUM_LIST_TABLE_LOW:
10554  0000000                   DRUM_LIST_TABLE_HIGH:
10555  0000000                   DRUM_LIST_TABLE_HIGH8:
10556  0000000                   
10557  0000000                   	.IF (WITH_VS0B .EQ. 1H)	; 5S channel
10558  0000000                   ; VS0A -> Time
10559  0000000                   		PUBLIC		LIB_VS0B_ISR
10560  0000000                   		PUBLIC		LIB_VS1B_ISR
10561  0000000                   		PUBLIC		LIB_VS2B_ISR
10562  0000000                   		PUBLIC		QUIT_LIB_VS0_ISR
10563  0000000                   		PUBLIC		QUIT_LIB_VS1_ISR
10564  0000000                   		PUBLIC		QUIT_LIB_VS2_ISR
10565  0000000                   
10566  0000000                   		LDA #.LOW.LIB_VS0B_ISR
10567  0000000                   		STA <VS0A_START+CH_ISR_SYNTH_START_SP
10568  0000000                   		LDA #.HIGH.LIB_VS0B_ISR
10569  0000000                   		STA <VS0A_START+CH_ISR_SYNTH_START_SP+1
10570  0000000                   
10571  0000000                   		LDA #.LOW.QUIT_LIB_VS0_ISR
10572  0000000                   		STA <VS0B_START+CH_ISR_SYNTH_START_SP
10573  0000000                   		LDA #.HIGH.QUIT_LIB_VS0_ISR
10574  0000000                   		STA <VS0B_START+CH_ISR_SYNTH_START_SP+1
10575  0000000                   
10576  0000000                   		LDA #.LOW.LIB_VS1B_ISR
10577  0000000                   		STA <VS1A_START+CH_ISR_SYNTH_START_SP
10578  0000000                   		LDA #.HIGH.LIB_VS1B_ISR
10579  0000000                   		STA <VS1A_START+CH_ISR_SYNTH_START_SP+1
10580  0000000                   
10581  0000000                   		LDA #.LOW.QUIT_LIB_VS1_ISR
10582  0000000                   		STA <VS1B_START+CH_ISR_SYNTH_START_SP
10583  0000000                   		LDA #.HIGH.QUIT_LIB_VS1_ISR
10584  0000000                   		STA <VS1B_START+CH_ISR_SYNTH_START_SP+1
10585  0000000                   
10586  0000000                   		LDA #.LOW.LIB_VS2B_ISR
10587  0000000                   		STA <VS2A_START+CH_ISR_SYNTH_START_SP
10588  0000000                   		LDA #.HIGH.LIB_VS2B_ISR
10589  0000000                   		STA <VS2A_START+CH_ISR_SYNTH_START_SP+1
10590  0000000                   
10591  0000000                   ;For 6S MD5





10592  0000000                   		LDA #80H
10593  0000000                   		STA <VS0A_START+CH_OLD_SAMPLE_EMM+1
10594  0000000                   		STA <VS0B_START+CH_OLD_SAMPLE_EMM+1
10595  0000000                   		STA <VS1A_START+CH_OLD_SAMPLE_EMM+1
10596  0000000                   		STA <VS1B_START+CH_OLD_SAMPLE_EMM+1
10597  0000000                   		STA <VS2A_START+CH_OLD_SAMPLE_EMM+1
10598  0000000                   		STA <VS2B_START+CH_OLD_SAMPLE_EMM+1
10599  0000000                   
10600  0000000                   	.ELSE 
10601  0000000                   ;		PUBLIC		QUIT_LIB_VS0_ISR
10602  0000000                   ;		PUBLIC		QUIT_LIB_VS1_ISR
10603  0000000                   ;		PUBLIC		QUIT_LIB_VS2_ISR
10604  0000000                   
10605  0000000                   		.IF (WITH_ISR_VS0A .EQ. 1H)
10606  0000000                   			PUBLIC		QUIT_LIB_VS0_ISR
10607  0000000                   			LDA #.LOW.QUIT_LIB_VS0_ISR
10608  0000000                   			STA <VS0A_START+CH_ISR_SYNTH_START_SP
10609  0000000                   			LDA #.HIGH.QUIT_LIB_VS0_ISR
10610  0000000                   			STA <VS0A_START+CH_ISR_SYNTH_START_SP+1
10611  0000000                   		.ENDIF
10612  0000000                   		.IF (WITH_ISR_VS1A .EQ. 1H)
10613  0000000                   			PUBLIC		QUIT_LIB_VS1_ISR
10614  0000000                   			LDA #.LOW.QUIT_LIB_VS1_ISR
10615  0000000                   			STA <VS1A_START+CH_ISR_SYNTH_START_SP
10616  0000000                   			LDA #.HIGH.QUIT_LIB_VS1_ISR
10617  0000000                   			STA <VS1A_START+CH_ISR_SYNTH_START_SP+1
10618  0000000                   		.ENDIF
10619  0000000                   		.IF (WITH_ISR_VS2A .EQ. 1H)
10620  0000000                   			PUBLIC		QUIT_LIB_VS2_ISR
10621  0000000                   			LDA #.LOW.QUIT_LIB_VS2_ISR
10622  0000000                   			STA <VS2A_START+CH_ISR_SYNTH_START_SP
10623  0000000                   			LDA #.HIGH.QUIT_LIB_VS2_ISR
10624  0000000                   			STA <VS2A_START+CH_ISR_SYNTH_START_SP+1
10625  0000000                   		.ENDIF
10626  0000000                   	.ENDIF
10627  0000000                   
10628  0000000                   	.IF (WITH_SP .EQ. 1).OR.(WITH_MS .EQ. 1)
10629  0000000                   	LDY #FFH
10630  0000000                   INIT_PCM#:
10631  0000000                   	INY
10632  0000000                   	LDX !SP_CHANNEL_ADDR_TABLE,Y		;X=STOP CHANNEL ADDRESS
10633  0000000                   	BEQ END_INIT_PCM#
10634  0000000                   
10635  0000000                   	LDA #80H
10636  0000000                   	STA <CH_PREVIOUS_PCM_SP+1,X
10637  0000000                   	STZ <CH_PREVIOUS_PCM_SP,X
10638  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1H)
10639  0000000                   	LDA #80H
10640  0000000                   	STA <CH_PREVIOUS_PCM_VOL_SP+1,X
10641  0000000                   	STZ <CH_PREVIOUS_PCM_VOL_SP,X
10642  0000000                   	.ENDIF
10643  0000000                   	BRA INIT_PCM#
10644  0000000                   END_INIT_PCM#:
10645  0000000                   	.ENDIF
10646  0000000                   
10647  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM == 1 || WITH_GLOBAL_CHANNEL_INS == 1 ||WITH_MULTI_CHANNEL == 1)
10648  0000000                   		LDY #FFH





10649  0000000                   INIT_GLOBAL_CHANNEL_SETTING#:
10650  0000000                   		INY
10651  0000000                   		CPY #03H
10652  0000000                   		BCS END_INIT_GLOBAL_CHANNEL_SETTING#
10653  0000000                   
10654  0000000                   		EXTERN MS_CHANNEL_TABLE
10655  0000000                   		LDA !MS_CHANNEL_TABLE,Y
10656  0000000                   		BEQ INIT_GLOBAL_CHANNEL_SETTING#
10657  0000000                   
10658  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
10659  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
10660  0000000                   			LDX MS_GLOBAL_CHANNEL_VOLUME_TABLE,Y
10661  0000000                   			LDA #7FH
10662  0000000                   			STA GLOBAL_CHANNEL_VOLM0,X
10663  0000000                   		.ENDIF
10664  0000000                   
10665  0000000                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
10666  0000000                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
10667  0000000                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
10668  0000000                   			STZ GLOBAL_CHANNEL_INS0,X
10669  0000000                   		.ENDIF
10670  0000000                   
10671  0000000                   		.IF (WITH_MULTI_CHANNEL .EQ. 1H)
10672  0000000                   			EXTERN ASSIGN_MELODY_CHANNEL_TABLE
10673  0000000                   			LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
10674  0000000                   			TYA
10675  0000000                   			STA CH_SYNTH_CHANNEL0,X
10676  0000000                   		.ENDIF
10677  0000000                   
10678  0000000                   		BRA INIT_GLOBAL_CHANNEL_SETTING#
10679  0000000                   END_INIT_GLOBAL_CHANNEL_SETTING#:
10680  0000000                   	.ENDIF
10681  0000000                   ENDM
10682  0000000                   ;------------------------------------------------------------------
10683  0000000                   STORE_PCM_TO_TBUF MACRO CHANNEL_VSXA,VSXA_START,TBUF_LOW,TBUF_HI
10684  0000000                   	.IF (WITH_VOL_REDUCE .EQ. 1)	
10685  0000000                   		LDY #CHANNEL_VSXA
10686  0000000                   		EXTERN SP_TM_CH_MAP_TABLE
10687  0000000                   		LDA !SP_TM_CH_MAP_TABLE,Y
10688  0000000                   		INC A
10689  0000000                   		BIT <COMMON_FLAG
10690  0000000                   		BEQ VSXA_STORE_PCM#
10691  0000000                   
10692  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
10693  0000000                   			LDA <(CH_PREVIOUS_PCM_SP+1+VSXA_START)
10694  0000000                   		.ELSE
10695  0000000                   			LDA <(CH_PREVIOUS_PCM_VOL_SP+1+VSXA_START)
10696  0000000                   		.ENDIF
10697  0000000                   		EOR #80H
10698  0000000                   		BMI NEG_PCM#
10699  0000000                   		CLC
10700  0000000                   		BRA STORE_REDUCE_VOL#
10701  0000000                   NEG_PCM#:
10702  0000000                   		SEC
10703  0000000                   
10704  0000000                   STORE_REDUCE_VOL#:
10705  0000000                   		ROR A





10706  0000000                   		EOR #80H
10707  0000000                   		STA !TBUF_HI
10708  0000000                   
10709  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
10710  0000000                   			LDA <(CH_PREVIOUS_PCM_SP+VSXA_START)
10711  0000000                   		.ELSE
10712  0000000                   			LDA <(CH_PREVIOUS_PCM_VOL_SP+VSXA_START)
10713  0000000                   		.ENDIF
10714  0000000                   		ROR A
10715  0000000                   		BRA STORE_LOW_PCM_TO_TBUF#
10716  0000000                   	.ENDIF
10717  0000000                   
10718  0000000                   VSXA_STORE_PCM#:	
10719  0000000                   	.IF (WITH_VOL_ADJ .EQ. 0)
10720  0000000                   		LDA <(CH_PREVIOUS_PCM_SP+1+VSXA_START)
10721  0000000                   	.ELSE
10722  0000000                   		LDA <(CH_PREVIOUS_PCM_VOL_SP+1+VSXA_START)
10723  0000000                   	.ENDIF
10724  0000000                   		STA !TBUF_HI
10725  0000000                   
10726  0000000                   	.IF (WITH_VOL_ADJ .EQ. 0)
10727  0000000                   		LDA <(CH_PREVIOUS_PCM_SP+VSXA_START)
10728  0000000                   	.ELSE
10729  0000000                   		LDA <(CH_PREVIOUS_PCM_VOL_SP+VSXA_START)
10730  0000000                   	.ENDIF
10731  0000000                   
10732  0000000                   STORE_LOW_PCM_TO_TBUF#:
10733  0000000                   	.IF (WITH_SP0XL_RESOLUTION .EQ. 2)
10734  0000000                   		AND #FCH
10735  0000000                   	.ENDIF
10736  0000000                   	.IF (WITH_SP0XL_RESOLUTION .EQ. 3)
10737  0000000                   		AND #F0H
10738  0000000                   	.ENDIF
10739  0000000                   	STA !TBUF_LOW
10740  0000000                   ENDM
10741  0000000                   
10742  0000000                   ;------------------------------------------------------------------
10743  0000000                   ;JMP_TMG_ISR_ACTION: when TMG interrupt to do ISR function
10744  0000000                   ;1. Check VS0A if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10745  0000000                   ;2. Check VS0B if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10746  0000000                   ;------------------------------------------------------------------
10747  0000000                   JMP_CH1_ISR_ACTION MACRO
10748  0000000                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
10749  0000000                   	.ELSE
10750  0000000                   	.IF (WITH_VS0A .EQ. 0H)
10751  0000000                   		JMP QUIT_LIB_ISR
10752  0000000                   	.ENDIF
10753  0000000                   VS0A_NEXT_ACTION:
10754  0000000                   	LDA <(CH_STATUS_SP+VS0A_START)
10755  0000000                   	BIT #SP_BZ
10756  0000000                   	BEQ LIB_VS0B_ISR	
10757  0000000                   
10758  0000000                   	BIT #SP_ADSR
10759  0000000                   	BNE VS0A_NEXT_ACTION_CONST
10760  0000000                   
10761  0000000                   	.IF (WITH_ISR_VS0A .EQ. 1H) 
10762  0000000                   		STORE_PCM_TO_TBUF CHANNEL_VS0A,VS0A_START,SP0CLT,SP0CT	





10763  0000000                   	.ENDIF
10764  0000000                   
10765  0000000                   	LDY #CHANNEL_VS0A
10766  0000000                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
10767  0000000                   		LDA <(CH_STATUS_SP+VS0A_START)
10768  0000000                   		BIT #SP_PAUSE
10769  0000000                   		BEQ 3
10770  0000000                   		EXTERN SP_PAUSE_RAMP_PROC
10771  0000000                   		JMP SP_PAUSE_RAMP_PROC
10772  0000000                   		BIT #SP_RESUME
10773  0000000                   		BEQ VS0A_NEXT_ACTION_CONST
10774  0000000                   		EXTERN SP_RESUME_RAMP_PROC
10775  0000000                   		JMP SP_RESUME_RAMP_PROC
10776  0000000                   	.ENDIF
10777  0000000                   
10778  0000000                   VS0A_NEXT_ACTION_CONST:
10779  0000000                   	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS0A_START)
10780  0000000                   
10781  0000000                   LIB_VS0B_ISR:
10782  0000000                   QUIT_LIB_VS0_ISR:
10783  0000000                   	JMP QUIT_LIB_ISR
10784  0000000                   	.ENDIF
10785  0000000                   ENDM
10786  0000000                   
10787  0000000                   ;------------------------------------------------------------------
10788  0000000                   ;JMP_TM0_ISR_ACTION: when TM0 interrupt to do ISR function
10789  0000000                   ;1. Check VS1A if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10790  0000000                   ;2. Check VS1B if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10791  0000000                   ;------------------------------------------------------------------
10792  0000000                   JMP_CH2_ISR_ACTION MACRO
10793  0000000                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
10794  0000000                   	.ELSE
10795  0000000                   	.IF (WITH_VS1A .EQ. 0H)
10796  0000000                   		JMP QUIT_LIB_ISR
10797  0000000                   	.ENDIF
10798  0000000                   VS1A_NEXT_ACTION:
10799  0000000                   	LDA <(CH_STATUS_SP+VS1A_START)
10800  0000000                   	BIT #SP_BZ
10801  0000000                   	BEQ LIB_VS1B_ISR
10802  0000000                   
10803  0000000                   	BIT #SP_ADSR
10804  0000000                   	BNE VS1A_NEXT_ACTION_CONST
10805  0000000                   
10806  0000000                   	.IF (WITH_ISR_VS1A .EQ. 1H) 
10807  0000000                   		STORE_PCM_TO_TBUF CHANNEL_VS1A,VS1A_START,SP0ALT,SP0AT
10808  0000000                   	.ENDIF
10809  0000000                   
10810  0000000                   	LDY #CHANNEL_VS1A
10811  0000000                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
10812  0000000                   		LDA <(CH_STATUS_SP+VS1A_START)
10813  0000000                   		BIT #SP_PAUSE
10814  0000000                   		BEQ 3
10815  0000000                   		EXTERN SP_PAUSE_RAMP_PROC
10816  0000000                   		JMP SP_PAUSE_RAMP_PROC
10817  0000000                   		BIT #SP_RESUME
10818  0000000                   		BEQ VS1A_NEXT_ACTION_CONST
10819  0000000                   		EXTERN SP_RESUME_RAMP_PROC





10820  0000000                   		JMP SP_RESUME_RAMP_PROC
10821  0000000                   	.ENDIF
10822  0000000                   
10823  0000000                   VS1A_NEXT_ACTION_CONST:
10824  0000000                   	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS1A_START)
10825  0000000                   
10826  0000000                   LIB_VS1B_ISR:
10827  0000000                   QUIT_LIB_VS1_ISR:
10828  0000000                   	JMP QUIT_LIB_ISR
10829  0000000                   	.ENDIF
10830  0000000                   ENDM
10831  0000000                   
10832  0000000                   ;------------------------------------------------------------------
10833  0000000                   ;JMP_TM1_ISR_ACTION: when TM1 interrupt to do ISR function
10834  0000000                   ;1. Check VS2A if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10835  0000000                   ;2. Check VS2B if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10836  0000000                   ;------------------------------------------------------------------
10837  0000000                   JMP_CH3_ISR_ACTION MACRO
10838  0000000                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
10839  0000000                   	.ELSE
10840  0000000                   	.IF (WITH_VS2A .EQ. 0H)
10841  0000000                   		JMP QUIT_LIB_ISR
10842  0000000                   	.ENDIF
10843  0000000                   VS2A_NEXT_ACTION:
10844  0000000                   	LDA <(CH_STATUS_SP+VS2A_START)
10845  0000000                   	BIT #SP_BZ
10846  0000000                   	BEQ LIB_VS2B_ISR
10847  0000000                   
10848  0000000                   	BIT #SP_ADSR
10849  0000000                   	BNE VS2A_NEXT_ACTION_CONST
10850  0000000                   
10851  0000000                   	.IF (WITH_ISR_VS2A .EQ. 1H) 
10852  0000000                   		STORE_PCM_TO_TBUF CHANNEL_VS2A,VS2A_START,SP0BLT,SP0BT
10853  0000000                   	.ENDIF
10854  0000000                   
10855  0000000                   	LDY #CHANNEL_VS2A
10856  0000000                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
10857  0000000                   		LDA <(CH_STATUS_SP+VS2A_START)
10858  0000000                   		BIT #SP_PAUSE
10859  0000000                   		BEQ 3
10860  0000000                   		EXTERN SP_PAUSE_RAMP_PROC
10861  0000000                   		JMP SP_PAUSE_RAMP_PROC
10862  0000000                   		BIT #SP_RESUME
10863  0000000                   		BEQ VS2A_NEXT_ACTION_CONST
10864  0000000                   		EXTERN SP_RESUME_RAMP_PROC
10865  0000000                   		JMP SP_RESUME_RAMP_PROC
10866  0000000                   	.ENDIF
10867  0000000                   
10868  0000000                   VS2A_NEXT_ACTION_CONST:
10869  0000000                   	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS2A_START)
10870  0000000                   
10871  0000000                   LIB_VS2B_ISR:
10872  0000000                   QUIT_LIB_VS2_ISR:
10873  0000000                   	JMP QUIT_LIB_ISR
10874  0000000                   	.ENDIF
10875  0000000                   ENDM
10876  0000000                   ;=====================================================================================





10877  0000000                   
10878  0000000                   
10879  0000000                   
10880  0000000                   
10881  0000000                   	GLOBAL 		COMMAND_ADDR_TABLE
10882  0000000                   	GLOBAL		NOTE_ON_CH1_NOTIFY
10883  0000000                   	GLOBAL		NOTE_OFF_CH1_NOTIFY
10884  0000000                   
10885  0000000                   ;==========================================================================
10886  0000000                   ;	DECLARE VARIABLES INSIDE THIS SECTION
10887  0000000                   ;	EXAMPLE => VAR1	DS	3
10888  0000000                   ;	           VAR2	DS	1
10889  0000000                   ;==========================================================================
10890  0000000                   	USER_RAM: SECTION
10891  0000000                   	ORG	0000H
10892  0000000                   
10893  0000000                   .IF	(WITH_RAM_OVER_STACK .EQ. 1)
10894  0000000                   	USER_RAM_AFTER_RESERVED: SECTION
10895  0000000                   
10896  0000000                   	ENDS
10897  0000000                   .ENDIF
10898  0000000                   
10899  0000000                   	ENDS
10900  0000000                   
10901  0000000                   ;==========================================================================
10902  0000000                   ;	WRITE COMMAND SUBROUTINE INSIDE THIS SECTION
10903  0000000                   ;	EACH SUBOUTINE SHOULD BE ENDED BY 'RTS'
10904  0000000                   ;==========================================================================
10905  0000000                   	CODE: SECTION
10906  0000000                   ;==========================================================================
10907  0000000                   ;	MIDI CHANNEL1 NOTE ON/OFF NOTIFY
10908  0000000                   ;==========================================================================
10909  0000000                   NOTE_ON_CH1_NOTIFY:
10910  0000000                   NOTE_OFF_CH1_NOTIFY:
10911  0000000  60           	RTS	
10912  0000001                   
10913  0000001                   CMD00:
10914  0000001                   CMD01:
10915  0000001                   CMD02:
10916  0000001                   CMD03:
10917  0000001                   CMD04:
10918  0000001                   CMD05:
10919  0000001                   CMD06:
10920  0000001                   CMD07:
10921  0000001                   CMD08:
10922  0000001                   CMD09:
10923  0000001                   CMD10:
10924  0000001                   CMD11:
10925  0000001                   CMD12:
10926  0000001  60           	RTS
10927  0000002                   
10928  0000002                   
10929  0000002                   COMMAND_ADDR_TABLE:
10930  0000002  0100            	DW	CMD00
10931  0000004  0100            	DW	CMD01
10932  0000006  0100            	DW	CMD02
10933  0000008  0100            	DW	CMD03





10934  000000A  0100            	DW	CMD04
10935  000000C  0100            	DW	CMD05
10936  000000E  0100            	DW	CMD06
10937  0000010  0100            	DW	CMD07
10938  0000012  0100            	DW	CMD08
10939  0000014  0100            	DW	CMD09
10940  0000016  0100            	DW	CMD10
10941  0000018  0100            	DW	CMD11
10942  000001A  0100            	DW	CMD12
10943  000001C                   
10944  000001C                   	ENDS
10945  000001C                   ;**The following is audio external**
10946  000001C                   ;**The following is sentence label**
10947  000001C                   ;**The following is INIT_DECODE_SPEECH label**
10948  000001C                   	EXT_PROGRAM: SECTION
10949  0000000                   	ENDS
10950  000001C                   
		Line(s) Assembled : 10950
		Error(s): 0
		Warn(s) : 0
		Begin Assembling Time : Tue Oct 23 10:35:26 2018
		End   Assembling Time : Tue Oct 23 10:35:26 2018

