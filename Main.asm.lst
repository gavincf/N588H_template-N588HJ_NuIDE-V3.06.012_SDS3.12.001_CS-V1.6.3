Tue Oct 23 10:35:26 2018







	Macro Assembler  -  Version 1.00.0
		-----------------------------------------------

		Input  Filename : D:\ASM_SAVE_backup\Nuvoton8bit\N588H_template\N588H340_NuIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\Main.asm.app
		Output Filename : D:\ASM_SAVE_backup\Nuvoton8bit\N588H_template\N588H340_NuIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\Code_Release\Main.oc


    1  0000000                   	CHIP	65C02
    2  0000000                   
    3  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\PGM_HEAD_N588H.INI.APP"
    4  0000000                   	SYMBOLS
    5  0000000                   	LINKLIST
    6  0000000                   	DEBUG  		ASM
    7  0000000                   	LINEAR	ON
    8  0000000                   	LONGA	OFF
    9  0000000                   	LONGI	OFF
   10  0000000                   
   11  0000000                   ;FOR *.LIC
   12  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\N588H_SYS_DEF_EQU.INI.APP"
   13  0000000                   DIRECT_PAGE		EQU	00H
   14  0000000                   
   15  0000000                   CHECKSUM_ADDR		EQU 	00H
   16  0000000                   CHECKSUM_ADDR1		EQU 	01H
   17  0000000                   CHECK_RESULT		EQU	02H
   18  0000000                   
   19  0000000                   ROM_START		EQU	0980H
   20  0000000                   ROM_SEC1_END		EQU	099FH
   21  0000000                   CHECKSUM_33TH		EQU	09A0H
   22  0000000                   CHECKSUM_34TH		EQU	09A1H
   23  0000000                   ROM_SEC2_START		EQU	09C0H
   24  0000000                   
   25  0000000                   RAM_BEGIN		EQU	00H
   26  0000000                   
   27  0000000                   .IF	 (PARTNO='N588H000')
   28  0000000                   RAM_END		EQU 7FFH
   29  0000000                   STACK_END   	EQU FFH
   30  0000000                   .ENDIF
   31  0000000                   
   32  0000000                   .IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
   33  0000000                   RAM_END		EQU 7FH
   34  0000000                   STACK_END   	EQU 7FH
   35  0000000                   .ENDIF
   36  0000000                   
   37  0000000                   .IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
   38  0000000                   RAM_END		EQU BFH
   39  0000000                   STACK_END   	EQU BFH
   40  0000000                   .ENDIF
   41  0000000                   
   42  0000000                   ; [Add] N588J chip series
   43  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   44  0000000                   .IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170')
   45  0000000                   RAM_END		EQU 7FH
   46  0000000                   STACK_END   	EQU 7FH





   47  0000000                   .ENDIF
   48  0000000                   
   49  0000000                   .IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
   50  0000000                   RAM_END		EQU BFH
   51  0000000                   STACK_END   	EQU BFH
   52  0000000                   .ENDIF
   53  0000000                   
   54  0000000                   
   55  0000000                   ;------------------------------------------------------
   56  0000000                   .IF	 (PARTNO='N588H000')
   57  0000000                   BODY_END_ADDR 	EQU	80FFH
   58  0000000                   BODY_END_BANK	EQU	20H
   59  0000000                   .ENDIF
   60  0000000                   
   61  0000000                   ; [Add] N588J010 (40K)
   62  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   63  0000000                   .IF	 (PARTNO='N588J010')
   64  0000000                   BODY_END_ADDR 	EQU	A8FFH
   65  0000000                   BODY_END_BANK	EQU	01H
   66  0000000                   .ENDIF
   67  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   68  0000000                   
   69  0000000                   ; [Add] N588J040 (126K)
   70  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   71  0000000                   .IF	 (PARTNO='N588H040').OR.(PARTNO='N588J040')
   72  0000000                   BODY_END_ADDR 	EQU	80FFH
   73  0000000                   BODY_END_BANK	EQU	04H
   74  0000000                   .ENDIF
   75  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   76  0000000                   
   77  0000000                   ; [Add] N588J060 (*206K)
   78  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   79  0000000                   .IF	 (PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588J060')
   80  0000000                   BODY_END_ADDR 	EQU	C0FFH
   81  0000000                   BODY_END_BANK	EQU	06H
   82  0000000                   .ENDIF
   83  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   84  0000000                   
   85  0000000                   ; [Add] N588J080 (254K)
   86  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   87  0000000                   .IF	 (PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588J080').OR.(PARTNO='N588HP080')
   88  0000000                   BODY_END_ADDR 	EQU	80FFH
   89  0000000                   BODY_END_BANK	EQU	08H
   90  0000000                   .ENDIF
   91  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   92  0000000                   
   93  0000000                   ; [Add] N588J120 (*414K)
   94  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   95  0000000                   .IF	 (PARTNO='N588H120').OR.(PARTNO='N588J120')
   96  0000000                   BODY_END_ADDR 	EQU	80FFH
   97  0000000                   BODY_END_BANK	EQU	0DH
   98  0000000                   .ENDIF
   99  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  100  0000000                   
  101  0000000                   ; [Add] N588J170 (510K)
  102  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  103  0000000                   .IF	 (PARTNO='N588H170').OR.(PARTNO='N588J170').OR.(PARTNO='N588HP170')





  104  0000000                   BODY_END_ADDR 	EQU	80FFH
  105  0000000                   BODY_END_BANK	EQU	10H
  106  0000000                   .ENDIF
  107  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  108  0000000                   
  109  0000000                   ; [Add] N588H/J200 (*704K)
  110  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  111  0000000                   .IF	 (PARTNO='N588H200').OR.(PARTNO='N588H201').OR.(PARTNO='N588J200').OR.(PARTNO='N588J201')
  112  0000000                   BODY_END_ADDR 	EQU	88FFH
  113  0000000                   BODY_END_BANK	EQU	16H
  114  0000000                   .ENDIF
  115  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  116  0000000                   
  117  0000000                   ; [Add] N588J250 (*830K)
  118  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  119  0000000                   .IF	 (PARTNO='N588H250').OR.(PARTNO='N588H251').OR.(PARTNO='N588J250').OR.(PARTNO='N588J251')
  120  0000000                   BODY_END_ADDR 	EQU	80FFH
  121  0000000                   BODY_END_BANK	EQU	1AH
  122  0000000                   .ENDIF
  123  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  124  0000000                   
  125  0000000                   ; [Add] N588J340 (*1022K)
  126  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  127  0000000                   .IF	 (PARTNO='N588H340').OR.(PARTNO='N588H341').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J340').OR.(PARTNO='N588J341')
  128  0000000                   BODY_END_ADDR 	EQU	FFFFH
  129  0000000                   BODY_END_BANK	EQU	1FH
  130  0000000                   .ENDIF
  131  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  132  0000000                   
  133  0000000                   ; [Add] N588H480 (*1534K)
  134  0000000                   .IF	 (PARTNO='N588H480').OR.(PARTNO='N588J480')
  135  0000000                   BODY_END_ADDR 	EQU	80FFH
  136  0000000                   BODY_END_BANK	EQU	30H
  137  0000000                   .ENDIF
  138  0000000                   
  139  0000000                   ; [Add] N588H650 (*2044K)
  140  0000000                   .IF	 (PARTNO='N588H650').OR.(PARTNO='N588J650')
  141  0000000                   BODY_END_ADDR 	EQU	F8FFH
  142  0000000                   BODY_END_BANK	EQU	3FH
  143  0000000                   .ENDIF
  144  0000000                   ;------------------------------------------------------
  145  0000000                   ;------------------------------------------------------
  146  0000000                   INT0_PORT	EQU 		01H
  147  0000000                   INT0_TM0	EQU 		02H
  148  0000000                   INT0_TM1	EQU 		04H
  149  0000000                   INT0_TMG0	EQU 		08H
  150  0000000                   INT0_FXF13	EQU 		10H
  151  0000000                   INT0_FXF10	EQU 		20H
  152  0000000                   INT0_TMG1	EQU 		40H
  153  0000000                   INT0_FXF15	EQU 		80H
  154  0000000                   
  155  0000000                   INT1_RTC	EQU 		01H
  156  0000000                   INT1_SPIO_OUT 	EQU 		02H
  157  0000000                   INT1_SPIO_IN	EQU 		04H
  158  0000000                   INT1_SIM	EQU 		08H
  159  0000000                   
  160  0000000                   CTL_CPU_STOP	EQU 		01H





  161  0000000                   CTL_CPU_WDT	EQU 		02H
  162  0000000                   CTL_CPU_FOSC	EQU 		04H
  163  0000000                   CTL_LVD		EQU 		08H
  164  0000000                   CTL_LVD_OCCUR	EQU 		80H
  165  0000000                   
  166  0000000                   RESET_LVR	EQU		01H
  167  0000000                   RESET_PORT	EQU		02H
  168  0000000                   RESET_WDT	EQU		04H
  169  0000000                   RESET_POR	EQU		08H
  170  0000000                   RESET_RPIN	EQU		10H
  171  0000000                   RESET_6502	EQU		20H
  172  0000000                   RESET_ABN	EQU		40H
  173  0000000                   
  174  0000000                   RDPC_WSC	EQU 		10H
  175  0000000                   SIC_EN		EQU 		01H
  176  0000000                   SIC_SPI		EQU 		04H
  177  0000000                   
  178  0000000                   SPEN_EPWM	EQU 		02H
  179  0000000                   SPEN_DAC	EQU 		01H
  180  0000000                   SPEN_NS		EQU 		08H
  181  0000000                   
  182  0000000                   RTC_EN 		EQU 		01H
  183  0000000                   RTC_4S 		EQU 		00H
  184  0000000                   RTC_2HZ 	EQU 		02H
  185  0000000                   RTC_32HZ	EQU 		04H
  186  0000000                   RTC_8HZ 	EQU 		06H
  187  0000000                   
  188  0000000                   RGT_EN		EQU 		01H
  189  0000000                   
  190  0000000                   BP00_PWM	EQU		01H
  191  0000000                   BP01_PWM	EQU		02H
  192  0000000                   BP02_PWM	EQU		04H
  193  0000000                   BP03_PWM	EQU		08H
  194  0000000                   BP04_PWM	EQU		10H
  195  0000000                   BP05_PWM	EQU		20H
  196  0000000                   
  197  0000000                   BP00_MOTOR	EQU		10H
  198  0000000                   BP01_MOTOR	EQU		10H
  199  0000000                   BP02_MOTOR	EQU		20H
  200  0000000                   BP03_MOTOR	EQU		20H
  201  0000000                   BP04_MOTOR	EQU		40H
  202  0000000                   BP05_MOTOR	EQU		40H
  203  0000000                   ;------------------------------------------------------
  204  0000000                   ;------------------------------------------------------
  205  0000000                   BP0		EQU		801H
  206  0000000                   BP0D		EQU		80AH
  207  0000000                   BP0C		EQU		815H
  208  0000000                   
  209  0000000                   BP1		EQU		802H
  210  0000000                   BP1D		EQU		80BH
  211  0000000                   BP1EN	 	EQU 		852H
  212  0000000                   
  213  0000000                   .IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
  214  0000000                   BP2		EQU		803H
  215  0000000                   BP2D		EQU		80CH
  216  0000000                   BP2C		EQU		822H
  217  0000000                   .ENDIF





  218  0000000                   
  219  0000000                   IEF0		EQU		81EH
  220  0000000                   EVF0		EQU		820H
  221  0000000                   EFC0		EQU		816H
  222  0000000                   
  223  0000000                   BANK		EQU		818H
  224  0000000                   RESET_F	   	EQU     	80EH
  225  0000000                   CTL_CPU	   	EQU     	80FH
  226  0000000                   
  227  0000000                   SPEN		EQU		833H
  228  0000000                   .IF(WITH_ALL_MIXER_SFR .EQ. 1)
  229  0000000                   SP0A		EQU		838H
  230  0000000                   SP0AL		EQU		834H
  231  0000000                   .IF	(CHIPSERIES = 'N588H')
  232  0000000                   SP0B		EQU		839H
  233  0000000                   SP0BL		EQU		835H
  234  0000000                   SP0C		EQU		83AH
  235  0000000                   SP0CL		EQU		836H
  236  0000000                   .ENDIF
  237  0000000                   .ENDIF
  238  0000000                   SP0ALT		EQU		83CH
  239  0000000                   SP0AT		EQU		83EH
  240  0000000                   .IF	(CHIPSERIES = 'N588H')
  241  0000000                   SP0BLT		EQU		83DH
  242  0000000                   SP0BT		EQU		83FH
  243  0000000                   SP0CLT		EQU		840H
  244  0000000                   SP0CT		EQU		841H
  245  0000000                   .ENDIF
  246  0000000                   
  247  0000000                   TMG0C		EQU		828H
  248  0000000                   TMG0V		EQU		829H
  249  0000000                   TMG0_O		EQU		82AH
  250  0000000                   TM0C		EQU		82BH
  251  0000000                   TM0V		EQU		82FH
  252  0000000                   TM1C		EQU		82CH
  253  0000000                   TM1V		EQU		830H
  254  0000000                   
  255  0000000                   CMP_C		EQU 		849H
  256  0000000                   PVL		EQU 		84AH
  257  0000000                   
  258  0000000                   PWMC 		EQU 		858H
  259  0000000                   PWV0 		EQU 		859H
  260  0000000                   PWV2 		EQU 		85AH
  261  0000000                   PWV4 		EQU 		85BH
  262  0000000                   
  263  0000000                   	.IF	(PARTNO='N588H000')
  264  0000000                   IP0		EQU		800H
  265  0000000                   IP0M     	EQU		805H
  266  0000000                   IP0EN 		EQU 		850H
  267  0000000                   OP1		EQU		809H
  268  0000000                   
  269  0000000                   RAMP		EQU 		842H
  270  0000000                   
  271  0000000                   SIC		EQU		81CH
  272  0000000                   RDPC		EQU  		81DH	
  273  0000000                   BANK1		EQU		832H
  274  0000000                   EXDAX0 		EQU 		868H





  275  0000000                   EXDAX1 		EQU 		869H
  276  0000000                   EXDAX2 		EQU 		86AH
  277  0000000                   EXDAX3 		EQU 		86BH
  278  0000000                   EXDAY0 		EQU 		86CH
  279  0000000                   EXDAY1 		EQU 		86DH
  280  0000000                   EXDAY2 		EQU 		86EH
  281  0000000                   EXDAY3 		EQU 		86FH	
  282  0000000                   
  283  0000000                   SPIC 		EQU 		85EH
  284  0000000                   SPIB 		EQU 		85FH
  285  0000000                   SPIB_NFT	EQU 		860H
  286  0000000                   
  287  0000000                   TMG1C		EQU 		823H
  288  0000000                   TMG1V		EQU		824H
  289  0000000                   TMG1_O		EQU		825H
  290  0000000                   
  291  0000000                   IEF1		EQU		81FH
  292  0000000                   EVF1		EQU		821H
  293  0000000                   EFC1		EQU		817H
  294  0000000                   
  295  0000000                   VD_C		EQU 		848H
  296  0000000                   RGT 		EQU 		84EH
  297  0000000                   RTCC 		EQU 		863H
  298  0000000                   
  299  0000000                   MPUC		EQU 		84FH
  300  0000000                   MPU10		EQU		8ECH
  301  0000000                   MPU11		EQU		8EDH
  302  0000000                   MPU00		EQU		8EEH
  303  0000000                   MPU01		EQU		8EFH
  304  0000000                   	.ENDIF
  305  0000000                   
  306  0000000                   CFG0 		EQU 		8F0H
  307  0000000                   CFG1 		EQU 		8F1H
  308  0000000                   CFG2 		EQU 		8F2H
  309  0000000                   CFG3 		EQU 		8F3H
  310  0000000                   CFG4 		EQU 		8F4H
  311  0000000                   CFG5 		EQU 		8F5H
  312  0000000                   CFG6 		EQU 		8F6H
  313  0000000                   CFG7 		EQU 		8F7H
  314  0000000                   CFG8 		EQU 		8F8H
  315  0000000                   CFG9 		EQU 		8F9H
  316  0000000                   CFGA 		EQU 		8FAH
  317  0000000                   CFGB 		EQU 		8FBH
  318  0000000                   CFGC 		EQU 		8FCH
  319  0000000                   CFGD 		EQU 		8FDH
  320  0000000                   CFGE 		EQU 		8FEH
  321  0000000                   CFGF 		EQU 		8FFH
  322  0000000                   
  323  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\N55P242_DEFINE.INI.APP"
  324  0000000                   ;----IO REGUSTER----------
  325  0000000                   BPA0			EQU	00H
  326  0000000                   BPB0			EQU	01H
  327  0000000                   BPC0			EQU	02H
  328  0000000                   BPA1			EQU	00H
  329  0000000                   BPB1			EQU	01H
  330  0000000                   BPC1			EQU	02H
  331  0000000                   





  332  0000000                   ;----IO REGUSTER----------
  333  0000000                   ; BUFFER  Data of GPA/B/C
  334  0000000                   ;-------------------------
  335  0000000                   P242BPA_B		EQU	00H
  336  0000000                   P242BPB_B		EQU	01H
  337  0000000                   P242BPC_B		EQU	02H
  338  0000000                   
  339  0000000                   ;-------------------------
  340  0000000                   ; DIRECTION  Data of GPA/B/C
  341  0000000                   ;-------------------------
  342  0000000                   P242BPA_D		EQU	04H
  343  0000000                   P242BPB_D		EQU	05H
  344  0000000                   P242BPC_D		EQU	06H
  345  0000000                   
  346  0000000                   ;-------------------------
  347  0000000                   ; ATTRIBUTE   Data of GPA/B/C
  348  0000000                   ;-------------------------
  349  0000000                   P242BPA_A		EQU	08H
  350  0000000                   P242BPB_A		EQU	09H
  351  0000000                   P242BPC_A		EQU	0AH
  352  0000000                   
  353  0000000                   ;-------------------------
  354  0000000                   ; PIN data   Data of GPA/B/C
  355  0000000                   ;-------------------------
  356  0000000                   P242BPA_P		EQU	0CH
  357  0000000                   P242BPB_P		EQU	0DH
  358  0000000                   P242BPC_P		EQU	0EH
  359  0000000                   
  360  0000000                   
  361  0000000                   
  362  0000000                   ;-----------------WAKE UP--------------------------
  363  0000000                   ;WAKEN[7] ,KCAEN[6], KCBEN[5], KCCEN[4] ; R/W 
  364  0000000                   ;PAC[3], PBC[2], PCC[1], WKFLG[0]  ; Read Only
  365  0000000                   ;--------------------------------------------------
  366  0000000                   ;WAKEN[7]: Wakeup enable bit.
  367  0000000                   ;KCA/B/C_EN :Wakeup enable bit of GPA/B/C
  368  0000000                   ;PAC/PBC/PCC : Change bit GPA/B/C :1: change; 0: no change.
  369  0000000                   ;WKFLG :Only when PAC, PBC and PCC bits are all ¡§0¡¨s is WKFLG bit set to ¡§0¡¨
  370  0000000                   ;--------------------------------------------------
  371  0000000                   P242WKCTL		EQU	0FH
  372  0000000                   
  373  0000000                   ;----RESET------------------
  374  0000000                   P242RESET		EQU	4FH    ; Write Only
  375  0000000                   
  376  0000000                   ;----Device Select----------
  377  0000000                   P242DVSL0		EQU	4CH    ; Write Only
  378  0000000                   P242DVSL1		EQU	4DH    ; Write Only
  379  0000000                   
  380  0000000                   ;----Test Mode--------------
  381  0000000                   ;TEST[7] : 
  382  0000000                   ;---------------------------
  383  0000000                   P242TEST		EQU	4EH    ; R/W
  384  0000000                   
  385  0000000                   
  386  0000000                   
  387  0000000                   ;---AND REGISTER----------
  388  0000000                   ;----For Buffer ----------





  389  0000000                   P242AND_BPA_B		EQU	10H
  390  0000000                   P242AND_BPB_B		EQU	11H
  391  0000000                   P242AND_BPC_B		EQU	12H
  392  0000000                   
  393  0000000                   ;--- For Direction --------
  394  0000000                   P242AND_BPA_D		EQU	14H
  395  0000000                   P242AND_BPB_D		EQU	15H
  396  0000000                   P242AND_BPC_D		EQU	16H
  397  0000000                   
  398  0000000                   ;--- For Attribute  -------
  399  0000000                   P242AND_BPA_A		EQU	18H
  400  0000000                   P242AND_BPB_A		EQU	19H
  401  0000000                   P242AND_BPC_A		EQU	1AH
  402  0000000                   
  403  0000000                   ;---OR REGISTER----------
  404  0000000                   ;----For Buffer ----------
  405  0000000                   P242OR_BPA_B		EQU	20H
  406  0000000                   P242OR_BPB_B		EQU	21H
  407  0000000                   P242OR_BPC_B		EQU	22H
  408  0000000                   
  409  0000000                   ;--- For Direction --------
  410  0000000                   P242OR_BPA_D		EQU	24H
  411  0000000                   P242OR_BPB_D		EQU	25H
  412  0000000                   P242OR_BPC_D		EQU	26H
  413  0000000                   
  414  0000000                   ;--- For Attribute  -------
  415  0000000                   P242OR_BPA_A		EQU	28H
  416  0000000                   P242OR_BPB_A		EQU	29H
  417  0000000                   P242OR_BPC_A		EQU	2AH
  418  0000000                   
  419  0000000                   ;---XOR REGISTER----------
  420  0000000                   ;--- For Attribute  -------
  421  0000000                   P242XOR_BPA_B		EQU	30H
  422  0000000                   P242XOR_BPB_B		EQU	31H
  423  0000000                   P242XOR_BPC_B		EQU	32H
  424  0000000                   
  425  0000000                   ;--- For Direction --------
  426  0000000                   P242XOR_BPA_D		EQU	34H
  427  0000000                   P242XOR_BPB_D		EQU	35H
  428  0000000                   P242XOR_BPC_D		EQU	36H
  429  0000000                   
  430  0000000                   ;--- For Attribute  -------
  431  0000000                   P242XOR_BPA_A		EQU	38H
  432  0000000                   P242XOR_BPB_A		EQU	39H
  433  0000000                   P242XOR_BPC_A		EQU	3AH
  434  0000000                   
  435  0000000                   ;---------------------------
  436  0000000                   ; Constant/Normal Current/
  437  0000000                   ; Current Control of GPA/B/C
  438  0000000                   ;---------------------------
  439  0000000                   P242CNST_BPA		EQU	40H
  440  0000000                   P242CNST_BPB		EQU	41H
  441  0000000                   P242CNST_BPC		EQU	42H
  442  0000000                   
  443  0000000                   ;---PWM REGISTER----------
  444  0000000                   ;   For BPA0~BPA7 
  445  0000000                   ;-------------------------





  446  0000000                   ; Writ Only
  447  0000000                   ;-------------------------
  448  0000000                   P242PWM_BPA0		EQU	50H
  449  0000000                   P242PWM_BPA1		EQU	51H
  450  0000000                   P242PWM_BPA2		EQU	52H
  451  0000000                   P242PWM_BPA3		EQU	53H
  452  0000000                   P242PWM_BPA4		EQU	54H
  453  0000000                   P242PWM_BPA5		EQU	55H
  454  0000000                   P242PWM_BPA6		EQU	56H
  455  0000000                   P242PWM_BPA7		EQU	57H
  456  0000000                   
  457  0000000                   
  458  0000000                   ;---PWM REGISTER----------
  459  0000000                   ;   For BPB0~BPB7 
  460  0000000                   ;-------------------------
  461  0000000                   ; Writ Only
  462  0000000                   ;-------------------------
  463  0000000                   P242PWM_BPB0		EQU	58H
  464  0000000                   P242PWM_BPB1		EQU	59H
  465  0000000                   P242PWM_BPB2		EQU	5AH
  466  0000000                   P242PWM_BPB3		EQU	5BH
  467  0000000                   P242PWM_BPB4		EQU	5CH
  468  0000000                   P242PWM_BPB5		EQU	5DH
  469  0000000                   P242PWM_BPB6		EQU	5EH
  470  0000000                   P242PWM_BPB7		EQU	5FH
  471  0000000                   
  472  0000000                   ;---PWM REGISTER----------
  473  0000000                   ;   For BPC0~BPC7 
  474  0000000                   ;-------------------------
  475  0000000                   ; Writ Only
  476  0000000                   ;-------------------------
  477  0000000                   P242PWM_BPC0		EQU	60H
  478  0000000                   P242PWM_BPC1		EQU	61H
  479  0000000                   P242PWM_BPC2		EQU	62H
  480  0000000                   P242PWM_BPC3		EQU	63H
  481  0000000                   P242PWM_BPC4		EQU	64H
  482  0000000                   P242PWM_BPC5		EQU	65H
  483  0000000                   P242PWM_BPC6		EQU	66H
  484  0000000                   P242PWM_BPC7		EQU	67H
  485  0000000                   
  486  0000000                   ;---ENABLE PWM REGISTER----------
  487  0000000                   ;   For BPA/B/C0~7 
  488  0000000                   ;--------------------------------
  489  0000000                   P242PWMEN_BPA		EQU	78H
  490  0000000                   P242PWMEN_BPB		EQU	79H
  491  0000000                   P242PWMEN_BPC		EQU	7AH
  492  0000000                   
  493  0000000                   ;---PWM CLK REGISTER----------
  494  0000000                   ;   For BPA0~3, BPA4~7
  495  0000000                   ;   For BPB0~3, BPB4~7
  496  0000000                   ;   For BPB0~3, BPB4~7
  497  0000000                   ;--------------------------------
  498  0000000                   P242PWMCK_BPA		EQU	7DH   ; MSB 4bit for BPB, LSB 4bit for BPA
  499  0000000                   P242PWMCK_BPB		EQU	7DH   ; BPA/B same address 7DH
  500  0000000                   P242PWMCK_BPC		EQU	7EH   ; only LSB 4bits for BPC
  501  0000000                   
  502  0000000                   ;===========================================





  503  0000000                   ; Control Symbol Definition
  504  0000000                   ;===========================================
  505  0000000                   ;--------Wake up way-------
  506  0000000                   BY_MISO		EQU	00H
  507  0000000                   BY_PIN		EQU	01H
  508  0000000                   
  509  0000000                   ;--------external port-----
  510  0000000                   XBPA		EQU	0800H   ;.HIGH. For WakeUp bit
  511  0000000                   XBPB		EQU	0401H
  512  0000000                   XBPC		EQU	0202H
  513  0000000                   ;--------------------------
  514  0000000                   ;-------PWM pin------------
  515  0000000                   XPWM0		EQU	0100H
  516  0000000                   XPWM1		EQU	0201H
  517  0000000                   XPWM2		EQU	0402H
  518  0000000                   XPWM3		EQU	0803H
  519  0000000                   XPWM4		EQU	1004H
  520  0000000                   XPWM5		EQU	2005H
  521  0000000                   XPWM6		EQU	4006H
  522  0000000                   XPWM7		EQU	8007H
  523  0000000                   ;--------------------------
  524  0000000                   ;-------PIN pin------------
  525  0000000                   
  526  0000000                   XPIN_ALL	EQU 	00FFh
  527  0000000                   XPINALL		EQU 	00FFh
  528  0000000                   
  529  0000000                   XPIN0		EQU	0001H
  530  0000000                   XPIN1		EQU	0002H
  531  0000000                   XPIN2		EQU	0004H
  532  0000000                   XPIN3		EQU	0008H
  533  0000000                   XPIN4		EQU	0010H
  534  0000000                   XPIN5		EQU	0020H
  535  0000000                   XPIN6		EQU	0040H
  536  0000000                   XPIN7		EQU	0080H
  537  0000000                   ;-------PIN pin------------
  538  0000000                   
  539  0000000                   ;--------------------------
  540  0000000                   
  541  0000000                   ;-------PWM Clock Divider------------
  542  0000000                   ; 00: GPA0~GPA3 PWM clock is Fosc/1.
  543  0000000                   ; 01: GPA0~GPA3 PWM clock is Fosc/2.
  544  0000000                   ; 10: GPA0~GPA3 PWM clock is Fosc/4.
  545  0000000                   ; 11: GPA0~GPA3 PWM clock is Fosc/32
  546  0000000                   ;------------------------------------
  547  0000000                   XPWMA03_DIV1		EQU	00H
  548  0000000                   XPWMA03_DIV2		EQU	01H
  549  0000000                   XPWMA03_DIV4		EQU	02H
  550  0000000                   XPWMA03_DIV32		EQU	03H
  551  0000000                   XPWMA47_DIV1		EQU	00H<<2
  552  0000000                   XPWMA47_DIV2		EQU	01H<<2
  553  0000000                   XPWMA47_DIV4		EQU	02H<<2
  554  0000000                   XPWMA47_DIV32		EQU	03H<<2
  555  0000000                   
  556  0000000                   XPWMB03_DIV1		EQU	00H<<4
  557  0000000                   XPWMB03_DIV2		EQU	01H<<4
  558  0000000                   XPWMB03_DIV4		EQU	02H<<4
  559  0000000                   XPWMB03_DIV32		EQU	03H<<4





  560  0000000                   XPWMB47_DIV1		EQU	00H<<6
  561  0000000                   XPWMB47_DIV2		EQU	01H<<6
  562  0000000                   XPWMB47_DIV4		EQU	02H<<6
  563  0000000                   XPWMB47_DIV32		EQU	03H<<6
  564  0000000                   
  565  0000000                   XPWMC03_DIV1		EQU	00H
  566  0000000                   XPWMC03_DIV2		EQU	01H
  567  0000000                   XPWMC03_DIV4		EQU	02H
  568  0000000                   XPWMC03_DIV32		EQU	03H
  569  0000000                   XPWMC47_DIV1		EQU	00H<<2
  570  0000000                   XPWMC47_DIV2		EQU	01H<<2
  571  0000000                   XPWMC47_DIV4		EQU	02H<<2
  572  0000000                   XPWMC47_DIV32		EQU	03H<<2
  573  0000000                   
  574  0000000                   ;=====================================================
  575  0000000                   ; Other Symobol Definition
  576  0000000                   ;=====================================================
  577  0000000                   ;----------input mode ---------
  578  0000000                   ;float low - A=1,D=0,B=0
  579  0000000                   M_IP_FL		EQU	FF0000H
  580  0000000                   M_IP0_FL	EQU	010000H
  581  0000000                   M_IP1_FL	EQU	020000H
  582  0000000                   M_IP2_FL	EQU	040000H
  583  0000000                   M_IP3_FL	EQU	080000H
  584  0000000                   M_IP4_FL	EQU	100000H
  585  0000000                   M_IP5_FL	EQU	200000H
  586  0000000                   M_IP6_FL	EQU	400000H
  587  0000000                   M_IP7_FL	EQU	800000H
  588  0000000                   
  589  0000000                   ;float high - A=0,D=0,B=0(Default)
  590  0000000                   M_IP_FH		EQU	000000H
  591  0000000                   M_IP0_FH	EQU	000000H
  592  0000000                   M_IP1_FH	EQU	000000H
  593  0000000                   M_IP2_FH	EQU	000000H
  594  0000000                   M_IP3_FH	EQU	000000H
  595  0000000                   M_IP4_FH	EQU	000000H
  596  0000000                   M_IP5_FH	EQU	000000H
  597  0000000                   M_IP6_FH	EQU	000000H
  598  0000000                   M_IP7_FH	EQU	000000H
  599  0000000                   
  600  0000000                   ;pull low - A=1,D=0,B=1
  601  0000000                   M_IP_PL		EQU	FF00FFH
  602  0000000                   M_IP0_PL	EQU	010001H
  603  0000000                   M_IP1_PL	EQU	020002H
  604  0000000                   M_IP2_PL	EQU	040004H
  605  0000000                   M_IP3_PL	EQU	080008H
  606  0000000                   M_IP4_PL	EQU	100010H
  607  0000000                   M_IP5_PL	EQU	200020H
  608  0000000                   M_IP6_PL	EQU	400040H
  609  0000000                   M_IP7_PL	EQU	800080H
  610  0000000                   
  611  0000000                   ;pull high - A=0,D=0,B=1
  612  0000000                   M_IP_PH		EQU	0000FFH
  613  0000000                   M_IP0_PH	EQU	000001H
  614  0000000                   M_IP1_PH	EQU	000002H
  615  0000000                   M_IP2_PH	EQU	000004H
  616  0000000                   M_IP3_PH	EQU	000008H





  617  0000000                   M_IP4_PH	EQU	000010H
  618  0000000                   M_IP5_PH	EQU	000020H
  619  0000000                   M_IP6_PH	EQU	000040H
  620  0000000                   M_IP7_PH	EQU	000080H
  621  0000000                   
  622  0000000                   ;----------output mode ---------
  623  0000000                   ;CMOS high - A=0,D=1,B=1
  624  0000000                   M_OP_CM_H	EQU	00FFFFH
  625  0000000                   M_OP0_CM_H	EQU	000101H
  626  0000000                   M_OP1_CM_H	EQU	000202H
  627  0000000                   M_OP2_CM_H	EQU	000404H
  628  0000000                   M_OP3_CM_H	EQU	000808H
  629  0000000                   M_OP4_CM_H	EQU	001010H
  630  0000000                   M_OP5_CM_H	EQU	002020H
  631  0000000                   M_OP6_CM_H	EQU	004040H
  632  0000000                   M_OP7_CM_H	EQU	008080H
  633  0000000                   
  634  0000000                   ;CMOS low - A=0,D=1,B=0
  635  0000000                   M_OP_CM_L	EQU	00FF00H
  636  0000000                   M_OP0_CM_L	EQU	000100H
  637  0000000                   M_OP1_CM_L	EQU	000200H
  638  0000000                   M_OP2_CM_L	EQU	000400H
  639  0000000                   M_OP3_CM_L	EQU	000800H
  640  0000000                   M_OP4_CM_L	EQU	001000H
  641  0000000                   M_OP5_CM_L	EQU	002000H
  642  0000000                   M_OP6_CM_L	EQU	004000H
  643  0000000                   M_OP7_CM_L	EQU	008000H
  644  0000000                   
  645  0000000                   ;Inverted CMOS high - A=1,D=1,B=0
  646  0000000                   M_OP_ICM_H	EQU	FFFF00H
  647  0000000                   M_OP0_ICM_H	EQU	010100H
  648  0000000                   M_OP1_ICM_H	EQU	020200H
  649  0000000                   M_OP2_ICM_H	EQU	040400H
  650  0000000                   M_OP3_ICM_H	EQU	080800H
  651  0000000                   M_OP4_ICM_H	EQU	101000H
  652  0000000                   M_OP5_ICM_H	EQU	202000H
  653  0000000                   M_OP6_ICM_H	EQU	404000H
  654  0000000                   M_OP7_ICM_H	EQU	808000H
  655  0000000                   
  656  0000000                   ;Inverted CMOS low - A=1,D=1,B=1
  657  0000000                   M_OP_ICM_L	EQU	FFFFFFH
  658  0000000                   M_OP0_ICM_L	EQU	010101H
  659  0000000                   M_OP1_ICM_L	EQU	020202H
  660  0000000                   M_OP2_ICM_L	EQU	040404H
  661  0000000                   M_OP3_ICM_L	EQU	080808H
  662  0000000                   M_OP4_ICM_L	EQU	101010H
  663  0000000                   M_OP5_ICM_L	EQU	202020H
  664  0000000                   M_OP6_ICM_L	EQU	404040H
  665  0000000                   M_OP7_ICM_L	EQU	808080H
  666  0000000                   
  667  0000000                   ;------set output value ---------
  668  0000000                   ;set CMOS low: AND BUF
  669  0000000                   S_OPALL		EQU	FFH
  670  0000000                   S_OP0		EQU	01H
  671  0000000                   S_OP1		EQU	02H
  672  0000000                   S_OP2		EQU	04H
  673  0000000                   S_OP3		EQU	08H





  674  0000000                   S_OP4		EQU	10H
  675  0000000                   S_OP5		EQU	20H
  676  0000000                   S_OP6		EQU	40H
  677  0000000                   S_OP7		EQU	80H
  678  0000000                   ;========================================================
  679  0000000                   
  680  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\CONFIGURATION.INI.APP"
  681  0000000                   LOCAL_TEST						EQU 0
  682  0000000                   ;--------------------------------------------------------------------------
  683  0000000                   ; Configurations : Configurations config features for di-fferent libraries.
  684  0000000                   ;--------------------------------------------------------------------------
  685  0000000                   WITH_VOL_ADJ					EQU 0
  686  0000000                   ; There will be 2 libraries for each chip series such as W566B,W566C,....
  687  0000000                   ; One library with Volume Adjustment, another one without Volume Adjustment.
  688  0000000                   ; 0: WITHOUT VOL ADJ.
  689  0000000                   ; 1: WITH S/W VOL ADJ.
  690  0000000                   ; 2: WITH H/W VOL ADJ.
  691  0000000                   
  692  0000000                   WITH_MULTI_CHANNEL				EQU  0
  693  0000000                   ; There will be 2 libraries 
  694  0000000                   ; One library with 16HQ, another one without 16HQ
  695  0000000                   ; 0: WITHOUT 16HQ.
  696  0000000                   ; 1: WITH 16HQ.	
  697  0000000                   
  698  0000000                   WITH_VOL_REDUCE					EQU 0	
  699  0000000                   
  700  0000000                   WITH_16BIT_MODE					EQU 0
  701  0000000                   ; Some with 65C816 uC, some with 65C02.
  702  0000000                   WITH_32K_BANK					EQU 1
  703  0000000                   ;some with bank (ex:W567,W588), some without (ex:W566,W5691)
  704  0000000                   WITH_T_BUFFER					EQU 1
  705  0000000                   ;T-buffer is the buffer for latch decoded output PCM
  706  0000000                   WITH_READ_DATA_TYPE 			EQU 0
  707  0000000                   ; 0 : from ROM
  708  0000000                   ; 1 : from FI-FO
  709  0000000                   WITH_PCM_OUTPUT_TYPE			EQU 0
  710  0000000                   ; 0 : unsigned PCM
  711  0000000                   ; 1 : signed PCM (2' complement) 
  712  0000000                   ; 2 : signed magnitude
  713  0000000                   WITH_PCM_OUTPUT_SIZE			EQU 2
  714  0000000                   ; 1 : 1 BYTE
  715  0000000                   ; 2 : 2 BYTE	
  716  0000000                   WITH_CMD						EQU 0
  717  0000000                   ; for W569 chips that CPU send command to uC for next operations
  718  0000000                   
  719  0000000                   WITH_FW_MIXER					EQU 0
  720  0000000                   ; I-f a timer mix several channels but output to a T-buffer/Mixer output.
  721  0000000                   ; A firmware mixer will be needed.
  722  0000000                   WITH_COMPRESSED_MIDI			EQU 2
  723  0000000                   WITH_MULTIPLIER					EQU 0
  724  0000000                   ; 0 : FW
  725  0000000                   ; 1 : 9*7
  726  0000000                   ; 2 : 9*8
  727  0000000                   WITH_HEAD_TAIL_PROCESS			EQU 1
  728  0000000                   
  729  0000000                   ;-------------------------------------------------
  730  0000000                   ; for melody symbol definition





  731  0000000                   ;-------------------------------------------------
  732  0000000                   ENV_SHARP_DECAY_AMOUNT				EQU 4
  733  0000000                   
  734  0000000                   WITH_ALL_MIXER_SFR				EQU 0
  735  0000000                   
  736  0000000                   ; Following defines T-buffer registers
  737  0000000                   ;USED ACCOMPANY WITH SP_LO_T_INDEX_TABLE & SP_HI_T_INDEX_TABLE
  738  0000000                   SP_LO_T_START_ADDR				EQU SP0ALT
  739  0000000                   SP_HI_T_START_ADDR				EQU SP0AT
  740  0000000                   
  741  0000000                   SP_LO_T_VS0A					EQU 840H	;SP0CLT
  742  0000000                   SP_HI_T_VS0A					EQU 841H	;SP0CT
  743  0000000                   SP_LO_T_VS1A					EQU SP0ALT
  744  0000000                   SP_HI_T_VS1A					EQU SP0AT
  745  0000000                   SP_LO_T_VS2A					EQU 83DH	;SP0BLT
  746  0000000                   SP_HI_T_VS2A					EQU 83FH	;SP0BT
  747  0000000                   
  748  0000000                   ;	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
  749  0000000                   ;SP_HI_VS0A					EQU SP0C
  750  0000000                   ;SP_HI_VS1A					EQU SP0A
  751  0000000                   ;SP_HI_VS2A					EQU SP0B
  752  0000000                   ;
  753  0000000                   ;SP_LO_VS0A					EQU SP0CL
  754  0000000                   ;SP_LO_VS1A					EQU SP0AL
  755  0000000                   ;SP_LO_VS2A					EQU SP0BL
  756  0000000                   ;
  757  0000000                   ;SP_HI_START_ADDR				EQU SP0A
  758  0000000                   ;SP_LO_START_ADDR				EQU SP0AL
  759  0000000                   ;	.ENDIF
  760  0000000                   
  761  0000000                   SP_START_SIM_BUF_VS0A			EQU 0
  762  0000000                   SP_START_SIM_BUF_VS1A			EQU 0;0
  763  0000000                   SP_START_SIM_BUF_VS2A			EQU 0;0
  764  0000000                   SP_START_SIM_BUF_VS0B 			EQU 0
  765  0000000                   SP_START_SIM_BUF_VS1B			EQU 0
  766  0000000                   
  767  0000000                   
  768  0000000                   ; Following options used for ISR.
  769  0000000                   ; Please disable VS0D->VS0C->VS2B->VS1B->VSF->VSE->...>VS0A 
  770  0000000                   WITH_ISR_VS0A					EQU 0
  771  0000000                   WITH_ISR_VS0B					EQU 0
  772  0000000                   WITH_ISR_VS1A					EQU 1
  773  0000000                   WITH_ISR_VS1B					EQU 0
  774  0000000                   WITH_ISR_VS2A					EQU 0
  775  0000000                   WITH_ISR_VS2B					EQU 0
  776  0000000                   
  777  0000000                   ; Following options used for selecting speech channels.
  778  0000000                   ; Please disable VS0D->VS0C->VS2B->VS1B->VSF->VSE->...>VS0A 
  779  0000000                   WITH_VS0A						EQU 0
  780  0000000                   WITH_VS0B						EQU 0
  781  0000000                   WITH_VS1A						EQU 1
  782  0000000                   WITH_VS1B						EQU 0
  783  0000000                   WITH_VS2A						EQU 0
  784  0000000                   WITH_VS2B						EQU 0
  785  0000000                   WITH_VS0C						EQU 0
  786  0000000                   WITH_VS0D						EQU 0
  787  0000000                   WITH_VS3						EQU 0





  788  0000000                   WITH_VS4						EQU 0
  789  0000000                   WITH_VS5						EQU 0
  790  0000000                   WITH_VS6						EQU 0
  791  0000000                   WITH_VS7						EQU 0
  792  0000000                   WITH_VS8						EQU 0
  793  0000000                   WITH_VS9						EQU 0
  794  0000000                   WITH_VSA						EQU 0
  795  0000000                   WITH_VSB						EQU 0
  796  0000000                   WITH_VSC						EQU 0
  797  0000000                   WITH_VSD						EQU 0
  798  0000000                   WITH_VSE						EQU 0
  799  0000000                   WITH_VSF						EQU 0
  800  0000000                   
  801  0000000                   WITH_MD4						EQU 0
  802  0000000                   WITH_NM4						EQU 1
  803  0000000                   WITH_NM4S						EQU 0
  804  0000000                   WITH_MDM						EQU 0
  805  0000000                   WITH_APM						EQU 0
  806  0000000                   WITH_LP8						EQU 0
  807  0000000                   WITH_VC4						EQU 0
  808  0000000                   WITH_MDR						EQU 0
  809  0000000                   
  810  0000000                   WITH_E2A						EQU 0
  811  0000000                   WITH_EMM						EQU 0
  812  0000000                   WITH_MD6						EQU 0
  813  0000000                   WITH_P10						EQU 0
  814  0000000                   WITH_PC8						EQU 0
  815  0000000                   
  816  0000000                   WITH_SIL						EQU 1
  817  0000000                   WITH_VMDPC8						EQU 0
  818  0000000                   WITH_PCSPC8						EQU 0
  819  0000000                   WITH_TONE						EQU 0
  820  0000000                   WITH_HQPC8						EQU 0
  821  0000000                   
  822  0000000                   WITH_HQ567						EQU 0
  823  0000000                   WITH_VMD567						EQU 0
  824  0000000                   WITH_HQ567_HW						EQU 0
  825  0000000                   WITH_HQ569_HW						EQU 0
  826  0000000                   WITH_YAD						EQU 0
  827  0000000                   WITH_P16						EQU 0
  828  0000000                   WITH_VC8						EQU 0
  829  0000000                   WITH_PC8VMDPCS						EQU 0
  830  0000000                   WITH_LP8VMDPCS						EQU 0
  831  0000000                   WITH_P16VMDPCS						EQU 0
  832  0000000                   ;--------------------------------------------------------------------------
  833  0000000                   ; Options
  834  0000000                   ;--------------------------------------------------------------------------
  835  0000000                   WITH_POLYPHONY					EQU 0
  836  0000000                   WITH_MIDI_CHANNEL				EQU 0
  837  0000000                   WITH_VOL_ADJ_MS					EQU 0
  838  0000000                   
  839  0000000                   WITH_PAUSE_RESUME				EQU 0
  840  0000000                   WITH_CHANNEL_PRESSURE				EQU 0
  841  0000000                   WITH_NOTE_OFFSET				EQU 0
  842  0000000                   WITH_CHANGE_TEMPO				EQU 0
  843  0000000                   WITH_VELOCITY					EQU 0
  844  0000000                   WITH_MS_EXT_MIDI				EQU 0





  845  0000000                   WITH_SYNC_CH1_MS				EQU 0
  846  0000000                   ; Disable this feature will save 5 bytes RAM.
  847  0000000                   WITH_GLOBAL_CHANNEL_VOLM 			EQU 0
  848  0000000                   WITH_GLOBAL_CHANNEL_INS   			EQU 0
  849  0000000                   
  850  0000000                   WITH_PITCH_BEND					EQU 0
  851  0000000                   WITH_MODULATION_DEPTH			EQU 0
  852  0000000                   WITH_CHANNEL_SUSTAIN			EQU 0
  853  0000000                   WITH_SP_MIDI					EQU 0
  854  0000000                   WITH_PERCUSSION					EQU 0
  855  0000000                   WITH_DYNAMIC_CH					EQU 0
  856  0000000                   WITH_MS_ENABLE_CHANNEL			EQU 0
  857  0000000                   ; Disable this feature will save 2 bytes RAM.
  858  0000000                   
  859  0000000                   WITH_SP							EQU 1
  860  0000000                   ; Disable speech channels to save code size.
  861  0000000                   WITH_MS							EQU 0
  862  0000000                   ; Disable melody channels to save RAM and code size.
  863  0000000                   WITH_EVO						EQU 0
  864  0000000                   ; Disable EVO channels to save RAM and code size.
  865  0000000                   
  866  0000000                   ;------for speaker output type-----------------------------------------
  867  0000000                   WITH_SPEAKER_OUTPUT_TYPE 			EQU 	2
  868  0000000                   WITH_SPEAKER_SWITCH      			EQU     0   
  869  0000000                   
  870  0000000                   WITH_SIM_SP                                     EQU     0 
  871  0000000                   WITH_SIM_TYPE					EQU	0
  872  0000000                   ;0:W55F
  873  0000000                   ;1:SPI
  874  0000000                   WITH_EXT32MBIT					EQU	0
  875  0000000                   WITH_EXT64M_SPI					EQU 	0
  876  0000000                   
  877  0000000                   WITH_SP_NUM                                     EQU     1
  878  0000000                   WITH_ONE_HQ					EQU	0
  879  0000000                   WITH_PLAYE					EQU 	0
  880  0000000                   
  881  0000000                   
  882  0000000                   ; Following Options speci-fy what format can be played in each individual channel.
  883  0000000                   ; Properly disable some formats for channels can save RAM and code size.
  884  0000000                   WITH_VS0A_SIL					EQU 0
  885  0000000                   WITH_VS0B_SIL					EQU 0
  886  0000000                   WITH_VS1A_SIL					EQU 1
  887  0000000                   WITH_VS1B_SIL					EQU 0
  888  0000000                   WITH_VS2A_SIL					EQU 0
  889  0000000                   WITH_VS2B_SIL					EQU 0
  890  0000000                   
  891  0000000                   WITH_VS0A_MD4					EQU 0
  892  0000000                   WITH_VS0B_MD4					EQU 0
  893  0000000                   WITH_VS1A_MD4					EQU 0
  894  0000000                   WITH_VS1B_MD4					EQU 0
  895  0000000                   WITH_VS2A_MD4					EQU 0
  896  0000000                   WITH_VS2B_MD4					EQU 0
  897  0000000                   
  898  0000000                   WITH_VS0A_NM4					EQU 0
  899  0000000                   WITH_VS0B_NM4					EQU 0
  900  0000000                   WITH_VS1A_NM4					EQU 1
  901  0000000                   WITH_VS1B_NM4					EQU 0





  902  0000000                   WITH_VS2A_NM4					EQU 0
  903  0000000                   WITH_VS2B_NM4					EQU 0
  904  0000000                   
  905  0000000                   WITH_VS0A_NM4S					EQU 0
  906  0000000                   WITH_VS0B_NM4S					EQU 0
  907  0000000                   WITH_VS1A_NM4S					EQU 0
  908  0000000                   WITH_VS1B_NM4S					EQU 0
  909  0000000                   WITH_VS2A_NM4S					EQU 0
  910  0000000                   WITH_VS2B_NM4S					EQU 0
  911  0000000                   
  912  0000000                   WITH_VS0A_MDM					EQU 0
  913  0000000                   WITH_VS0B_MDM					EQU 0
  914  0000000                   WITH_VS1A_MDM					EQU 0
  915  0000000                   WITH_VS1B_MDM					EQU 0
  916  0000000                   WITH_VS2A_MDM					EQU 0
  917  0000000                   WITH_VS2B_MDM					EQU 0
  918  0000000                   
  919  0000000                   WITH_VS0A_APM					EQU 0
  920  0000000                   WITH_VS0B_APM					EQU 0
  921  0000000                   WITH_VS1A_APM					EQU 0
  922  0000000                   WITH_VS1B_APM					EQU 0
  923  0000000                   WITH_VS2A_APM					EQU 0
  924  0000000                   WITH_VS2B_APM					EQU 0
  925  0000000                   
  926  0000000                   WITH_VS0A_LP8					EQU 0
  927  0000000                   WITH_VS0B_LP8					EQU 0
  928  0000000                   WITH_VS1A_LP8					EQU 0
  929  0000000                   WITH_VS1B_LP8					EQU 0
  930  0000000                   WITH_VS2A_LP8					EQU 0
  931  0000000                   WITH_VS2B_LP8					EQU 0
  932  0000000                   
  933  0000000                   WITH_VS0A_VC4					EQU 0
  934  0000000                   WITH_VS0B_VC4					EQU 0
  935  0000000                   WITH_VS1A_VC4					EQU 0
  936  0000000                   WITH_VS1B_VC4					EQU 0
  937  0000000                   WITH_VS2A_VC4					EQU 0
  938  0000000                   WITH_VS2B_VC4					EQU 0
  939  0000000                   
  940  0000000                   WITH_VS0A_MDR					EQU 0
  941  0000000                   WITH_VS0B_MDR					EQU 0
  942  0000000                   WITH_VS1A_MDR					EQU 0
  943  0000000                   WITH_VS1B_MDR					EQU 0
  944  0000000                   WITH_VS2A_MDR					EQU 0
  945  0000000                   WITH_VS2B_MDR					EQU 0
  946  0000000                   
  947  0000000                   WITH_VS0A_E2A					EQU 0
  948  0000000                   WITH_VS0B_E2A					EQU 0
  949  0000000                   WITH_VS1A_E2A					EQU 0
  950  0000000                   WITH_VS1B_E2A					EQU 0
  951  0000000                   WITH_VS2A_E2A					EQU 0
  952  0000000                   WITH_VS2B_E2A					EQU 0
  953  0000000                   
  954  0000000                   WITH_VS0A_EMM					EQU 0
  955  0000000                   WITH_VS0B_EMM					EQU 0
  956  0000000                   WITH_VS1A_EMM					EQU 0
  957  0000000                   WITH_VS1B_EMM					EQU 0
  958  0000000                   WITH_VS2A_EMM					EQU 0





  959  0000000                   WITH_VS2B_EMM					EQU 0
  960  0000000                   
  961  0000000                   WITH_VS0A_MD6					EQU 0
  962  0000000                   WITH_VS0B_MD6					EQU 0
  963  0000000                   WITH_VS1A_MD6					EQU 0
  964  0000000                   WITH_VS1B_MD6					EQU 0
  965  0000000                   WITH_VS2A_MD6					EQU 0
  966  0000000                   WITH_VS2B_MD6					EQU 0
  967  0000000                   
  968  0000000                   WITH_VS0A_P10					EQU 0
  969  0000000                   WITH_VS0B_P10					EQU 0
  970  0000000                   WITH_VS1A_P10					EQU 0
  971  0000000                   WITH_VS1B_P10					EQU 0
  972  0000000                   WITH_VS2A_P10					EQU 0
  973  0000000                   WITH_VS2B_P10					EQU 0
  974  0000000                   
  975  0000000                   WITH_VS0A_PC8					EQU 0
  976  0000000                   WITH_VS0B_PC8					EQU 0
  977  0000000                   WITH_VS1A_PC8					EQU 0
  978  0000000                   WITH_VS1B_PC8					EQU 0
  979  0000000                   WITH_VS2A_PC8					EQU 0
  980  0000000                   WITH_VS2B_PC8					EQU 0
  981  0000000                   
  982  0000000                   ; PC8 type VMD, disable to save code size.
  983  0000000                   WITH_VS0A_VMDPC8				EQU 0
  984  0000000                   WITH_VS0B_VMDPC8				EQU 0
  985  0000000                   WITH_VS1A_VMDPC8				EQU 0
  986  0000000                   WITH_VS1B_VMDPC8				EQU 0
  987  0000000                   WITH_VS2A_VMDPC8				EQU 0
  988  0000000                   WITH_VS2B_VMDPC8				EQU 0
  989  0000000                   
  990  0000000                   ; PC8 type PCS, disable to save code size.
  991  0000000                   WITH_VS0A_PCSPC8				EQU 0
  992  0000000                   WITH_VS0B_PCSPC8				EQU 0
  993  0000000                   WITH_VS1A_PCSPC8				EQU 0
  994  0000000                   WITH_VS1B_PCSPC8				EQU 0
  995  0000000                   WITH_VS2A_PCSPC8				EQU 0
  996  0000000                   WITH_VS2B_PCSPC8				EQU 0
  997  0000000                   
  998  0000000                   ; I-f there is HQ melody, disable TONE save nothing.
  999  0000000                   WITH_VS0A_TONE					EQU 0
 1000  0000000                   WITH_VS0B_TONE					EQU 0
 1001  0000000                   WITH_VS1A_TONE					EQU 0
 1002  0000000                   WITH_VS1B_TONE					EQU 0
 1003  0000000                   WITH_VS2A_TONE					EQU 0
 1004  0000000                   WITH_VS2B_TONE					EQU 0
 1005  0000000                   
 1006  0000000                   ; W566/W588(PC8) type HQ, disable to save code size.
 1007  0000000                   WITH_VS0A_HQPC8					EQU 0
 1008  0000000                   WITH_VS0B_HQPC8					EQU 0
 1009  0000000                   WITH_VS1A_HQPC8					EQU 0
 1010  0000000                   WITH_VS1B_HQPC8					EQU 0
 1011  0000000                   WITH_VS2A_HQPC8					EQU 0
 1012  0000000                   WITH_VS2B_HQPC8					EQU 0
 1013  0000000                   
 1014  0000000                   WITH_CH0_EVO					EQU 0
 1015  0000000                   WITH_CH1_EVO					EQU 0





 1016  0000000                   WITH_CH2_EVO					EQU 0
 1017  0000000                   
 1018  0000000                   WITH_FILTER					EQU 0
 1019  0000000                   WITH_NOISE_SHAPING				EQU 1
 1020  0000000                   ;0 - not support noise shaping
 1021  0000000                   ;1 - support noise shaping
 1022  0000000                   ;2 - only PWM support shaping
 1023  0000000                   
 1024  0000000                   WITH_DAC_ENABLE					EQU 0
 1025  0000000                   WITH_SP0XL_RESOLUTION				EQU 1
 1026  0000000                   ; 1 - 16 bit
 1027  0000000                   ; 2 - 14 bit
 1028  0000000                   ; 3 - 12 bit
 1029  0000000                   WITH_SPEN_EFFECTIVE_BITS       			EQU 2
 1030  0000000                   ;X X X X PWM_NS DAC_MA PWM DAC  
 1031  0000000                   WITH_RDPC_VALUE         			EQU 1
 1032  0000000                   
 1033  0000000                   WITH_MS_CODA					EQU 0
 1034  0000000                   WITH_SP_MIDI_SIMUL 				EQU 0
 1035  0000000                   WITH_SP_SKIP                       		EQU 0
 1036  0000000                   WITH_SP_GLOBAL_SR                       	EQU 0
 1037  0000000                   
 1038  0000000                   WITH_RAM_OVER_STACK				EQU 	0
 1039  0000000                   WITH_STACK_SIZE					EQU	20
 1040  0000000                   
 1041  0000000                   TONE_2KHZ_TMC	EQU 5
 1042  0000000                   TONE_2KHZ_TMV 	EQU 95
 1043  0000000                   
 1044  0000000                   WITH_SPI_GPIO                                   EQU     0
 1045  0000000                   
 1046  0000000                   WITH_EN_ULTRAIO                 EQU     0
 1047  0000000                   
 1048  0000000                   ; Cap-Sensor Library
 1049  0000000                   ; 
 1050  0000000                   ;;;; There are two libraries for Cap-Sensor.
 1051  0000000                   ;;;; [1] 8  key detection via PORT_ISR
 1052  0000000                   ;;;;    
 1053  0000000                   ;;;;    
 1054  0000000                   ;;;; [2] 8+ key detection via MAIN_LOOP
 1055  0000000                   ;;;;    
 1056  0000000                   ;;;;    
 1057  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1058  0000000                   WITH_PSF_PROJECT  		EQU 0
 1059  0000000                   
 1060  0000000                   WITH_FW_SEN_OPTION_PIN           EQU         0
 1061  0000000                   WITH_CAPSENSOR_MULTISENTABLE     EQU         1
 1062  0000000                   
 1063  0000000                   CAP_SENSOR_TBL0_KEY0_TH              EQU 0
 1064  0000000                   CAP_SENSOR_TBL0_KEY1_TH              EQU 0
 1065  0000000                   CAP_SENSOR_TBL0_KEY2_TH              EQU 0
 1066  0000000                   CAP_SENSOR_TBL0_KEY3_TH              EQU 0
 1067  0000000                   CAP_SENSOR_TBL0_KEY4_TH              EQU 0
 1068  0000000                   CAP_SENSOR_TBL0_KEY5_TH              EQU 0
 1069  0000000                   CAP_SENSOR_TBL0_KEY6_TH              EQU 0
 1070  0000000                   CAP_SENSOR_TBL0_KEY7_TH              EQU 0
 1071  0000000                   CAP_SENSOR_TBL0_KEY8_TH              EQU 0
 1072  0000000                   CAP_SENSOR_TBL0_KEY9_TH              EQU 0





 1073  0000000                   CAP_SENSOR_TBL0_KEY10_TH             EQU 0
 1074  0000000                   CAP_SENSOR_TBL0_KEY11_TH             EQU 0
 1075  0000000                   CAP_SENSOR_TBL0_KEY12_TH             EQU 0
 1076  0000000                   CAP_SENSOR_TBL0_KEY13_TH             EQU 0
 1077  0000000                   CAP_SENSOR_TBL0_KEY14_TH             EQU 0
 1078  0000000                   CAP_SENSOR_TBL0_KEY15_TH             EQU 0
 1079  0000000                   CAP_SENSOR_TBL0_KEY16_TH             EQU 0
 1080  0000000                   CAP_SENSOR_TBL0_KEY17_TH             EQU 0
 1081  0000000                   CAP_SENSOR_TBL0_KEY18_TH             EQU 0
 1082  0000000                   CAP_SENSOR_TBL0_KEY19_TH             EQU 0
 1083  0000000                   CAP_SENSOR_TBL0_KEY20_TH             EQU 0
 1084  0000000                   CAP_SENSOR_TBL0_KEY21_TH             EQU 0
 1085  0000000                   CAP_SENSOR_TBL0_KEY22_TH             EQU 0
 1086  0000000                   CAP_SENSOR_TBL0_KEY23_TH             EQU 0
 1087  0000000                   
 1088  0000000                   
 1089  0000000                   CAP_SENSOR_SEL_PIN0     EQU 0
 1090  0000000                   CAP_SENSOR_SEL_PIN1     EQU 0
 1091  0000000                   CAP_SENSOR_SEL_PIN2     EQU 0
 1092  0000000                   CAP_SENSOR_SEL_PIN3     EQU 0
 1093  0000000                   
 1094  0000000                   CAP_SENSOR_IMPLEMENTATION       EQU 2
 1095  0000000                   WITH_CHARGE_ENABLE              EQU 0
 1096  0000000                   ;CapSensorChargeEnable
 1097  0000000                   
 1098  0000000                   ;;;; Common
 1099  0000000                   ;;;; 
 1100  0000000                   ;;;;
 1101  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1102  0000000                   WITH_FW_CAP_SENSOR_KEYS         EQU 0
 1103  0000000                   CAP_SENSOR_KEY0_TH              EQU 0
 1104  0000000                   CAP_SENSOR_KEY1_TH              EQU 0
 1105  0000000                   CAP_SENSOR_KEY2_TH              EQU 0
 1106  0000000                   CAP_SENSOR_KEY3_TH              EQU 0
 1107  0000000                   CAP_SENSOR_KEY4_TH              EQU 0
 1108  0000000                   CAP_SENSOR_KEY5_TH              EQU 0
 1109  0000000                   CAP_SENSOR_KEY6_TH              EQU 0
 1110  0000000                   CAP_SENSOR_KEY7_TH              EQU 0
 1111  0000000                   CAP_SENSOR_KEY8_TH              EQU 0
 1112  0000000                   CAP_SENSOR_KEY9_TH              EQU 0
 1113  0000000                   CAP_SENSOR_KEY10_TH             EQU 0
 1114  0000000                   CAP_SENSOR_KEY11_TH             EQU 0
 1115  0000000                   CAP_SENSOR_KEY12_TH             EQU 0
 1116  0000000                   CAP_SENSOR_KEY13_TH             EQU 0
 1117  0000000                   CAP_SENSOR_KEY14_TH             EQU 0
 1118  0000000                   CAP_SENSOR_KEY15_TH             EQU 0
 1119  0000000                   CAP_SENSOR_KEY16_TH             EQU 0
 1120  0000000                   CAP_SENSOR_KEY17_TH             EQU 0
 1121  0000000                   CAP_SENSOR_KEY18_TH             EQU 0
 1122  0000000                   CAP_SENSOR_KEY19_TH             EQU 0
 1123  0000000                   CAP_SENSOR_KEY20_TH             EQU 0
 1124  0000000                   CAP_SENSOR_KEY21_TH             EQU 0
 1125  0000000                   CAP_SENSOR_KEY22_TH             EQU 0
 1126  0000000                   CAP_SENSOR_KEY23_TH             EQU 0
 1127  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1128  0000000                   
 1129  0000000                   





 1130  0000000                   ;;;; Cap Sensor V1
 1131  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1132  0000000                   S_CAP_SENSOR_KEY_MASK           EQU 0H
 1133  0000000                   S_TOUCH_KEY_MASK                EQU 0H
 1134  0000000                   S_TOUCH_KEY_MASK_REV            EQU FFH
 1135  0000000                   CAP_SENSOR_KEY_EN0              EQU 0
 1136  0000000                   CAP_SENSOR_KEY_EN1              EQU 0
 1137  0000000                   CAP_SENSOR_KEY_EN2              EQU 0
 1138  0000000                   CAP_SENSOR_KEY_EN3              EQU 0
 1139  0000000                   CAP_SENSOR_KEY_EN4              EQU 0
 1140  0000000                   CAP_SENSOR_KEY_EN5              EQU 0
 1141  0000000                   CAP_SENSOR_KEY_EN6              EQU 0
 1142  0000000                   CAP_SENSOR_KEY_EN7              EQU 0
 1143  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1144  0000000                   
 1145  0000000                   ;;;; Cap Sensor V2
 1146  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1147  0000000                   CAP_SENSOR_KEY0_BP              EQU 0
 1148  0000000                   CAP_SENSOR_KEY1_BP              EQU 0
 1149  0000000                   CAP_SENSOR_KEY2_BP              EQU 0
 1150  0000000                   CAP_SENSOR_KEY3_BP              EQU 0
 1151  0000000                   CAP_SENSOR_KEY4_BP              EQU 0
 1152  0000000                   CAP_SENSOR_KEY5_BP              EQU 0
 1153  0000000                   CAP_SENSOR_KEY6_BP              EQU 0
 1154  0000000                   CAP_SENSOR_KEY7_BP              EQU 0
 1155  0000000                   CAP_SENSOR_KEY8_BP              EQU 0
 1156  0000000                   CAP_SENSOR_KEY9_BP              EQU 0
 1157  0000000                   CAP_SENSOR_KEY10_BP             EQU 0
 1158  0000000                   CAP_SENSOR_KEY11_BP             EQU 0
 1159  0000000                   CAP_SENSOR_KEY12_BP             EQU 0
 1160  0000000                   CAP_SENSOR_KEY13_BP             EQU 0
 1161  0000000                   CAP_SENSOR_KEY14_BP             EQU 0
 1162  0000000                   CAP_SENSOR_KEY15_BP             EQU 0
 1163  0000000                   CAP_SENSOR_KEY16_BP             EQU 0
 1164  0000000                   CAP_SENSOR_KEY17_BP             EQU 0
 1165  0000000                   CAP_SENSOR_KEY18_BP             EQU 0
 1166  0000000                   CAP_SENSOR_KEY19_BP             EQU 0
 1167  0000000                   CAP_SENSOR_KEY20_BP             EQU 0
 1168  0000000                   CAP_SENSOR_KEY21_BP             EQU 0
 1169  0000000                   CAP_SENSOR_KEY22_BP             EQU 0
 1170  0000000                   CAP_SENSOR_KEY23_BP             EQU 0
 1171  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1172  0000000                   
 1173  0000000                   ;;;;IO EXPANDER SETTING
 1174  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1175  0000000                   N55P_DEVICE_NUM		EQU       0          
 1176  0000000                   ;N55PDeviceNum:0/1/2
 1177  0000000                   N55P_DEVICE_UIO_USED	EQU       00H
 1178  0000000                   N55P_DEVICE0_CNSTA    EQU       00H          
 1179  0000000                   N55P_DEVICE0_CNSTB    EQU       00H          
 1180  0000000                   N55P_DEVICE0_CNSTC    EQU       00H          
 1181  0000000                   N55P_DEVICE0_PCKAB    EQU       00H     
 1182  0000000                   N55P_DEVICE0_PCKCD    EQU       00H         
 1183  0000000                   
 1184  0000000                   N55P_DEVICE1_CNSTA    EQU       00H          
 1185  0000000                   N55P_DEVICE1_CNSTB    EQU       00H          
 1186  0000000                   N55P_DEVICE1_CNSTC    EQU       00H          





 1187  0000000                   N55P_DEVICE1_PCKAB    EQU       00H     
 1188  0000000                   N55P_DEVICE1_PCKCD    EQU       00H     
 1189  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 1190  0000000                   SPI_COMMAND_ENABLE        EQU 0
 1191  0000000                   I2C_COMMAND_ENABLE        EQU 0
 1192  0000000                   
 1193  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\RAMVAR.INI.APP"
 1194  0000000                   ;  0WITH_VOL_ADJ
 1195  0000000                   ;  0WITH_MULTI_CHANNEL
 1196  0000000                   ;  0WITH_VOL_REDUCE
 1197  0000000                   ;  0WITH_16BIT_MODE
 1198  0000000                   ;  1WITH_32K_BANK
 1199  0000000                   ;  1WITH_T_BUFFER
 1200  0000000                   ;  0WITH_READ_DATA_TYPE
 1201  0000000                   ;  0WITH_PCM_OUTPUT_TYPE
 1202  0000000                   ;  2WITH_PCM_OUTPUT_SIZE
 1203  0000000                   ;  0WITH_CMD
 1204  0000000                   ;  0WITH_FW_MIXER
 1205  0000000                   ;  2WITH_COMPRESSED_MIDI
 1206  0000000                   ;  0WITH_MULTIPLIER
 1207  0000000                   ;  1WITH_HEAD_TAIL_PROCESS
 1208  0000000                   ;  0WITH_ALL_MIXER_SFR
 1209  0000000                   ;  0WITH_ISR_VS0A
 1210  0000000                   ;  0WITH_ISR_VS0B
 1211  0000000                   ;  1WITH_ISR_VS1A
 1212  0000000                   ;  0WITH_ISR_VS1B
 1213  0000000                   ;  0WITH_ISR_VS2A
 1214  0000000                   ;  0WITH_ISR_VS2B
 1215  0000000                   ;  0WITH_VS0A
 1216  0000000                   ;  0WITH_VS0B
 1217  0000000                   ;  1WITH_VS1A
 1218  0000000                   ;  0WITH_VS1B
 1219  0000000                   ;  0WITH_VS2A
 1220  0000000                   ;  0WITH_VS2B
 1221  0000000                   ;  0WITH_VS0C
 1222  0000000                   ;  0WITH_VS0D
 1223  0000000                   ;  0WITH_VS3
 1224  0000000                   ;  0WITH_VS4
 1225  0000000                   ;  0WITH_VS5
 1226  0000000                   ;  0WITH_VS6
 1227  0000000                   ;  0WITH_VS7
 1228  0000000                   ;  0WITH_VS8
 1229  0000000                   ;  0WITH_VS9
 1230  0000000                   ;  0WITH_VSA
 1231  0000000                   ;  0WITH_VSB
 1232  0000000                   ;  0WITH_VSC
 1233  0000000                   ;  0WITH_VSD
 1234  0000000                   ;  0WITH_VSE
 1235  0000000                   ;  0WITH_VSF
 1236  0000000                   ;  0WITH_MD4
 1237  0000000                   ;  1WITH_NM4
 1238  0000000                   ;  0WITH_NM4S
 1239  0000000                   ;  0WITH_MDM
 1240  0000000                   ;  0WITH_APM
 1241  0000000                   ;  0WITH_LP8
 1242  0000000                   ;  0WITH_VC4
 1243  0000000                   ;  0WITH_MDR





 1244  0000000                   ;  0WITH_E2A
 1245  0000000                   ;  0WITH_EMM
 1246  0000000                   ;  0WITH_MD6
 1247  0000000                   ;  0WITH_P10
 1248  0000000                   ;  0WITH_PC8
 1249  0000000                   ;  1WITH_SIL
 1250  0000000                   ;  0WITH_VMDPC8
 1251  0000000                   ;  0WITH_PCSPC8
 1252  0000000                   ;  0WITH_TONE
 1253  0000000                   ;  0WITH_HQPC8
 1254  0000000                   ;  0WITH_HQ567
 1255  0000000                   ;  0WITH_VMD567
 1256  0000000                   ;  0WITH_HQ567_HW
 1257  0000000                   ;  0WITH_HQ569_HW
 1258  0000000                   ;  0WITH_YAD
 1259  0000000                   ;  0WITH_P16
 1260  0000000                   ;  0WITH_VC8
 1261  0000000                   ;  0WITH_PC8VMDPCS
 1262  0000000                   ;  0WITH_LP8VMDPCS
 1263  0000000                   ;  0WITH_P16VMDPCS
 1264  0000000                   ;  0WITH_POLYPHONY
 1265  0000000                   ;  0WITH_MIDI_CHANNEL
 1266  0000000                   ;  0WITH_VOL_ADJ_MS
 1267  0000000                   ;  0WITH_PAUSE_RESUME
 1268  0000000                   ;  0WITH_CHANNEL_PRESSURE
 1269  0000000                   ;  0WITH_NOTE_OFFSET
 1270  0000000                   ;  0WITH_CHANGE_TEMPO
 1271  0000000                   ;  0WITH_VELOCITY
 1272  0000000                   ;  0WITH_MS_EXT_MIDI
 1273  0000000                   ;  0WITH_SYNC_CH1_MS
 1274  0000000                   ;  0WITH_GLOBAL_CHANNEL_VOLM
 1275  0000000                   ;  0WITH_GLOBAL_CHANNEL_INS
 1276  0000000                   ;  0WITH_PITCH_BEND
 1277  0000000                   ;  0WITH_MODULATION_DEPTH
 1278  0000000                   ;  0WITH_CHANNEL_SUSTAIN
 1279  0000000                   ;  0WITH_SP_MIDI
 1280  0000000                   ;  0WITH_PERCUSSION
 1281  0000000                   ;  0WITH_DYNAMIC_CH
 1282  0000000                   ;  0WITH_MS_ENABLE_CHANNEL
 1283  0000000                   ;  1WITH_SP
 1284  0000000                   ;  0WITH_MS
 1285  0000000                   ;  0WITH_EVO
 1286  0000000                   ;  2WITH_SPEAKER_OUTPUT_TYPE
 1287  0000000                   ;  0WITH_SPEAKER_SWITCH
 1288  0000000                   ;  0WITH_SIM_SP
 1289  0000000                   ;  0WITH_SIM_TYPE
 1290  0000000                   ;  0WITH_EXT32MBIT
 1291  0000000                   ;  0WITH_EXT64M_SPI
 1292  0000000                   ;  1WITH_SP_NUM
 1293  0000000                   ;  0WITH_ONE_HQ
 1294  0000000                   ;  0WITH_PLAYE
 1295  0000000                   ;  0WITH_VS0A_SIL
 1296  0000000                   ;  0WITH_VS0B_SIL
 1297  0000000                   ;  1WITH_VS1A_SIL
 1298  0000000                   ;  0WITH_VS1B_SIL
 1299  0000000                   ;  0WITH_VS2A_SIL
 1300  0000000                   ;  0WITH_VS2B_SIL





 1301  0000000                   ;  0WITH_VS0A_MD4
 1302  0000000                   ;  0WITH_VS0B_MD4
 1303  0000000                   ;  0WITH_VS1A_MD4
 1304  0000000                   ;  0WITH_VS1B_MD4
 1305  0000000                   ;  0WITH_VS2A_MD4
 1306  0000000                   ;  0WITH_VS2B_MD4
 1307  0000000                   ;  0WITH_VS0A_NM4
 1308  0000000                   ;  0WITH_VS0B_NM4
 1309  0000000                   ;  1WITH_VS1A_NM4
 1310  0000000                   ;  0WITH_VS1B_NM4
 1311  0000000                   ;  0WITH_VS2A_NM4
 1312  0000000                   ;  0WITH_VS2B_NM4
 1313  0000000                   ;  0WITH_VS0A_NM4S
 1314  0000000                   ;  0WITH_VS0B_NM4S
 1315  0000000                   ;  0WITH_VS1A_NM4S
 1316  0000000                   ;  0WITH_VS1B_NM4S
 1317  0000000                   ;  0WITH_VS2A_NM4S
 1318  0000000                   ;  0WITH_VS2B_NM4S
 1319  0000000                   ;  0WITH_VS0A_MDM
 1320  0000000                   ;  0WITH_VS0B_MDM
 1321  0000000                   ;  0WITH_VS1A_MDM
 1322  0000000                   ;  0WITH_VS1B_MDM
 1323  0000000                   ;  0WITH_VS2A_MDM
 1324  0000000                   ;  0WITH_VS2B_MDM
 1325  0000000                   ;  0WITH_VS0A_APM
 1326  0000000                   ;  0WITH_VS0B_APM
 1327  0000000                   ;  0WITH_VS1A_APM
 1328  0000000                   ;  0WITH_VS1B_APM
 1329  0000000                   ;  0WITH_VS2A_APM
 1330  0000000                   ;  0WITH_VS2B_APM
 1331  0000000                   ;  0WITH_VS0A_LP8
 1332  0000000                   ;  0WITH_VS0B_LP8
 1333  0000000                   ;  0WITH_VS1A_LP8
 1334  0000000                   ;  0WITH_VS1B_LP8
 1335  0000000                   ;  0WITH_VS2A_LP8
 1336  0000000                   ;  0WITH_VS2B_LP8
 1337  0000000                   ;  0WITH_VS0A_VC4
 1338  0000000                   ;  0WITH_VS0B_VC4
 1339  0000000                   ;  0WITH_VS1A_VC4
 1340  0000000                   ;  0WITH_VS1B_VC4
 1341  0000000                   ;  0WITH_VS2A_VC4
 1342  0000000                   ;  0WITH_VS2B_VC4
 1343  0000000                   ;  0WITH_VS0A_MDR
 1344  0000000                   ;  0WITH_VS0B_MDR
 1345  0000000                   ;  0WITH_VS1A_MDR
 1346  0000000                   ;  0WITH_VS1B_MDR
 1347  0000000                   ;  0WITH_VS2A_MDR
 1348  0000000                   ;  0WITH_VS2B_MDR
 1349  0000000                   ;  0WITH_VS0A_E2A
 1350  0000000                   ;  0WITH_VS0B_E2A
 1351  0000000                   ;  0WITH_VS1A_E2A
 1352  0000000                   ;  0WITH_VS1B_E2A
 1353  0000000                   ;  0WITH_VS2A_E2A
 1354  0000000                   ;  0WITH_VS2B_E2A
 1355  0000000                   ;  0WITH_VS0A_EMM
 1356  0000000                   ;  0WITH_VS0B_EMM
 1357  0000000                   ;  0WITH_VS1A_EMM





 1358  0000000                   ;  0WITH_VS1B_EMM
 1359  0000000                   ;  0WITH_VS2A_EMM
 1360  0000000                   ;  0WITH_VS2B_EMM
 1361  0000000                   ;  0WITH_VS0A_MD6
 1362  0000000                   ;  0WITH_VS0B_MD6
 1363  0000000                   ;  0WITH_VS1A_MD6
 1364  0000000                   ;  0WITH_VS1B_MD6
 1365  0000000                   ;  0WITH_VS2A_MD6
 1366  0000000                   ;  0WITH_VS2B_MD6
 1367  0000000                   ;  0WITH_VS0A_P10
 1368  0000000                   ;  0WITH_VS0B_P10
 1369  0000000                   ;  0WITH_VS1A_P10
 1370  0000000                   ;  0WITH_VS1B_P10
 1371  0000000                   ;  0WITH_VS2A_P10
 1372  0000000                   ;  0WITH_VS2B_P10
 1373  0000000                   ;  0WITH_VS0A_PC8
 1374  0000000                   ;  0WITH_VS0B_PC8
 1375  0000000                   ;  0WITH_VS1A_PC8
 1376  0000000                   ;  0WITH_VS1B_PC8
 1377  0000000                   ;  0WITH_VS2A_PC8
 1378  0000000                   ;  0WITH_VS2B_PC8
 1379  0000000                   ;  0WITH_VS0A_VMDPC8
 1380  0000000                   ;  0WITH_VS0B_VMDPC8
 1381  0000000                   ;  0WITH_VS1A_VMDPC8
 1382  0000000                   ;  0WITH_VS1B_VMDPC8
 1383  0000000                   ;  0WITH_VS2A_VMDPC8
 1384  0000000                   ;  0WITH_VS2B_VMDPC8
 1385  0000000                   ;  0WITH_VS0A_PCSPC8
 1386  0000000                   ;  0WITH_VS0B_PCSPC8
 1387  0000000                   ;  0WITH_VS1A_PCSPC8
 1388  0000000                   ;  0WITH_VS1B_PCSPC8
 1389  0000000                   ;  0WITH_VS2A_PCSPC8
 1390  0000000                   ;  0WITH_VS2B_PCSPC8
 1391  0000000                   ;  0WITH_VS0A_TONE
 1392  0000000                   ;  0WITH_VS0B_TONE
 1393  0000000                   ;  0WITH_VS1A_TONE
 1394  0000000                   ;  0WITH_VS1B_TONE
 1395  0000000                   ;  0WITH_VS2A_TONE
 1396  0000000                   ;  0WITH_VS2B_TONE
 1397  0000000                   ;  0WITH_VS0A_HQPC8
 1398  0000000                   ;  0WITH_VS0B_HQPC8
 1399  0000000                   ;  0WITH_VS1A_HQPC8
 1400  0000000                   ;  0WITH_VS1B_HQPC8
 1401  0000000                   ;  0WITH_VS2A_HQPC8
 1402  0000000                   ;  0WITH_VS2B_HQPC8
 1403  0000000                   ;  0WITH_CH0_EVO
 1404  0000000                   ;  0WITH_CH1_EVO
 1405  0000000                   ;  0WITH_CH2_EVO
 1406  0000000                   ;  0WITH_FILTER
 1407  0000000                   ;  1WITH_NOISE_SHAPING
 1408  0000000                   ;  0WITH_DAC_ENABLE
 1409  0000000                   ;  1WITH_SP0XL_RESOLUTION
 1410  0000000                   ;  2WITH_SPEN_EFFECTIVE_BITS
 1411  0000000                   ;  1WITH_RDPC_VALUE
 1412  0000000                   ;  0WITH_MS_CODA
 1413  0000000                   ;  0WITH_SP_MIDI_SIMUL
 1414  0000000                   ;  0WITH_SP_SKIP





 1415  0000000                   ;  0WITH_SP_GLOBAL_SR
 1416  0000000                   ;  0WITH_RAM_OVER_STACK
 1417  0000000                   ; 20WITH_STACK_SIZE
 1418  0000000                   ;  0WITH_SPI_GPIO
 1419  0000000                   ;  0WITH_EN_ULTRAIO
 1420  0000000                   ;  0WITH_PSF_PROJECT
 1421  0000000                   ;  0WITH_FW_SEN_OPTION_PIN
 1422  0000000                   ;  1WITH_CAPSENSOR_MULTISENTABLE
 1423  0000000                   ;  0WITH_CHARGE_ENABLE
 1424  0000000                   ;  0WITH_FW_CAP_SENSOR_KEYS
 1425  0000000                   
 1426  0000000                   ;Support WITH_SP channel variables ========================
 1427  0000000                   CH_STATUS_SP                             EQU  0H ;  1,  0
 1428  0000000                   CH_ISR_SYNTH_START_SP                    EQU  1H ;  2,  1
 1429  0000000                   CH_PREVIOUS_PCM_SP                       EQU  3H ;  2,  3
 1430  0000000                   CH_PAUSE_PCM_SP                          EQU  5H ;  2,  5
 1431  0000000                   CH_DATA_ADDR_SP                          EQU  5H ;  2,  5
 1432  0000000                   CH_RAMP_BUF1_SP                          EQU  5H ;  2,  5
 1433  0000000                   CH_DATA_BANK_SP                          EQU  7H ;  1,  7
 1434  0000000                   CH_PHRASE_REPEAT_NUM_SP                  EQU  8H ;  1,  8
 1435  0000000                   CH_SENTENCE_START_ADDR_SP                EQU  9H ;  2,  9
 1436  0000000                   CH_RAMP_BUF2_SP                          EQU  9H ;  2,  9
 1437  0000000                   CH_SENTENCE_START_BANK_SP                EQU  BH ;  1, 11
 1438  0000000                   ; Size = 12  ==============================================
 1439  0000000                   
 1440  0000000                   ;Not support WITH_APM channel variables ========================
 1441  0000000                   
 1442  0000000                   ;Not support WITH_EAM channel variables ========================
 1443  0000000                   
 1444  0000000                   ;Not support WITH_E2A channel variables ========================
 1445  0000000                   
 1446  0000000                   ;Not support WITH_VC4 channel variables ========================
 1447  0000000                   
 1448  0000000                   ;Not support WITH_YAD channel variables ========================
 1449  0000000                   
 1450  0000000                   ;Support WITH_SIL channel variables ========================
 1451  0000000                   CH_STATUS_SIL                            EQU  0H ;  1,  0
 1452  0000000                   CH_ISR_SYNTH_START_SIL                   EQU  1H ;  2,  1
 1453  0000000                   CH_OLD_SAMPLE_SIL                        EQU  3H ;  2,  3
 1454  0000000                   CH_PAUSE_PCM_SIL                         EQU  5H ;  2,  5
 1455  0000000                   CH_DATA_ADDR_SIL                         EQU  5H ;  2,  5
 1456  0000000                   CH_DATA_BANK_SIL                         EQU  7H ;  1,  7
 1457  0000000                   CH_PHRASE_REPEAT_NUM_SIL                 EQU  8H ;  1,  8
 1458  0000000                   CH_SENTENCE_START_ADDR_SIL               EQU  9H ;  2,  9
 1459  0000000                   CH_SENTENCE_START_BANK_SIL               EQU  BH ;  1, 11
 1460  0000000                   CH_COUNTER_SIL                           EQU  CH ;  1, 12
 1461  0000000                   CH_COUNTER2_SIL                          EQU  DH ;  1, 13
 1462  0000000                   ; Size = 14  ==============================================
 1463  0000000                   
 1464  0000000                   ;Not support WITH_MDM channel variables ========================
 1465  0000000                   
 1466  0000000                   ;Not support WITH_EMM channel variables ========================
 1467  0000000                   
 1468  0000000                   ;Not support WITH_MD6 channel variables ========================
 1469  0000000                   
 1470  0000000                   ;Not support WITH_PC8 channel variables ========================
 1471  0000000                   





 1472  0000000                   ;Not support WITH_LP8 channel variables ========================
 1473  0000000                   
 1474  0000000                   ;Not support WITH_P10 channel variables ========================
 1475  0000000                   
 1476  0000000                   ;Not support WITH_P16 channel variables ========================
 1477  0000000                   
 1478  0000000                   ;Not support WITH_VC8 channel variables ========================
 1479  0000000                   
 1480  0000000                   ;Not support WITH_MD4 channel variables ========================
 1481  0000000                   
 1482  0000000                   ;Not support WITH_MDR channel variables ========================
 1483  0000000                   
 1484  0000000                   ;Support WITH_NM4 channel variables ========================
 1485  0000000                   CH_STATUS_NM4                            EQU  0H ;  1,  0
 1486  0000000                   CH_ISR_SYNTH_START_NM4                   EQU  1H ;  2,  1
 1487  0000000                   CH_OLD_SAMPLE_NM4                        EQU  3H ;  2,  3
 1488  0000000                   CH_PAUSE_PCM_NM4                         EQU  5H ;  2,  5
 1489  0000000                   CH_DATA_ADDR_NM4                         EQU  5H ;  2,  5
 1490  0000000                   CH_DATA_BANK_NM4                         EQU  7H ;  1,  7
 1491  0000000                   CH_PHRASE_REPEAT_NUM_NM4                 EQU  8H ;  1,  8
 1492  0000000                   CH_SENTENCE_START_ADDR_NM4               EQU  9H ;  2,  9
 1493  0000000                   CH_SENTENCE_START_BANK_NM4               EQU  BH ;  1, 11
 1494  0000000                   CH_COUNTER_NM4                           EQU  CH ;  1, 12
 1495  0000000                   CH_GAIN_BUFFER_NM4                       EQU  DH ;  2, 13
 1496  0000000                   CH_DECODE_DATA_NM4                       EQU  FH ;  1, 15
 1497  0000000                   CH_PREV1_BUFFER_NM4                      EQU 10H ;  1, 16
 1498  0000000                   CH_PREV2_BUFFER_NM4                      EQU 11H ;  1, 17
 1499  0000000                   CH_PCM_TABLE_ADDR1_NM4                   EQU 12H ;  2, 18
 1500  0000000                   CH_PCM_TABLE_ADDR2_NM4                   EQU 14H ;  2, 20
 1501  0000000                   CH_INSERT_FLAG_NM4                       EQU 16H ;  1, 22
 1502  0000000                   CH_NEXT_SAMPLE_NM4                       EQU 17H ;  2, 23
 1503  0000000                   ; Size = 25  ==============================================
 1504  0000000                   
 1505  0000000                   ;Not support WITH_NM4S channel variables ========================
 1506  0000000                   CH_STATUS_MS                             EQU  0H ;  0,   0
 1507  0000000                   
 1508  0000000                   
 1509  0000000                   ;Support WITH_EVO channel variables ========================
 1510  0000000                   CH_STATUS_EVO                            EQU  0H ;  1,   0
 1511  0000000                   
 1512  0000000                   ;     RAM addresses =======================================
 1513  0000000                   GLOBAL_PLAY                              EQU  0H ;  1,   0
 1514  0000000                   COMMON_FLAG                              EQU  1H ;  1,   1
 1515  0000000                   COMMON_FLAG2                             EQU  2H ;  1,   2
 1516  0000000                   SPEN_TMP                                 EQU  3H ;  0,   3
 1517  0000000                   SUB_INDEX                                EQU  3H ;  0,   3
 1518  0000000                   COMMAND_OPERAND                          EQU  3H ;  1,   3
 1519  0000000                   RAMP_CHANNEL                             EQU  3H ;  1,   3
 1520  0000000                   RAMP_OPERAND                             EQU  3H ;  1,   3
 1521  0000000                   TEMP_REG1                                EQU  4H ;  2,   4
 1522  0000000                   TEMP_REG2                                EQU  6H ;  2,   6
 1523  0000000                   GLOBAL_VOL_SP0                           EQU  8H ;  1,   8
 1524  0000000                   GLOBAL_VOL_SP1                           EQU  8H ;  1,   8
 1525  0000000                   GLOBAL_VOL_SP2                           EQU  8H ;  1,   8
 1526  0000000                   GLOBAL_MASTER_VOL_MS                     EQU  8H ;  1,   8
 1527  0000000                   CH1_GLOBAL_TMC                           EQU  8H ;  1,   8
 1528  0000000                   CH1_GLOBAL_TMV                           EQU  8H ;  1,   8





 1529  0000000                   CH2_GLOBAL_TMC                           EQU  8H ;  1,   8
 1530  0000000                   CH2_GLOBAL_TMV                           EQU  8H ;  1,   8
 1531  0000000                   CH3_GLOBAL_TMC                           EQU  8H ;  1,   8
 1532  0000000                   CH3_GLOBAL_TMV                           EQU  8H ;  1,   8
 1533  0000000                   VS0A_START                               EQU  8H ;  0,   8
 1534  0000000                   VS0B_START                               EQU  8H ;  0,   8
 1535  0000000                   VS1A_START                               EQU  8H ; 25,   8
 1536  0000000                   VS1B_START                               EQU 21H ;  0,  33
 1537  0000000                   VS2A_START                               EQU 21H ;  0,  33
 1538  0000000                   VS2B_START                               EQU 21H ;  0,  33
 1539  0000000                   MS_START                                 EQU  8H ;  0,   8
 1540  0000000                   EVO0_START                               EQU 21H ;  0,  33
 1541  0000000                   EVO1_START                               EQU 21H ;  0,  33
 1542  0000000                   EVO2_START                               EQU 21H ;  0,  33
 1543  0000000                   CH_SYNTH_CHANNEL0                        EQU 21H ;  0,  33
 1544  0000000                   CH_SYNTH_CHANNEL1                        EQU 21H ;  0,  33
 1545  0000000                   CH_SYNTH_CHANNEL2                        EQU 21H ;  0,  33
 1546  0000000                   GLOBAL_CHANNEL_VOLM0                     EQU 21H ;  0,  33
 1547  0000000                   GLOBAL_CHANNEL_VOLM1                     EQU 21H ;  0,  33
 1548  0000000                   GLOBAL_CHANNEL_VOLM2                     EQU 21H ;  0,  33
 1549  0000000                   GLOBAL_CHANNEL_INS0                      EQU 21H ;  0,  33
 1550  0000000                   GLOBAL_CHANNEL_INS1                      EQU 21H ;  0,  33
 1551  0000000                   GLOBAL_CHANNEL_INS2                      EQU 21H ;  0,  33
 1552  0000000                   CH1_PLAY_SEGMENT                         EQU 21H ;  0,  33
 1553  0000000                   CH2_PLAY_SEGMENT                         EQU 21H ;  0,  33
 1554  0000000                   CH3_PLAY_SEGMENT                         EQU 21H ;  0,  33
 1555  0000000                   BP0M_BAK                                 EQU 21H ;  0,  33
 1556  0000000                   BP1M_BAK                                 EQU 21H ;  0,  33
 1557  0000000                   BP2M_BAK                                 EQU 21H ;  0,  33
 1558  0000000                   USER_START                               EQU 21H ; 33
 1559  0000000                   
 1560  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\SYNTHCONSTANT_EXTERNAL.INI.APP"
 1561  0000000                   	EXTERN TONE_MELODY_TYPE
 1562  0000000                   	EXTERN VMDPC8_MELODY_TYPE
 1563  0000000                   	EXTERN HQPC8_MELODY_TYPE
 1564  0000000                   	EXTERN PCSPC8_MELODY_TYPE
 1565  0000000                   	EXTERN END_MELODY_TYPE
 1566  0000000                   ;========================================================================	
 1567  0000000                   	EXTERN TONE_MELODY_TYPE_2
 1568  0000000                   	EXTERN VMDPC8_MELODY_TYPE_2
 1569  0000000                   	EXTERN HQPC8_MELODY_TYPE_2
 1570  0000000                   	EXTERN PCSPC8_MELODY_TYPE_2
 1571  0000000                   ;========================================================================
 1572  0000000                   	EXTERN RESTYPE_APM
 1573  0000000                   	EXTERN RESTYPE_PC8
 1574  0000000                   	EXTERN RESTYPE_P10
 1575  0000000                   	EXTERN RESTYPE_SIL
 1576  0000000                   	EXTERN RESTYPE_MDM
 1577  0000000                   	EXTERN RESTYPE_EMM
 1578  0000000                   	EXTERN RESTYPE_LP8
 1579  0000000                   	EXTERN RESTYPE_MD6
 1580  0000000                   	EXTERN RESTYPE_E2A
 1581  0000000                   	EXTERN RESTYPE_VC4
 1582  0000000                   	EXTERN RESTYPE_MD4		
 1583  0000000                   	EXTERN RESTYPE_MDR
 1584  0000000                   	EXTERN RESTYPE_NM4
 1585  0000000                   	EXTERN RESTYPE_NM4S	





 1586  0000000                   
 1587  0000000                   	EXTERN RESTYPE_EVO
 1588  0000000                   	EXTERN RESTYPE_MIDI0
 1589  0000000                   ;============================================================================
 1590  0000000                   	EXTERN CHANNEL_ID_START
 1591  0000000                   	EXTERN CHANNEL_VS0A
 1592  0000000                   	EXTERN CHANNEL_VS0B
 1593  0000000                   	EXTERN CHANNEL_VS0
 1594  0000000                   ;-------------------------------------------------------------------------
 1595  0000000                   	EXTERN CHANNEL_VS1A
 1596  0000000                   	EXTERN CHANNEL_VS1B
 1597  0000000                   	EXTERN CHANNEL_VS1
 1598  0000000                   ;-------------------------------------------------------------------------
 1599  0000000                   	EXTERN CHANNEL_VS2A
 1600  0000000                   	EXTERN CHANNEL_VS2B
 1601  0000000                   	EXTERN CHANNEL_VS2
 1602  0000000                   ;-------------------------------------------------------------------------
 1603  0000000                   	EXTERN CHANNEL_MS
 1604  0000000                   ;-------------------------------------------------------------------------
 1605  0000000                   	EXTERN CHANNEL_EVO0			
 1606  0000000                   	EXTERN CHANNEL_EVO1
 1607  0000000                   	EXTERN CHANNEL_EVO2
 1608  0000000                   ;-------------------------------------------------------------------------
 1609  0000000                   	EXTERN CHANNEL_NONE
 1610  0000000                   ;============================================================================
 1611  0000000                   	EXTERN CHANNEL_VS0A_2
 1612  0000000                   	EXTERN CHANNEL_VS0B_2
 1613  0000000                   	EXTERN CHANNEL_VS0_2
 1614  0000000                   	EXTERN CHANNEL_VS1A_2
 1615  0000000                   	EXTERN CHANNEL_VS1B_2
 1616  0000000                   	EXTERN CHANNEL_VS1_2
 1617  0000000                   	EXTERN CHANNEL_VS2A_2
 1618  0000000                   	EXTERN CHANNEL_VS2B_2
 1619  0000000                   	EXTERN CHANNEL_VS2_2
 1620  0000000                   	EXTERN CHANNEL_MS_2
 1621  0000000                   ;========================================================================
 1622  0000000                   ; Speech / melody channel flags
 1623  0000000                   ;========================================================================
 1624  0000000                   	EXTERN SP_BZ
 1625  0000000                   
 1626  0000000                   	EXTERN SP_DC_RAMP_UP_FOR_MS
 1627  0000000                   	EXTERN SP_INIT
 1628  0000000                   
 1629  0000000                   	EXTERN SP_NOTE
 1630  0000000                   
 1631  0000000                   	EXTERN SP_DC_RAMP_DOWN
 1632  0000000                   	EXTERN SP_EXT_NOTE
 1633  0000000                   
 1634  0000000                   	EXTERN SP_PAUSE
 1635  0000000                   
 1636  0000000                   	EXTERN SP_DECAY
 1637  0000000                   	EXTERN SP_RESUME
 1638  0000000                   
 1639  0000000                   	EXTERN SP_DC_RAMP_UP
 1640  0000000                   
 1641  0000000                   	EXTERN SP_ADSR
 1642  0000000                   	EXTERN SP_DRUM





 1643  0000000                   	EXTERN SP_AUD
 1644  0000000                   ;---------------------------------------------------------------------------------------
 1645  0000000                   ; Melody flags
 1646  0000000                   ;---------------------------------------------------------------------------------------
 1647  0000000                   	EXTERN MS_BZ
 1648  0000000                   
 1649  0000000                   	EXTERN MS_DC_RAMP_UP
 1650  0000000                   	EXTERN MS_COMD_PHRASE
 1651  0000000                   
 1652  0000000                   	EXTERN MS_LE
 1653  0000000                   
 1654  0000000                   	EXTERN MS_PS
 1655  0000000                   	EXTERN MS_PAUSE
 1656  0000000                   
 1657  0000000                   	EXTERN MS_DC_RAMP_DOWN
 1658  0000000                   	EXTERN MS_COMD_EVENT
 1659  0000000                   
 1660  0000000                   	EXTERN MS_STOP
 1661  0000000                   
 1662  0000000                   	EXTERN MS_CNP
 1663  0000000                   ;---------------------------------------------------------------------------------------
 1664  0000000                   ; EVO flags
 1665  0000000                   ;---------------------------------------------------------------------------------------
 1666  0000000                   	EXTERN EVO_BZ
 1667  0000000                   
 1668  0000000                   	EXTERN EVO_PAUSE
 1669  0000000                   
 1670  0000000                   	EXTERN EVO_EVENT_TYPE
 1671  0000000                   	EXTERN EVO_NOP_EVENT
 1672  0000000                   	EXTERN EVO_COMD_EVENT
 1673  0000000                   	EXTERN EVO_STOP_EVENT
 1674  0000000                   ;=========================================GLOBAL_PLAY bits
 1675  0000000                   	EXTERN SP1_BZ
 1676  0000000                   	EXTERN SP2_BZ
 1677  0000000                   	EXTERN SP3_BZ
 1678  0000000                   	EXTERN EVO1_BZ
 1679  0000000                   	EXTERN EVO2_BZ
 1680  0000000                   	EXTERN EVO3_BZ
 1681  0000000                   	EXTERN MIDI_BZ
 1682  0000000                   	EXTERN MS_EXT
 1683  0000000                   ;========================================COMMON_FLAG bits
 1684  0000000                   	EXTERN TAIL_OFF_DAC
 1685  0000000                   ;	EXTERN NOISE_SHAPING_FLAG	
 1686  0000000                   ;========================================================================
 1687  0000000                   ;ENV_STATE_HOLD 					EQ 0
 1688  0000000                   	EXTERN ENV_STATE_ATTACK
 1689  0000000                   	EXTERN ENV_STATE_DECAY
 1690  0000000                   	EXTERN ENV_STATE_SUSTAIN
 1691  0000000                   	EXTERN ENV_STATE_RELEASE
 1692  0000000                   
 1693  0000000                   ;========================================================================
 1694  0000000                   	EXTERN HEAD_TAIL_STEP_COUNT
 1695  0000000                   	EXTERN PLAY_PHRASE_LEN
 1696  0000000                   	EXTERN PLAY_PHRASE_MDR_LEN
 1697  0000000                   ;===========================================================================
 1698  0000000                   	EXTERN DRUM_CHANNEL_ID
 1699  0000000                   





 1700  0000000                   	EXTERN SP_CH0
 1701  0000000                   	EXTERN SP_CH1
 1702  0000000                   	EXTERN SP_CH2
 1703  0000000                   
 1704  0000000                   	EXTERN MS_CH0
 1705  0000000                   	EXTERN MS_CH1
 1706  0000000                   	EXTERN MS_CH2
 1707  0000000                   ;===========================================================================
 1708  0000000                   	EXTERN SPEECH_TYPE
 1709  0000000                   	EXTERN EVO_TYPE
 1710  0000000                   	EXTERN GLOBAL_SR_FLAG
 1711  0000000                   	EXTERN GLOBAL_VOL_FLAG
 1712  0000000                   	EXTERN GLOBAL_VOL_MS_FLAG
 1713  0000000                   
 1714  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\MACROS.INI.APP"
 1715  0000000                   A_TOGGLE						EQU	00100000B
 1716  0000000                   I_TOGGLE						EQU	00010000B
 1717  0000000                   AI_TOGGLE						EQU	00110000B
 1718  0000000                   ;===============================================================
 1719  0000000                   ;
 1720  0000000                   ;===============================================================
 1721  0000000                   LDA_DP MACRO VAR_ADDR				
 1722  0000000                   	LDA <VAR_ADDR
 1723  0000000                   	ENDM
 1724  0000000                   ;------------------------------------------------------------------------------
 1725  0000000                   LDA_DP_CH MACRO VAR_ADDR				
 1726  0000000                   	LDA <CHANNEL_ADDR+VAR_ADDR
 1727  0000000                   	ENDM
 1728  0000000                   ;------------------------------------------------------------------------------
 1729  0000000                   LDA_DP_X MACRO VAR_ADDR				
 1730  0000000                   	LDA <VAR_ADDR,X
 1731  0000000                   	ENDM
 1732  0000000                   ;------------------------------------------------------------------------------
 1733  0000000                   LDA_DP_X_CH MACRO VAR_ADDR
 1734  0000000                   	LDA_DP_X CHANNEL_ADDR+VAR_ADDR		
 1735  0000000                   	ENDM
 1736  0000000                   ;------------------------------------------------------------------------------
 1737  0000000                   LDA_AI_Y_CH MACRO VAR_ADDR				
 1738  0000000                   	LDA !DIRECT_PAGE+CHANNEL_ADDR+VAR_ADDR,Y
 1739  0000000                   	ENDM
 1740  0000000                   ;------------------------------------------------------------------------------
 1741  0000000                   LDA_DP_ILI MACRO VAR_ADDR	
 1742  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1743  0000000                   ;	LDA [<VAR_ADDR]
 1744  0000000                   ;	.ELSE
 1745  0000000                   	LDA <VAR_ADDR+2
 1746  0000000                   	STA !BANK
 1747  0000000                   	LDA (<VAR_ADDR)
 1748  0000000                   ;	.ENDIF
 1749  0000000                   	ENDM
 1750  0000000                   ;------------------------------------------------------------------------------
 1751  0000000                   LDA_DP_ILI_Y MACRO VAR_ADDR	
 1752  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1753  0000000                   ;	LDA [<VAR_ADDR],Y
 1754  0000000                   ;	.ELSE
 1755  0000000                   	LDA <VAR_ADDR+2
 1756  0000000                   	STA !BANK





 1757  0000000                   	LDA (<VAR_ADDR),Y
 1758  0000000                   ;	.ENDIF
 1759  0000000                   	ENDM
 1760  0000000                   ;------------------------------------------------------------------------------
 1761  0000000                   LDA_DP_ILI_CH MACRO	VAR_ADDR		
 1762  0000000                   	LDA_DP_ILI_SIM CHANNEL_ADDR+VAR_ADDR
 1763  0000000                   	ENDM
 1764  0000000                   ;===============================================================
 1765  0000000                   LDX_DP_CH MACRO VAR_ADDR				
 1766  0000000                   	LDX <CHANNEL_ADDR+VAR_ADDR
 1767  0000000                   	ENDM
 1768  0000000                   
 1769  0000000                   ;===============================================================
 1770  0000000                   LDY_DP_CH MACRO VAR_ADDR				
 1771  0000000                   	LDY <CHANNEL_ADDR+VAR_ADDR
 1772  0000000                   	ENDM
 1773  0000000                   
 1774  0000000                   ;===============================================================
 1775  0000000                   STY_DP_CH MACRO VAR_ADDR				
 1776  0000000                   	STY <CHANNEL_ADDR+VAR_ADDR
 1777  0000000                   	ENDM
 1778  0000000                   ;===============================================================
 1779  0000000                   STX_DP_CH MACRO VAR_ADDR				
 1780  0000000                   	STX <CHANNEL_ADDR+VAR_ADDR
 1781  0000000                   	ENDM
 1782  0000000                   
 1783  0000000                   ;===============================================================
 1784  0000000                   ;
 1785  0000000                   ;===============================================================
 1786  0000000                   STA_DP MACRO VAR_ADDR				
 1787  0000000                   	STA <VAR_ADDR
 1788  0000000                   	ENDM
 1789  0000000                   ;------------------------------------------------------------------------------
 1790  0000000                   STA_DP_CH MACRO VAR_ADDR				
 1791  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR
 1792  0000000                   	ENDM
 1793  0000000                   ;------------------------------------------------------------------------------
 1794  0000000                   STA_DP_X MACRO VAR_ADDR				
 1795  0000000                   	STA <VAR_ADDR,X
 1796  0000000                   	ENDM
 1797  0000000                   ;------------------------------------------------------------------------------
 1798  0000000                   STA_DP_X_CH MACRO VAR_ADDR
 1799  0000000                   	STA_DP_X CHANNEL_ADDR+VAR_ADDR
 1800  0000000                   	ENDM
 1801  0000000                   
 1802  0000000                   ;------------------------------------------------------------------------------
 1803  0000000                   ; MACRO TO DEFINED ACCESS RAM
 1804  0000000                   ;------------------------------------------------------------------------------
 1805  0000000                   
 1806  0000000                   SYNTH_LABEL MACRO LABEL,CHANNEL_NAME
 1807  0000000                   .IFNDEF WITH_USER_PLAY
 1808  0000000                   CHANNEL_ADDR 		EQU CHANNEL_NAME|_START
 1809  0000000                   ;CHANNEL_ID			EQU CHANNEL_|CHANNEL_NAME
 1810  0000000                   START_CHANNEL_ID 	EQU CHANNEL_|CHANNEL_NAME
 1811  0000000                   START_CHANNEL_ID_2 	EQU CHANNEL_|CHANNEL_NAME|_2
 1812  0000000                   .IF (CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
 1813  0000000                   START_SIM_BUF		EQU	SP_START_SIM_BUF_|CHANNEL_NAME





 1814  0000000                   .ENDIF
 1815  0000000                   .ENDIF
 1816  0000000                   	PUBLIC	LABEL|_|CHANNEL_NAME
 1817  0000000                   LABEL|_|CHANNEL_NAME:					;STATE IS NOW X X X 0 0 0 1 BZ
 1818  0000000                   
 1819  0000000                   	ENDM
 1820  0000000                   
 1821  0000000                   ;================================================================================
 1822  0000000                   SYNTH_LABEL_EVO MACRO LABEL,CHANNEL_NAME
 1823  0000000                   
 1824  0000000                   CHANNEL_ADDR 		EQU CHANNEL_NAME|_START
 1825  0000000                   START_CHANNEL_ID 	EQU CHANNEL_|CHANNEL_NAME
 1826  0000000                   ;START_CHANNEL_ID_2 	EQU CHANNEL_|CHANNEL_NAME|_2
 1827  0000000                   
 1828  0000000                   	PUBLIC	LABEL|_|CHANNEL_NAME
 1829  0000000                   LABEL|_|CHANNEL_NAME:					;STATE IS NOW X X X 0 0 0 1 BZ
 1830  0000000                   
 1831  0000000                   	ENDM
 1832  0000000                   ;===============================================================
 1833  0000000                   STA_ISR MACRO ISR_ADDR,FORMAT_CHANNEL
 1834  0000000                   	LDA #.LOW.ISR_ADDR
 1835  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 1836  0000000                   	LDA #.HIGH.ISR_ADDR
 1837  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 1838  0000000                   	ENDM
 1839  0000000                   ;------------------------------------------------------------------------------
 1840  0000000                   STA_ISR_SKIP MACRO ISR_ADDR,FORMAT_CHANNEL
 1841  0000000                   	EXTERN SP_SKIP_SEGMENT_PROC
 1842  0000000                   	LDA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 1843  0000000                   	CMP #.LOW.SP_SKIP_SEGMENT_PROC
 1844  0000000                   	BNE STA_ISR_SKIP_NEXT#
 1845  0000000                   	LDA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 1846  0000000                   	CMP #.HIGH.SP_SKIP_SEGMENT_PROC
 1847  0000000                   	BEQ STA_ISR_SKIP_END#
 1848  0000000                   
 1849  0000000                   STA_ISR_SKIP_NEXT#:
 1850  0000000                   	LDA #.LOW.ISR_ADDR
 1851  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 1852  0000000                   	LDA #.HIGH.ISR_ADDR
 1853  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 1854  0000000                   STA_ISR_SKIP_END#:
 1855  0000000                   	ENDM
 1856  0000000                   ;------------------------------------------------------------------------------
 1857  0000000                   STA_ISR_X MACRO ISR_ADDR,FORMAT_CHANNEL
 1858  0000000                   	LDA #.LOW.ISR_ADDR
 1859  0000000                   	STA <CH_ISR_SYNTH_START|FORMAT_CHANNEL,X
 1860  0000000                   	LDA #.HIGH.ISR_ADDR
 1861  0000000                   	STA <CH_ISR_SYNTH_START|FORMAT_CHANNEL+1,X
 1862  0000000                   	ENDM
 1863  0000000                   
 1864  0000000                   ;===============================================================
 1865  0000000                   ;
 1866  0000000                   ;===============================================================
 1867  0000000                   ORA_DP_CH MACRO VAR_ADDR
 1868  0000000                   	ORA <CHANNEL_ADDR+VAR_ADDR
 1869  0000000                   	ENDM
 1870  0000000                   





 1871  0000000                   ;===============================================================
 1872  0000000                   ;
 1873  0000000                   ;===============================================================
 1874  0000000                   INC_DP_CH MACRO VAR_ADDR
 1875  0000000                   	INC <CHANNEL_ADDR+VAR_ADDR
 1876  0000000                   	ENDM
 1877  0000000                   
 1878  0000000                   ;===============================================================
 1879  0000000                   ;
 1880  0000000                   ;===============================================================
 1881  0000000                   ASL_DP_CH MACRO VAR_ADDR
 1882  0000000                   	ASL <CHANNEL_ADDR+VAR_ADDR
 1883  0000000                   	ENDM
 1884  0000000                   ;===============================================================
 1885  0000000                   ROL_DP_CH MACRO VAR_ADDR
 1886  0000000                   	ROL <CHANNEL_ADDR+VAR_ADDR
 1887  0000000                   	ENDM
 1888  0000000                   
 1889  0000000                   ;===============================================================
 1890  0000000                   ;
 1891  0000000                   ;===============================================================
 1892  0000000                   LSR_DP_CH MACRO VAR_ADDR
 1893  0000000                   	LSR <CHANNEL_ADDR+VAR_ADDR
 1894  0000000                   	ENDM
 1895  0000000                   
 1896  0000000                   ;===============================================================
 1897  0000000                   ;
 1898  0000000                   ;===============================================================
 1899  0000000                   ROR_DP_CH MACRO VAR_ADDR
 1900  0000000                   	ROR <CHANNEL_ADDR+VAR_ADDR
 1901  0000000                   	ENDM
 1902  0000000                   
 1903  0000000                   ;===============================================================
 1904  0000000                   ;
 1905  0000000                   ;===============================================================
 1906  0000000                   CMP_DP_CH MACRO VAR_ADDR
 1907  0000000                   	CMP <CHANNEL_ADDR+VAR_ADDR
 1908  0000000                   	ENDM
 1909  0000000                   
 1910  0000000                   ;===============================================================
 1911  0000000                   CPX_DP_CH MACRO VAR_ADDR
 1912  0000000                   	CPX <CHANNEL_ADDR+VAR_ADDR
 1913  0000000                   	ENDM
 1914  0000000                   
 1915  0000000                   ;===============================================================
 1916  0000000                   CPY_DP_CH MACRO VAR_ADDR
 1917  0000000                   	CPY <CHANNEL_ADDR+VAR_ADDR
 1918  0000000                   	ENDM
 1919  0000000                   
 1920  0000000                   ;===============================================================
 1921  0000000                   ;
 1922  0000000                   ;===============================================================
 1923  0000000                   ADC_DP_CH MACRO VAR_ADDR
 1924  0000000                   	ADC <CHANNEL_ADDR+VAR_ADDR
 1925  0000000                   	ENDM
 1926  0000000                   
 1927  0000000                   ;===============================================================





 1928  0000000                   ;
 1929  0000000                   ;===============================================================
 1930  0000000                   AND_DP_CH MACRO VAR_ADDR
 1931  0000000                   	AND <CHANNEL_ADDR+VAR_ADDR
 1932  0000000                   	ENDM
 1933  0000000                   
 1934  0000000                   ;===============================================================
 1935  0000000                   ;
 1936  0000000                   ;===============================================================
 1937  0000000                   STZ_DP_CH MACRO VAR_ADDR
 1938  0000000                   	STZ <CHANNEL_ADDR+VAR_ADDR
 1939  0000000                   	ENDM
 1940  0000000                   
 1941  0000000                   ;===============================================================
 1942  0000000                   ;
 1943  0000000                   ;===============================================================
 1944  0000000                   BIT_DP_CH MACRO VAR_ADDR
 1945  0000000                   	BIT <CHANNEL_ADDR+VAR_ADDR
 1946  0000000                   	ENDM
 1947  0000000                   ;===============================================================
 1948  0000000                   ;
 1949  0000000                   ;===============================================================
 1950  0000000                   TRB_DP_CH MACRO VAR_ADDR
 1951  0000000                   	TRB <CHANNEL_ADDR+VAR_ADDR
 1952  0000000                   	ENDM
 1953  0000000                   ;===============================================================
 1954  0000000                   TSB_DP_CH MACRO VAR_ADDR
 1955  0000000                   	TSB <CHANNEL_ADDR+VAR_ADDR
 1956  0000000                   	ENDM
 1957  0000000                   ;===============================================================
 1958  0000000                   ;
 1959  0000000                   ;===============================================================
 1960  0000000                   DEC_DP_CH MACRO VAR_ADDR
 1961  0000000                   	DEC <CHANNEL_ADDR+VAR_ADDR
 1962  0000000                   	ENDM
 1963  0000000                   
 1964  0000000                   ;===============================================================
 1965  0000000                   ;
 1966  0000000                   ;===============================================================
 1967  0000000                   EOR_DP_CH MACRO VAR_ADDR
 1968  0000000                   	EOR <CHANNEL_ADDR+VAR_ADDR
 1969  0000000                   	ENDM
 1970  0000000                   
 1971  0000000                   ;===============================================================
 1972  0000000                   ;
 1973  0000000                   ;===============================================================
 1974  0000000                   SBC_DP_CH MACRO VAR_ADDR
 1975  0000000                   	SBC <CHANNEL_ADDR+VAR_ADDR
 1976  0000000                   	ENDM
 1977  0000000                   
 1978  0000000                   ;------------------------------------------------------------------------------
 1979  0000000                   SBC_DP_ILI_Y MACRO VAR_ADDR	
 1980  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1981  0000000                   ;	SBC [<VAR_ADDR],Y
 1982  0000000                   ;	.ELSE
 1983  0000000                   	LDA <VAR_ADDR+2
 1984  0000000                   	STA !BANK





 1985  0000000                   	SBC (<VAR_ADDR),Y
 1986  0000000                   ;	.ENDIF
 1987  0000000                   	ENDM
 1988  0000000                   
 1989  0000000                   ;------------------------------------------------------------------------------
 1990  0000000                   SBC_DP_ILI_Y_CH MACRO VAR_ADDR	
 1991  0000000                   	SBC_DP_ILI_Y CHANNEL_ADDR+VAR_ADDR	
 1992  0000000                   	ENDM
 1993  0000000                   ;------------------------------------------------------------------------------
 1994  0000000                   ADC_DP_ILI_Y MACRO VAR_ADDR	
 1995  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 1996  0000000                   ;	ADC [<VAR_ADDR],Y
 1997  0000000                   ;	.ELSE
 1998  0000000                   	LDA <VAR_ADDR+2
 1999  0000000                   	STA !BANK
 2000  0000000                   	ADC (<VAR_ADDR),Y
 2001  0000000                   ;	.ENDIF
 2002  0000000                   	ENDM
 2003  0000000                   
 2004  0000000                   ;------------------------------------------------------------------------------
 2005  0000000                   ADC_DP_ILI_Y_CH MACRO VAR_ADDR	
 2006  0000000                   	ADC_DP_ILI_Y CHANNEL_ADDR+VAR_ADDR
 2007  0000000                   	ENDM
 2008  0000000                   
 2009  0000000                   ;------------------------------------------------------------------------------
 2010  0000000                   ADC_DP_ILI MACRO VAR_ADDR	
 2011  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2012  0000000                   ;	ADC [<VAR_ADDR]
 2013  0000000                   ;	.ELSE
 2014  0000000                   	LDA <VAR_ADDR+2
 2015  0000000                   	STA !BANK
 2016  0000000                   	ADC (<VAR_ADDR)
 2017  0000000                   ;	.ENDIF
 2018  0000000                   	ENDM
 2019  0000000                   ;------------------------------------------------------------------------------
 2020  0000000                   LDA_DP_ILI_CH_DATA_HQ MACRO CHANNEL_NAME
 2021  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2022  0000000                   	STZ !BANK1
 2023  0000000                   	.ENDIF
 2024  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME+2
 2025  0000000                   	STA !BANK
 2026  0000000                   	LDA (<CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME)
 2027  0000000                   	ENDM
 2028  0000000                   ;------------------------------------------------------------------------------
 2029  0000000                   LDA_DP_ILI_CH_DATA MACRO CHANNEL_NAME
 2030  0000000                   .IFNDEF WITH_USER_PLAY
 2031  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2032  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1|CHANNEL_NAME
 2033  0000000                   	AND #03H
 2034  0000000                   	STA !BANK1
 2035  0000000                   	.ENDIF
 2036  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK|CHANNEL_NAME
 2037  0000000                   	SW_CS
 2038  0000000                   	STA !BANK
 2039  0000000                   	LDA (<CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME)
 2040  0000000                   .ELSE
 2041  0000000                   	LDX <CHANNEL_ADDR+CH_DATA_INDEX|CHANNEL_NAME





 2042  0000000                   	LDA <USER_PLAY_BUF,X
 2043  0000000                   .ENDIF
 2044  0000000                   	ENDM
 2045  0000000                   
 2046  0000000                   ;------------------------------------------------------------------------------
 2047  0000000                   LDA_DP_ILI_CH_DATA_MS MACRO 
 2048  0000000                   	LDA_DP_ILI_CH_DATA _MS
 2049  0000000                   	ENDM
 2050  0000000                   
 2051  0000000                   ;------------------------------------------------------------------------------
 2052  0000000                   LDA_DP_ILI_Y_CH MACRO	VAR_ADDR
 2053  0000000                   	LDA_DP_ILI_Y_SIM CHANNEL_ADDR+VAR_ADDR
 2054  0000000                   	ENDM
 2055  0000000                   
 2056  0000000                   ;===============================================================
 2057  0000000                   ;DESIGNATION
 2058  0000000                   ;===============================================================
 2059  0000000                   LDA_DP_II_Y MACRO	VAR_ADDR
 2060  0000000                   	LDA (<VAR_ADDR),Y
 2061  0000000                   	ENDM
 2062  0000000                   
 2063  0000000                   LDA_DP_II_Y_CH MACRO	VAR_ADDR
 2064  0000000                   	LDA (<CHANNEL_ADDR+VAR_ADDR),Y
 2065  0000000                   	ENDM
 2066  0000000                   
 2067  0000000                   ;------------------------------------------------------------------------------
 2068  0000000                   LDA_DP_II MACRO	VAR_ADDR
 2069  0000000                   	LDA (<VAR_ADDR)
 2070  0000000                   	ENDM
 2071  0000000                   
 2072  0000000                   LDA_DP_II_CH MACRO	VAR_ADDR
 2073  0000000                   	LDA (<CHANNEL_ADDR+VAR_ADDR)
 2074  0000000                   	ENDM
 2075  0000000                   
 2076  0000000                   ;------------------------------------------------------------------------------
 2077  0000000                   ADC_DP_II_Y_CH MACRO	VAR_ADDR
 2078  0000000                   	ADC (<CHANNEL_ADDR+VAR_ADDR),Y
 2079  0000000                   	ENDM
 2080  0000000                   
 2081  0000000                   ;------------------------------------------------------------------------------
 2082  0000000                   SBC_DP_II_Y_CH MACRO	VAR_ADDR
 2083  0000000                   	SBC (<CHANNEL_ADDR+VAR_ADDR),Y
 2084  0000000                   	ENDM
 2085  0000000                   ;===============================================================
 2086  0000000                   ;
 2087  0000000                   ;===============================================================
 2088  0000000                   JMP_QUIT_ISR MACRO
 2089  0000000                   ;	.IF (WITH_VS0B .EQ. 1)
 2090  0000000                   ;	LDX #START_CHANNEL_ID_2
 2091  0000000                   ;	JMP (SP_CHANNEL_QUIT_TABLE,X)
 2092  0000000                   ;	.ELSE
 2093  0000000                   ;	EXTERN		QUIT_LIB_ISR
 2094  0000000                   	.IFNDEF WITH_USER_PLAY
 2095  0000000                   	JMP QUIT_LIB_ISR
 2096  0000000                   	.ELSE
 2097  0000000                   	JMP QUIT_USER_PLAY
 2098  0000000                   	.ENDIF





 2099  0000000                   ;	.ENDIF
 2100  0000000                   	ENDM
 2101  0000000                   
 2102  0000000                   ;===============================================================
 2103  0000000                   ;
 2104  0000000                   ;===============================================================
 2105  0000000                   JMP_QUIT_ISR_CHANNEL_X MACRO
 2106  0000000                   ;	.IF (WITH_VS0B .EQ. 1)
 2107  0000000                   ;		EXTERN SP_CHANNEL_QUIT_TABLE
 2108  0000000                   ;		JMP (SP_CHANNEL_QUIT_TABLE,X)
 2109  0000000                   ;	.ELSE
 2110  0000000                   ;		EXTERN		QUIT_LIB_ISR
 2111  0000000                   		JMP QUIT_LIB_ISR
 2112  0000000                   ;	.ENDIF
 2113  0000000                   ENDM
 2114  0000000                   ;===============================================================
 2115  0000000                   ;
 2116  0000000                   ;===============================================================
 2117  0000000                   ; Internal called only in Macros.ini
 2118  0000000                   INC_ADDR_DP MACRO VAR_ADDR
 2119  0000000                   	INC <VAR_ADDR
 2120  0000000                   	BNE INC_ADDR_CH_END_#
 2121  0000000                   
 2122  0000000                   	INC <VAR_ADDR+1
 2123  0000000                   	LDA <VAR_ADDR+1
 2124  0000000                   	AND #7FH
 2125  0000000                   	BNE INC_ADDR_CH_END_#
 2126  0000000                   CROSS_BANK_#:
 2127  0000000                   	LDA #80H
 2128  0000000                   	STA <VAR_ADDR+1
 2129  0000000                   	INC <VAR_ADDR+2
 2130  0000000                   
 2131  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2132  0000000                   	BNE INC_ADDR_CH_END_#
 2133  0000000                   	INC <VAR_ADDR+3
 2134  0000000                   	.ENDIF
 2135  0000000                   
 2136  0000000                   INC_ADDR_CH_END_#:
 2137  0000000                   	ENDM
 2138  0000000                   ;------------------------------------------------------------------------------
 2139  0000000                   INC_DATA_ADDR_CH	MACRO	FORMAT
 2140  0000000                   .IFNDEF WITH_USER_PLAY
 2141  0000000                   	INC_ADDR_DP CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2142  0000000                   .ELSE
 2143  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_INDEX|FORMAT
 2144  0000000                   	CMP #(USER_PLAY_BUF_SIZE-1)
 2145  0000000                   	BCC NOT_RESET_BUF_INDEX#
 2146  0000000                   	STZ <CHANNEL_ADDR+CH_DATA_INDEX|FORMAT
 2147  0000000                   	BRA END_INC_DATA_ADDR_CH#
 2148  0000000                   
 2149  0000000                   NOT_RESET_BUF_INDEX#:
 2150  0000000                   	INC <CHANNEL_ADDR+CH_DATA_INDEX|FORMAT
 2151  0000000                   
 2152  0000000                   END_INC_DATA_ADDR_CH#:
 2153  0000000                   .ENDIF
 2154  0000000                   	ENDM
 2155  0000000                   ;------------------------------------------------------------------------------





 2156  0000000                   INC_DATA_ADDR_HQ	MACRO	FORMAT
 2157  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2158  0000000                   	BNE INC_DATA_ADDR_HQ_END_#
 2159  0000000                   
 2160  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2161  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2162  0000000                   	AND #7FH
 2163  0000000                   	BNE INC_DATA_ADDR_HQ_END_#
 2164  0000000                   CROSS_BANK_#:
 2165  0000000                   	LDA #80H
 2166  0000000                   	STA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2167  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+2
 2168  0000000                   INC_DATA_ADDR_HQ_END_#:
 2169  0000000                   	ENDM
 2170  0000000                   ;===============================================================
 2171  0000000                   DEC_ADDR_DP MACRO VAR_ADDR
 2172  0000000                   	DEC <VAR_ADDR
 2173  0000000                   	LDA <VAR_ADDR
 2174  0000000                   	CMP #FFH
 2175  0000000                   	BNE DEC_ADDR_CH_END_#
 2176  0000000                   
 2177  0000000                   	DEC <VAR_ADDR+1
 2178  0000000                   	LDA <VAR_ADDR+1
 2179  0000000                   	CMP #7FH
 2180  0000000                   	BNE DEC_ADDR_CH_END_#
 2181  0000000                   
 2182  0000000                   	LDA #FFH
 2183  0000000                   	STA <VAR_ADDR+1
 2184  0000000                   	DEC <VAR_ADDR+2
 2185  0000000                   
 2186  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2187  0000000                   	LDA <VAR_ADDR+2
 2188  0000000                   	CMP #FFH
 2189  0000000                   	BNE IS_BANK_0000#
 2190  0000000                   
 2191  0000000                   	DEC <VAR_ADDR+3
 2192  0000000                   	BRA DEC_ADDR_CH_END_#
 2193  0000000                   	.ENDIF
 2194  0000000                   
 2195  0000000                   IS_BANK_0000#:
 2196  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2197  0000000                   	LDA <VAR_ADDR+2
 2198  0000000                   	.ENDIF
 2199  0000000                   	BNE DEC_ADDR_CH_END_#
 2200  0000000                   
 2201  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2202  0000000                   	LDA <VAR_ADDR+3
 2203  0000000                   	AND #03H
 2204  0000000                   	BNE DEC_ADDR_CH_END_#
 2205  0000000                   	.ENDIF
 2206  0000000                   
 2207  0000000                       LDA #7FH
 2208  0000000                   	STA <VAR_ADDR+1,X
 2209  0000000                   
 2210  0000000                   DEC_ADDR_CH_END_#:
 2211  0000000                   	ENDM
 2212  0000000                   ;------------------------------------------------------------------------------





 2213  0000000                   DEC_DATA_ADDR_CH	MACRO	FORMAT
 2214  0000000                   	DEC_ADDR_DP CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2215  0000000                   	ENDM
 2216  0000000                   ;------------------------------------------------------------------------------
 2217  0000000                   ; X: CHANNEL ADDR.
 2218  0000000                   ; note: INC_NUM cannot over 256D
 2219  0000000                   ;------------------------------------------------------------------------------
 2220  0000000                   ADC_ADDR_II_X	MACRO	VAR_ADDR, INC_NUM
 2221  0000000                   	LDA <VAR_ADDR,X
 2222  0000000                   	CLC
 2223  0000000                   	ADC	#INC_NUM
 2224  0000000                   	STA <VAR_ADDR,X
 2225  0000000                   	BCC ADC_ADDR_CH_#
 2226  0000000                   
 2227  0000000                   	INC <VAR_ADDR+1,X
 2228  0000000                   	LDA <VAR_ADDR+1,X
 2229  0000000                   	AND #7FH
 2230  0000000                   	BNE ADC_ADDR_CH_#
 2231  0000000                   CROSS_BANK_#:
 2232  0000000                   	LDA #80H
 2233  0000000                   	STA <VAR_ADDR+1,X
 2234  0000000                   	INC <VAR_ADDR+2,X
 2235  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2236  0000000                   	BNE ADC_ADDR_CH_#
 2237  0000000                   	INC <VAR_ADDR+3,X
 2238  0000000                   	.ENDIF
 2239  0000000                   ADC_ADDR_CH_#
 2240  0000000                   	ENDM
 2241  0000000                   ;------------------------------------------------------------------------------
 2242  0000000                   ADC_ADDR_II_A_X	MACRO	VAR_ADDR
 2243  0000000                   	CLC
 2244  0000000                   	ADC	<VAR_ADDR,X
 2245  0000000                   	STA <VAR_ADDR,X
 2246  0000000                   	BCC ADC_ADDR_CH_#
 2247  0000000                   
 2248  0000000                   	INC <VAR_ADDR+1,X
 2249  0000000                   	LDA <VAR_ADDR+1,X
 2250  0000000                   	AND #7FH
 2251  0000000                   	BNE ADC_ADDR_CH_#
 2252  0000000                   CROSS_BANK_#:
 2253  0000000                   	LDA #80H
 2254  0000000                   	STA <VAR_ADDR+1,X
 2255  0000000                   	INC <VAR_ADDR+2,X
 2256  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2257  0000000                   	BNE ADC_ADDR_CH_#
 2258  0000000                   	INC <VAR_ADDR+3,X
 2259  0000000                   	.ENDIF
 2260  0000000                   ADC_ADDR_CH_#
 2261  0000000                   	ENDM
 2262  0000000                   ;------------------------------------------------------------------------------
 2263  0000000                   ADC_ADDR_A_X_SENTENCE	MACRO	VAR_ADDR, VAR_ADDR2
 2264  0000000                   	CLC
 2265  0000000                   	ADC	<VAR_ADDR,X
 2266  0000000                   	STA <VAR_ADDR,X
 2267  0000000                   	BCC ADC_ADDR_A_X_SENTENCE_END_#
 2268  0000000                   
 2269  0000000                   	INC <VAR_ADDR+1,X





 2270  0000000                   	LDA <VAR_ADDR+1,X
 2271  0000000                   	AND #7FH
 2272  0000000                   	BNE ADC_ADDR_A_X_SENTENCE_END_#
 2273  0000000                   CROSS_BANK_#:
 2274  0000000                   	LDA #80H
 2275  0000000                   	STA <VAR_ADDR+1,X
 2276  0000000                   	INC <VAR_ADDR+2,X
 2277  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2278  0000000                   	BNE ADC_ADDR_A_X_SENTENCE_END_#
 2279  0000000                   
 2280  0000000                   	CLC
 2281  0000000                   	LDA <VAR_ADDR2+1,X
 2282  0000000                   	ADC	#04H
 2283  0000000                   	STA <VAR_ADDR2+1,X
 2284  0000000                   
 2285  0000000                   	LSR A
 2286  0000000                   	LSR A
 2287  0000000                   	STA !BANK1
 2288  0000000                   	.ENDIF
 2289  0000000                   ADC_ADDR_A_X_SENTENCE_END_#
 2290  0000000                   	ENDM
 2291  0000000                   ;------------------------------------------------------------------------------
 2292  0000000                   ADC_ADDR_MS_SENTENCE	MACRO	VAR_ADDR, VAR_ADDR2
 2293  0000000                   	CLC
 2294  0000000                   	ADC	<CHANNEL_ADDR+VAR_ADDR
 2295  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR
 2296  0000000                   	BCC ADC_ADDR_MS_SENTENCE_END_#
 2297  0000000                   
 2298  0000000                   	INC <CHANNEL_ADDR+VAR_ADDR+1
 2299  0000000                   	LDA <CHANNEL_ADDR+VAR_ADDR+1
 2300  0000000                   	AND #7FH
 2301  0000000                   	BNE ADC_ADDR_MS_SENTENCE_END_#
 2302  0000000                   CROSS_BANK_#:
 2303  0000000                   	LDA #80H
 2304  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR+1
 2305  0000000                   	INC <CHANNEL_ADDR+VAR_ADDR+2
 2306  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2307  0000000                   	BNE ADC_ADDR_MS_SENTENCE_END_#
 2308  0000000                   
 2309  0000000                   	CLC
 2310  0000000                   	LDA <CHANNEL_ADDR+VAR_ADDR2+1
 2311  0000000                   	ADC	#04H
 2312  0000000                   	STA <CHANNEL_ADDR+VAR_ADDR2+1
 2313  0000000                   
 2314  0000000                   	LSR A
 2315  0000000                   	LSR A
 2316  0000000                   	STA !BANK1
 2317  0000000                   	.ENDIF
 2318  0000000                   ADC_ADDR_MS_SENTENCE_END_#
 2319  0000000                   	ENDM
 2320  0000000                   ;------------------------------------------------------------------------------
 2321  0000000                   SBC_ADDR_II_X	MACRO	VAR_ADDR, SBC_NUM
 2322  0000000                   	LDA <VAR_ADDR,X
 2323  0000000                   	SEC
 2324  0000000                   	SBC	#SBC_NUM
 2325  0000000                   	STA <VAR_ADDR,X
 2326  0000000                   	BCS SBC_ADDR_CH_#





 2327  0000000                   
 2328  0000000                   	DEC <VAR_ADDR+1,X
 2329  0000000                   	LDA <VAR_ADDR+1,X
 2330  0000000                   	CMP #7FH
 2331  0000000                   	BNE SBC_ADDR_CH_#
 2332  0000000                   
 2333  0000000                   	LDA #FFH
 2334  0000000                   	STA <VAR_ADDR+1,X
 2335  0000000                   	DEC <VAR_ADDR+2,X
 2336  0000000                   
 2337  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2338  0000000                   	LDA <VAR_ADDR+2,X
 2339  0000000                   	CMP #FFH
 2340  0000000                   	BNE IS_BANK_0000#
 2341  0000000                   
 2342  0000000                   	DEC <VAR_ADDR+3,X
 2343  0000000                   	BRA SBC_ADDR_CH_#
 2344  0000000                   	.ENDIF
 2345  0000000                   
 2346  0000000                   IS_BANK_0000#:
 2347  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2348  0000000                   	LDA <VAR_ADDR+2,X
 2349  0000000                   	.ENDIF
 2350  0000000                   	BNE SBC_ADDR_CH_#
 2351  0000000                   
 2352  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2353  0000000                   	LDA <VAR_ADDR+3,X
 2354  0000000                   	AND #03H
 2355  0000000                   	BNE SBC_ADDR_CH_#
 2356  0000000                   	.ENDIF
 2357  0000000                   
 2358  0000000                       LDA #7FH
 2359  0000000                   	STA <VAR_ADDR+1,X
 2360  0000000                   
 2361  0000000                   SBC_ADDR_CH_#
 2362  0000000                   	ENDM
 2363  0000000                   ;------------------------------------------------------------------------------
 2364  0000000                   ; NOTE: INC_NUM MUST BE 0~255
 2365  0000000                   ;------------------------------------------------------------------------------
 2366  0000000                   ; Internal called only in Macros.ini
 2367  0000000                   ADC_ADDR_A	MACRO	VAR_ADDR
 2368  0000000                   	CLC
 2369  0000000                   	ADC <VAR_ADDR
 2370  0000000                   	STA <VAR_ADDR
 2371  0000000                   	BCC ADC_ADDR_A_END_#
 2372  0000000                   
 2373  0000000                   	INC <VAR_ADDR+1
 2374  0000000                   	LDA <VAR_ADDR+1
 2375  0000000                   	AND #7FH
 2376  0000000                   	BNE ADC_ADDR_A_END_#
 2377  0000000                   CROSS_BANK_#:
 2378  0000000                   	LDA #80H
 2379  0000000                   	STA <VAR_ADDR+1
 2380  0000000                   	INC <VAR_ADDR+2
 2381  0000000                   
 2382  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2383  0000000                   	BNE ADC_ADDR_A_END_#





 2384  0000000                   	INC <VAR_ADDR+3
 2385  0000000                   	.ENDIF
 2386  0000000                   
 2387  0000000                   ADC_ADDR_A_END_#
 2388  0000000                   	ENDM
 2389  0000000                   ;------------------------------------------------------------------------------
 2390  0000000                   ;for Winmelody,Percussion,VoiceMelogy
 2391  0000000                   ADC_DATA_ADDR_A_HQ	MACRO	FORMAT
 2392  0000000                   	CLC
 2393  0000000                   	ADC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2394  0000000                   	STA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2395  0000000                   	BCC ADC_DATA_ADDR_A_HQ_END_#
 2396  0000000                   
 2397  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2398  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2399  0000000                   	AND #7FH
 2400  0000000                   	BNE ADC_DATA_ADDR_A_HQ_END_#
 2401  0000000                   CROSS_BANK_#:
 2402  0000000                   	LDA #80H
 2403  0000000                   	STA <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+1
 2404  0000000                   	INC <CHANNEL_ADDR+CH_DATA_ADDR|FORMAT+2
 2405  0000000                   
 2406  0000000                   ADC_DATA_ADDR_A_HQ_END_#
 2407  0000000                   	ENDM
 2408  0000000                   ;------------------------------------------------------------------------------
 2409  0000000                   ; called by MidiMain.asm for midi sentence list
 2410  0000000                   ADC_ADDR_CH	MACRO	VAR_ADDR, INC_NUM
 2411  0000000                   	LDA #INC_NUM
 2412  0000000                   	ADC_ADDR_A CHANNEL_ADDR+VAR_ADDR
 2413  0000000                   	ENDM
 2414  0000000                   ;------------------------------------------------------------------------------
 2415  0000000                   ;for Winmelody,Percussion,VoiceMelogy
 2416  0000000                   ADC_DATA_ADDR_A_CH	MACRO	FORMAT
 2417  0000000                   	ADC_ADDR_A CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2418  0000000                   	ENDM
 2419  0000000                   ;------------------------------------------------------------------------------
 2420  0000000                   ;for speech address adc
 2421  0000000                   ADC_DATA_ADDR_CH	MACRO	FORMAT, INC_NUM
 2422  0000000                   	LDA #INC_NUM
 2423  0000000                   	ADC_ADDR_A CHANNEL_ADDR+CH_DATA_ADDR|FORMAT
 2424  0000000                   	ENDM
 2425  0000000                   ;------------------------------------------------------------------------------
 2426  0000000                   ADC_DATA_ADDR_CH_SA_MS	MACRO	INC_NUM
 2427  0000000                   	PHA
 2428  0000000                   	ADC_DATA_ADDR_CH _MS,INC_NUM
 2429  0000000                   	PLA
 2430  0000000                   	ENDM
 2431  0000000                   ;------------------------------------------------------------------------------
 2432  0000000                   ; NOTE: SBC_NUM MUST BE 0~255
 2433  0000000                   ;------------------------------------------------------------------------------
 2434  0000000                   ; Internal called only in Macros.ini
 2435  0000000                   SBC_ADDR	MACRO	VAR_ADDR,SBC_NUM
 2436  0000000                   	SEC
 2437  0000000                   	LDA <VAR_ADDR
 2438  0000000                   	SBC	#SBC_NUM
 2439  0000000                   	STA <VAR_ADDR
 2440  0000000                   	BCS SBC_ADDR_#





 2441  0000000                   
 2442  0000000                   	DEC <VAR_ADDR+1
 2443  0000000                   	LDA <VAR_ADDR+1
 2444  0000000                   	CMP #7FH
 2445  0000000                   	BNE SBC_ADDR_#
 2446  0000000                   
 2447  0000000                   	LDA #FFH
 2448  0000000                   	STA <VAR_ADDR+1
 2449  0000000                   	DEC <VAR_ADDR+2
 2450  0000000                   
 2451  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2452  0000000                   	LDA <VAR_ADDR+2
 2453  0000000                   	CMP #FFH
 2454  0000000                   	BNE IS_BANK_0000#
 2455  0000000                   
 2456  0000000                   	DEC <VAR_ADDR+3
 2457  0000000                   	BRA SBC_ADDR_#
 2458  0000000                   	.ENDIF
 2459  0000000                   
 2460  0000000                   IS_BANK_0000#:
 2461  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2462  0000000                   	LDA <VAR_ADDR+2
 2463  0000000                   	.ENDIF
 2464  0000000                   	BNE SBC_ADDR_#
 2465  0000000                   
 2466  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 2467  0000000                   	LDA <VAR_ADDR+3
 2468  0000000                   	AND #03H
 2469  0000000                   	BNE SBC_ADDR_#
 2470  0000000                   	.ENDIF
 2471  0000000                   
 2472  0000000                   	LDA #7FH
 2473  0000000                   	STA <VAR_ADDR+1
 2474  0000000                   
 2475  0000000                   SBC_ADDR_#
 2476  0000000                   	ENDM
 2477  0000000                   ;------------------------------------------------------------------------------
 2478  0000000                   SBC_DATA_ADDR_CH MACRO	FORMAT, SBC_NUM
 2479  0000000                   	SBC_ADDR CHANNEL_ADDR+CH_DATA_ADDR|FORMAT,SBC_NUM
 2480  0000000                   	ENDM
 2481  0000000                   ;======================================================================================
 2482  0000000                   SBC16_DP MACRO VAR_ADDR,NUM
 2483  0000000                   	LDA_DP VAR_ADDR
 2484  0000000                   	SEC
 2485  0000000                   	SBC #NUM
 2486  0000000                   	STA_DP VAR_ADDR
 2487  0000000                   	BCS SBC16_DP_DONE_#
 2488  0000000                   
 2489  0000000                   	LDA_DP VAR_ADDR+1
 2490  0000000                   	SBC #00H
 2491  0000000                   	STA_DP VAR_ADDR+1
 2492  0000000                   
 2493  0000000                   SBC16_DP_DONE_#
 2494  0000000                   	ENDM
 2495  0000000                   ;======================================================================================
 2496  0000000                   SBC16_DP_2B MACRO VAR_ADDR,NUM
 2497  0000000                   	LDA_DP VAR_ADDR





 2498  0000000                   	SEC
 2499  0000000                   	SBC #.LOW.NUM
 2500  0000000                   	STA_DP VAR_ADDR
 2501  0000000                   
 2502  0000000                   	LDA_DP VAR_ADDR+1
 2503  0000000                   	SBC #.HIGH.NUM
 2504  0000000                   	STA_DP VAR_ADDR+1
 2505  0000000                   	ENDM
 2506  0000000                   ;------------------------------------------------------------------------------
 2507  0000000                   ; Add By TSH
 2508  0000000                   ;--------------------------------------------------------------------------
 2509  0000000                   SBC16_DP_X MACRO VAR_ADDR,NUM
 2510  0000000                   	LDA_DP_X VAR_ADDR
 2511  0000000                   	SEC
 2512  0000000                   	SBC #NUM
 2513  0000000                   	STA_DP_X VAR_ADDR
 2514  0000000                   	BCS SBC16_DP_X_DONE_#
 2515  0000000                   
 2516  0000000                   	LDA_DP_X VAR_ADDR+1
 2517  0000000                   	SBC #00H
 2518  0000000                   	STA_DP_X VAR_ADDR+1
 2519  0000000                   
 2520  0000000                   SBC16_DP_X_DONE_#
 2521  0000000                   	ENDM
 2522  0000000                   ;------------------------------------------------------------------------------
 2523  0000000                   ; Add By TSH
 2524  0000000                   ;--------------------------------------------------------------------------
 2525  0000000                   SBC16_DP_RAM MACRO VAR_ADDR,VAR_RAM
 2526  0000000                   	LDA_DP VAR_ADDR
 2527  0000000                   	SEC
 2528  0000000                   	SBC <VAR_RAM
 2529  0000000                   	STA_DP VAR_ADDR
 2530  0000000                   	BCS SBC16_DP_RAM_DONE_#
 2531  0000000                   
 2532  0000000                   	LDA_DP VAR_ADDR+1
 2533  0000000                   	SBC #00H
 2534  0000000                   	STA_DP VAR_ADDR+1
 2535  0000000                   
 2536  0000000                   SBC16_DP_RAM_DONE_#
 2537  0000000                   	ENDM
 2538  0000000                   ;------------------------------------------------------------------------------
 2539  0000000                   ; Add By TSH
 2540  0000000                   ;--------------------------------------------------------------------------
 2541  0000000                   SBC16_DP_X_RAM MACRO VAR_ADDR,VAR_RAM
 2542  0000000                   	LDA_DP_X VAR_ADDR
 2543  0000000                   	SEC
 2544  0000000                   	SBC <VAR_RAM
 2545  0000000                   	STA_DP_X VAR_ADDR
 2546  0000000                   	BCS SBC16_DP_RAM_DONE_#
 2547  0000000                   
 2548  0000000                   	LDA_DP_X VAR_ADDR+1
 2549  0000000                   	SBC #00H
 2550  0000000                   	STA_DP_X VAR_ADDR+1
 2551  0000000                   
 2552  0000000                   SBC16_DP_RAM_DONE_#
 2553  0000000                   	ENDM
 2554  0000000                   ;------------------------------------------------------------------------------





 2555  0000000                   SBC16_DP_CH MACRO VAR_ADDR,NUM
 2556  0000000                   	SBC16_DP CHANNEL_ADDR+VAR_ADDR,NUM
 2557  0000000                   	ENDM
 2558  0000000                   ;======================================================================================
 2559  0000000                   SBC24_DP MACRO VAR_ADDR,NUM
 2560  0000000                   	LDA_DP VAR_ADDR
 2561  0000000                   	SEC
 2562  0000000                   	SBC #NUM
 2563  0000000                   	STA_DP VAR_ADDR
 2564  0000000                   	BCS SBC24_DP_DONE_#
 2565  0000000                   
 2566  0000000                   	LDA_DP VAR_ADDR+1
 2567  0000000                   	SBC #00H
 2568  0000000                   	STA_DP VAR_ADDR+1
 2569  0000000                   	BCS SBC24_DP_DONE_#
 2570  0000000                   
 2571  0000000                   	LDA_DP VAR_ADDR+2
 2572  0000000                   	SBC #00H
 2573  0000000                   	STA_DP VAR_ADDR+2
 2574  0000000                   
 2575  0000000                   SBC24_DP_DONE_#
 2576  0000000                   	ENDM
 2577  0000000                   
 2578  0000000                   ;---------------------------------------------------------------------------
 2579  0000000                   SBC24_DP_CH MACRO VAR_ADDR,NUM
 2580  0000000                   	SBC24_DP CHANNEL_ADDR+VAR_ADDR,NUM
 2581  0000000                   	ENDM
 2582  0000000                   ;======================================================================================
 2583  0000000                   ;
 2584  0000000                   ;======================================================================================
 2585  0000000                   ADC16_DP MACRO VAR_ADDR,NUM
 2586  0000000                   	LDA_DP VAR_ADDR
 2587  0000000                   	CLC
 2588  0000000                   	ADC #NUM
 2589  0000000                   	STA_DP VAR_ADDR
 2590  0000000                   	LDA_DP VAR_ADDR+1
 2591  0000000                   	ADC #00H
 2592  0000000                   	STA_DP VAR_ADDR+1
 2593  0000000                   	ENDM
 2594  0000000                   ;--------------------------------------------------------------------------
 2595  0000000                   ADC16_DP_2B MACRO VAR_ADDR,NUM
 2596  0000000                   	LDA_DP VAR_ADDR
 2597  0000000                   	CLC
 2598  0000000                   	ADC #.LOW.NUM
 2599  0000000                   	STA_DP VAR_ADDR
 2600  0000000                   	LDA_DP VAR_ADDR+1
 2601  0000000                   	ADC #.HIGH.NUM
 2602  0000000                   	STA_DP VAR_ADDR+1
 2603  0000000                   	ENDM
 2604  0000000                   ;--------------------------------------------------------------------------
 2605  0000000                   ; Add By TSH
 2606  0000000                   ;--------------------------------------------------------------------------
 2607  0000000                   ADC16_DP_RAM MACRO VAR_ADDR,RAM_VAR
 2608  0000000                   	LDA_DP VAR_ADDR
 2609  0000000                   	CLC
 2610  0000000                   	ADC <RAM_VAR
 2611  0000000                   	STA_DP VAR_ADDR





 2612  0000000                   	LDA_DP VAR_ADDR+1
 2613  0000000                   	ADC #00H
 2614  0000000                   	STA_DP VAR_ADDR+1
 2615  0000000                   	ENDM
 2616  0000000                   ;---------------------------------------------------------------------------
 2617  0000000                   ADC16_DP_X MACRO VAR_ADDR,NUM
 2618  0000000                   	LDA_DP_X VAR_ADDR
 2619  0000000                   	CLC
 2620  0000000                   	ADC #NUM
 2621  0000000                   	STA_DP_X VAR_ADDR
 2622  0000000                   	LDA_DP_X VAR_ADDR+1
 2623  0000000                   	ADC #00H
 2624  0000000                   	STA_DP_X VAR_ADDR+1
 2625  0000000                   	ENDM
 2626  0000000                   ;---------------------------------------------------------------------------
 2627  0000000                   ADC16_DP_CH MACRO VAR_ADDR,NUM
 2628  0000000                   	ADC16_DP CHANNEL_ADDR+VAR_ADDR,NUM
 2629  0000000                   	ENDM
 2630  0000000                   
 2631  0000000                   ;======================================================================================
 2632  0000000                   ADC24_DP MACRO VAR_ADDR,NUM
 2633  0000000                   	LDA_DP VAR_ADDR
 2634  0000000                   	CLC
 2635  0000000                   	ADC #NUM
 2636  0000000                   	STA_DP VAR_ADDR
 2637  0000000                   	BCC ADC24_DONE_#
 2638  0000000                   
 2639  0000000                   	LDA_DP VAR_ADDR+1
 2640  0000000                   	ADC #00H
 2641  0000000                   	STA_DP VAR_ADDR+1
 2642  0000000                   	BCC ADC24_DONE_#
 2643  0000000                   
 2644  0000000                   	LDA_DP VAR_ADDR+2
 2645  0000000                   	ADC #00H
 2646  0000000                   	STA_DP VAR_ADDR+2
 2647  0000000                   
 2648  0000000                   ADC24_DONE_#:
 2649  0000000                   	ENDM
 2650  0000000                   ;======================================================================================
 2651  0000000                   ADC32_DP MACRO VAR_ADDR,NUM
 2652  0000000                   	LDA_DP VAR_ADDR
 2653  0000000                   	CLC
 2654  0000000                   	ADC #NUM
 2655  0000000                   	STA_DP VAR_ADDR
 2656  0000000                   	BCC ADC32_DONE_#
 2657  0000000                   
 2658  0000000                   	LDA_DP VAR_ADDR+1
 2659  0000000                   	ADC #00H
 2660  0000000                   	STA_DP VAR_ADDR+1
 2661  0000000                   	BCC ADC32_DONE_#
 2662  0000000                   
 2663  0000000                   	LDA_DP VAR_ADDR+2
 2664  0000000                   	ADC #00H
 2665  0000000                   	STA_DP VAR_ADDR+2
 2666  0000000                   	BCC ADC32_DONE_#
 2667  0000000                   
 2668  0000000                   	LDA_DP VAR_ADDR+3





 2669  0000000                   	ADC #00H
 2670  0000000                   	STA_DP VAR_ADDR+3
 2671  0000000                   
 2672  0000000                   ADC32_DONE_#:
 2673  0000000                   	ENDM
 2674  0000000                   ;======================================================================================
 2675  0000000                   ;
 2676  0000000                   ;======================================================================================
 2677  0000000                   ;CHECK_EXT_EVENT_ENABLE_CHANNEL MACRO BY_PASS_LABEL
 2678  0000000                   ;	;=== CHK I-F EXT_MIDI_EVENT ===
 2679  0000000                   ;	.IF (WITH_READ_DATA_TYPE .EQ. 0)
 2680  0000000                   ;	EXTERN	CHECK_EXT_EVENT_ENABLE_CHANNEL_PROC
 2681  0000000                   ;	JSR CHECK_EXT_EVENT_ENABLE_CHANNEL_PROC
 2682  0000000                   ;	CPY #01H
 2683  0000000                   ;	BEQ CHECK_EXT_EVENT_CHANNEL_END_#
 2684  0000000                   ;
 2685  0000000                   ;	JMP BY_PASS_LABEL
 2686  0000000                   ;
 2687  0000000                   ;CHECK_EXT_EVENT_CHANNEL_END_#
 2688  0000000                   ;	.ENDIF
 2689  0000000                   ;	ENDM
 2690  0000000                   
 2691  0000000                   ;======================================================================================
 2692  0000000                   ; INPUT: X- CHANNEL ADDR. 
 2693  0000000                   ;======================================================================================
 2694  0000000                   SET_SYNTH_CHANNEL_NOTE_VELOCITY MACRO CHANNEL_NAME
 2695  0000000                   ;	LDA_DP_CH CH_MIDI_CHANNEL_MS
 2696  0000000                   ;	STA <CH_SYNTH_CHANNEL|CHANNEL_NAME,X
 2697  0000000                   
 2698  0000000                   	LDA_DP_CH CH_MIDI_NOTE_MS
 2699  0000000                   	STA <CH_SYNTH_NOTE|CHANNEL_NAME,X
 2700  0000000                   
 2701  0000000                   	LDA #WITH_VELOCITY
 2702  0000000                   	BEQ SET_NEXT_DATA_#
 2703  0000000                   
 2704  0000000                   	LDA_DP_CH CH_MIDI_VELOCITY_MS			;0~127
 2705  0000000                   	STA <CH_SYNTH_VELOCITY|CHANNEL_NAME,X
 2706  0000000                   
 2707  0000000                   SET_NEXT_DATA_#
 2708  0000000                   ;	.IF (WITH_COMPRESSED_MIDI .GT. 0)
 2709  0000000                   ;	.IF (WITH_COMPRESSED_MIDI .EQ. 2H)
 2710  0000000                   ; W588 Compress Midi
 2711  0000000                   ;	.ELSE
 2712  0000000                   ;		LDA_DP_CH CH_MIDI_SYNTH_LENGTH_MS
 2713  0000000                   ;		STA <CH_SYNTH_LENGTH|CHANNEL_NAME,X
 2714  0000000                   ;	.ENDIF
 2715  0000000                   ;SET_DONE:
 2716  0000000                   ;	.ENDIF
 2717  0000000                   
 2718  0000000                   	ENDM
 2719  0000000                   
 2720  0000000                   ;======================================================================================
 2721  0000000                   ; INPUT: Y-CHANNEL INDEX, X- CHANNEL ADDR. 
 2722  0000000                   ;======================================================================================
 2723  0000000                   ;================================
 2724  0000000                   ; For Speech PC8 Volume Table
 2725  0000000                   ;--------------------------------





 2726  0000000                   SET_PC8_VOL_MUL_8X3_SP_ADDR MACRO CHANNEL_NAME
 2727  0000000                   	EXTERN	MULTIPLY_8x3_HI_TABLE
 2728  0000000                   	LDA <CH_R_FINAL_VOLUME|CHANNEL_NAME,X
 2729  0000000                   	AND #7FH ;BUG: 821
 2730  0000000                   	LSR A
 2731  0000000                   	CLC
 2732  0000000                   	ADC #.HIGH.MULTIPLY_8x3_HI_TABLE
 2733  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME+1,X
 2734  0000000                   	LDA #.LOW.MULTIPLY_8x3_HI_TABLE
 2735  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME,X
 2736  0000000                   	ENDM
 2737  0000000                   ;--------------------------------------------------------------------------
 2738  0000000                   ;================================
 2739  0000000                   ; For Speech LP8 Volume Table
 2740  0000000                   ;--------------------------------
 2741  0000000                   SET_LP8_VOL_MUL_8X3_SP_ADDR MACRO CHANNEL_NAME
 2742  0000000                   	EXTERN	MULTIPLY_L8x3_HI_TABLE
 2743  0000000                   	LDA <CH_R_FINAL_VOLUME|CHANNEL_NAME,X
 2744  0000000                   	AND #7FH  ;BUG: 821
 2745  0000000                   	LSR A
 2746  0000000                   	CLC
 2747  0000000                   	ADC #.HIGH.MULTIPLY_L8x3_HI_TABLE
 2748  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME+1,X
 2749  0000000                   	LDA #.LOW.MULTIPLY_L8x3_HI_TABLE
 2750  0000000                   	STA <CH_VOL_MUL_ADDR|CHANNEL_NAME,X
 2751  0000000                   	ENDM
 2752  0000000                   ;===============================================================
 2753  0000000                   GET_ENV_VALUE MACRO 
 2754  0000000                   	SEI	; two JSR steps, so disable interrupt
 2755  0000000                   	JSR SET_TONE_ENV_ADDR_INC_COUNT_PROC
 2756  0000000                   	LDA_DP_ILI CH_FXF_TEMP_REG1
 2757  0000000                   	CLI
 2758  0000000                   	ENDM
 2759  0000000                   
 2760  0000000                   ;===============================================================
 2761  0000000                   ; A changed
 2762  0000000                   ;===============================================================
 2763  0000000                   JSR_AII_X MACRO JSR_ADDR
 2764  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2765  0000000                   ;	JSR (JSR_ADDR,X)
 2766  0000000                   ;	.ELSE
 2767  0000000                   	LDA #.HIGH.RETURN_ADDR_#
 2768  0000000                   	PHA
 2769  0000000                   ;	LDA #.LOW.RETURN_ADDR_#-1
 2770  0000000                   	LDA #.LOW.RETURN_ADDR_#
 2771  0000000                   	PHA
 2772  0000000                   	JMP (JSR_ADDR,X)
 2773  0000000                   RETURN_ADDR_#:
 2774  0000000                   	NOP
 2775  0000000                   ;	.ENDIF
 2776  0000000                   	ENDM
 2777  0000000                   ;---------------------------------------------------------------
 2778  0000000                   ; PHY for Return Addr
 2779  0000000                   ;---------------------------------------------------------------
 2780  0000000                   JSR_AII_PHY_X MACRO JSR_ADDR
 2781  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2782  0000000                   ;	JSR (JSR_ADDR,X)





 2783  0000000                   ;	.ELSE
 2784  0000000                   	LDY #.HIGH.RETURN_ADDR_Y_#
 2785  0000000                   	PHY
 2786  0000000                   	LDY #.LOW.RETURN_ADDR_Y_#
 2787  0000000                   	PHY
 2788  0000000                   	JMP (JSR_ADDR,X)
 2789  0000000                   RETURN_ADDR_Y_#:
 2790  0000000                   	NOP
 2791  0000000                   ;	.ENDIF
 2792  0000000                   	ENDM
 2793  0000000                   ;--------------------------------------------------------------------------
 2794  0000000                   JSR_AII_X_SA MACRO JSR_ADDR,BUF_ADDR
 2795  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2796  0000000                   ;	JSR (JSR_ADDR,X)
 2797  0000000                   ;	.ELSE
 2798  0000000                   	STA <BUF_ADDR
 2799  0000000                   	LDA #.HIGH.RETURN_ADDR_#
 2800  0000000                   	PHA
 2801  0000000                   ;	LDA #.LOW.RETURN_ADDR_#-1
 2802  0000000                   	LDA #.LOW.RETURN_ADDR_#
 2803  0000000                   	PHA
 2804  0000000                   	LDA <BUF_ADDR
 2805  0000000                   	JMP (JSR_ADDR,X)
 2806  0000000                   RETURN_ADDR_#:
 2807  0000000                   	NOP
 2808  0000000                   ;	.ENDIF
 2809  0000000                   	ENDM
 2810  0000000                   ;--------------------------------------------------------------------------
 2811  0000000                   JSR_AII_X_TA MACRO JSR_ADDR,DATA
 2812  0000000                   	LDA #.HIGH.RETURN_ADDR_#
 2813  0000000                   	PHA
 2814  0000000                   	LDA #.LOW.RETURN_ADDR_#
 2815  0000000                   	PHA
 2816  0000000                   	LDA #DATA
 2817  0000000                   	JMP (JSR_ADDR,X)
 2818  0000000                   RETURN_ADDR_#:
 2819  0000000                   	NOP
 2820  0000000                   	ENDM
 2821  0000000                   ;===============================================================
 2822  0000000                   JSR_AII_X_LA MACRO JSR_ADDR
 2823  0000000                   	LDA #.HIGH.RETURN_ADDR_LA_#
 2824  0000000                   	PHA
 2825  0000000                   	LDA #.LOW.RETURN_ADDR_LA_#
 2826  0000000                   	PHA
 2827  0000000                   
 2828  0000000                   	JMP (JSR_ADDR,X)
 2829  0000000                   RETURN_ADDR_LA_#:
 2830  0000000                   	NOP
 2831  0000000                   	ENDM
 2832  0000000                   
 2833  0000000                   ;===============================================================
 2834  0000000                   ;
 2835  0000000                   ;===============================================================
 2836  0000000                   T_XY MACRO
 2837  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2838  0000000                   ;	TXY
 2839  0000000                   ;	.ELSE





 2840  0000000                   	PHX
 2841  0000000                   	PLY
 2842  0000000                   ;	.ENDIF
 2843  0000000                   	ENDM
 2844  0000000                   ;--------------------------------------------------------------------------
 2845  0000000                   T_YX MACRO
 2846  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2847  0000000                   ;	TYX
 2848  0000000                   ;	.ELSE
 2849  0000000                   	PHY
 2850  0000000                   	PLX
 2851  0000000                   ;	.ENDIF
 2852  0000000                   	ENDM
 2853  0000000                   ;===============================================================
 2854  0000000                   ;
 2855  0000000                   ;===============================================================
 2856  0000000                   IDX16		MACRO
 2857  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2858  0000000                   ;	REP		#I_TOGGLE
 2859  0000000                   ;	LONGI	ON
 2860  0000000                   ;	.ENDIF
 2861  0000000                   	ENDM
 2862  0000000                   
 2863  0000000                   ;--------------------------------------------------------------------------
 2864  0000000                   ACC16		MACRO
 2865  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2866  0000000                   ;	REP		#A_TOGGLE
 2867  0000000                   ;	LONGA	ON
 2868  0000000                   ;	.ENDIF
 2869  0000000                   	ENDM
 2870  0000000                   
 2871  0000000                   ;--------------------------------------------------------------------------
 2872  0000000                   IDX8		MACRO
 2873  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2874  0000000                   ;	SEP		#I_TOGGLE
 2875  0000000                   ;	LONGI	OFF
 2876  0000000                   ;	.ENDIF
 2877  0000000                   	ENDM
 2878  0000000                   
 2879  0000000                   ;--------------------------------------------------------------------------
 2880  0000000                   ACC8		MACRO
 2881  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2882  0000000                   ;	SEP		#A_TOGGLE
 2883  0000000                   ;	LONGA	OFF
 2884  0000000                   ;	.ENDIF
 2885  0000000                   	ENDM
 2886  0000000                   
 2887  0000000                   ;--------------------------------------------------------------------------
 2888  0000000                   AI16		MACRO
 2889  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2890  0000000                   ;	REP		#AI_TOGGLE
 2891  0000000                   ;	LONGI	ON
 2892  0000000                   ;	LONGA	ON
 2893  0000000                   ;	.ENDIF
 2894  0000000                   	ENDM
 2895  0000000                   
 2896  0000000                   ;--------------------------------------------------------------------------





 2897  0000000                   AI8			MACRO
 2898  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 2899  0000000                   ;	SEP		#AI_TOGGLE
 2900  0000000                   ;	LONGI	OFF
 2901  0000000                   ;	LONGA	OFF
 2902  0000000                   ;	.ENDIF
 2903  0000000                   	ENDM
 2904  0000000                   
 2905  0000000                   ;--------------------------------------------------------------------------
 2906  0000000                   ;**************************************************************************
 2907  0000000                   STA_DP_II_Y MACRO	VAR_ADDR
 2908  0000000                   	STA (<VAR_ADDR),Y
 2909  0000000                   	ENDM
 2910  0000000                   
 2911  0000000                   STA_DP_II_Y_CH MACRO	VAR_ADDR
 2912  0000000                   	STA (<CHANNEL_ADDR+VAR_ADDR),Y
 2913  0000000                   	ENDM
 2914  0000000                   
 2915  0000000                   ;---------------------------------------------------------------------------
 2916  0000000                   MULTIPLY_256X8_PORC  MACRO OP1, OP2
 2917  0000000                   	SEI
 2918  0000000                   		LDA <OP2
 2919  0000000                   		ASL A
 2920  0000000                   		TAX
 2921  0000000                   		LDA <OP1		
 2922  0000000                   		BPL MULTIPLE_PLUS_256X8_#
 2923  0000000                   ; 2's complement
 2924  0000000                   		EOR #FFH
 2925  0000000                   		INC A			
 2926  0000000                   MULTIPLE_PLUS_256X8_#:	
 2927  0000000                   		TAY
 2928  0000000                   		ASL A
 2929  0000000                   			EXTERN MULTIPLY_128_8_TABLE
 2930  0000000                   		LDA !MULTIPLY_128_8_TABLE, X
 2931  0000000                   		STA <TEMP_REG1
 2932  0000000                   		LDA !MULTIPLY_128_8_TABLE+1, X
 2933  0000000                   		STA <TEMP_REG1+1
 2934  0000000                   		LDA (<TEMP_REG1), Y		; only get MSB
 2935  0000000                   	CLI
 2936  0000000                   	ENDM
 2937  0000000                   
 2938  0000000                   ;--------------------------------------------------------------------------
 2939  0000000                   SHARP_DECAY_INS MACRO
 2940  0000000                   	LDA <CH_STATUS_MC,X
 2941  0000000                   	ORA #SP_DECAY
 2942  0000000                   	AND #FFH^(SP_NOTE)
 2943  0000000                   	STA <CH_STATUS_MC,X
 2944  0000000                   ;	STA <CH_DECAY_STATUS_MC,X
 2945  0000000                   	ENDM
 2946  0000000                   ;------------------------------------------------------------------------------
 2947  0000000                   ;load SIC buffer data
 2948  0000000                   LDA_DP_ILI_CH_DATA_SP_EXT MACRO CHANNEL_NAME, INDEX  
 2949  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)
 2950  0000000                   ;LDA_DP_CH CH_DATA_BANK|CHANNEL_NAME
 2951  0000000                   ;CMP #80H
 2952  0000000                   ;BCC INTERNAL_SP#
 2953  0000000                   ;LDA #.LOW.START_SIM_BUF





 2954  0000000                   ;BEQ EXT_NO_SIM_BUF_SP#
 2955  0000000                   	LDY #INDEX
 2956  0000000                   	LDA START_SIM_BUF,Y
 2957  0000000                   ;BRA END_SP#
 2958  0000000                   ;EXT_NO_SIM_BUF_SP#:
 2959  0000000                   ;.ENDIF
 2960  0000000                   	ENDM
 2961  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;	
 2962  0000000                   ;set SIC to get next data,set COMMON_FLAG
 2963  0000000                   SET_SIC_BUF_SP_EXT MACRO VALUE, CHANNEL_NAME
 2964  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)
 2965  0000000                   	LDY #START_CHANNEL_ID
 2966  0000000                   	EXTERN SP_TM_CH_MAP_TABLE
 2967  0000000                   	LDA !SP_TM_CH_MAP_TABLE,Y
 2968  0000000                   	TAY
 2969  0000000                   	LDA !SP_CH_SIM_BUF_SET,Y
 2970  0000000                   ;BEQ END_SET_SIC_SP#
 2971  0000000                   	ORA #VALUE
 2972  0000000                   	STA !SIC
 2973  0000000                   	LDA #RDPC_WSC
 2974  0000000                   	TRB !RDPC
 2975  0000000                   	LDA !SP_CH_SIM_BUF_LOOP_FLAG,Y
 2976  0000000                   	TSB <COMMON_FLAG
 2977  0000000                   	LDA_DP_ILI_CH_DATA CHANNEL_NAME
 2978  0000000                   ;INTERNAL_SP_RS#:
 2979  0000000                   ;END_SET_SIC_SP#:	
 2980  0000000                   ;.ENDIF
 2981  0000000                   	ENDM	
 2982  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 2983  0000000                   ;wait for SIC buffer ready
 2984  0000000                   WAIT_SIC_LOOP_SP_EXT MACRO     
 2985  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)
 2986  0000000                   	LDY #START_CHANNEL_ID
 2987  0000000                   	EXTERN SP_TM_CH_MAP_TABLE
 2988  0000000                   	LDA !SP_TM_CH_MAP_TABLE,Y
 2989  0000000                   	TAY
 2990  0000000                   	LDA !SP_CH_SIM_BUF_LOOP_FLAG,Y
 2991  0000000                   ;BEQ SP_NO_WAIT#
 2992  0000000                   	BIT <COMMON_FLAG
 2993  0000000                   	BEQ SP_NO_WAIT#
 2994  0000000                   	TRB <COMMON_FLAG
 2995  0000000                   WAIT_SP#:
 2996  0000000                   	LDA !SIC
 2997  0000000                   	BPL WAIT_SP#
 2998  0000000                   	LDA #RDPC_WSC
 2999  0000000                   	TSB !RDPC
 3000  0000000                   SP_NO_WAIT#:			
 3001  0000000                   ;.ENDIF
 3002  0000000                   	ENDM	
 3003  0000000                   
 3004  0000000                   STA_ISR_SIM_BUF MACRO ISR_ADDR,FORMAT_CHANNEL
 3005  0000000                   ;.IF (WITH_SIM_SP .EQ. 1)	
 3006  0000000                   ;LDA #.LOW.START_SIM_BUF
 3007  0000000                   ;BEQ NO_RESET_ISR_SP#	
 3008  0000000                   	LDA #.LOW.ISR_ADDR
 3009  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL
 3010  0000000                   	LDA #.HIGH.ISR_ADDR





 3011  0000000                   	STA <CHANNEL_ADDR+CH_ISR_SYNTH_START|FORMAT_CHANNEL+1
 3012  0000000                   ;NO_RESET_ISR_SP#:	
 3013  0000000                   ;.ENDIF
 3014  0000000                   	ENDM
 3015  0000000                   
 3016  0000000                   GET_SPEN MACRO
 3017  0000000                   	LDA #WITH_SPEAKER_SWITCH
 3018  0000000                   	BEQ DEFAULT_SPEAKER#
 3019  0000000                   	LDA <SPEN_TMP
 3020  0000000                   	BRA END_GET_SPEN#
 3021  0000000                   DEFAULT_SPEAKER#:
 3022  0000000                   	LDA #WITH_SPEAKER_OUTPUT_TYPE
 3023  0000000                   END_GET_SPEN#:
 3024  0000000                   	ENDM
 3025  0000000                   
 3026  0000000                   OPEN_SPEN MACRO
 3027  0000000                   	GET_SPEN
 3028  0000000                   SET_SPEAKER#:
 3029  0000000                   ;	ORA #SPEN_NS
 3030  0000000                   	STA !SPEN
 3031  0000000                   OPEN_SPEN_END#:
 3032  0000000                   	ENDM
 3033  0000000                   
 3034  0000000                   CLOSE_SPEN MACRO
 3035  0000000                   	STZ !SPEN
 3036  0000000                   	ENDM
 3037  0000000                   ;==========================================================
 3038  0000000                   LDA_DATA_ILI_X MACRO  CHANNEL_NAME
 3039  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3040  0000000                   	LDA <CH_DATA_BANK1|CHANNEL_NAME,X
 3041  0000000                   	AND #03H
 3042  0000000                   	STA !BANK1
 3043  0000000                   	.ENDIF
 3044  0000000                   	LDA <CH_DATA_BANK|CHANNEL_NAME,X
 3045  0000000                   	SW_CS
 3046  0000000                   	STA !BANK
 3047  0000000                   	LDA (<CH_DATA_ADDR|CHANNEL_NAME,X)
 3048  0000000                   	ENDM
 3049  0000000                   ;==========================================================
 3050  0000000                   ;SWITCH W551C320 CS PIN
 3051  0000000                   ;==========================================================
 3052  0000000                   LDA_DP_ILI_Y_SIM MACRO VAR_ADDR	
 3053  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 3054  0000000                   ;	LDA [<VAR_ADDR],Y
 3055  0000000                   ;	.ELSE
 3056  0000000                   	LDA <VAR_ADDR+2
 3057  0000000                   	SW_CS
 3058  0000000                   	STA !BANK
 3059  0000000                   	LDA (<VAR_ADDR),Y
 3060  0000000                   ;	.ENDIF
 3061  0000000                   	ENDM
 3062  0000000                   ;---------------------------------------------------------------------------
 3063  0000000                   LDA_DP_ILI_SIM MACRO VAR_ADDR	
 3064  0000000                   ;	.IF (WITH_16BIT_MODE .EQ. 1)
 3065  0000000                   ;	LDA [<VAR_ADDR]
 3066  0000000                   ;	.ELSE
 3067  0000000                   	LDA <VAR_ADDR+2





 3068  0000000                   	SW_CS
 3069  0000000                   	STA !BANK
 3070  0000000                   	LDA (<VAR_ADDR)
 3071  0000000                   ;	.ENDIF
 3072  0000000                   	ENDM
 3073  0000000                   ;---------------------------------------------------------------------------
 3074  0000000                   SW_CS  MACRO
 3075  0000000                   .IF (WITH_EXT32MBIT .EQ. 1)
 3076  0000000                   	CMP #80H
 3077  0000000                   	BCC END_SW_CS#
 3078  0000000                   	CMP #C0H
 3079  0000000                   	PHA
 3080  0000000                   	LDA #08H
 3081  0000000                   	BCC NOT_SW#
 3082  0000000                   	TSB !BP2
 3083  0000000                   	PLA
 3084  0000000                   	AND #BFH
 3085  0000000                   	BRA END_SW_CS#
 3086  0000000                   NOT_SW#:
 3087  0000000                       TRB !BP2
 3088  0000000                   	PLA
 3089  0000000                   END_SW_CS#:
 3090  0000000                   .ENDIF
 3091  0000000                   	ENDM
 3092  0000000                   
 3093  0000000                   ;---------------------------------------------------------------------------
 3094  0000000                   STORE_SW_CS MACRO
 3095  0000000                   .IF (WITH_EXT32MBIT .EQ. 1)
 3096  0000000                   	LDA !BANK	
 3097  0000000                   	CMP #80H
 3098  0000000                   	BCC END_STORE_SW_CS#
 3099  0000000                   ;	LDA #WITH_EXT32MBIT
 3100  0000000                   ;	BEQ END_STORE_SW_CS#
 3101  0000000                   	LDA !BP2
 3102  0000000                   	AND #08H
 3103  0000000                   	PHA
 3104  0000000                   END_STORE_SW_CS#:
 3105  0000000                   .ELSE
 3106  0000000                   .IF (WITH_EXT64M_SPI .EQ. 1H)
 3107  0000000                   	LDA !BANK1
 3108  0000000                   	AND #03H
 3109  0000000                   	PHA
 3110  0000000                   .ENDIF
 3111  0000000                   .ENDIF
 3112  0000000                   	ENDM
 3113  0000000                   
 3114  0000000                   ;---------------------------------------------------------------------------
 3115  0000000                   RELOAD_SW_CS MACRO
 3116  0000000                   .IF (WITH_EXT32MBIT .EQ. 1)
 3117  0000000                   	CMP #80H
 3118  0000000                   	BCC END_RELOAD_SW_CS#
 3119  0000000                   	PLA 
 3120  0000000                   	BEQ SW_CS_0#
 3121  0000000                   	LDA #08H
 3122  0000000                   	TSB !BP2
 3123  0000000                   	BRA END_RELOAD_SW_CS#
 3124  0000000                   SW_CS_0#:





 3125  0000000                   	LDA #08H
 3126  0000000                       TRB !BP2
 3127  0000000                   END_RELOAD_SW_CS#:
 3128  0000000                   .ELSE
 3129  0000000                   .IF (WITH_EXT64M_SPI .EQ. 1H)
 3130  0000000                   	PLA
 3131  0000000                   	STA !BANK1
 3132  0000000                   .ENDIF
 3133  0000000                   .ENDIF
 3134  0000000                   	ENDM
 3135  0000000                   ;---------------------------------------------------------------------------
 3136  0000000                   CHECK_MIDI_CHANNEL_MAPPING  MACRO
 3137  0000000                   .IF (WITH_MULTI_CHANNEL .EQ. 1)
 3138  0000000                   	LDY #FFH
 3139  0000000                   CHECK_MIDI_CHANNEL_MAPPING_NEXT#:
 3140  0000000                   	INY
 3141  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 3142  0000000                   		CPY #03H
 3143  0000000                   	.ELSE
 3144  0000000                   		CPY #02H
 3145  0000000                   	.ENDIF
 3146  0000000                   	BCS BY_PASS_MIDI_EVENT
 3147  0000000                   
 3148  0000000                   	EXTERN MS_CHANNEL_TABLE
 3149  0000000                   	LDA !MS_CHANNEL_TABLE,Y
 3150  0000000                   	BEQ CHECK_MIDI_CHANNEL_MAPPING_NEXT#
 3151  0000000                   
 3152  0000000                   	EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 3153  0000000                   	LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 3154  0000000                   	LDA CH_SYNTH_CHANNEL0,X
 3155  0000000                   	CMP_DP_CH CH_MIDI_CHANNEL_MS
 3156  0000000                   	BNE CHECK_MIDI_CHANNEL_MAPPING_NEXT#
 3157  0000000                   
 3158  0000000                   CHECK_MIDI_CHANNEL_PERCUSSION#:
 3159  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 3160  0000000                   		CPY #MS_CH2	;PERCUSSION CHANNEL
 3161  0000000                   	.ELSE
 3162  0000000                   		CPY #MS_CH1
 3163  0000000                   	.ENDIF
 3164  0000000                   	BNE STORE_MIDI_CHANNEL_MAPPING#
 3165  0000000                   
 3166  0000000                   	LDA_DP_CH CH_MIDI_CHANNEL_MS
 3167  0000000                   	CMP #09H
 3168  0000000                   	BNE STORE_MIDI_CHANNEL_MAPPING#
 3169  0000000                   
 3170  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 3171  0000000                   		LDY #MS_CH2	;PERCUSSION CHANNEL
 3172  0000000                   	.ELSE
 3173  0000000                   		LDY #MS_CH1
 3174  0000000                   	.ENDIF
 3175  0000000                   	EXTERN MS_CHANNEL_PCSPC8_TABLE
 3176  0000000                   	LDA !MS_CHANNEL_PCSPC8_TABLE,Y
 3177  0000000                   	BEQ BY_PASS_MIDI_EVENT
 3178  0000000                   
 3179  0000000                   	LDY #DRUM_CHANNEL_ID
 3180  0000000                   	STY_DP_CH CH_MIDI_CHANNEL_MS
 3181  0000000                   	BRA DECODE_MULTI_CHANNEL





 3182  0000000                   
 3183  0000000                   STORE_MIDI_CHANNEL_MAPPING#:
 3184  0000000                   	STY_DP_CH CH_MIDI_CHANNEL_MS
 3185  0000000                   
 3186  0000000                   	LDA #WITH_CHANNEL_PRESSURE
 3187  0000000                   	BEQ DECODE_MULTI_CHANNEL
 3188  0000000                   
 3189  0000000                   	LDY_DP_CH CH_MIDI_CHANNEL_MS
 3190  0000000                   	LDA !CH_CHANNEL_VOLUME,Y
 3191  0000000                   	BNE DECODE_MULTI_CHANNEL
 3192  0000000                   
 3193  0000000                   BY_PASS_MIDI_EVENT:
 3194  0000000                   	LDY #00H
 3195  0000000                   	BRA END_CHECK_MIDI_CHANNEL_MAPPING#
 3196  0000000                   DECODE_MULTI_CHANNEL:
 3197  0000000                   	LDY #01H	
 3198  0000000                   END_CHECK_MIDI_CHANNEL_MAPPING#:
 3199  0000000                   .ENDIF
 3200  0000000                   	ENDM
 3201  0000000                   ;=====================================================================================
 3202  0000000                   ;=====================================================================================
 3203  0000000                   SET_SENTENCE_BANK1 MACRO VAR_ADDR
 3204  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3205  0000000                   	LDA <VAR_ADDR+1,X
 3206  0000000                   	LSR A 
 3207  0000000                   	LSR A 
 3208  0000000                   	STA !BANK1
 3209  0000000                   	.ENDIF
 3210  0000000                   	ENDM
 3211  0000000                   ;---------------------------------------------------------------------------
 3212  0000000                   SET_ADDR_BANK1 MACRO VAR_ADDR
 3213  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3214  0000000                   	LDA <VAR_ADDR+1,X
 3215  0000000                   	AND #03H
 3216  0000000                   	STA !BANK1
 3217  0000000                   	.ENDIF
 3218  0000000                   	ENDM
 3219  0000000                   ;---------------------------------------------------------------------------
 3220  0000000                   SET_MS_SENTENCE_BANK1 MACRO
 3221  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3222  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1_MS
 3223  0000000                   	LSR A 
 3224  0000000                   	LSR A 
 3225  0000000                   	STA !BANK1
 3226  0000000                   	.ENDIF
 3227  0000000                   	ENDM
 3228  0000000                   ;---------------------------------------------------------------------------
 3229  0000000                   SET_MS_ADDR_BANK1 MACRO
 3230  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3231  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1_MS
 3232  0000000                   	AND #03H
 3233  0000000                   	STA !BANK1
 3234  0000000                   	.ENDIF
 3235  0000000                   	ENDM
 3236  0000000                   ;---------------------------------------------------------------------------
 3237  0000000                   STORE_BANK1 MACRO
 3238  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)





 3239  0000000                   	LDA !BANK1
 3240  0000000                   	AND #03H
 3241  0000000                   	STA <TEMP_REG2+1
 3242  0000000                   	.ENDIF
 3243  0000000                   	ENDM	
 3244  0000000                   ;---------------------------------------------------------------------------
 3245  0000000                   SET_BANK1 MACRO
 3246  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3247  0000000                   	LDA <TEMP_REG2+1
 3248  0000000                   	AND #03H
 3249  0000000                   	STA !BANK1
 3250  0000000                   	.ENDIF
 3251  0000000                   	ENDM
 3252  0000000                   ;---------------------------------------------------------------------------
 3253  0000000                   GET_SPEAKER_TPYE MACRO 
 3254  0000000                   	LDA #WITH_SPEAKER_SWITCH
 3255  0000000                   	BEQ NOT_SWITCH_SPEAKER#
 3256  0000000                   	LDA <SPEN_TMP
 3257  0000000                   	BRA CHECK_DAC_MODE#
 3258  0000000                   NOT_SWITCH_SPEAKER#:
 3259  0000000                   	LDA #WITH_SPEAKER_OUTPUT_TYPE
 3260  0000000                   CHECK_DAC_MODE#:
 3261  0000000                   	ENDM
 3262  0000000                   ;---------------------------------------------------------------------------
 3263  0000000                   CHECK_NS_ACTIVE MACRO
 3264  0000000                   	LDA !SPEN
 3265  0000000                   	AND #WITH_SPEN_EFFECTIVE_BITS
 3266  0000000                   	BIT #08H
 3267  0000000                   	ENDM
 3268  0000000                   ;=====================================================================================
 3269  0000000                   ;=====================================================================================
 3270  0000000                   TSB_IEF_REG MACRO IEF_REG,EFC_REG
 3271  0000000                         BIT !IEF_REG
 3272  0000000                         BNE END_TSB_IEF_REG#             			
 3273  0000000                         STA !EFC_REG  
 3274  0000000                         PHP
 3275  0000000                         SEI                              		
 3276  0000000                         TSB !IEF_REG 
 3277  0000000                         PLP
 3278  0000000                   END_TSB_IEF_REG#:  
 3279  0000000                         ENDM
 3280  0000000                   ;-----------------------------------------------------------	
 3281  0000000                   TRB_IEF_REG MACRO IEF_REG,EFC_REG
 3282  0000000                         PHP
 3283  0000000                         SEI				; avoid port_int be disabled always 
 3284  0000000                         TRB !IEF_REG     
 3285  0000000                         PLP
 3286  0000000                         STA !EFC_REG
 3287  0000000                         ENDM
 3288  0000000                   ;=====================================================================================
 3289  0000000                   ;=====================================================================================
 3290  0000000                   ADC16_ADDR_X MACRO VAR_ADDR
 3291  0000000                   	CLC 
 3292  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3293  0000000                   	ADC <VAR_ADDR
 3294  0000000                   	STA <CH_DATA_ADDR_SP,X
 3295  0000000                   	LDA <CH_DATA_ADDR_SP+1,X





 3296  0000000                   	ADC <VAR_ADDR+1
 3297  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3298  0000000                   	LDA <CH_DATA_BANK_SP,X
 3299  0000000                   	ADC #00H
 3300  0000000                   	STA <CH_DATA_BANK_SP,X
 3301  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3302  0000000                   	LDA <CH_DATA_BANK_SP+1,X
 3303  0000000                   	ADC #00H
 3304  0000000                   	STA <CH_DATA_BANK_SP+1,X
 3305  0000000                   
 3306  0000000                   	AND #03H
 3307  0000000                   	BNE CHECK_CROSS_BANK#
 3308  0000000                   	.ENDIF
 3309  0000000                   
 3310  0000000                   	LDA <CH_DATA_BANK_SP,X
 3311  0000000                   	BNE CHECK_CROSS_BANK#
 3312  0000000                   
 3313  0000000                   CHECK_CROSS_BANK_BANK0#:
 3314  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3315  0000000                   	CMP #80H
 3316  0000000                   	BCC END_ADC16_ADDR_X#
 3317  0000000                   	INC <CH_DATA_BANK_SP,X
 3318  0000000                   	BRA END_ADC16_ADDR_X#
 3319  0000000                   
 3320  0000000                   CHECK_CROSS_BANK#:
 3321  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3322  0000000                   	CMP #80H
 3323  0000000                   	BEQ END_ADC16_ADDR_X#
 3324  0000000                   	BCS END_ADC16_ADDR_X#
 3325  0000000                   
 3326  0000000                   	CLC 
 3327  0000000                    	LDA <CH_DATA_ADDR_SP+1,X
 3328  0000000                   	ADC #80H
 3329  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3330  0000000                   
 3331  0000000                   END_ADC16_ADDR_X#:
 3332  0000000                   	ENDM
 3333  0000000                   ;---------------------------------------------------------------------------
 3334  0000000                   ADC32_ADDR_X MACRO VAR_ADDR
 3335  0000000                   	LDA <VAR_ADDR+1
 3336  0000000                   	CMP #80H
 3337  0000000                   	BCC ADC32_ADDR_X_PRE#
 3338  0000000                   
 3339  0000000                   	SEC 
 3340  0000000                   	LDA <VAR_ADDR+1
 3341  0000000                   	SBC #80H
 3342  0000000                   	STA <VAR_ADDR+1
 3343  0000000                   
 3344  0000000                   	ASL <VAR_ADDR+2
 3345  0000000                   	ROL <VAR_ADDR+3
 3346  0000000                   	CLC 
 3347  0000000                   	LDA <VAR_ADDR+2
 3348  0000000                   	ADC #01H
 3349  0000000                   	STA <VAR_ADDR+2
 3350  0000000                   	LDA <VAR_ADDR+3
 3351  0000000                   	ADC #00H
 3352  0000000                   	STA <VAR_ADDR+3





 3353  0000000                   	BRA ADC32_ADDR_X_NEXT#
 3354  0000000                   
 3355  0000000                   ADC32_ADDR_X_PRE#:
 3356  0000000                   	ASL <VAR_ADDR+2
 3357  0000000                   	ROL <VAR_ADDR+3
 3358  0000000                   
 3359  0000000                   ADC32_ADDR_X_NEXT#:
 3360  0000000                   	CLC 
 3361  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3362  0000000                   	ADC <VAR_ADDR
 3363  0000000                   	STA <CH_DATA_ADDR_SP,X
 3364  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3365  0000000                   	ADC <VAR_ADDR+1
 3366  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3367  0000000                   	LDA <CH_DATA_BANK_SP,X
 3368  0000000                   	ADC <VAR_ADDR+2
 3369  0000000                   	STA <CH_DATA_BANK_SP,X
 3370  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 3371  0000000                   	LDA <CH_DATA_BANK_SP+1,X
 3372  0000000                   	ADC <VAR_ADDR+3
 3373  0000000                   	STA <CH_DATA_BANK_SP+1,X
 3374  0000000                   
 3375  0000000                   	AND #03H
 3376  0000000                   	BNE CHECK_CROSS_BANK#
 3377  0000000                   	.ENDIF
 3378  0000000                   
 3379  0000000                   	LDA <CH_DATA_BANK_SP,X
 3380  0000000                   	BNE CHECK_CROSS_BANK#
 3381  0000000                   
 3382  0000000                   CHECK_CROSS_BANK_BANK0#:
 3383  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3384  0000000                   	CMP #80H
 3385  0000000                   	BCC END_ADC32_ADDR_X#
 3386  0000000                   	INC <CH_DATA_BANK_SP,X
 3387  0000000                   	BRA END_ADC32_ADDR_X#
 3388  0000000                   
 3389  0000000                   CHECK_CROSS_BANK#:
 3390  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3391  0000000                   	CMP #80H
 3392  0000000                   	BEQ END_ADC32_ADDR_X#
 3393  0000000                   	BCS END_ADC32_ADDR_X#
 3394  0000000                   
 3395  0000000                   	CLC 
 3396  0000000                    	LDA <CH_DATA_ADDR_SP+1,X
 3397  0000000                   	ADC #80H
 3398  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3399  0000000                   
 3400  0000000                   END_ADC32_ADDR_X#:
 3401  0000000                   	ENDM
 3402  0000000                   ;---------------------------------------------------------------------------
 3403  0000000                   ADC16_ADDR_X_EX_ MACRO VAR_ADDR
 3404  0000000                   	CLC 
 3405  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3406  0000000                   	ADC <VAR_ADDR
 3407  0000000                   	STA <CH_DATA_ADDR_SP,X
 3408  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3409  0000000                   	ADC <VAR_ADDR+1





 3410  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3411  0000000                   	LDA <CH_DATA_BANK_SP,X
 3412  0000000                   	ADC #00H
 3413  0000000                   	STA <CH_DATA_BANK_SP,X
 3414  0000000                   	ENDM
 3415  0000000                   ;---------------------------------------------------------------------------
 3416  0000000                   ADC32_ADDR_X_EX_ MACRO VAR_ADDR
 3417  0000000                   	CLC 
 3418  0000000                   	LDA <CH_DATA_ADDR_SP,X
 3419  0000000                   	ADC <VAR_ADDR
 3420  0000000                   	STA <CH_DATA_ADDR_SP,X
 3421  0000000                   	LDA <CH_DATA_ADDR_SP+1,X
 3422  0000000                   	ADC <VAR_ADDR+1
 3423  0000000                   	STA <CH_DATA_ADDR_SP+1,X
 3424  0000000                   	LDA <CH_DATA_BANK_SP,X
 3425  0000000                   	ADC <VAR_ADDR+2
 3426  0000000                   	STA <CH_DATA_BANK_SP,X
 3427  0000000                   	ENDM	
 3428  0000000                   ;=====================================================================================
 3429  0000000                   ; Add the SIM function implementing by GPIO 2012/12/11 by CWChang
 3430  0000000                   ;=====================================================================================
 3431  0000000                   NEX_CMD_WRITE_STATUS:	.EQU	01h
 3432  0000000                   NEX_CMD_PAGE_PROGRAM:	.EQU	02h
 3433  0000000                   NEX_CMD_READ_DATA:		.EQU	03h
 3434  0000000                   NEX_CMD_WRITE_DISABLE:	.EQU	04h
 3435  0000000                   NEX_CMD_READ_STATUS:	.EQU	05h
 3436  0000000                   NEX_CMD_WRITE_ENABLE:	.EQU	06h
 3437  0000000                   NEX_CMD_FAST_READ:		.EQU	0Bh
 3438  0000000                   NEX_CMD_DEVICE_ID:		.EQU	ABh
 3439  0000000                   NEX_CMD_RELEASE_POWER_DOWN	.EQU	ABh
 3440  0000000                   NEX_CMD_POWER_DOWN:		.EQU	B9h
 3441  0000000                   NEX_CMD_BULK_ERASE:		.EQU	C7h
 3442  0000000                   NEX_CMD_SECTOR_ERASE:	.EQU	D8h
 3443  0000000                   
 3444  0000000                   BIT_0	.EQU	(1<<0)
 3445  0000000                   BIT_1	.EQU	(1<<1)
 3446  0000000                   BIT_2	.EQU	(1<<2)
 3447  0000000                   BIT_3	.EQU	(1<<3)
 3448  0000000                   BIT_4	.EQU	(1<<4)
 3449  0000000                   BIT_5	.EQU	(1<<5)
 3450  0000000                   BIT_6	.EQU	(1<<6)
 3451  0000000                   BIT_7	.EQU	(1<<7)
 3452  0000000                   
 3453  0000000                   ;SPI
 3454  0000000                   BPn:	EQU	BP0
 3455  0000000                   BPnD:	EQU	BP0D
 3456  0000000                   ;BPnM:	EQU	BP1M
 3457  0000000                   BPn_SPI_MASK_1:	EQU	10101010b
 3458  0000000                   BPn_SPI_MASK_2:	EQU	00000001b
 3459  0000000                   NEX_CLK_ADDR:	.EQU	BPn
 3460  0000000                   NEX_CLK:		.EQU	BIT_2
 3461  0000000                   NEX_CLK_B:		.EQU	11111011b
 3462  0000000                   NEX_DI_ADDR:	.EQU	BPn
 3463  0000000                   NEX_DI:			.EQU	BIT_6
 3464  0000000                   NEX_DI_B:		.EQU	10111111b
 3465  0000000                   NEX_DO_ADDR:	.EQU	BPn
 3466  0000000                   NEX_DO:			.EQU	BIT_0





 3467  0000000                   NEX_DO_B:		.EQU	11111110b
 3468  0000000                   NEX_CS0_ADDR:	.EQU	BPn
 3469  0000000                   NEX_CS0:		.EQU	BIT_4
 3470  0000000                   NEX_CS0_B:		.EQU	11101111b
 3471  0000000                   ;;IOSPI_BUFFER   .EQU	50H
 3472  0000000                   ;----------------------------------------------------
 3473  0000000                   NEX_ON0:	.MACRO
 3474  0000000                   	LDA	!NEX_CS0_ADDR
 3475  0000000                   	ORA !BPnD 
 3476  0000000                   	AND #NEX_CS0_B
 3477  0000000                   	STA	!NEX_CS0_ADDR
 3478  0000000                   	.ENDM
 3479  0000000                   ;----------------------------------------------------
 3480  0000000                   NEX_OFF0:	.MACRO
 3481  0000000                   	LDA	!NEX_CS0_ADDR
 3482  0000000                   	ORA !BPnD
 3483  0000000                   	ORA  #NEX_CS0
 3484  0000000                   	STA	!NEX_CS0_ADDR
 3485  0000000                   	.ENDM
 3486  0000000                   ;----------------------------------------------------
 3487  0000000                   NEX_CLK_OUT:	.MACRO
 3488  0000000                   	LDA	!NEX_CLK_ADDR
 3489  0000000                   	ORA !BPnD
 3490  0000000                   	ORA #NEX_CLK
 3491  0000000                   	STA !NEX_CLK_ADDR
 3492  0000000                   	AND #NEX_CLK_B	
 3493  0000000                   	STA	!NEX_CLK_ADDR
 3494  0000000                   	.ENDM
 3495  0000000                   ;----------------------------------------------------
 3496  0000000                   NEX_DI_0:	.MACRO
 3497  0000000                   	LDA	!NEX_DI_ADDR
 3498  0000000                   	ORA !BPnD
 3499  0000000                   	AND #NEX_DI_B
 3500  0000000                   	STA	!NEX_DI_ADDR
 3501  0000000                   	NEX_CLK_OUT
 3502  0000000                   	.ENDM
 3503  0000000                   ;----------------------------------------------------
 3504  0000000                   NEX_DI_1:	.MACRO
 3505  0000000                   	LDA !NEX_DI_ADDR
 3506  0000000                   	ORA !BPnD
 3507  0000000                   	ORA #NEX_DI
 3508  0000000                   	STA	!NEX_DI_ADDR
 3509  0000000                   	NEX_CLK_OUT
 3510  0000000                   	.ENDM
 3511  0000000                   ;----------------------------------------------------
 3512  0000000                   NEX_DI_X:	.MACRO
 3513  0000000                   ;ROL	<NFV_TEMP
 3514  0000000                       ROL	<IOSPI_BUFFER+3
 3515  0000000                   	BCS	NEX_DI_1_#
 3516  0000000                   NEX_DI_0_#:
 3517  0000000                   	NEX_DI_0
 3518  0000000                   	BRA	NEX_DI_X_END_#
 3519  0000000                   NEX_DI_1_#:
 3520  0000000                   	NEX_DI_1
 3521  0000000                   NEX_DI_X_END_#:
 3522  0000000                   	.ENDM
 3523  0000000                   ;----------------------------------------------------





 3524  0000000                   NEX_DO_X:	.MACRO
 3525  0000000                   	LDA	!NEX_DO_ADDR
 3526  0000000                   ;ROL	A
 3527  0000000                       ROR	A
 3528  0000000                   ;ROL	<NFV_TEMP
 3529  0000000                       ROL <IOSPI_BUFFER+3
 3530  0000000                   	NEX_CLK_OUT
 3531  0000000                   	.ENDM
 3532  0000000                   ;----------------------------------------------------
 3533  0000000                   NEX_DI_BYTE_X:	.MACRO
 3534  0000000                   	STA	<IOSPI_BUFFER+3
 3535  0000000                   ;STA <NFV_TEMP
 3536  0000000                   	NEX_DI_X
 3537  0000000                   	NEX_DI_X
 3538  0000000                   	NEX_DI_X
 3539  0000000                   	NEX_DI_X
 3540  0000000                   	NEX_DI_X
 3541  0000000                   	NEX_DI_X
 3542  0000000                   	NEX_DI_X
 3543  0000000                   	NEX_DI_X
 3544  0000000                   	.ENDM
 3545  0000000                   ;----------------------------------------------------
 3546  0000000                   NEX_DO_BYTE_X:	.MACRO
 3547  0000000                   	NEX_DO_X
 3548  0000000                   	NEX_DO_X
 3549  0000000                   	NEX_DO_X
 3550  0000000                   	NEX_DO_X
 3551  0000000                   	NEX_DO_X
 3552  0000000                   	NEX_DO_X
 3553  0000000                   	NEX_DO_X
 3554  0000000                   	NEX_DO_X
 3555  0000000                   	LDA	<IOSPI_BUFFER+3
 3556  0000000                   ;LDA <NFV_TEMP
 3557  0000000                   	.ENDM
 3558  0000000                   ;----------------------------------------------------
 3559  0000000                   NEX_CLK_BYTE:	.MACRO
 3560  0000000                   	NEX_CLK_OUT
 3561  0000000                   	NEX_CLK_OUT
 3562  0000000                   	NEX_CLK_OUT
 3563  0000000                   	NEX_CLK_OUT
 3564  0000000                   	NEX_CLK_OUT
 3565  0000000                   	NEX_CLK_OUT
 3566  0000000                   	NEX_CLK_OUT
 3567  0000000                   	NEX_CLK_OUT
 3568  0000000                   	.ENDM
 3569  0000000                   ;----------------------------------------------------
 3570  0000000                   ;----------------------------------------------------
 3571  0000000                   ; NEX_READ_DATA_START:
 3572  0000000                   ;----------------------------------------------------
 3573  0000000                   NEX_READ_DATA_START: .MACRO
 3574  0000000                   	LDA	#NEX_CMD_READ_DATA
 3575  0000000                   	NEX_DI_BYTE_X
 3576  0000000                   	LDA	<IOSPI_BUFFER+2
 3577  0000000                   	NEX_DI_BYTE_X
 3578  0000000                   	LDA	<IOSPI_BUFFER+1
 3579  0000000                   	NEX_DI_BYTE_X
 3580  0000000                   	LDA	<IOSPI_BUFFER





 3581  0000000                   	NEX_DI_BYTE_X
 3582  0000000                   	.ENDM
 3583  0000000                   ;----------------------------------------------------
 3584  0000000                   ; NEX_READ_CONTINUE:
 3585  0000000                   ;----------------------------------------------------
 3586  0000000                   NEX_READ_CONTINUE: .MACRO
 3587  0000000                   	NEX_DO_BYTE_X
 3588  0000000                   	.ENDM
 3589  0000000                   ;----------------------------------------------------
 3590  0000000                   IOSPI_ADDR_MAPPING MACRO VAR_ADDR	
 3591  0000000                   	LDA <VAR_ADDR+2
 3592  0000000                   	BIT #01H
 3593  0000000                   	BNE ODD_BANK# 
 3594  0000000                   	LDA <VAR_ADDR+1
 3595  0000000                   	AND #7FH
 3596  0000000                   	STA <IOSPI_BUFFER+1
 3597  0000000                   	BRA ADDR_MAPPING_END# 
 3598  0000000                   ODD_BANK#:	
 3599  0000000                   	LDA <VAR_ADDR+1
 3600  0000000                   	STA <IOSPI_BUFFER+1
 3601  0000000                   ADDR_MAPPING_END#:   
 3602  0000000                   	LDA <VAR_ADDR+2
 3603  0000000                   	AND #7FH
 3604  0000000                   	LSR A
 3605  0000000                   	STA <IOSPI_BUFFER+2
 3606  0000000                   	LDA <VAR_ADDR
 3607  0000000                   	STA <IOSPI_BUFFER
 3608  0000000                   	ENDM
 3609  0000000                   ;----------------------------------------------------
 3610  0000000                   IOSPI_ADDR_MAPPING_X MACRO VAR_ADDR	
 3611  0000000                   	LDA <VAR_ADDR+2,X
 3612  0000000                   	BIT #01H
 3613  0000000                   	BNE ODD_BANK# 
 3614  0000000                   	LDA <VAR_ADDR+1,X
 3615  0000000                   	AND #7FH
 3616  0000000                   	STA <IOSPI_BUFFER+1
 3617  0000000                   	BRA ADDR_MAPPING_END# 
 3618  0000000                   ODD_BANK#:	
 3619  0000000                   	LDA <VAR_ADDR+1,X
 3620  0000000                   	STA <IOSPI_BUFFER+1
 3621  0000000                   ADDR_MAPPING_END#:   
 3622  0000000                   	LDA <VAR_ADDR+2,X
 3623  0000000                   	AND #7FH
 3624  0000000                   	LSR A
 3625  0000000                   	STA <IOSPI_BUFFER+2
 3626  0000000                   	LDA <VAR_ADDR,X
 3627  0000000                   	STA <IOSPI_BUFFER
 3628  0000000                   	ENDM
 3629  0000000                   ;----------------------------------------------------
 3630  0000000                   IOSPI_ADDR_LOAD MACRO VAR_ADDR	
 3631  0000000                   	LDA VAR_ADDR
 3632  0000000                   	STA <IOSPI_BUFFER
 3633  0000000                   	LDA VAR_ADDR+1
 3634  0000000                   	STA <IOSPI_BUFFER+1
 3635  0000000                   	LDA VAR_ADDR+2
 3636  0000000                   	STA <IOSPI_BUFFER+2
 3637  0000000                   	ENDM





 3638  0000000                   ;----------------------------------------------------
 3639  0000000                   IOSPI_ADDR_LOAD_X MACRO VAR_ADDR	
 3640  0000000                   	LDA VAR_ADDR,X
 3641  0000000                   	STA <IOSPI_BUFFER
 3642  0000000                   	LDA VAR_ADDR+1,X
 3643  0000000                   	STA <IOSPI_BUFFER+1
 3644  0000000                   	LDA VAR_ADDR+2,X
 3645  0000000                   	STA <IOSPI_BUFFER+2
 3646  0000000                   	ENDM
 3647  0000000                   ;-----------------------------------------------------
 3648  0000000                   IOSPI_INIT  MACRO 	
 3649  0000000                   	LDA !BPnD
 3650  0000000                   	AND #BPn_SPI_MASK_1
 3651  0000000                   	ORA #BPn_SPI_MASK_2
 3652  0000000                   	STA !BPnD
 3653  0000000                   	LDA !BPn
 3654  0000000                   	ORA !BPnD
 3655  0000000                   	AND #BPn_SPI_MASK_1
 3656  0000000                   	ORA #BPn_SPI_MASK_2
 3657  0000000                   	STA !BPn
 3658  0000000                   	NEX_OFF0
 3659  0000000                   	ENDM
 3660  0000000                   ;-----------------------------------------------------
 3661  0000000                   LDA_DP_ILI_SIM_IOSPI MACRO 	VAR_ADDR
 3662  0000000                   ;IOSPI_ADDR_MAPPING TEMP_REG1
 3663  0000000                   	IOSPI_INIT
 3664  0000000                   
 3665  0000000                   	LDA VAR_ADDR
 3666  0000000                   	STA <IOSPI_BUFFER
 3667  0000000                   	LDA VAR_ADDR+1
 3668  0000000                   	STA <IOSPI_BUFFER+1
 3669  0000000                   	LDA VAR_ADDR+2
 3670  0000000                   	STA <IOSPI_BUFFER+2
 3671  0000000                   
 3672  0000000                   	NEX_ON0
 3673  0000000                   	NEX_READ_DATA_START
 3674  0000000                   	NEX_READ_CONTINUE
 3675  0000000                   	NEX_OFF0
 3676  0000000                   
 3677  0000000                   	LDA <IOSPI_BUFFER+3
 3678  0000000                   	ENDM
 3679  0000000                   ;----------------------------------------------------
 3680  0000000                   LDA_DP_ILI_Y_SIM_IOSPI MACRO VAR_ADDR	
 3681  0000000                   ;IOSPI_ADDR_MAPPING TEMP_REG1
 3682  0000000                   	IOSPI_INIT
 3683  0000000                   
 3684  0000000                   	LDA VAR_ADDR
 3685  0000000                   	STA <IOSPI_BUFFER
 3686  0000000                   	LDA VAR_ADDR+1
 3687  0000000                   	STA <IOSPI_BUFFER+1
 3688  0000000                   	LDA VAR_ADDR+2
 3689  0000000                   	STA <IOSPI_BUFFER+2
 3690  0000000                   
 3691  0000000                   	TYA 
 3692  0000000                   	CLC 
 3693  0000000                   	ADC <IOSPI_BUFFER
 3694  0000000                   	STA <IOSPI_BUFFER





 3695  0000000                   	LDA <IOSPI_BUFFER+1
 3696  0000000                   	ADC #00H
 3697  0000000                   	STA <IOSPI_BUFFER+1
 3698  0000000                   	LDA <IOSPI_BUFFER+2
 3699  0000000                   	ADC #00H
 3700  0000000                   	STA <IOSPI_BUFFER+2	
 3701  0000000                   
 3702  0000000                   	NEX_ON0
 3703  0000000                   	NEX_READ_DATA_START
 3704  0000000                   	NEX_READ_CONTINUE
 3705  0000000                   	NEX_OFF0
 3706  0000000                   
 3707  0000000                   	LDA <IOSPI_BUFFER+3
 3708  0000000                   	ENDM
 3709  0000000                   ;------------------------------------------------
 3710  0000000                   ;load Temp buffer data
 3711  0000000                   LDA_DP_ILI_CH_DATA_SP_EXT_IOSPI MACRO CHANNEL_NAME,INDEX  
 3712  0000000                   	LDY #INDEX
 3713  0000000                   	LDA !IOSPI_BUFFER,Y
 3714  0000000                   	ENDM
 3715  0000000                   ;-------------------------------------------------
 3716  0000000                   SET_SIC_BUF_SP_EXT_IOSPI MACRO VALUE, CHANNEL_NAME
 3717  0000000                   	LDY #0	
 3718  0000000                   CONTINUE_READ#:	
 3719  0000000                   	NEX_READ_CONTINUE
 3720  0000000                   	STA !IOSPI_BUFFER,Y
 3721  0000000                   	INY 
 3722  0000000                   	CPY #VALUE+1
 3723  0000000                   	BEQ CONTINUE_READ_END#
 3724  0000000                   	JMP CONTINUE_READ#
 3725  0000000                   CONTINUE_READ_END#:		
 3726  0000000                   	ENDM
 3727  0000000                   ;------------------------------------------------------------------------------
 3728  0000000                   ;------------------------------------------------------------------------------	
 3729  0000000                   NEX_POWER_DOWN MACRO
 3730  0000000                   	LDA #NEX_CMD_POWER_DOWN
 3731  0000000                   	NEX_DI_BYTE_X
 3732  0000000                   	ENDM
 3733  0000000                   ;----------------------------------------------------
 3734  0000000                   NEX_RELEASE_POWER_DOWN MACRO
 3735  0000000                   	LDA #NEX_CMD_RELEASE_POWER_DOWN
 3736  0000000                   	NEX_DI_BYTE_X
 3737  0000000                   	ENDM
 3738  0000000                   ;----------------------------------------------------
 3739  0000000                   DELAY_MACRO MACRO
 3740  0000000                       	LDX #0AH
 3741  0000000                   LOOP#:	
 3742  0000000                   	NOP
 3743  0000000                   	NOP
 3744  0000000                   	DEX
 3745  0000000                       	BNE LOOP#
 3746  0000000                       	ENDM
 3747  0000000                   ;----------------------------------------------------   	
 3748  0000000                   SPI_ENTER_POWER_DOWN MACRO REG,FLAG,FLAG_REG
 3749  0000000                   .IF (WITH_SPI_GPIO .EQ. 1H)
 3750  0000000                   	SEI
 3751  0000000                   	LDA !BPnD





 3752  0000000                   	STA REG
 3753  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3754  0000000                   	LDA <BP0M_BAK
 3755  0000000                   	STA REG+1
 3756  0000000                   	.ENDIF
 3757  0000000                   
 3758  0000000                   	LDA #01010100b
 3759  0000000                   	TRB !BPnD
 3760  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3761  0000000                   	TRB <BP0M_BAK
 3762  0000000                   	.ENDIF
 3763  0000000                   	LDA !BPn
 3764  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3765  0000000                   	ORA #NEX_CS0		;CSB:1	
 3766  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3767  0000000                   	ORA !BPnD		
 3768  0000000                   	.ELSE
 3769  0000000                   	ORA <BP0M_BAK
 3770  0000000                   	.ENDIF
 3771  0000000                   	STA !BPn
 3772  0000000                   
 3773  0000000                   	NEX_ON0
 3774  0000000                   	NEX_POWER_DOWN
 3775  0000000                   	NEX_OFF0
 3776  0000000                   
 3777  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3778  0000000                   	LDA REG+1
 3779  0000000                   	STA <BP0M_BAK
 3780  0000000                   	.ENDIF
 3781  0000000                   	LDA REG
 3782  0000000                   	STA !BPnD
 3783  0000000                   	LDA #FLAG
 3784  0000000                   	TSB FLAG_REG
 3785  0000000                   .ENDIF
 3786  0000000                   	ENDM
 3787  0000000                   ;------------------------------------------------------------------------------
 3788  0000000                   SPI_RELEASE_POWER_DOWN MACRO REG,FLAG,FLAG_REG
 3789  0000000                   .IF (WITH_SPI_GPIO.EQ. 1H)
 3790  0000000                   	SEI
 3791  0000000                   	LDA #FLAG
 3792  0000000                   	BIT FLAG_REG
 3793  0000000                   	BNE 3 
 3794  0000000                   	JMP END_SPI_RELEASE_POWER_DOWN#
 3795  0000000                   	TRB FLAG_REG
 3796  0000000                   
 3797  0000000                   	LDA !BPnD
 3798  0000000                   	STA REG
 3799  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3800  0000000                   	LDA <BP0M_BAK
 3801  0000000                   	STA REG+1
 3802  0000000                   	.ENDIF
 3803  0000000                   
 3804  0000000                   	LDA #01010100b
 3805  0000000                   	TRB !BPnD
 3806  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3807  0000000                   	TRB <BP0M_BAK
 3808  0000000                   	.ENDIF





 3809  0000000                   	LDA !BPn
 3810  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3811  0000000                   	ORA #NEX_CS0		;CSB:1	
 3812  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3813  0000000                   	ORA !BPnD		
 3814  0000000                   	.ELSE
 3815  0000000                   	ORA <BP0M_BAK
 3816  0000000                   	.ENDIF
 3817  0000000                   	STA !BPn
 3818  0000000                   
 3819  0000000                   	NEX_ON0
 3820  0000000                   	NEX_RELEASE_POWER_DOWN
 3821  0000000                   	NEX_OFF0  
 3822  0000000                   
 3823  0000000                   	DELAY_MACRO 
 3824  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3825  0000000                   	LDA REG+1
 3826  0000000                   	STA <BP0M_BAK
 3827  0000000                   	.ENDIF 
 3828  0000000                   	LDA REG
 3829  0000000                   	STA !BPnD
 3830  0000000                   
 3831  0000000                   END_SPI_RELEASE_POWER_DOWN#:
 3832  0000000                   	CLI
 3833  0000000                   .ENDIF
 3834  0000000                   	ENDM
 3835  0000000                   ;------------------------------------------------------------------------------
 3836  0000000                   SPI_RELEASE_POWER_DOWN_MAIN MACRO REG,FLAG,FLAG_REG
 3837  0000000                   .IF (WITH_SPI_GPIO .EQ. 1H)
 3838  0000000                   	SEI
 3839  0000000                   	LDA #RESET_POR
 3840  0000000                   	BIT !RESET_F
 3841  0000000                   	BEQ 3
 3842  0000000                   	JMP MAIN_START_NEXT#
 3843  0000000                   	LDA #FLAG
 3844  0000000                   	BIT FLAG_REG
 3845  0000000                   	BNE 3 
 3846  0000000                   	JMP MAIN_START_NEXT#
 3847  0000000                   	TRB FLAG_REG
 3848  0000000                   
 3849  0000000                   	LDA !BPnD
 3850  0000000                   	STA REG
 3851  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3852  0000000                   	LDA <BP0M_BAK
 3853  0000000                   	STA REG+1
 3854  0000000                   	.ENDIF
 3855  0000000                   
 3856  0000000                   	LDA #01010100b
 3857  0000000                   	TRB !BPnD
 3858  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3859  0000000                   	TRB <BP0M_BAK
 3860  0000000                   	.ENDIF
 3861  0000000                   	LDA !BPn
 3862  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3863  0000000                   	ORA #NEX_CS0		;CSB:1	
 3864  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3865  0000000                   	ORA !BPnD		





 3866  0000000                   	.ELSE
 3867  0000000                   	ORA <BP0M_BAK
 3868  0000000                   	.ENDIF
 3869  0000000                   	STA !BPn
 3870  0000000                   
 3871  0000000                   	NEX_ON0
 3872  0000000                   	NEX_RELEASE_POWER_DOWN
 3873  0000000                   	NEX_OFF0  
 3874  0000000                   
 3875  0000000                   	DELAY_MACRO  
 3876  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3877  0000000                   	LDA REG+1
 3878  0000000                   	STA <BP0M_BAK
 3879  0000000                   	.ENDIF 
 3880  0000000                   	LDA REG
 3881  0000000                   	STA !BPnD
 3882  0000000                   
 3883  0000000                   MAIN_START_NEXT#:
 3884  0000000                   	LDA #RESET_POR
 3885  0000000                   	STA !RESET_F
 3886  0000000                   .ENDIF
 3887  0000000                   	ENDM
 3888  0000000                   ;------------------------------------------------------------------------------
 3889  0000000                   SPI_RELEASE_POWER_DOWN_PORT MACRO REG,FLAG,FLAG_REG
 3890  0000000                   .IF (WITH_SPI_GPIO .EQ. 1H)
 3891  0000000                   	SEI
 3892  0000000                   	LDA #FLAG
 3893  0000000                   	BIT FLAG_REG
 3894  0000000                   	BNE 3 
 3895  0000000                   	JMP END_SPI_RELEASE_POWER_DOWN_PORT#
 3896  0000000                   	TRB FLAG_REG
 3897  0000000                   
 3898  0000000                   	LDA !BPnD
 3899  0000000                   	STA REG
 3900  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3901  0000000                   	LDA <BP0M_BAK
 3902  0000000                   	STA REG+1
 3903  0000000                   	.ENDIF
 3904  0000000                   
 3905  0000000                   	LDA #01010100b
 3906  0000000                   	TRB !BPnD
 3907  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3908  0000000                   	TRB <BP0M_BAK
 3909  0000000                   	.ENDIF
 3910  0000000                   	LDA !BPn
 3911  0000000                   	AND #BPn_SPI_MASK_1	;DO,CSB,CLK:0
 3912  0000000                   	ORA #NEX_CS0		;CSB:1	
 3913  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 0H)
 3914  0000000                   	ORA !BPnD		
 3915  0000000                   	.ELSE
 3916  0000000                   	ORA <BP0M_BAK
 3917  0000000                   	.ENDIF
 3918  0000000                   	STA !BPn
 3919  0000000                   
 3920  0000000                   	NEX_ON0
 3921  0000000                   	NEX_RELEASE_POWER_DOWN
 3922  0000000                   	NEX_OFF0 





 3923  0000000                   
 3924  0000000                   	DELAY_MACRO  
 3925  0000000                   	.IF (WITH_PSF_PROJECT .EQ. 1H)
 3926  0000000                   	LDA REG+1
 3927  0000000                   	STA <BP0M_BAK
 3928  0000000                   	.ENDIF  
 3929  0000000                   	LDA REG
 3930  0000000                   	STA !BPnD
 3931  0000000                   
 3932  0000000                   END_SPI_RELEASE_POWER_DOWN_PORT#:
 3933  0000000                   .ENDIF
 3934  0000000                   	ENDM
 3935  0000000                   ;------------------------------------------------------------------------------
 3936  0000000                   ;------------------------------------------------------------------------------
 3937  0000000                   ;IEF0_FLAG: 
 3938  0000000                   ;80h:speech/other interrupt 
 3939  0000000                   ;40h:BAM in speech interrupt
 3940  0000000                   ;20H:BAM interrupt
 3941  0000000                   ;10H:speech in BAM interrupt
 3942  0000000                   ;------------------------------------------------------------------------------
 3943  0000000                   ENABLE_SPEECH_INT_EXCEPT MACRO
 3944  0000000                   .ifdef	FW_BAM_TIMER
 3945  0000000                   	LDA <UIO_TIMER_CH_FLAG				;3
 3946  0000000                   	BEQ END_ENABLE_SPEECH_INT_EXCEPT#		;2~3
 3947  0000000                   
 3948  0000000                   	LDA <IEF0_FLAG					;3
 3949  0000000                   	BIT #80H					;2
 3950  0000000                   	BEQ ENABLE_SPEECH_INT_EXCEPT_NEXT#		;2~3
 3951  0000000                   	LDA #40H					;2
 3952  0000000                   	TSB <IEF0_FLAG					;5
 3953  0000000                   	BRA END_ENABLE_SPEECH_INT_EXCEPT#		;3
 3954  0000000                   
 3955  0000000                   ENABLE_SPEECH_INT_EXCEPT_NEXT#:
 3956  0000000                   	LDA <UIO_BIT_COUNT				;3
 3957  0000000                   	AND #07H					;2
 3958  0000000                   	EXTERN BAM_INT_LONG				
 3959  0000000                   	CMP #BAM_INT_LONG				;2
 3960  0000000                   	BNE END_ENABLE_SPEECH_INT_EXCEPT#		;2~3
 3961  0000000                   	LDA #20H					;2
 3962  0000000                   	TSB <IEF0_FLAG					;5
 3963  0000000                   	LDA !IEF0					;4
 3964  0000000                   	STA <IEF0_BAK					;3
 3965  0000000                   	AND #(INT0_TM0+INT0_TM1+INT0_TMG0)		;2
 3966  0000000                   	AND #(FFH^UIO_TIMER_INT)			;2
 3967  0000000                   	STA !IEF0 					;4
 3968  0000000                   	CLI						;2
 3969  0000000                   END_ENABLE_SPEECH_INT_EXCEPT#:
 3970  0000000                   .endif
 3971  0000000                   ENDM	
 3972  0000000                   ;------------------------------------------------------------------------------
 3973  0000000                   ENABLE_BAM_INT_EXCEPT	MACRO
 3974  0000000                   .ifdef	FW_BAM_TIMER
 3975  0000000                   	LDA <UIO_TIMER_CH_FLAG				;3
 3976  0000000                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			;2~3
 3977  0000000                   
 3978  0000000                   	LDA <IEF0_FLAG					;3
 3979  0000000                   	BIT #20H					;2





 3980  0000000                   	BEQ ENABLE_BAM_INT_EXCEPT_NEXT#			;2~3
 3981  0000000                   	LDA #10H					;2
 3982  0000000                   	TSB <IEF0_FLAG					;5
 3983  0000000                   	BRA END_ENABLE_BAM_INT_EXCEPT#			;3
 3984  0000000                   
 3985  0000000                   ENABLE_BAM_INT_EXCEPT_NEXT#:
 3986  0000000                   	LDA <UIO_BIT_COUNT				;3
 3987  0000000                   	AND #07H					;2
 3988  0000000                   	EXTERN BAM_INT_LONG
 3989  0000000                   	CMP #BAM_INT_LONG				;2
 3990  0000000                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			;2~3
 3991  0000000                   	CMP #00H					;2
 3992  0000000                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			;2~3
 3993  0000000                   	LDA #80H					;2
 3994  0000000                   	TSB <IEF0_FLAG					;5
 3995  0000000                   	LDA !IEF0					;4
 3996  0000000                   	STA <IEF0_BAK					;3
 3997  0000000                   	AND #UIO_TIMER_INT				;2
 3998  0000000                   	STA !IEF0 					;4
 3999  0000000                   	CLI						;2
 4000  0000000                   END_ENABLE_BAM_INT_EXCEPT#:
 4001  0000000                   .endif
 4002  0000000                   ENDM
 4003  0000000                   ;------------------------------------------------------------------------------
 4004  0000000                   QUIT_ENABLE_BAM_INT_EXCEPT	MACRO
 4005  0000000                   .ifdef	FW_BAM_TIMER
 4006  0000000                   	LDA <IEF0_FLAG					;3
 4007  0000000                   	BIT #C0H					;2
 4008  0000000                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			;2~3
 4009  0000000                   	BIT #40H					;2
 4010  0000000                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		;2~3
 4011  0000000                   	LDA #40H					;2
 4012  0000000                   	TRB <IEF0_FLAG					;5
 4013  0000000                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		;3
 4014  0000000                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
 4015  0000000                   	SEI						;2
 4016  0000000                   	LDA <IEF0_BAK					;3
 4017  0000000                   	AND #(FFH^UIO_TIMER_INT)			;2
 4018  0000000                   	ORA !IEF0					;4
 4019  0000000                   	STA !IEF0					;4
 4020  0000000                   	LDA #80H					;2
 4021  0000000                   	TRB <IEF0_FLAG					;5
 4022  0000000                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		;3
 4023  0000000                   
 4024  0000000                   NEXT_CHECK_BAM_INT_EXCEPT#:
 4025  0000000                   	BIT #30H					;2
 4026  0000000                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		;2~3
 4027  0000000                   	BIT #10H					;2
 4028  0000000                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		;2~3
 4029  0000000                   	LDA #10H					;2
 4030  0000000                   	TRB <IEF0_FLAG					;5
 4031  0000000                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		;3
 4032  0000000                   
 4033  0000000                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
 4034  0000000                   	SEI						;2
 4035  0000000                   	LDA <IEF0_BAK					;3
 4036  0000000                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		;2





 4037  0000000                   	ORA #UIO_TIMER_INT				;2
 4038  0000000                   	ORA !IEF0					;4
 4039  0000000                   	STA !IEF0					;4
 4040  0000000                   	LDA #20H					;2
 4041  0000000                   	TRB <IEF0_FLAG					;5
 4042  0000000                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
 4043  0000000                   .endif
 4044  0000000                   ENDM
 4045  0000000                   ;------------------------------------------------------------------------------
 4046  0000000                   ENABLE_BAM_INT_EXCEPT_PSF_TIMER	MACRO
 4047  0000000                   .ifdef	FW_BAM_TIMER
 4048  0000000                   	LDA <UIO_TIMER_CH_FLAG
 4049  0000000                   	BNE END_ENABLE_BAM_INT_EXCEPT_PSF_TIMER#
 4050  0000000                   ENABLE_BAM_INT_EXCEPT#:
 4051  0000000                   .endif
 4052  0000000                   	SEI
 4053  0000000                   END_ENABLE_BAM_INT_EXCEPT_PSF_TIMER#:
 4054  0000000                   ENDM
 4055  0000000                   ;------------------------------------------------------------------------------
 4056  0000000                   ;------------------------------------------------------------------------------
 4057  0000000                   STORE_CH_ADDR_TO_BAM_REG MACRO CHANNEL_NAME
 4058  0000000                   	EXTERN BAM_EVENT_ADDR_OFFSET_TABLE
 4059  0000000                   	EXTERN BAM_EVENT_ADDR_SP1
 4060  0000000                   	LDA !BAM_EVENT_ADDR_OFFSET_TABLE,Y
 4061  0000000                   	TAY
 4062  0000000                   
 4063  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 4064  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK1|CHANNEL_NAME
 4065  0000000                   	STA BAM_EVENT_ADDR_SP1+3,Y
 4066  0000000                   	.ENDIF
 4067  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_BANK|CHANNEL_NAME
 4068  0000000                   	STA BAM_EVENT_ADDR_SP1+2,Y
 4069  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME+1
 4070  0000000                   	STA BAM_EVENT_ADDR_SP1+1,Y
 4071  0000000                   	LDA <CHANNEL_ADDR+CH_DATA_ADDR|CHANNEL_NAME
 4072  0000000                   	STA BAM_EVENT_ADDR_SP1,Y
 4073  0000000                   	ENDM
 4074  0000000                   ;------------------------------------------------------------------------------
 4075  0000000                   ;------------------------------------------------------------------------------
 4076  0000000                   PSF_RESPONSE_LIMIT MACRO 
 4077  0000000                   .IF (WITH_PSF_PROJECT .EQ. 1)
 4078  0000000                   .IFDEF ABANDON_STACK
 4079  0000000                   	LDA #80H
 4080  0000000                   	BIT ABANDON_STACK_FLAG
 4081  0000000                   	BEQ PSF_RESPONSE_LIMIT_END#
 4082  0000000                   	LDA #01H
 4083  0000000                   PSF_RESPONSE_LIMIT_END#:
 4084  0000000                   	TSB ABANDON_STACK_FLAG
 4085  0000000                   .ENDIF
 4086  0000000                   .ENDIF
 4087  0000000                   	ENDM
 4088  0000000                   ;------------------------------------------------------------------------------
 4089  0000000                   PSF_RESPONSE_LIMIT_RELEASE MACRO 
 4090  0000000                   .IF (WITH_PSF_PROJECT .EQ. 1)
 4091  0000000                   .IFDEF ABANDON_STACK
 4092  0000000                   	LDA #01H
 4093  0000000                   	BIT ABANDON_STACK_FLAG





 4094  0000000                   	BNE PSF_RESPONSE_LIMIT_RELEASE_END#
 4095  0000000                   	LDA #80H
 4096  0000000                   PSF_RESPONSE_LIMIT_RELEASE_END#:
 4097  0000000                   	TRB ABANDON_STACK_FLAG
 4098  0000000                   .ENDIF
 4099  0000000                   .ENDIF
 4100  0000000                   	ENDM	
 4101  0000000                   ;------------------------------------------------------------------------------	
 4102  0000000                   PSF_RESPONSE_LIMIT_JSR MACRO JSR_ADDR
 4103  0000000                   	PSF_RESPONSE_LIMIT
 4104  0000000                   	JSR JSR_ADDR
 4105  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4106  0000000                   	ENDM
 4107  0000000                   ;------------------------------------------------------------------------------
 4108  0000000                   ;------------------------------------------------------------------------------
 4109  0000000                   
 4110  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\N588H_MACRO_SYSTEM_INIT.INI.APP"
 4111  0000000                   SYSTEM_INIT_PROCEDURE MACRO
 4112  0000000                   	.IF	(CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
 4113  0000000                       	SYSTEM_INIT_PROCEDURE_N588H
 4114  0000000                       	.ENDIF
 4115  0000000                   	ENDM
 4116  0000000                   
 4117  0000000                   SYSTEM_INIT_PROCEDURE_N588H MACRO
 4118  0000000                   	.IF	 (PARTNO='N588H000')
 4119  0000000                   	SYSTEM_INIT_PROCEDURE_N588H000
 4120  0000000                   	.ELSE
 4121  0000000                   	SYSTEM_INIT_PROCEDURE_N588H340
 4122  0000000                   	.ENDIF
 4123  0000000                   	ENDM 
 4124  0000000                   
 4125  0000000                   SYSTEM_INIT_PROCEDURE_N588H000 MACRO
 4126  0000000                   	LDA #04H
 4127  0000000                   	TSB CTL_CPU
 4128  0000000                   ; for ICE chip to keep Fosc same as Rosc and it can't be changed again
 4129  0000000                   ; This bit is reserved bit for Product chip 
 4130  0000000                   	LDA #1EH
 4131  0000000                   	STA CFGF
 4132  0000000                   	LDA #FFH 
 4133  0000000                   	STA CFGE 
 4134  0000000                   ;new version
 4135  0000000                   	.IFDEF      ROSC_USER
 4136  0000000                   	    LDA #F7H        
 4137  0000000                   	.ENDIF
 4138  0000000                   	.IFDEF      ROSC_4M
 4139  0000000                   	    LDA #E7H
 4140  0000000                   	.ENDIF	
 4141  0000000                   	.IFDEF      ROSC_8M
 4142  0000000                   	    LDA #D7H
 4143  0000000                   	.ENDIF
 4144  0000000                   	.IFDEF      ROSC_6M
 4145  0000000                   	    LDA #C7H
 4146  0000000                   	.ENDIF
 4147  0000000                   	STA CFGA
 4148  0000000                   	LDA #13H
 4149  0000000                   	STA CFGD
 4150  0000000                   	LDA #12H





 4151  0000000                   	STA CFGC
 4152  0000000                   	LDA #1FH
 4153  0000000                   	.IFDEF      INN_INTERNAL
 4154  0000000                   	    ORA #20H
 4155  0000000                   	.ENDIF
 4156  0000000                   	.IFDEF      LVR_20V
 4157  0000000                   	    ORA #C0H
 4158  0000000                   	.ENDIF
 4159  0000000                   	.IFDEF      LVR_22V
 4160  0000000                   	    ORA #80H
 4161  0000000                   	.ENDIF	
 4162  0000000                   	.IFDEF      LVR_26V
 4163  0000000                   	    ORA #40H
 4164  0000000                   	.ENDIF
 4165  0000000                   	.IFDEF      LVR_28V
 4166  0000000                   	    ORA #00H
 4167  0000000                   	.ENDIF
 4168  0000000                   	STA CFGB	
 4169  0000000                   	LDA #F2H
 4170  0000000                   	STA	CFG9
 4171  0000000                   	LDA #FFH
 4172  0000000                   	STA	CFG8
 4173  0000000                   	LDA #D7H
 4174  0000000                   	STA	CFG7
 4175  0000000                   	LDA	#00H
 4176  0000000                   	STA	CFG6
 4177  0000000                   	LDA	#40H
 4178  0000000                   	STA	CFG5
 4179  0000000                   	LDA	#00H
 4180  0000000                   	STA	CFG4
 4181  0000000                   	.IFDEF	WDTIMER
 4182  0000000                   	LDA	#FFH
 4183  0000000                   	.ELSE
 4184  0000000                   	LDA	#7FH
 4185  0000000                   	.ENDIF	
 4186  0000000                   	STA	CFG3
 4187  0000000                   	LDA	#FFH
 4188  0000000                   	STA	CFG2
 4189  0000000                   	.IFDEF	PHR_150
 4190  0000000                   	LDA	#FFH
 4191  0000000                   	.ELSE
 4192  0000000                   	LDA	#BFH
 4193  0000000                   	.ENDIF
 4194  0000000                   	STA	CFG1
 4195  0000000                   	LDA	#FFH
 4196  0000000                   	STA	CFG0
 4197  0000000                   	ENDM
 4198  0000000                   
 4199  0000000                   SYSTEM_INIT_PROCEDURE_N588H340 MACRO
 4200  0000000                   	LDA #04H
 4201  0000000                   	TSB CTL_CPU
 4202  0000000                   ; for ICE chip to keep Fosc same as Rosc and it can't be changed again
 4203  0000000                   ; This bit is reserved bit for Product chip 
 4204  0000000                   	LDA #16H
 4205  0000000                   	STA CFGF
 4206  0000000                   	LDA #FFH 
 4207  0000000                   	STA CFGE 





 4208  0000000                   ;new version
 4209  0000000                   	.IFDEF      ROSC_USER
 4210  0000000                   	    LDA #75H  	        
 4211  0000000                   	.ENDIF
 4212  0000000                   	.IFDEF      ROSC_4M
 4213  0000000                   	    LDA #65H
 4214  0000000                   	.ENDIF	
 4215  0000000                   	.IFDEF      ROSC_8M
 4216  0000000                   	    LDA #55H
 4217  0000000                   	.ENDIF
 4218  0000000                   	.IFDEF      ROSC_6M
 4219  0000000                   	    LDA #45H
 4220  0000000                   	.ENDIF
 4221  0000000                   	.IF	 (PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341')
 4222  0000000                   	    ORA #00H
 4223  0000000                   	.ELSE
 4224  0000000                   	    ORA #02H	
 4225  0000000                   	.ENDIF	
 4226  0000000                   	STA CFGA
 4227  0000000                   	LDA #17H
 4228  0000000                   	STA CFGD
 4229  0000000                   	LDA #02H
 4230  0000000                   	STA CFGC
 4231  0000000                   	LDA #02H
 4232  0000000                   	.IFDEF      INN_INTERNAL
 4233  0000000                   	    ORA #20H
 4234  0000000                   	.ENDIF	
 4235  0000000                   	.IFDEF      LVR_20V
 4236  0000000                   	    ORA #C0H
 4237  0000000                   	.ENDIF
 4238  0000000                   	.IFDEF      LVR_22V
 4239  0000000                   	    ORA #80H
 4240  0000000                   	.ENDIF	
 4241  0000000                   	.IFDEF      LVR_26V
 4242  0000000                   	    ORA #40H
 4243  0000000                   	.ENDIF
 4244  0000000                   	.IFDEF      LVR_28V
 4245  0000000                   	    ORA #00H
 4246  0000000                   	.ENDIF
 4247  0000000                   	STA CFGB
 4248  0000000                   	.IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
 4249  0000000                   	    LDA #00H
 4250  0000000                   	.ENDIF
 4251  0000000                   	.IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170').OR.(PARTNO='N588JP170')
 4252  0000000                   	    LDA #00H
 4253  0000000                   	.ENDIF
 4254  0000000                   	.IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
 4255  0000000                   	    LDA #02H
 4256  0000000                   	.ENDIF
 4257  0000000                   	.IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
 4258  0000000                   	    LDA #02H
 4259  0000000                   	.ENDIF
 4260  0000000                   	STA	CFG9
 4261  0000000                   	.IF	(CHIPSERIES = 'N588H')
 4262  0000000                   	    LDA #9EH
 4263  0000000                   	.ENDIF
 4264  0000000                   	.IF	(CHIPSERIES = 'N588J')





 4265  0000000                   	    LDA #96H
 4266  0000000                   	.ENDIF
 4267  0000000                   	STA	CFG8
 4268  0000000                   	LDA 	#02H
 4269  0000000                   	STA	CFG7
 4270  0000000                   	LDA	#00H
 4271  0000000                   	STA	CFG6
 4272  0000000                   	STA	CFG5
 4273  0000000                   	STA	CFG4
 4274  0000000                   	.IFDEF	WDTIMER
 4275  0000000                   	    LDA	#F7H
 4276  0000000                   	.ELSE
 4277  0000000                   	    LDA	#77H
 4278  0000000                   	.ENDIF	
 4279  0000000                   	STA	CFG3
 4280  0000000                   	LDA	#FFH
 4281  0000000                   	STA	CFG2
 4282  0000000                   	.IFDEF	PHR_150
 4283  0000000                   	    LDA	#DFH
 4284  0000000                   	.ELSE
 4285  0000000                   	    LDA	#9FH
 4286  0000000                   	.ENDIF
 4287  0000000                   	STA	CFG1
 4288  0000000                   	.IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
 4289  0000000                   	    LDA #00H
 4290  0000000                   	.ENDIF
 4291  0000000                   	.IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170').OR.(PARTNO='N588JP170')
 4292  0000000                   	    LDA #00H
 4293  0000000                   	.ENDIF
 4294  0000000                   	.IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
 4295  0000000                   	    LDA #F0H
 4296  0000000                   	.ENDIF
 4297  0000000                   	.IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
 4298  0000000                   	    LDA #F0H
 4299  0000000                   	.ENDIF
 4300  0000000                   	STA	CFG0
 4301  0000000                   	ENDM
 4302  0000000                   ;------------------------------------------------------
 4303  0000000                   .IF(WITH_SPEAKER_SWITCH .EQ. 1)
 4304  0000000                   SET_SPEAKER_OUTPUT_TYPE_TO	MACRO	OUTPUT_TYPE
 4305  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0))
 4306  0000000                   .ELSE
 4307  0000000                    	LDA #OUTPUT_TYPE		;01H=DAC, 02H=EPWM
 4308  0000000                   	BIT #SPEN_EPWM
 4309  0000000                   	BEQ IS_DAC_OUTPUT#
 4310  0000000                   
 4311  0000000                   	STZ !SP0ALT
 4312  0000000                   	.IF	(CHIPSERIES = 'N588J')
 4313  0000000                   	.ELSE
 4314  0000000                   		STZ !SP0BLT
 4315  0000000                   		STZ !SP0CLT
 4316  0000000                   	.ENDIF
 4317  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 4318  0000000                   		STZ !SP0AL
 4319  0000000                   		.IF	(CHIPSERIES = 'N588J')
 4320  0000000                   		.ELSE
 4321  0000000                   			STZ !SP0BL





 4322  0000000                   			STZ !SP0CL
 4323  0000000                   		.ENDIF
 4324  0000000                   	.ENDIF
 4325  0000000                   
 4326  0000000                   	LDA #80H	
 4327  0000000                   	STA !SP0AT	
 4328  0000000                   	.IF	(CHIPSERIES = 'N588J')
 4329  0000000                   	.ELSE
 4330  0000000                   		STA !SP0BT	
 4331  0000000                   		STA !SP0CT
 4332  0000000                   	.ENDIF
 4333  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 4334  0000000                   		STA !SP0A
 4335  0000000                   		.IF	(CHIPSERIES = 'N588J')
 4336  0000000                   		.ELSE
 4337  0000000                   			STA !SP0B
 4338  0000000                   			STA !SP0C	
 4339  0000000                   		.ENDIF
 4340  0000000                   	.ENDIF
 4341  0000000                   
 4342  0000000                   IS_DAC_OUTPUT#:
 4343  0000000                   	LDA #OUTPUT_TYPE
 4344  0000000                   	STA <SPEN_TMP	;set the of type mixer output
 4345  0000000                   	STZ !SPEN
 4346  0000000                   .ENDIF
 4347  0000000                      	ENDM
 4348  0000000                   .ENDIF
 4349  0000000                   ;------------------------------------------------------
 4350  0000000                   ADD_CHECKSUM	MACRO
 4351  0000000                   	LDX #00 
 4352  0000000                   	TXA
 4353  0000000                   	STA	!BANK
 4354  0000000                   	LDA #.LOW.ROM_START
 4355  0000000                   	STA <CHECKSUM_ADDR
 4356  0000000                   	LDA #.HIGH.ROM_START
 4357  0000000                   	STA <CHECKSUM_ADDR1
 4358  0000000                   	STZ <CHECK_RESULT
 4359  0000000                   	STZ <CHECK_RESULT+1
 4360  0000000                   CHECK_SUM_SEC1#:	
 4361  0000000                   	.IFDEF WDTIMER
 4362  0000000                   	.IFDEF LVDEN
 4363  0000000                   		LDA #CTL_CPU_WDT
 4364  0000000                   		TSB RAM_CTL_CPU
 4365  0000000                   		LDA RAM_CTL_CPU
 4366  0000000                   		STA !CTL_CPU
 4367  0000000                   	.ELSE
 4368  0000000                   		LDA #CTL_CPU_WDT
 4369  0000000                   		TSB !CTL_CPU
 4370  0000000                   	.ENDIF 	
 4371  0000000                   	.ENDIF     
 4372  0000000                   	CLC
 4373  0000000                   	LDA	(<CHECKSUM_ADDR)	
 4374  0000000                   	ADC	<CHECK_RESULT
 4375  0000000                   	STA	<CHECK_RESULT
 4376  0000000                   	LDA	<CHECK_RESULT+1
 4377  0000000                   	ADC	#00H
 4378  0000000                   	STA	<CHECK_RESULT+1





 4379  0000000                   
 4380  0000000                   	LDA 	<CHECKSUM_ADDR
 4381  0000000                   	CMP 	#.LOW.ROM_SEC1_END
 4382  0000000                   	BEQ 	SET_START_ADDR_SEC2#
 4383  0000000                   	INC	<CHECKSUM_ADDR
 4384  0000000                   	BRA 	CHECK_SUM_SEC1#
 4385  0000000                   SET_START_ADDR_SEC2#:
 4386  0000000                   	LDA #.LOW.ROM_SEC2_START
 4387  0000000                   	STA <CHECKSUM_ADDR
 4388  0000000                   ;===============================
 4389  0000000                   ; PROCESS ROM_START - 00:7FFF DATA
 4390  0000000                   ;===============================
 4391  0000000                   ;	.IF	(CHIPBODY = '')
 4392  0000000                   ;CHECK_SUM_BANK0#:
 4393  0000000                   ;.IFDEF WDTIMER
 4394  0000000                   ;.IFDEF LVDEN
 4395  0000000                   ;	LDA #CTL_CPU_WDT
 4396  0000000                   ;	TSB RAM_CTL_CPU
 4397  0000000                   ;	LDA RAM_CTL_CPU
 4398  0000000                   ;	STA !CTL_CPU
 4399  0000000                   ;.ELSE
 4400  0000000                   ;	LDA #CTL_CPU_WDT
 4401  0000000                   ;	TSB !CTL_CPU
 4402  0000000                   ;.ENDIF 	
 4403  0000000                   ;.ENDIF     
 4404  0000000                   ;	CLC
 4405  0000000                   ;	LDA	(<CHECKSUM_ADDR)	
 4406  0000000                   ;	ADC	<CHECK_RESULT
 4407  0000000                   ;	STA	<CHECK_RESULT
 4408  0000000                   ;	LDA	<CHECK_RESULT+1
 4409  0000000                   ;	ADC	#00H
 4410  0000000                   ;	STA	<CHECK_RESULT+1	
 4411  0000000                   ;
 4412  0000000                   ;	INC	<CHECKSUM_ADDR
 4413  0000000                   ;	BNE	CHECK_SUM_BANK0#
 4414  0000000                   ;	INC	<CHECKSUM_ADDR1
 4415  0000000                   ;	LDA	<CHECKSUM_ADDR1
 4416  0000000                   ;	CMP	#60H
 4417  0000000                   ;	BNE	CHECK_SUM_BANK0#
 4418  0000000                   ;	JMP END_CHECKSUM#
 4419  0000000                   ;	.ELSE
 4420  0000000                   CHECK_SUM_BANK0#:
 4421  0000000                   	.IFDEF WDTIMER
 4422  0000000                   	.IFDEF LVDEN
 4423  0000000                   		LDA #CTL_CPU_WDT
 4424  0000000                   		TSB RAM_CTL_CPU
 4425  0000000                   		LDA RAM_CTL_CPU
 4426  0000000                   		STA !CTL_CPU
 4427  0000000                   	.ELSE
 4428  0000000                   		LDA #CTL_CPU_WDT
 4429  0000000                   		TSB !CTL_CPU
 4430  0000000                   	.ENDIF 	
 4431  0000000                   	.ENDIF     
 4432  0000000                   	CLC
 4433  0000000                   	LDA	(<CHECKSUM_ADDR)	
 4434  0000000                   	ADC	<CHECK_RESULT
 4435  0000000                   	STA	<CHECK_RESULT





 4436  0000000                   	LDA	<CHECK_RESULT+1
 4437  0000000                   	ADC	#00H
 4438  0000000                   	STA	<CHECK_RESULT+1
 4439  0000000                   
 4440  0000000                   	INC	<CHECKSUM_ADDR
 4441  0000000                   	BNE	CHECK_SUM_BANK0#
 4442  0000000                   	INC	<CHECKSUM_ADDR1
 4443  0000000                   	LDA	<CHECKSUM_ADDR1
 4444  0000000                   	CMP	#80H
 4445  0000000                   	BNE	CHECK_SUM_BANK0#
 4446  0000000                   ;	.ENDIF
 4447  0000000                   ;==================================
 4448  0000000                   ; PROCESS 01:8000 - ENDING ADDRESS
 4449  0000000                   ;==================================		
 4450  0000000                   	INX	
 4451  0000000                   	TXA
 4452  0000000                   	STA	!BANK
 4453  0000000                   CHECK_SUM_BANK1#:
 4454  0000000                   	.IFDEF WDTIMER
 4455  0000000                   	.IFDEF LVDEN
 4456  0000000                   		LDA #CTL_CPU_WDT
 4457  0000000                   		TSB RAM_CTL_CPU
 4458  0000000                   		LDA RAM_CTL_CPU
 4459  0000000                   		STA !CTL_CPU
 4460  0000000                   	.ELSE
 4461  0000000                   		LDA #CTL_CPU_WDT
 4462  0000000                   		TSB !CTL_CPU
 4463  0000000                   	.ENDIF 	
 4464  0000000                   	.ENDIF     
 4465  0000000                   	CLC
 4466  0000000                   	LDA	(<CHECKSUM_ADDR)				
 4467  0000000                   	ADC	<CHECK_RESULT
 4468  0000000                   	STA	<CHECK_RESULT
 4469  0000000                   	LDA	<CHECK_RESULT+1
 4470  0000000                   	ADC	#00H
 4471  0000000                   	STA	<CHECK_RESULT+1
 4472  0000000                   
 4473  0000000                   	LDA	<CHECKSUM_ADDR1
 4474  0000000                   	CMP	#.HIGH.BODY_END_ADDR
 4475  0000000                   	BNE	ROM_ADDR_INC#
 4476  0000000                   	LDA <CHECKSUM_ADDR
 4477  0000000                   	CMP #.LOW.BODY_END_ADDR-1
 4478  0000000                   	BEQ CHECK_ROM_BANK# 
 4479  0000000                   ROM_ADDR_INC#:
 4480  0000000                   	INC	<CHECKSUM_ADDR
 4481  0000000                   	BNE	CHECK_SUM_BANK1#
 4482  0000000                   	INC	<CHECKSUM_ADDR1
 4483  0000000                   	BNE	CHECK_SUM_BANK1#
 4484  0000000                   ROM_BANK_INC#:
 4485  0000000                   	INX	
 4486  0000000                   	TXA
 4487  0000000                   	STA	!BANK
 4488  0000000                   	LDA	#80H
 4489  0000000                   	STA <CHECKSUM_ADDR1
 4490  0000000                   	BRA CHECK_SUM_BANK1#
 4491  0000000                   CHECK_ROM_BANK#:	
 4492  0000000                   	CPX #BODY_END_BANK 





 4493  0000000                   	BNE ROM_ADDR_INC#
 4494  0000000                   END_CHECKSUM#:
 4495  0000000                   	.IFDEF WDTIMER
 4496  0000000                   	.IFDEF LVDEN
 4497  0000000                   		LDA #CTL_CPU_WDT
 4498  0000000                   		TSB RAM_CTL_CPU
 4499  0000000                   		LDA RAM_CTL_CPU
 4500  0000000                   		STA !CTL_CPU
 4501  0000000                   	.ELSE
 4502  0000000                   		LDA #CTL_CPU_WDT
 4503  0000000                   		TSB !CTL_CPU
 4504  0000000                   	.ENDIF 	
 4505  0000000                   	.ENDIF     
 4506  0000000                   	LDA	#0
 4507  0000000                   	STA	!BANK
 4508  0000000                   	ENDM
 4509  0000000                   ;------------------------------------------------------
 4510  0000000                   GET_CHECKSUM	MACRO
 4511  0000000                   	PSF_RESPONSE_LIMIT
 4512  0000000                   	PHP
 4513  0000000                   	SEI
 4514  0000000                   	LDA <CHECKSUM_ADDR
 4515  0000000                   	PHA
 4516  0000000                   	LDA <CHECKSUM_ADDR1
 4517  0000000                   	PHA
 4518  0000000                   ;	LDA <CHECK_RESULT
 4519  0000000                   ;	PHA
 4520  0000000                   	ADD_CHECKSUM
 4521  0000000                   ;	PLA
 4522  0000000                   ;	STA <CHECK_RESULT
 4523  0000000                   	PLA
 4524  0000000                   	STA <CHECKSUM_ADDR1
 4525  0000000                   	PLA
 4526  0000000                   	STA <CHECKSUM_ADDR
 4527  0000000                   	PLP
 4528  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4529  0000000                   	ENDM
 4530  0000000                   ;------------------------------------------------------
 4531  0000000                   CHECKSUM	MACRO
 4532  0000000                   	PSF_RESPONSE_LIMIT
 4533  0000000                   	PHP
 4534  0000000                   	SEI
 4535  0000000                   	LDA <CHECKSUM_ADDR
 4536  0000000                   	PHA
 4537  0000000                   	LDA <CHECKSUM_ADDR1
 4538  0000000                   	PHA
 4539  0000000                   ;	LDA <CHECK_RESULT
 4540  0000000                   ;	PHA
 4541  0000000                   	ADD_CHECKSUM
 4542  0000000                   
 4543  0000000                   	LDA	#.high.CHECKSUM_33TH
 4544  0000000                   	STA <CHECKSUM_ADDR1
 4545  0000000                   	LDA #.low.CHECKSUM_33TH
 4546  0000000                   	STA <CHECKSUM_ADDR	
 4547  0000000                   	CLC
 4548  0000000                   	LDA	(<CHECKSUM_ADDR)
 4549  0000000                   	ADC <CHECK_RESULT





 4550  0000000                   	STA <CHECK_RESULT
 4551  0000000                   	INC CHECKSUM_ADDR
 4552  0000000                   	LDA	(<CHECKSUM_ADDR)
 4553  0000000                   	ADC <CHECK_RESULT+1
 4554  0000000                   	STA <CHECK_RESULT+1
 4555  0000000                   
 4556  0000000                   ;	PLA
 4557  0000000                   ;	STA <CHECK_RESULT
 4558  0000000                   	PLA
 4559  0000000                   	STA <CHECKSUM_ADDR1
 4560  0000000                   	PLA
 4561  0000000                   	STA <CHECKSUM_ADDR
 4562  0000000                   	PLP
 4563  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4564  0000000                   	ENDM	
 4565  0000000                   
 4566  0000000                   ;------------------------------------------------------------
 4567  0000000                   BP00	EQU 00H	
 4568  0000000                   BP01	EQU 01H	
 4569  0000000                   BP02	EQU 02H	
 4570  0000000                   BP03	EQU 03H	
 4571  0000000                   BP04	EQU 04H	
 4572  0000000                   BP05	EQU 05H	
 4573  0000000                   BP06	EQU 06H	
 4574  0000000                   BP07	EQU 07H	
 4575  0000000                   BP10	EQU 10H	
 4576  0000000                   BP11	EQU 11H	
 4577  0000000                   BP12	EQU 12H	
 4578  0000000                   BP13	EQU 13H	
 4579  0000000                   BP14	EQU 14H	
 4580  0000000                   BP15	EQU 15H	
 4581  0000000                   BP16	EQU 16H	
 4582  0000000                   BP17	EQU 17H	
 4583  0000000                   BP20	EQU 20H	
 4584  0000000                   BP21	EQU 21H	
 4585  0000000                   BP22	EQU 22H	
 4586  0000000                   BP23	EQU 23H	
 4587  0000000                   BP24	EQU 24H	
 4588  0000000                   BP25	EQU 25H	
 4589  0000000                   BP26	EQU 26H	
 4590  0000000                   BP27	EQU 27H	
 4591  0000000                   ;------------------------------------------------------------
 4592  0000000                   OUT1KHZTONE MACRO	PORT, TIMES 	
 4593  0000000                   	PSF_RESPONSE_LIMIT
 4594  0000000                   	PHP
 4595  0000000                   	SEI
 4596  0000000                   	LDA <0
 4597  0000000                   	PHA
 4598  0000000                   	LDA <1
 4599  0000000                   	PHA
 4600  0000000                   	LDA <2
 4601  0000000                   	PHA
 4602  0000000                   	BRA xGET_PORTPIN#
 4603  0000000                   
 4604  0000000                   .ifndef xpintable_
 4605  0000000                   xPINOUT_TABLE:
 4606  0000000                   xPINMODE_TABLE01:





 4607  0000000                   	DB  01H
 4608  0000000                   	DB 	02H
 4609  0000000                   	DB 	04H
 4610  0000000                   	DB 	08H
 4611  0000000                   	DB 	10H
 4612  0000000                   	DB 	20H
 4613  0000000                   	DB 	40H
 4614  0000000                   	DB 	80H
 4615  0000000                   xPINMODE_TABLE2:
 4616  0000000                   	DB  01H
 4617  0000000                   	DB 	01H
 4618  0000000                   	DB 	01H
 4619  0000000                   	DB 	01H
 4620  0000000                   	DB 	02H
 4621  0000000                   	DB 	02H
 4622  0000000                   	DB 	02H
 4623  0000000                   	DB 	02H
 4624  0000000                   xpintable_:
 4625  0000000                   .endif
 4626  0000000                   
 4627  0000000                   xGET_PORTPIN#:
 4628  0000000                   	LDA #0
 4629  0000000                   	STA !TM0C
 4630  0000000                   	STA <0
 4631  0000000                   	STA <1
 4632  0000000                   	STA <2
 4633  0000000                   	LDA #PORT
 4634  0000000                   	LSR A
 4635  0000000                   	LSR A
 4636  0000000                   	LSR A
 4637  0000000                   	LSR A
 4638  0000000                   	TAX
 4639  0000000                   	LDA !BP0D,X
 4640  0000000                   	PHA
 4641  0000000                   	.IFDEF       BPXM_RAM
 4642  0000000                   	LDA BP0M_BAK,X
 4643  0000000                   	PHA
 4644  0000000                   	.ENDIF
 4645  0000000                   
 4646  0000000                   	LDA #PORT
 4647  0000000                   	AND #07H
 4648  0000000                   	TAY 
 4649  0000000                   
 4650  0000000                   	LDA xPINMODE_TABLE01,Y
 4651  0000000                       CPX #02H
 4652  0000000                   	BCC 3 					; port0 or port1	
 4653  0000000                   	LDA xPINMODE_TABLE2,Y	; port2
 4654  0000000                   
 4655  0000000                   	EOR #FFH
 4656  0000000                   	AND !BP0D,X 
 4657  0000000                   	STA !BP0D,X				; output
 4658  0000000                   	.IFDEF       BPXM_RAM
 4659  0000000                   	.IF ((PORT>>4).EQ.0 )||((PORT>>4).EQ.1)
 4660  0000000                   		LDA xPINOUT_TABLE,Y
 4661  0000000                   		EOR #FFH
 4662  0000000                   		AND !BP0M_BAK,X 
 4663  0000000                   		STA !BP0M_BAK,X





 4664  0000000                   	.ENDIF
 4665  0000000                   	.IF ((PORT>>4).EQ.2)
 4666  0000000                   		.IF	 ((PORT&0Fh).GT. 3H)
 4667  0000000                   			LDA #F0H
 4668  0000000                   		.ELSE
 4669  0000000                   			LDA #0FH
 4670  0000000                   		.ENDIF
 4671  0000000                   		TRB BP2M_BAK
 4672  0000000                   	.ENDIF
 4673  0000000                   	.ENDIF
 4674  0000000                   
 4675  0000000                   	LDA #TONE_2KHZ_TMV
 4676  0000000                   	STA !TM0V
 4677  0000000                   	LDA #02H
 4678  0000000                   	STA !EFC0
 4679  0000000                   	LDA #TONE_2KHZ_TMC
 4680  0000000                   	ORA #01H
 4681  0000000                   	STA !TM0C
 4682  0000000                   
 4683  0000000                   xPOLL_TIMEOUT#:
 4684  0000000                   	LDA !EVF0
 4685  0000000                   	AND #02H				; Timer0
 4686  0000000                   	BEQ xPOLL_TIMEOUT# 
 4687  0000000                   	STA !EFC0
 4688  0000000                   
 4689  0000000                   	.IFDEF       BPXM_RAM
 4690  0000000                   		.IF	 ((PORT>>4).EQ.0)
 4691  0000000                   			PHX
 4692  0000000                   			LDX !BP0D
 4693  0000000                   			LDA xPINOUT_TABLE,Y
 4694  0000000                   			EOR !BP0
 4695  0000000                   			EXTERN BP0D_OUTPUT_TABLE
 4696  0000000                   			AND !BP0D_OUTPUT_TABLE,X
 4697  0000000                   			ORA BP0M_BAK
 4698  0000000                   			STA !BP0
 4699  0000000                   			PLX
 4700  0000000                   		.ENDIF
 4701  0000000                   		.IF	 ((PORT>>4).EQ.1)
 4702  0000000                   			PHX
 4703  0000000                   			LDX !BP1D
 4704  0000000                   			LDA xPINOUT_TABLE,Y
 4705  0000000                   			EOR !BP1
 4706  0000000                   			EXTERN BP1D_OUTPUT_TABLE
 4707  0000000                   			AND !BP1D_OUTPUT_TABLE,X
 4708  0000000                   			ORA BP1M_BAK
 4709  0000000                   			STA !BP1
 4710  0000000                   			PLX
 4711  0000000                   		.ENDIF
 4712  0000000                   		.IF	 ((PORT>>4).EQ.2)
 4713  0000000                   			PHX
 4714  0000000                   			LDX !BP2D
 4715  0000000                   			LDA xPINOUT_TABLE,Y
 4716  0000000                   			EOR !BP2
 4717  0000000                   			EXTERN BP2D_OUTPUT_TABLE
 4718  0000000                   			AND !BP2D_OUTPUT_TABLE,X
 4719  0000000                   			ORA BP2M_BAK
 4720  0000000                   			STA !BP2





 4721  0000000                   			PLX
 4722  0000000                   		.ENDIF
 4723  0000000                   	.ELSE
 4724  0000000                   		LDA xPINOUT_TABLE,Y
 4725  0000000                   		EOR !BP0,X
 4726  0000000                   		ORA !BP0D,X
 4727  0000000                   		STA !BP0,X
 4728  0000000                   	.ENDIF
 4729  0000000                   	INC <2
 4730  0000000                   	LDA <2
 4731  0000000                   	AND #01H
 4732  0000000                   	BNE xPOLL_TIMEOUT#
 4733  0000000                   	LDA #CTL_CPU_WDT
 4734  0000000                   	TSB !CTL_CPU
 4735  0000000                   
 4736  0000000                   	LDA #.low.TIMES
 4737  0000000                   	BNE xCHECK_TIMEOUT#
 4738  0000000                   	LDA #.high.TIMES
 4739  0000000                   	BEQ xPOLL_TIMEOUT#
 4740  0000000                   
 4741  0000000                   xCHECK_TIMEOUT#:    
 4742  0000000                   	CLC
 4743  0000000                       LDA <0
 4744  0000000                   	ADC #1
 4745  0000000                   	STA <0
 4746  0000000                   	LDA <1
 4747  0000000                   	ADC #0
 4748  0000000                   	STA <1
 4749  0000000                       CMP #.high.TIMES  
 4750  0000000                   	BNE xPOLL_TIMEOUT#
 4751  0000000                   	LDA <0
 4752  0000000                   	CMP #.low.TIMES  
 4753  0000000                   	BNE xPOLL_TIMEOUT#
 4754  0000000                   	STZ !TM0C
 4755  0000000                   
 4756  0000000                   	.IFDEF       BPXM_RAM
 4757  0000000                   	PLA
 4758  0000000                   	STA BP0M_BAK,X
 4759  0000000                   	.ENDIF
 4760  0000000                   	PLA
 4761  0000000                   	STA !BP0D,X
 4762  0000000                   xDONOT_DO#:
 4763  0000000                   	PLA 
 4764  0000000                   	STA <2
 4765  0000000                   	PLA 
 4766  0000000                   	STA <1
 4767  0000000                   	PLA 
 4768  0000000                   	STA <0
 4769  0000000                   	PLP
 4770  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 4771  0000000                   	ENDM	
 4772  0000000                   
 4773  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\SPI_MACROS.INI.APP"
 4774  0000000                   ;========================================================
 4775  0000000                   ;-----SPI mode define,user can change--------
 4776  0000000                   ;SPI_MODE		EQU	00H
 4777  0000000                   ;SPI mode0: SCK:LOW; 	DI:Raising; DO:Falling	





 4778  0000000                   ;SPI mode1: SCK:LOW; 	DI:Falling; DO:Raising
 4779  0000000                   ;SPI mode2: SCK:HIGH; 	DI:Falling; DO:Raising
 4780  0000000                   ;SPI mode3: SCK:HIGH; 	DI:Raising; DO:Falling
 4781  0000000                   
 4782  0000000                   ;----internal pin-----------
 4783  0000000                   SPI_IP00		EQU	00H
 4784  0000000                   SPI_IP01		EQU	01H
 4785  0000000                   SPI_IP02		EQU	02H
 4786  0000000                   SPI_IP03		EQU	03H
 4787  0000000                   SPI_IP04		EQU	04H
 4788  0000000                   SPI_IP05		EQU	05H
 4789  0000000                   SPI_IP06		EQU	06H
 4790  0000000                   SPI_IP07		EQU	07H
 4791  0000000                   
 4792  0000000                   SPI_BP00		EQU	10H
 4793  0000000                   SPI_BP01		EQU	11H
 4794  0000000                   SPI_BP02		EQU	12H
 4795  0000000                   SPI_BP03		EQU	13H
 4796  0000000                   SPI_BP04		EQU	14H
 4797  0000000                   SPI_BP05		EQU	15H
 4798  0000000                   SPI_BP06		EQU	16H
 4799  0000000                   SPI_BP07		EQU	17H
 4800  0000000                   
 4801  0000000                   SPI_BP10		EQU	20H
 4802  0000000                   SPI_BP11		EQU	21H
 4803  0000000                   SPI_BP12		EQU	22H
 4804  0000000                   SPI_BP13		EQU	23H
 4805  0000000                   SPI_BP14		EQU	24H
 4806  0000000                   SPI_BP15		EQU	25H
 4807  0000000                   SPI_BP16		EQU	26H
 4808  0000000                   SPI_BP17		EQU	27H
 4809  0000000                   
 4810  0000000                   SPI_BP20		EQU	30H
 4811  0000000                   SPI_BP21		EQU	31H
 4812  0000000                   SPI_BP22		EQU	32H
 4813  0000000                   SPI_BP23		EQU	33H
 4814  0000000                   SPI_BP24		EQU	34H
 4815  0000000                   SPI_BP25		EQU	35H
 4816  0000000                   SPI_BP26		EQU	36H
 4817  0000000                   SPI_BP27		EQU	37H
 4818  0000000                   ;========================================================
 4819  0000000                   ;IP0~BP2:   		800H~803H;
 4820  0000000                   ;IP0M: 			805H;
 4821  0000000                   ;BP0D~BP2D: 		80AH~80CH;
 4822  0000000                   ;IP0EN~BP1EN:		850H~852H;
 4823  0000000                   
 4824  0000000                   SPI_PORT_BASE		EQU	800H
 4825  0000000                   SPI_PORT_M_BASE		EQU	805H
 4826  0000000                   SPI_PORT_D_BASE		EQU	80AH
 4827  0000000                   SPI_PORT_EN_BASE	EQU	850H
 4828  0000000                   ;========================================================
 4829  0000000                   ;-----pin define,user can change--------
 4830  0000000                   SPI_X0CSB_PIN	EQU	SPI_BP04
 4831  0000000                   SPI_X0SCK_PIN	EQU	SPI_BP02
 4832  0000000                   SPI_X0MOSI_PIN	EQU	SPI_BP06
 4833  0000000                   SPI_X0MISO_PIN	EQU	SPI_BP00
 4834  0000000                   





 4835  0000000                   .IFDEF  BPXM_RAM
 4836  0000000                   SPI_X0CSB_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0CSB_PIN>>4)-1
 4837  0000000                   SPI_X0SCK_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0SCK_PIN>>4)-1
 4838  0000000                   SPI_X0MOSI_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0MOSI_PIN>>4)-1
 4839  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.0)
 4840  0000000                   .ELSE
 4841  0000000                   SPI_X0MISO_BAKM_ADDR		EQU 	BP0M_BAK+(SPI_X0MISO_PIN>>4)-1
 4842  0000000                   .ENDIF
 4843  0000000                   .ENDIF
 4844  0000000                   
 4845  0000000                   ;-------------X0 4Pin parameter ------------------------
 4846  0000000                   SPI_X0CSB_PIN_VALUE		EQU	1<<(SPI_X0CSB_PIN&0FH)
 4847  0000000                   SPI_X0CSB_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0CSB_PIN>>4)
 4848  0000000                   SPI_X0CSB_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0CSB_PIN>>4)-1
 4849  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4850  0000000                   SPI_X0CSB_M_ADDR		EQU 	SPI_X0CSB_PORT_ADDR
 4851  0000000                   .ELSE
 4852  0000000                   SPI_X0CSB_M_ADDR		EQU 	SPI_PORT_M_BASE
 4853  0000000                   .ENDIF
 4854  0000000                   
 4855  0000000                   SPI_X0SCK_PIN_VALUE		EQU	1<<(SPI_X0SCK_PIN&0FH)
 4856  0000000                   SPI_X0SCK_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0SCK_PIN>>4)
 4857  0000000                   SPI_X0SCK_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0SCK_PIN>>4)-1
 4858  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4859  0000000                   SPI_X0SCK_M_ADDR		EQU 	SPI_X0SCK_PORT_ADDR
 4860  0000000                   .ELSE
 4861  0000000                   SPI_X0SCK_M_ADDR		EQU 	SPI_PORT_M_BASE
 4862  0000000                   .ENDIF
 4863  0000000                   
 4864  0000000                   SPI_X0MOSI_PIN_VALUE		EQU	1<<(SPI_X0MOSI_PIN&0FH)
 4865  0000000                   SPI_X0MOSI_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0MOSI_PIN>>4)
 4866  0000000                   SPI_X0MOSI_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0MOSI_PIN>>4)-1
 4867  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4868  0000000                   SPI_X0MOSI_M_ADDR		EQU 	SPI_X0MOSI_PORT_ADDR
 4869  0000000                   .ELSE
 4870  0000000                   SPI_X0MOSI_M_ADDR		EQU 	SPI_PORT_M_BASE
 4871  0000000                   .ENDIF
 4872  0000000                   
 4873  0000000                   SPI_X0MISO_PIN_VALUE		EQU	1<<(SPI_X0MISO_PIN&0FH)
 4874  0000000                   SPI_X0MISO_PORT_ADDR 		EQU 	SPI_PORT_BASE+(SPI_X0MISO_PIN>>4)
 4875  0000000                   SPI_X0MISO_D_ADDR		EQU 	SPI_PORT_D_BASE+(SPI_X0MISO_PIN>>4)-1
 4876  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)||((SPI_X0CSB_PIN>>4).EQ.3)
 4877  0000000                   SPI_X0MISO_M_ADDR		EQU 	SPI_X0MISO_PORT_ADDR
 4878  0000000                   .ELSE
 4879  0000000                   SPI_X0MISO_M_ADDR		EQU 	SPI_PORT_M_BASE
 4880  0000000                   .ENDIF
 4881  0000000                   ;========================================================
 4882  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.0)
 4883  0000000                   SPI_X0CSB_M_VALUE		EQU 	1<<((SPI_X0CSB_PIN&0FH)>>1)
 4884  0000000                   SPI_X0CSB_D_VALUE		EQU 	1<<((SPI_X0CSB_PIN&0FH)>>1)
 4885  0000000                   .ENDIF
 4886  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 4887  0000000                   SPI_X0CSB_M_VALUE		EQU 	1<<(SPI_X0CSB_PIN&0FH)
 4888  0000000                   SPI_X0CSB_D_VALUE		EQU 	1<<(SPI_X0CSB_PIN&0FH)
 4889  0000000                   .ENDIF		
 4890  0000000                   .IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 4891  0000000                   .IF ((SPI_X0CSB_PIN&0Fh).GT. 3H )





 4892  0000000                   SPI_X0CSB_M_VALUE		EQU 	F0H
 4893  0000000                   .ELSE
 4894  0000000                   SPI_X0CSB_M_VALUE		EQU 	0FH
 4895  0000000                   .ENDIF
 4896  0000000                   SPI_X0CSB_D_VALUE		EQU 	1<<((SPI_X0CSB_PIN&0FH)>>2)
 4897  0000000                   .ENDIF
 4898  0000000                   ;--------------------------------------------------------
 4899  0000000                   .IF ((SPI_X0SCK_PIN>>4).EQ.0)
 4900  0000000                   SPI_X0SCK_M_VALUE		EQU 	1<<((SPI_X0SCK_PIN&0FH)>>1)
 4901  0000000                   SPI_X0SCK_D_VALUE		EQU 	1<<((SPI_X0SCK_PIN&0FH)>>1)
 4902  0000000                   .ENDIF
 4903  0000000                   .IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 4904  0000000                   SPI_X0SCK_M_VALUE		EQU 	1<<(SPI_X0SCK_PIN&0FH)
 4905  0000000                   SPI_X0SCK_D_VALUE		EQU 	1<<(SPI_X0SCK_PIN&0FH)
 4906  0000000                   .ENDIF		
 4907  0000000                   .IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 4908  0000000                   .IF ((SPI_X0SCK_PIN&0Fh).GT. 3H )
 4909  0000000                   SPI_X0SCK_M_VALUE		EQU 	F0H
 4910  0000000                   .ELSE
 4911  0000000                   SPI_X0SCK_M_VALUE		EQU 	0FH
 4912  0000000                   .ENDIF
 4913  0000000                   SPI_X0SCK_D_VALUE		EQU 	1<<((SPI_X0SCK_PIN&0FH)>>2)
 4914  0000000                   .ENDIF
 4915  0000000                   ;--------------------------------------------------------
 4916  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.0)
 4917  0000000                   SPI_X0MOSI_M_VALUE		EQU 	1<<((SPI_X0MOSI_PIN&0FH)>>1)
 4918  0000000                   SPI_X0MOSI_D_VALUE		EQU 	1<<((SPI_X0MOSI_PIN&0FH)>>1)
 4919  0000000                   .ENDIF
 4920  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.1 )||((SPI_X0MOSI_PIN>>4).EQ.2)
 4921  0000000                   SPI_X0MOSI_M_VALUE		EQU 	1<<(SPI_X0MOSI_PIN&0FH)
 4922  0000000                   SPI_X0MOSI_D_VALUE		EQU 	1<<(SPI_X0MOSI_PIN&0FH)
 4923  0000000                   .ENDIF		
 4924  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.3 )
 4925  0000000                   .IF ((SPI_X0MOSI_PIN&0Fh).GT. 3H )
 4926  0000000                   SPI_X0MOSI_M_VALUE		EQU 	F0H
 4927  0000000                   .ELSE
 4928  0000000                   SPI_X0MOSI_M_VALUE		EQU 	0FH
 4929  0000000                   .ENDIF
 4930  0000000                   SPI_X0MOSI_D_VALUE		EQU 	1<<((SPI_X0MOSI_PIN&0FH)>>2)
 4931  0000000                   .ENDIF
 4932  0000000                   ;--------------------------------------------------------
 4933  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.0)
 4934  0000000                   SPI_X0MISO_M_VALUE		EQU 	1<<((SPI_X0MISO_PIN&0FH)>>1)
 4935  0000000                   SPI_X0MISO_D_VALUE		EQU 	1<<((SPI_X0MISO_PIN&0FH)>>1)
 4936  0000000                   .ENDIF
 4937  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.1 )||((SPI_X0MISO_PIN>>4).EQ.2)
 4938  0000000                   SPI_X0MISO_M_VALUE		EQU 	1<<(SPI_X0MISO_PIN&0FH)
 4939  0000000                   SPI_X0MISO_D_VALUE		EQU 	1<<(SPI_X0MISO_PIN&0FH)
 4940  0000000                   .ENDIF		
 4941  0000000                   .IF ((SPI_X0MISO_PIN>>4).EQ.3 )
 4942  0000000                   .IF ((SPI_X0MISO_PIN&0Fh).GT. 3H )
 4943  0000000                   SPI_X0MISO_M_VALUE		EQU 	F0H
 4944  0000000                   .ELSE
 4945  0000000                   SPI_X0MISO_M_VALUE		EQU 	0FH
 4946  0000000                   .ENDIF
 4947  0000000                   SPI_X0MISO_D_VALUE		EQU 	1<<((SPI_X0MISO_PIN&0FH)>>2)
 4948  0000000                   .ENDIF





 4949  0000000                   ;========================================================
 4950  0000000                   
 4951  0000000                   ;================================================================================
 4952  0000000                   ; 	USER MACRO - Drive Macro
 4953  0000000                   ;================================================================================
 4954  0000000                   SPI_BP2_OUTPUT_MASK MACRO
 4955  0000000                   	CMP #00H
 4956  0000000                   	BNE SPI_BP2_OUTPUT_MASK_01#
 4957  0000000                   	LDA #FFH
 4958  0000000                   	BRA SPI_BP2_OUTPUT_MASK_END#
 4959  0000000                   SPI_BP2_OUTPUT_MASK_01#:
 4960  0000000                   	CMP #01H
 4961  0000000                   	BNE SPI_BP2_OUTPUT_MASK_02#
 4962  0000000                   	LDA #F0H
 4963  0000000                   	BRA SPI_BP2_OUTPUT_MASK_END#
 4964  0000000                   SPI_BP2_OUTPUT_MASK_02#:
 4965  0000000                   	CMP #02H
 4966  0000000                   	BNE SPI_BP2_OUTPUT_MASK_03#
 4967  0000000                   	LDA #0FH
 4968  0000000                   	BRA SPI_BP2_OUTPUT_MASK_END#
 4969  0000000                   SPI_BP2_OUTPUT_MASK_03#:
 4970  0000000                   	LDA #00H
 4971  0000000                   SPI_BP2_OUTPUT_MASK_END#:
 4972  0000000                   	ENDM
 4973  0000000                   ;--------------------------------------------------------	
 4974  0000000                   SPI_X0_INIT_PIN MACRO
 4975  0000000                   ;CSB: cmos output,init value 1
 4976  0000000                   	LDA #SPI_X0CSB_D_VALUE
 4977  0000000                   	TRB !SPI_X0CSB_D_ADDR	
 4978  0000000                   	.IFDEF  BPXM_RAM
 4979  0000000                   		LDA #SPI_X0CSB_M_VALUE
 4980  0000000                   		TRB SPI_X0CSB_BAKM_ADDR
 4981  0000000                   	.ENDIF		
 4982  0000000                   ;	TSB !SPI_X0CSB_M_ADDR	
 4983  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 4984  0000000                   		LDA !SPI_X0CSB_D_ADDR
 4985  0000000                   		EOR #FFH
 4986  0000000                   	.ENDIF
 4987  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 4988  0000000                   		LDA !SPI_X0CSB_D_ADDR
 4989  0000000                   		SPI_BP2_OUTPUT_MASK
 4990  0000000                   	.ENDIF			
 4991  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 4992  0000000                   	ORA #SPI_X0CSB_PIN_VALUE
 4993  0000000                   	.IFDEF  BPXM_RAM
 4994  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 4995  0000000                   	.ELSE
 4996  0000000                   		ORA !SPI_X0CSB_D_ADDR
 4997  0000000                   	.ENDIF
 4998  0000000                   	STA !SPI_X0CSB_PORT_ADDR	
 4999  0000000                   
 5000  0000000                   
 5001  0000000                   ;SCK: cmos output
 5002  0000000                   	LDA #SPI_X0SCK_D_VALUE
 5003  0000000                   	TRB !SPI_X0SCK_D_ADDR
 5004  0000000                   	.IFDEF  BPXM_RAM
 5005  0000000                   		LDA #SPI_X0SCK_M_VALUE





 5006  0000000                   		TRB SPI_X0SCK_BAKM_ADDR
 5007  0000000                   	.ENDIF
 5008  0000000                   ;	TSB !SPI_X0SCK_M_ADDR	
 5009  0000000                   .IF (SPI_MODE.EQ.0)||(SPI_MODE.EQ.1)
 5010  0000000                   ;SCK: init value 0
 5011  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5012  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5013  0000000                   		EOR #FFH
 5014  0000000                   	.ENDIF
 5015  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5016  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5017  0000000                   		SPI_BP2_OUTPUT_MASK
 5018  0000000                   	.ENDIF	
 5019  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5020  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5021  0000000                   	.IFDEF  BPXM_RAM
 5022  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5023  0000000                   	.ELSE
 5024  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5025  0000000                   	.ENDIF
 5026  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5027  0000000                   .ELSE
 5028  0000000                   ;SCK: init value 1
 5029  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5030  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5031  0000000                   		EOR #FFH
 5032  0000000                   	.ENDIF
 5033  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5034  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5035  0000000                   		SPI_BP2_OUTPUT_MASK
 5036  0000000                   	.ENDIF	
 5037  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5038  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5039  0000000                   	.IFDEF  BPXM_RAM
 5040  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5041  0000000                   	.ELSE
 5042  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5043  0000000                   	.ENDIF
 5044  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5045  0000000                   .ENDIF
 5046  0000000                   
 5047  0000000                   ;MOSI: cmos output,init value 1
 5048  0000000                   	LDA #SPI_X0MOSI_D_VALUE
 5049  0000000                   	TRB !SPI_X0MOSI_D_ADDR
 5050  0000000                   	.IFDEF  BPXM_RAM
 5051  0000000                   		LDA #SPI_X0MOSI_M_VALUE
 5052  0000000                   		TRB SPI_X0MOSI_BAKM_ADDR
 5053  0000000                   	.ENDIF
 5054  0000000                   ;	TSB !SPI_X0MOSI_M_ADDR
 5055  0000000                   	.IF ((SPI_X0MOSI_PIN>>4).EQ.1 )||((SPI_X0MOSI_PIN>>4).EQ.2)
 5056  0000000                   		LDA !SPI_X0MOSI_D_ADDR
 5057  0000000                   		EOR #FFH
 5058  0000000                   	.ENDIF
 5059  0000000                   	.IF ((SPI_X0MOSI_PIN>>4).EQ.3 )
 5060  0000000                   		LDA !SPI_X0MOSI_D_ADDR
 5061  0000000                   		SPI_BP2_OUTPUT_MASK
 5062  0000000                   	.ENDIF	





 5063  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5064  0000000                   	ORA #SPI_X0MOSI_PIN_VALUE
 5065  0000000                   	.IFDEF  BPXM_RAM
 5066  0000000                   		ORA SPI_X0MOSI_BAKM_ADDR
 5067  0000000                   	.ELSE
 5068  0000000                   		ORA !SPI_X0MOSI_D_ADDR
 5069  0000000                   	.ENDIF
 5070  0000000                   	STA !SPI_X0MOSI_PORT_ADDR	
 5071  0000000                   
 5072  0000000                   ;MISO: pull high input,init value 1
 5073  0000000                   	LDA #SPI_X0MISO_D_VALUE
 5074  0000000                   	TSB !SPI_X0MISO_D_ADDR
 5075  0000000                   	.IF ((SPI_X0MOSI_PIN>>4).EQ.0)
 5076  0000000                   		TSB !SPI_X0MISO_M_ADDR
 5077  0000000                   		LDA #SPI_X0MISO_PIN_VALUE
 5078  0000000                   		TSB !SPI_X0MISO_PORT_ADDR
 5079  0000000                   	.ELSE
 5080  0000000                   		.IFDEF  BPXM_RAM
 5081  0000000                   			LDA #SPI_X0MISO_M_VALUE
 5082  0000000                   			TSB SPI_X0MISO_BAKM_ADDR
 5083  0000000                   		.ENDIF
 5084  0000000                   		.IF ((SPI_X0MISO_PIN>>4).EQ.1 )||((SPI_X0MISO_PIN>>4).EQ.2)
 5085  0000000                   			LDA !SPI_X0MOSI_D_ADDR
 5086  0000000                   			EOR #FFH
 5087  0000000                   		.ENDIF
 5088  0000000                   		.IF ((SPI_X0MISO_PIN>>4).EQ.3 )
 5089  0000000                   			LDA !SPI_X0MOSI_D_ADDR
 5090  0000000                   			SPI_BP2_OUTPUT_MASK
 5091  0000000                   		.ENDIF	
 5092  0000000                   		AND !SPI_X0MISO_PORT_ADDR
 5093  0000000                   		ORA #SPI_X0MISO_PIN_VALUE
 5094  0000000                   		.IFDEF  BPXM_RAM
 5095  0000000                   			ORA SPI_X0MISO_BAKM_ADDR
 5096  0000000                   		.ELSE
 5097  0000000                   			ORA !SPI_X0MISO_D_ADDR
 5098  0000000                   		.ENDIF
 5099  0000000                   		STA !SPI_X0MISO_PORT_ADDR
 5100  0000000                   	.ENDIF
 5101  0000000                   
 5102  0000000                   SPI_X0_INIT_PIN_END#:
 5103  0000000                   	ENDM
 5104  0000000                   ;================================================================================
 5105  0000000                   ; 	SPI SUBROUTINE
 5106  0000000                   ;================================================================================
 5107  0000000                   SPI_X0_ON MACRO 
 5108  0000000                   ;CSB:1->0
 5109  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 5110  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5111  0000000                   		EOR #FFH
 5112  0000000                   	.ENDIF
 5113  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 5114  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5115  0000000                   		SPI_BP2_OUTPUT_MASK
 5116  0000000                   	.ENDIF		
 5117  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 5118  0000000                   	ORA #SPI_X0CSB_PIN_VALUE
 5119  0000000                   	.IFDEF  BPXM_RAM





 5120  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 5121  0000000                   	.ELSE
 5122  0000000                   		ORA !SPI_X0CSB_D_ADDR
 5123  0000000                   	.ENDIF
 5124  0000000                   	STA !SPI_X0CSB_PORT_ADDR
 5125  0000000                   
 5126  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 5127  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5128  0000000                   		EOR #FFH
 5129  0000000                   	.ENDIF
 5130  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 5131  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5132  0000000                   		SPI_BP2_OUTPUT_MASK
 5133  0000000                   	.ENDIF		
 5134  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 5135  0000000                   	AND #(FFH^SPI_X0CSB_PIN_VALUE)
 5136  0000000                   	.IFDEF  BPXM_RAM
 5137  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 5138  0000000                   	.ELSE
 5139  0000000                   		ORA !SPI_X0CSB_D_ADDR
 5140  0000000                   	.ENDIF
 5141  0000000                   	STA !SPI_X0CSB_PORT_ADDR
 5142  0000000                   	ENDM
 5143  0000000                   ;--------------------------------------------------------
 5144  0000000                   SPI_X0_OFF MACRO
 5145  0000000                   ;CSB£º1
 5146  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.1 )||((SPI_X0CSB_PIN>>4).EQ.2)
 5147  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5148  0000000                   		EOR #FFH
 5149  0000000                   	.ENDIF
 5150  0000000                   	.IF ((SPI_X0CSB_PIN>>4).EQ.3 )
 5151  0000000                   		LDA !SPI_X0CSB_D_ADDR
 5152  0000000                   		SPI_BP2_OUTPUT_MASK
 5153  0000000                   	.ENDIF		
 5154  0000000                   	AND !SPI_X0CSB_PORT_ADDR
 5155  0000000                   	ORA #SPI_X0CSB_PIN_VALUE
 5156  0000000                   	.IFDEF  BPXM_RAM
 5157  0000000                   		ORA SPI_X0CSB_BAKM_ADDR
 5158  0000000                   	.ELSE
 5159  0000000                   		ORA !SPI_X0CSB_D_ADDR
 5160  0000000                   	.ENDIF
 5161  0000000                   	STA !SPI_X0CSB_PORT_ADDR
 5162  0000000                   	ENDM
 5163  0000000                   ;========================================================
 5164  0000000                   ;SCL pin
 5165  0000000                   ;mode0: idle:0;	DO:falling edge;	DI:rising edge
 5166  0000000                   ;mode1: idle:0;	DO:rising edge;		DI:falling edge
 5167  0000000                   ;mode2: idle:1;	DO:rising edge;		DI:falling edge
 5168  0000000                   ;mode3: idle:1;	DO:falling edge;	DI:rising edge
 5169  0000000                   
 5170  0000000                   SPI_X0_CLK_READY MACRO
 5171  0000000                   .IF (SPI_MODE.EQ.1)
 5172  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5173  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5174  0000000                   		EOR #FFH
 5175  0000000                   	.ENDIF
 5176  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )





 5177  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5178  0000000                   		SPI_BP2_OUTPUT_MASK
 5179  0000000                   	.ENDIF	
 5180  0000000                   	AND !SPI_X0SCK_PORT_ADDR
 5181  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5182  0000000                   	.IFDEF  BPXM_RAM
 5183  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5184  0000000                   	.ELSE
 5185  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5186  0000000                   	.ENDIF
 5187  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5188  0000000                   .ENDIF
 5189  0000000                   .IF (SPI_MODE.EQ.3)
 5190  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5191  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5192  0000000                   		EOR #FFH
 5193  0000000                   	.ENDIF
 5194  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5195  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5196  0000000                   		SPI_BP2_OUTPUT_MASK
 5197  0000000                   	.ENDIF	
 5198  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5199  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5200  0000000                   	.IFDEF  BPXM_RAM
 5201  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5202  0000000                   	.ELSE
 5203  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5204  0000000                   	.ENDIF
 5205  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5206  0000000                   .ENDIF
 5207  0000000                   	ENDM
 5208  0000000                   ;--------------------------------------------------------
 5209  0000000                   SPI_X0_CLK_OUT MACRO
 5210  0000000                   .IF (SPI_MODE.EQ.0)
 5211  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5212  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5213  0000000                   		EOR #FFH
 5214  0000000                   	.ENDIF
 5215  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5216  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5217  0000000                   		SPI_BP2_OUTPUT_MASK
 5218  0000000                   	.ENDIF	
 5219  0000000                   	AND !SPI_X0SCK_PORT_ADDR
 5220  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5221  0000000                   	.IFDEF  BPXM_RAM
 5222  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5223  0000000                   	.ELSE
 5224  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5225  0000000                   	.ENDIF
 5226  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5227  0000000                   .ENDIF
 5228  0000000                   .IF (SPI_MODE.EQ.0)||(SPI_MODE.EQ.1)	
 5229  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5230  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5231  0000000                   		EOR #FFH
 5232  0000000                   	.ENDIF
 5233  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )





 5234  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5235  0000000                   		SPI_BP2_OUTPUT_MASK
 5236  0000000                   	.ENDIF	
 5237  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5238  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5239  0000000                   	.IFDEF  BPXM_RAM
 5240  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5241  0000000                   	.ELSE
 5242  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5243  0000000                   	.ENDIF
 5244  0000000                   	STA !SPI_X0SCK_PORT_ADDR	
 5245  0000000                   .ENDIF
 5246  0000000                   .IF (SPI_MODE.EQ.2)
 5247  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5248  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5249  0000000                   		EOR #FFH
 5250  0000000                   	.ENDIF
 5251  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5252  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5253  0000000                   		SPI_BP2_OUTPUT_MASK
 5254  0000000                   	.ENDIF	
 5255  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5256  0000000                   	AND #(FFH^SPI_X0SCK_PIN_VALUE)
 5257  0000000                   	.IFDEF  BPXM_RAM
 5258  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5259  0000000                   	.ELSE
 5260  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5261  0000000                   	.ENDIF
 5262  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5263  0000000                   .ENDIF	
 5264  0000000                   .IF (SPI_MODE.EQ.2)||(SPI_MODE.EQ.3)	
 5265  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.1 )||((SPI_X0SCK_PIN>>4).EQ.2)
 5266  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5267  0000000                   		EOR #FFH
 5268  0000000                   	.ENDIF
 5269  0000000                   	.IF ((SPI_X0SCK_PIN>>4).EQ.3 )
 5270  0000000                   		LDA !SPI_X0SCK_D_ADDR
 5271  0000000                   		SPI_BP2_OUTPUT_MASK
 5272  0000000                   	.ENDIF	
 5273  0000000                   	AND !SPI_X0SCK_PORT_ADDR		
 5274  0000000                   	ORA #SPI_X0SCK_PIN_VALUE
 5275  0000000                   	.IFDEF  BPXM_RAM
 5276  0000000                   		ORA SPI_X0SCK_BAKM_ADDR
 5277  0000000                   	.ELSE
 5278  0000000                   		ORA !SPI_X0SCK_D_ADDR
 5279  0000000                   	.ENDIF
 5280  0000000                   	STA !SPI_X0SCK_PORT_ADDR
 5281  0000000                   .ENDIF
 5282  0000000                   	ENDM
 5283  0000000                   ;--------------------------------------------------------
 5284  0000000                   SPI_X0_MOSI_Y MACRO
 5285  0000000                   	TYA
 5286  0000000                   	ASL A
 5287  0000000                   	TAY
 5288  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.1 )||((SPI_X0MOSI_PIN>>4).EQ.2)
 5289  0000000                   	LDA !SPI_X0MOSI_D_ADDR
 5290  0000000                   	EOR #FFH





 5291  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5292  0000000                   	BCC SPI_X0_MOSI_SET_0#
 5293  0000000                   SPI_X0_MOSI_SET_1#:
 5294  0000000                   	ORA #SPI_X0MOSI_PIN_VALUE
 5295  0000000                   	BRA SPI_X0_MOSI_NEXT#
 5296  0000000                   SPI_X0_MOSI_SET_0#:
 5297  0000000                   	AND #(FFH^SPI_X0MOSI_PIN_VALUE)
 5298  0000000                   SPI_X0_MOSI_NEXT#:
 5299  0000000                   .ENDIF
 5300  0000000                   
 5301  0000000                   .IF ((SPI_X0MOSI_PIN>>4).EQ.3 )
 5302  0000000                   	BCC SPI_X0_MOSI_SET_0#
 5303  0000000                   SPI_X0_MOSI_SET_1#:
 5304  0000000                   	LDA !SPI_X0MOSI_D_ADDR
 5305  0000000                   	SPI_BP2_OUTPUT_MASK
 5306  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5307  0000000                   	ORA #SPI_X0MOSI_PIN_VALUE
 5308  0000000                   	BRA SPI_X0_MOSI_NEXT#
 5309  0000000                   SPI_X0_MOSI_SET_0#:
 5310  0000000                   	LDA !SPI_X0MOSI_D_ADDR
 5311  0000000                   	SPI_BP2_OUTPUT_MASK
 5312  0000000                   	AND !SPI_X0MOSI_PORT_ADDR
 5313  0000000                   	AND #(FFH^SPI_X0MOSI_PIN_VALUE)
 5314  0000000                   SPI_X0_MOSI_NEXT#:
 5315  0000000                   .ENDIF
 5316  0000000                   	.IFDEF  BPXM_RAM
 5317  0000000                   		ORA SPI_X0MOSI_BAKM_ADDR
 5318  0000000                   	.ELSE
 5319  0000000                   		ORA !SPI_X0MOSI_D_ADDR
 5320  0000000                   	.ENDIF
 5321  0000000                   	STA !SPI_X0MOSI_PORT_ADDR
 5322  0000000                   	ENDM
 5323  0000000                   ;--------------------------------------------------------
 5324  0000000                   SPI_X0_MOSI_Y_1BIT MACRO
 5325  0000000                   	SPI_X0_CLK_READY
 5326  0000000                   	SPI_X0_MOSI_Y
 5327  0000000                   	SPI_X0_CLK_OUT
 5328  0000000                   	ENDM
 5329  0000000                   ;--------------------------------------------------------
 5330  0000000                   SPI_X0_MOSI MACRO
 5331  0000000                   	TAY
 5332  0000000                   	SPI_X0_MOSI_Y_1BIT
 5333  0000000                   	SPI_X0_MOSI_Y_1BIT
 5334  0000000                   	SPI_X0_MOSI_Y_1BIT
 5335  0000000                   	SPI_X0_MOSI_Y_1BIT
 5336  0000000                   	SPI_X0_MOSI_Y_1BIT
 5337  0000000                   	SPI_X0_MOSI_Y_1BIT
 5338  0000000                   	SPI_X0_MOSI_Y_1BIT
 5339  0000000                   	SPI_X0_MOSI_Y_1BIT	
 5340  0000000                   	ENDM
 5341  0000000                   ;--------------------------------------------------------
 5342  0000000                   SPI_X0_MISO_Y MACRO
 5343  0000000                   	LDA !SPI_X0MISO_PORT_ADDR
 5344  0000000                   	BIT #SPI_X0MISO_PIN_VALUE
 5345  0000000                   	BEQ SPI_X0_MISO_0#	
 5346  0000000                   SPI_X0_MISO_1#:
 5347  0000000                   	TYA





 5348  0000000                   	SEC
 5349  0000000                   	ROL A
 5350  0000000                   	TAY
 5351  0000000                   	BRA SPI_X0_MISO_NEXT#
 5352  0000000                   SPI_X0_MISO_0#:
 5353  0000000                   	TYA
 5354  0000000                   	CLC
 5355  0000000                   	ROL A
 5356  0000000                   	TAY
 5357  0000000                   SPI_X0_MISO_NEXT#:
 5358  0000000                   	ENDM
 5359  0000000                   ;--------------------------------------------------------
 5360  0000000                   SPI_X0_MISO_Y_1BIT MACRO
 5361  0000000                   	SPI_X0_CLK_READY
 5362  0000000                   	SPI_X0_MISO_Y
 5363  0000000                   	SPI_X0_CLK_OUT
 5364  0000000                   	ENDM
 5365  0000000                   ;--------------------------------------------------------
 5366  0000000                   SPI_X0_MISO MACRO
 5367  0000000                   	LDY #00H
 5368  0000000                   	SPI_X0_MISO_Y_1BIT
 5369  0000000                   	SPI_X0_MISO_Y_1BIT
 5370  0000000                   	SPI_X0_MISO_Y_1BIT
 5371  0000000                   	SPI_X0_MISO_Y_1BIT
 5372  0000000                   	SPI_X0_MISO_Y_1BIT
 5373  0000000                   	SPI_X0_MISO_Y_1BIT
 5374  0000000                   	SPI_X0_MISO_Y_1BIT
 5375  0000000                   	SPI_X0_MISO_Y_1BIT
 5376  0000000                   	ENDM
 5377  0000000                   ;--------------------------------------------------------
 5378  0000000                   ;--------------------------------------------------------
 5379  0000000                   SPI_X0_WRITE_NB_RAM MACRO NUM,REG
 5380  0000000                   	LDX #00H
 5381  0000000                   SPI_X0_WRITE_NB_RAM_LOOP#:
 5382  0000000                   	CPX #NUM
 5383  0000000                   	BNE 3
 5384  0000000                   	JMP END_SPI_X0_WRITE_NB_RAM#
 5385  0000000                   	LDA REG,X
 5386  0000000                   	SPI_X0_MOSI
 5387  0000000                   	INX
 5388  0000000                   	JMP SPI_X0_WRITE_NB_RAM_LOOP#
 5389  0000000                   END_SPI_X0_WRITE_NB_RAM#:
 5390  0000000                   	ENDM
 5391  0000000                   ;--------------------------------------------------------
 5392  0000000                   SPI_X0_WRITE_NB_RAM2 MACRO REG
 5393  0000000                   	LDX #00H
 5394  0000000                   SPI_X0_WRITE_NB_RAM2_LOOP#:
 5395  0000000                   	CPX REG
 5396  0000000                   	BNE 3
 5397  0000000                   	JMP END_SPI_X0_WRITE_NB_RAM2#
 5398  0000000                   	LDA REG+1,X
 5399  0000000                   	SPI_X0_MOSI
 5400  0000000                   	INX
 5401  0000000                   	JMP SPI_X0_WRITE_NB_RAM2_LOOP#
 5402  0000000                   END_SPI_X0_WRITE_NB_RAM2#:
 5403  0000000                   	ENDM
 5404  0000000                   ;--------------------------------------------------------





 5405  0000000                   SPI_X0_READ_NB_RAM MACRO NUM,REG
 5406  0000000                   	LDX #00H
 5407  0000000                   SPI_X0_READ_NB_RAM_LOOP#:
 5408  0000000                   	CPX #NUM
 5409  0000000                   	BNE 3
 5410  0000000                   	JMP END_SPI_X0_READ_NB_RAM#
 5411  0000000                   	SPI_X0_MISO
 5412  0000000                   	TYA
 5413  0000000                   	STA REG,X
 5414  0000000                   	INX
 5415  0000000                   	JMP SPI_X0_READ_NB_RAM_LOOP#
 5416  0000000                   END_SPI_X0_READ_NB_RAM#:
 5417  0000000                   	ENDM
 5418  0000000                   ;--------------------------------------------------------
 5419  0000000                   SPI_X0_READ_NB_RAM2 MACRO REG
 5420  0000000                   	LDX #00H
 5421  0000000                   SPI_X0_READ_NB_RAM2_LOOP#:
 5422  0000000                   	CPX REG
 5423  0000000                   	BNE 3
 5424  0000000                   	JMP END_SPI_X0_READ_NB_RAM2#
 5425  0000000                   	SPI_X0_MISO
 5426  0000000                   	TYA
 5427  0000000                   	STA REG+1,X
 5428  0000000                   	INX
 5429  0000000                   	JMP SPI_X0_READ_NB_RAM2_LOOP#
 5430  0000000                   END_SPI_X0_READ_NB_RAM2#:
 5431  0000000                   	ENDM
 5432  0000000                   ;=====================================================================================
 5433  0000000                   ;=====================================================================================
 5434  0000000                   .IF (SPI_COMMAND_ENABLE .EQ. 1H)
 5435  0000000                   SPI_INIT MACRO 
 5436  0000000                   	SPI_X0_INIT_PIN
 5437  0000000                   	ENDM
 5438  0000000                   ;------------------------------------------------------------------------------
 5439  0000000                   SPI_ON	MACRO 
 5440  0000000                   	SPI_X0_ON
 5441  0000000                   	ENDM
 5442  0000000                   ;------------------------------------------------------------------------------
 5443  0000000                   SPI_OFF	MACRO 
 5444  0000000                   	SPI_X0_OFF
 5445  0000000                   	ENDM
 5446  0000000                   ;------------------------------------------------------------------------------
 5447  0000000                   SPI_WRITE MACRO DATA
 5448  0000000                   	LDA #DATA
 5449  0000000                   	SPI_X0_MOSI
 5450  0000000                   	ENDM
 5451  0000000                   ;------------------------------------------------------------------------------
 5452  0000000                   SPI_WRITE_RAM MACRO REG
 5453  0000000                   	LDA REG
 5454  0000000                   	SPI_X0_MOSI
 5455  0000000                   	ENDM
 5456  0000000                   ;------------------------------------------------------------------------------
 5457  0000000                   SPI_WRITE_NB_RAM MACRO NUM,REG
 5458  0000000                   	SPI_X0_WRITE_NB_RAM NUM,REG
 5459  0000000                   	ENDM
 5460  0000000                   ;------------------------------------------------------------------------------
 5461  0000000                   SPI_WRITE_NB_RAM2 MACRO REG





 5462  0000000                   	SPI_X0_WRITE_NB_RAM2 REG
 5463  0000000                   	ENDM
 5464  0000000                   ;------------------------------------------------------------------------------
 5465  0000000                   SPI_READ MACRO 
 5466  0000000                   	SPI_X0_MISO
 5467  0000000                   	TYA
 5468  0000000                   	ENDM
 5469  0000000                   ;------------------------------------------------------------------------------
 5470  0000000                   SPI_READ_RAM MACRO REG
 5471  0000000                   	SPI_X0_MISO
 5472  0000000                   	STY REG
 5473  0000000                   	ENDM
 5474  0000000                   ;------------------------------------------------------------------------------
 5475  0000000                   SPI_READ_NB_RAM MACRO NUM,REG
 5476  0000000                   	SPI_X0_READ_NB_RAM NUM,REG
 5477  0000000                   	ENDM
 5478  0000000                   ;------------------------------------------------------------------------------
 5479  0000000                   SPI_READ_NB_RAM2 MACRO REG
 5480  0000000                   	SPI_X0_READ_NB_RAM2 REG
 5481  0000000                   	ENDM
 5482  0000000                   .ENDIF
 5483  0000000                   ;=====================================================================================
 5484  0000000                   ;=====================================================================================	
 5485  0000000                   
 5486  0000000                   
 5487  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\I2C_MACROS.INI.APP"
 5488  0000000                   ;========================================================
 5489  0000000                   ;----internal pin-----------
 5490  0000000                   I2C_IP00		EQU	00H
 5491  0000000                   I2C_IP01		EQU	01H
 5492  0000000                   I2C_IP02		EQU	02H
 5493  0000000                   I2C_IP03		EQU	03H
 5494  0000000                   I2C_IP04		EQU	04H
 5495  0000000                   I2C_IP05		EQU	05H
 5496  0000000                   I2C_IP06		EQU	06H
 5497  0000000                   I2C_IP07		EQU	07H
 5498  0000000                   
 5499  0000000                   I2C_BP00		EQU	10H
 5500  0000000                   I2C_BP01		EQU	11H
 5501  0000000                   I2C_BP02		EQU	12H
 5502  0000000                   I2C_BP03		EQU	13H
 5503  0000000                   I2C_BP04		EQU	14H
 5504  0000000                   I2C_BP05		EQU	15H
 5505  0000000                   I2C_BP06		EQU	16H
 5506  0000000                   I2C_BP07		EQU	17H
 5507  0000000                   
 5508  0000000                   I2C_BP10		EQU	20H
 5509  0000000                   I2C_BP11		EQU	21H
 5510  0000000                   I2C_BP12		EQU	22H
 5511  0000000                   I2C_BP13		EQU	23H
 5512  0000000                   I2C_BP14		EQU	24H
 5513  0000000                   I2C_BP15		EQU	25H
 5514  0000000                   I2C_BP16		EQU	26H
 5515  0000000                   I2C_BP17		EQU	27H
 5516  0000000                   
 5517  0000000                   I2C_BP20		EQU	30H
 5518  0000000                   I2C_BP21		EQU	31H





 5519  0000000                   I2C_BP22		EQU	32H
 5520  0000000                   I2C_BP23		EQU	33H
 5521  0000000                   I2C_BP24		EQU	34H
 5522  0000000                   I2C_BP25		EQU	35H
 5523  0000000                   I2C_BP26		EQU	36H
 5524  0000000                   I2C_BP27		EQU	37H
 5525  0000000                   ;========================================================
 5526  0000000                   ;IP0~BP2:   		800H~803H;
 5527  0000000                   ;IP0M: 			805H;
 5528  0000000                   ;BP0D~BP2D: 		80AH~80CH;
 5529  0000000                   ;IP0EN~BP1EN:		850H~852H;
 5530  0000000                   
 5531  0000000                   I2C_PORT_BASE		EQU	800H
 5532  0000000                   I2C_PORT_M_BASE		EQU	805H
 5533  0000000                   I2C_PORT_D_BASE		EQU	80AH
 5534  0000000                   I2C_PORT_EN_BASE	EQU	850H
 5535  0000000                   ;========================================================
 5536  0000000                   ;-----pin define,user can change--------
 5537  0000000                   I2C_X0SCL_PIN	EQU	I2C_BP02
 5538  0000000                   I2C_X0SDA_PIN	EQU	I2C_BP00
 5539  0000000                   
 5540  0000000                   .IFDEF  BPXM_RAM
 5541  0000000                   I2C_X0SCL_BAKM_ADDR		EQU 	BP0M_BAK+(I2C_X0SCL_PIN>>4)-1
 5542  0000000                   I2C_X0SDA_BAKM_ADDR		EQU 	BP0M_BAK+(I2C_X0SDA_PIN>>4)-1
 5543  0000000                   .ENDIF
 5544  0000000                   
 5545  0000000                   ;-------------X0 2Pin parameter ------------------------
 5546  0000000                   I2C_X0SCL_PIN_VALUE		EQU	1<<(I2C_X0SCL_PIN&0FH)
 5547  0000000                   I2C_X0SCL_PORT_ADDR 		EQU 	I2C_PORT_BASE+(I2C_X0SCL_PIN>>4)
 5548  0000000                   I2C_X0SCL_D_ADDR		EQU 	I2C_PORT_D_BASE+(I2C_X0SCL_PIN>>4)-1
 5549  0000000                   I2C_X0SCL_M_ADDR		EQU 	I2C_X0SCL_PORT_ADDR
 5550  0000000                   
 5551  0000000                   I2C_X0SDA_PIN_VALUE		EQU	1<<(I2C_X0SDA_PIN&0FH)
 5552  0000000                   I2C_X0SDA_PORT_ADDR 		EQU 	I2C_PORT_BASE+(I2C_X0SDA_PIN>>4)
 5553  0000000                   I2C_X0SDA_D_ADDR		EQU 	I2C_PORT_D_BASE+(I2C_X0SDA_PIN>>4)-1
 5554  0000000                   I2C_X0SDA_M_ADDR		EQU 	I2C_X0SDA_PORT_ADDR
 5555  0000000                   ;========================================================
 5556  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.1 )||((I2C_X0SCL_PIN>>4).EQ.2)
 5557  0000000                   I2C_X0SCL_M_VALUE		EQU 	1<<(I2C_X0SCL_PIN&0FH)
 5558  0000000                   I2C_X0SCL_D_VALUE		EQU 	1<<(I2C_X0SCL_PIN&0FH)
 5559  0000000                   .ENDIF		
 5560  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.3 )
 5561  0000000                   .IF ((I2C_X0SCL_PIN&0Fh).GT. 3H )
 5562  0000000                   I2C_X0SCL_M_VALUE		EQU 	F0H
 5563  0000000                   .ELSE
 5564  0000000                   I2C_X0SCL_M_VALUE		EQU 	0FH
 5565  0000000                   .ENDIF
 5566  0000000                   I2C_X0SCL_D_VALUE		EQU 	1<<((I2C_X0SCL_PIN&0FH)>>2)
 5567  0000000                   .ENDIF
 5568  0000000                   ;--------------------------------------------------------
 5569  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5570  0000000                   I2C_X0SDA_M_VALUE		EQU 	1<<(I2C_X0SDA_PIN&0FH)
 5571  0000000                   I2C_X0SDA_D_VALUE		EQU 	1<<(I2C_X0SDA_PIN&0FH)
 5572  0000000                   .ENDIF		
 5573  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5574  0000000                   .IF ((I2C_X0SDA_PIN&0Fh).GT. 3H )
 5575  0000000                   I2C_X0SDA_M_VALUE		EQU 	F0H





 5576  0000000                   .ELSE
 5577  0000000                   I2C_X0SDA_M_VALUE		EQU 	0FH
 5578  0000000                   .ENDIF
 5579  0000000                   I2C_X0SDA_D_VALUE		EQU 	1<<((I2C_X0SDA_PIN&0FH)>>2)
 5580  0000000                   .ENDIF
 5581  0000000                   ;========================================================
 5582  0000000                   
 5583  0000000                   ;================================================================================
 5584  0000000                   ; 	I2C SUBROUTINE
 5585  0000000                   ;================================================================================
 5586  0000000                   I2C_DELAY MACRO
 5587  0000000                   	NOP
 5588  0000000                   	NOP
 5589  0000000                   	NOP
 5590  0000000                   	NOP
 5591  0000000                   	NOP
 5592  0000000                   .IF (SYSTEMCLK.GT.4096000 )
 5593  0000000                   	NOP
 5594  0000000                   	NOP
 5595  0000000                   	NOP
 5596  0000000                   	NOP
 5597  0000000                   	NOP
 5598  0000000                   .IF (SYSTEMCLK.GT.6144000 )	
 5599  0000000                   	NOP
 5600  0000000                   	NOP
 5601  0000000                   	NOP
 5602  0000000                   	NOP
 5603  0000000                   	NOP
 5604  0000000                   .ENDIF
 5605  0000000                   .ENDIF
 5606  0000000                   ENDM
 5607  0000000                   ;--------------------------------------------------------
 5608  0000000                   BP2_OUTPUT_MASK MACRO
 5609  0000000                   	CMP #00H
 5610  0000000                   	BNE BP2_OUTPUT_MASK_01#
 5611  0000000                   	LDA #FFH
 5612  0000000                   	BRA BP2_OUTPUT_MASK_END#
 5613  0000000                   BP2_OUTPUT_MASK_01#:
 5614  0000000                   	CMP #01H
 5615  0000000                   	BNE BP2_OUTPUT_MASK_02#
 5616  0000000                   	LDA #F0H
 5617  0000000                   	BRA BP2_OUTPUT_MASK_END#
 5618  0000000                   BP2_OUTPUT_MASK_02#:
 5619  0000000                   	CMP #02H
 5620  0000000                   	BNE BP2_OUTPUT_MASK_03#
 5621  0000000                   	LDA #0FH
 5622  0000000                   	BRA BP2_OUTPUT_MASK_END#
 5623  0000000                   BP2_OUTPUT_MASK_03#:
 5624  0000000                   	LDA #00H
 5625  0000000                   BP2_OUTPUT_MASK_END#:
 5626  0000000                   	ENDM
 5627  0000000                   ;--------------------------------------------------------
 5628  0000000                   I2C_X0_SCL_1 MACRO 
 5629  0000000                   ;SCL:0->1
 5630  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.1 )||((I2C_X0SCL_PIN>>4).EQ.2)
 5631  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5632  0000000                   	EOR #FFH





 5633  0000000                   .ENDIF
 5634  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.3 )
 5635  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5636  0000000                   	BP2_OUTPUT_MASK
 5637  0000000                   .ENDIF
 5638  0000000                   	AND !I2C_X0SCL_PORT_ADDR
 5639  0000000                   	ORA #I2C_X0SCL_PIN_VALUE
 5640  0000000                   	.IFDEF  BPXM_RAM
 5641  0000000                   		ORA I2C_X0SCL_BAKM_ADDR
 5642  0000000                   	.ELSE
 5643  0000000                   		ORA !I2C_X0SCL_D_ADDR
 5644  0000000                   	.ENDIF
 5645  0000000                   	STA !I2C_X0SCL_PORT_ADDR
 5646  0000000                   	ENDM
 5647  0000000                   ;--------------------------------------------------------
 5648  0000000                   I2C_X0_SCL_0 MACRO
 5649  0000000                   ;SCL:1->0
 5650  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.1 )||((I2C_X0SCL_PIN>>4).EQ.2)
 5651  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5652  0000000                   	EOR #FFH
 5653  0000000                   .ENDIF
 5654  0000000                   .IF ((I2C_X0SCL_PIN>>4).EQ.3 )
 5655  0000000                   	LDA !I2C_X0SCL_D_ADDR
 5656  0000000                   	BP2_OUTPUT_MASK
 5657  0000000                   .ENDIF
 5658  0000000                   	AND !I2C_X0SCL_PORT_ADDR		
 5659  0000000                   	AND #(FFH^I2C_X0SCL_PIN_VALUE)
 5660  0000000                   	.IFDEF  BPXM_RAM
 5661  0000000                   		ORA I2C_X0SCL_BAKM_ADDR
 5662  0000000                   	.ELSE
 5663  0000000                   		ORA !I2C_X0SCL_D_ADDR
 5664  0000000                   	.ENDIF
 5665  0000000                   	STA !I2C_X0SCL_PORT_ADDR 
 5666  0000000                   	ENDM
 5667  0000000                   ;--------------------------------------------------------
 5668  0000000                   I2C_X0_SDA_OUTPUT MACRO
 5669  0000000                   ;SDA: output
 5670  0000000                   	LDA #I2C_X0SDA_D_VALUE
 5671  0000000                   	TRB !I2C_X0SDA_D_ADDR
 5672  0000000                   	.IFDEF  BPXM_RAM
 5673  0000000                   		LDA #I2C_X0SDA_M_VALUE
 5674  0000000                   		TRB I2C_X0SDA_BAKM_ADDR
 5675  0000000                   	.ENDIF
 5676  0000000                   	ENDM
 5677  0000000                   ;--------------------------------------------------------
 5678  0000000                   I2C_X0_SDA_0 MACRO
 5679  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5680  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5681  0000000                   	EOR #FFH
 5682  0000000                   .ENDIF
 5683  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5684  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5685  0000000                   	BP2_OUTPUT_MASK
 5686  0000000                   .ENDIF
 5687  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5688  0000000                   	AND #(FFH^I2C_X0SDA_PIN_VALUE)
 5689  0000000                   	.IFDEF  BPXM_RAM





 5690  0000000                   		ORA I2C_X0SDA_BAKM_ADDR
 5691  0000000                   	.ELSE
 5692  0000000                   		ORA !I2C_X0SDA_D_ADDR
 5693  0000000                   	.ENDIF
 5694  0000000                   	STA !I2C_X0SDA_PORT_ADDR
 5695  0000000                   	ENDM
 5696  0000000                   ;--------------------------------------------------------
 5697  0000000                   I2C_X0_SDA_1 MACRO
 5698  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5699  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5700  0000000                   	EOR #FFH
 5701  0000000                   .ENDIF
 5702  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5703  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5704  0000000                   	BP2_OUTPUT_MASK
 5705  0000000                   .ENDIF
 5706  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5707  0000000                   	ORA #I2C_X0SDA_PIN_VALUE
 5708  0000000                   	.IFDEF  BPXM_RAM
 5709  0000000                   		ORA I2C_X0SDA_BAKM_ADDR
 5710  0000000                   	.ELSE
 5711  0000000                   		ORA !I2C_X0SDA_D_ADDR
 5712  0000000                   	.ENDIF
 5713  0000000                   	STA !I2C_X0SDA_PORT_ADDR
 5714  0000000                   	ENDM
 5715  0000000                   ;--------------------------------------------------------
 5716  0000000                   I2C_X0_SDA_OUTPUT_0 MACRO
 5717  0000000                   	I2C_X0_SDA_OUTPUT
 5718  0000000                   	I2C_X0_SDA_0
 5719  0000000                   	ENDM
 5720  0000000                   ;--------------------------------------------------------
 5721  0000000                   I2C_X0_SDA_OUTPUT_1 MACRO
 5722  0000000                   	I2C_X0_SDA_OUTPUT
 5723  0000000                   	I2C_X0_SDA_1
 5724  0000000                   	ENDM
 5725  0000000                   ;--------------------------------------------------------
 5726  0000000                   I2C_X0_SDA_PULL_HIGH_1	MACRO
 5727  0000000                   ;SDA:pull high input, value 1
 5728  0000000                   	LDA #I2C_X0SDA_D_VALUE
 5729  0000000                   	TSB !I2C_X0SDA_D_ADDR
 5730  0000000                   	.IFDEF  BPXM_RAM
 5731  0000000                   		LDA #I2C_X0SDA_M_VALUE
 5732  0000000                   		TSB I2C_X0SDA_BAKM_ADDR
 5733  0000000                   	.ENDIF
 5734  0000000                   	I2C_X0_SDA_1
 5735  0000000                   	ENDM
 5736  0000000                   ;========================================================
 5737  0000000                   ;output: SCL output
 5738  0000000                   I2C_X0_INIT_PIN MACRO
 5739  0000000                   ;SCL:  output,init value 1
 5740  0000000                   	LDA #I2C_X0SCL_D_VALUE
 5741  0000000                   	TRB !I2C_X0SCL_D_ADDR
 5742  0000000                   	.IFDEF  BPXM_RAM
 5743  0000000                   		LDA #I2C_X0SCL_M_VALUE
 5744  0000000                   		TRB I2C_X0SCL_BAKM_ADDR
 5745  0000000                   	.ENDIF
 5746  0000000                   	ENDM





 5747  0000000                   ;--------------------------------------------------------
 5748  0000000                   ;output: SDA output low,SCL output low
 5749  0000000                   I2C_X0_START MACRO
 5750  0000000                   ;SDA:  output,init value 1
 5751  0000000                   	I2C_X0_SDA_OUTPUT_1
 5752  0000000                   
 5753  0000000                   ;SCL:  output,init value 1
 5754  0000000                   	I2C_X0_SCL_1
 5755  0000000                   	I2C_DELAY
 5756  0000000                   
 5757  0000000                   ;SDA:1->0
 5758  0000000                   	I2C_X0_SDA_0
 5759  0000000                   	I2C_DELAY
 5760  0000000                   
 5761  0000000                   ;SCL:1->0 
 5762  0000000                   	I2C_X0_SCL_0
 5763  0000000                   	ENDM
 5764  0000000                   ;--------------------------------------------------------
 5765  0000000                   ;output: SDA output high,SCL output high
 5766  0000000                   I2C_X0_STOP MACRO
 5767  0000000                   ;SDA: output,0
 5768  0000000                   	I2C_X0_SDA_OUTPUT_0
 5769  0000000                   
 5770  0000000                   ;SCL: output value 1
 5771  0000000                   	I2C_X0_SCL_1
 5772  0000000                   	I2C_DELAY	
 5773  0000000                   
 5774  0000000                   ;SDA:0->1
 5775  0000000                   	I2C_X0_SDA_1
 5776  0000000                   	I2C_DELAY
 5777  0000000                   	ENDM
 5778  0000000                   ;========================================================
 5779  0000000                   ;--------------------------------------------------------
 5780  0000000                   I2C_X0_MOSI_Y MACRO
 5781  0000000                   	TYA
 5782  0000000                   	ASL A
 5783  0000000                   	TAY
 5784  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.1 )||((I2C_X0SDA_PIN>>4).EQ.2)
 5785  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5786  0000000                   	EOR #FFH
 5787  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5788  0000000                   	BCC I2C_X0_MOSI_SET_0#
 5789  0000000                   I2C_X0_MOSI_SET_1#:
 5790  0000000                   	ORA #I2C_X0SDA_PIN_VALUE
 5791  0000000                   	BRA I2C_X0_MOSI_NEXT#
 5792  0000000                   I2C_X0_MOSI_SET_0#:
 5793  0000000                   	AND #(FFH^I2C_X0SDA_PIN_VALUE)
 5794  0000000                   I2C_X0_MOSI_NEXT#:
 5795  0000000                   .ENDIF
 5796  0000000                   
 5797  0000000                   .IF ((I2C_X0SDA_PIN>>4).EQ.3 )
 5798  0000000                   	BCC I2C_X0_MOSI_SET_0#
 5799  0000000                   I2C_X0_MOSI_SET_1#:
 5800  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5801  0000000                   	BP2_OUTPUT_MASK
 5802  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5803  0000000                   	ORA #I2C_X0SDA_PIN_VALUE





 5804  0000000                   	BRA I2C_X0_MOSI_NEXT#
 5805  0000000                   I2C_X0_MOSI_SET_0#:
 5806  0000000                   	LDA !I2C_X0SDA_D_ADDR
 5807  0000000                   	BP2_OUTPUT_MASK
 5808  0000000                   	AND !I2C_X0SDA_PORT_ADDR
 5809  0000000                   	AND #(FFH^I2C_X0SDA_PIN_VALUE)
 5810  0000000                   I2C_X0_MOSI_NEXT#:
 5811  0000000                   .ENDIF
 5812  0000000                   	.IFDEF  BPXM_RAM
 5813  0000000                   		ORA I2C_X0SDA_BAKM_ADDR
 5814  0000000                   	.ELSE
 5815  0000000                   		ORA !I2C_X0SDA_D_ADDR
 5816  0000000                   	.ENDIF
 5817  0000000                   	STA !I2C_X0SDA_PORT_ADDR
 5818  0000000                   	ENDM
 5819  0000000                   ;--------------------------------------------------------
 5820  0000000                   I2C_X0_MOSI_Y_1BIT MACRO
 5821  0000000                   	I2C_X0_MOSI_Y
 5822  0000000                   	I2C_DELAY
 5823  0000000                   
 5824  0000000                   	I2C_X0_SCL_1 	
 5825  0000000                   	I2C_DELAY	
 5826  0000000                   	I2C_X0_SCL_0	
 5827  0000000                   	ENDM
 5828  0000000                   ;--------------------------------------------------------
 5829  0000000                   ;input: SCL output low,
 5830  0000000                   ;output:SCL output low, SDA input
 5831  0000000                   ;	ack:acc=01;nack:acc=00
 5832  0000000                   
 5833  0000000                   I2C_X0_MOSI MACRO
 5834  0000000                   	TAY
 5835  0000000                   	I2C_X0_SDA_OUTPUT
 5836  0000000                   
 5837  0000000                   	I2C_X0_MOSI_Y_1BIT
 5838  0000000                   	I2C_X0_MOSI_Y_1BIT
 5839  0000000                   	I2C_X0_MOSI_Y_1BIT
 5840  0000000                   	I2C_X0_MOSI_Y_1BIT
 5841  0000000                   	I2C_X0_MOSI_Y_1BIT
 5842  0000000                   	I2C_X0_MOSI_Y_1BIT
 5843  0000000                   	I2C_X0_MOSI_Y_1BIT
 5844  0000000                   	I2C_X0_MOSI_Y_1BIT
 5845  0000000                   
 5846  0000000                   I2C_X0_MOSI_ACK#:
 5847  0000000                   	I2C_X0_SDA_PULL_HIGH_1
 5848  0000000                   	I2C_DELAY
 5849  0000000                   
 5850  0000000                   ;SCL:9th:0->1
 5851  0000000                   	I2C_X0_SCL_1
 5852  0000000                   	I2C_DELAY
 5853  0000000                   
 5854  0000000                   ;SDA:check ACK
 5855  0000000                   	LDA !I2C_X0SDA_PORT_ADDR
 5856  0000000                   	BIT #I2C_X0SDA_PIN_VALUE
 5857  0000000                   	BNE I2C_X0_MOSI_NACK#
 5858  0000000                   
 5859  0000000                   	I2C_X0_SCL_0
 5860  0000000                   	LDA #01H





 5861  0000000                   	BRA I2C_X0_MOSI_END#
 5862  0000000                   
 5863  0000000                   I2C_X0_MOSI_NACK#:
 5864  0000000                   	I2C_X0_SCL_0	
 5865  0000000                   	LDA #00H
 5866  0000000                   
 5867  0000000                   I2C_X0_MOSI_END#:		
 5868  0000000                   	ENDM	
 5869  0000000                   ;--------------------------------------------------------
 5870  0000000                   I2C_X0_MISO_Y	MACRO
 5871  0000000                   	LDA !I2C_X0SDA_PORT_ADDR
 5872  0000000                   	BIT #I2C_X0SDA_PIN_VALUE
 5873  0000000                   	BEQ I2C_X0_MISO_0#	
 5874  0000000                   I2C_X0_MISO_1#:
 5875  0000000                   	TYA
 5876  0000000                   	SEC
 5877  0000000                   	ROL A
 5878  0000000                   	TAY
 5879  0000000                   	BRA I2C_X0_MISO_NEXT#
 5880  0000000                   I2C_X0_MISO_0#:
 5881  0000000                   	TYA
 5882  0000000                   	CLC
 5883  0000000                   	ROL A
 5884  0000000                   	TAY
 5885  0000000                   I2C_X0_MISO_NEXT#:	
 5886  0000000                   	ENDM
 5887  0000000                   ;--------------------------------------------------------
 5888  0000000                   I2C_X0_MISO_Y_1BIT	MACRO
 5889  0000000                   	I2C_X0_SCL_0
 5890  0000000                   	I2C_DELAY
 5891  0000000                   	I2C_X0_SCL_1
 5892  0000000                   	I2C_DELAY
 5893  0000000                   
 5894  0000000                   	I2C_X0_MISO_Y
 5895  0000000                   	ENDM
 5896  0000000                   ;--------------------------------------------------------
 5897  0000000                   ;input: SCL output low,
 5898  0000000                   ;output:SCL output low, SDA output 1
 5899  0000000                   
 5900  0000000                   I2C_X0_MISO MACRO
 5901  0000000                   	I2C_X0_SDA_PULL_HIGH_1
 5902  0000000                   
 5903  0000000                   	LDY #00H
 5904  0000000                   	I2C_X0_MISO_Y_1BIT
 5905  0000000                   	I2C_X0_MISO_Y_1BIT
 5906  0000000                   	I2C_X0_MISO_Y_1BIT
 5907  0000000                   	I2C_X0_MISO_Y_1BIT
 5908  0000000                   	I2C_X0_MISO_Y_1BIT
 5909  0000000                   	I2C_X0_MISO_Y_1BIT
 5910  0000000                   	I2C_X0_MISO_Y_1BIT
 5911  0000000                   	I2C_X0_MISO_Y_1BIT
 5912  0000000                   
 5913  0000000                   	ENDM
 5914  0000000                   ;--------------------------------------------------------
 5915  0000000                   I2C_X0_MISO_ACK MACRO
 5916  0000000                   	I2C_X0_SCL_0
 5917  0000000                   





 5918  0000000                   ;SDA: output0
 5919  0000000                   	I2C_X0_SDA_OUTPUT_0	
 5920  0000000                   	I2C_DELAY
 5921  0000000                   
 5922  0000000                   ;SCL:0->1
 5923  0000000                   	I2C_X0_SCL_1
 5924  0000000                   	I2C_DELAY
 5925  0000000                   
 5926  0000000                   ;SCL:1->0
 5927  0000000                   	I2C_X0_SCL_0
 5928  0000000                   	ENDM
 5929  0000000                   ;--------------------------------------------------------
 5930  0000000                   I2C_X0_MISO_NACK MACRO
 5931  0000000                   ;SCL:1->0
 5932  0000000                   	I2C_X0_SCL_0
 5933  0000000                   
 5934  0000000                   ;SDA: output1
 5935  0000000                   	I2C_X0_SDA_OUTPUT_1
 5936  0000000                   	I2C_DELAY
 5937  0000000                   
 5938  0000000                   ;SCL:0->1
 5939  0000000                   	I2C_X0_SCL_1
 5940  0000000                   	I2C_DELAY
 5941  0000000                   
 5942  0000000                   ;SCL:1->0
 5943  0000000                   	I2C_X0_SCL_0
 5944  0000000                   	ENDM
 5945  0000000                   ;--------------------------------------------------------
 5946  0000000                   ;	ack:acc=01;nack:acc=00
 5947  0000000                   I2C_X0_WRITE_NB_RAM MACRO NUM,REG
 5948  0000000                   	LDX #00H
 5949  0000000                   I2C_X0_WRITE_NB_RAM_LOOP#:
 5950  0000000                   	CPX #NUM
 5951  0000000                   	BNE 3
 5952  0000000                   	JMP I2C_X0_WRITE_NB_RAM_DONE#
 5953  0000000                   	LDA REG,X
 5954  0000000                   	I2C_X0_MOSI
 5955  0000000                   	BEQ I2C_X0_WRITE_NB_RAM_NACK#
 5956  0000000                   	INX
 5957  0000000                   	JMP I2C_X0_WRITE_NB_RAM_LOOP#
 5958  0000000                   I2C_X0_WRITE_NB_RAM_DONE#:
 5959  0000000                   	LDA #01H
 5960  0000000                   	BRA END_I2C_X0_WRITE_NB_RAM#
 5961  0000000                   
 5962  0000000                   I2C_X0_WRITE_NB_RAM_NACK#:
 5963  0000000                   	LDA #00H
 5964  0000000                   
 5965  0000000                   END_I2C_X0_WRITE_NB_RAM#:
 5966  0000000                   	ENDM
 5967  0000000                   ;--------------------------------------------------------
 5968  0000000                   ;	ack:acc=01;nack:acc=00
 5969  0000000                   I2C_X0_WRITE_NB_RAM2 MACRO REG
 5970  0000000                   	LDX #00H
 5971  0000000                   I2C_X0_WRITE_NB_RAM2_LOOP#:
 5972  0000000                   	CPX REG
 5973  0000000                   	BNE 3
 5974  0000000                   	JMP I2C_X0_WRITE_NB_RAM2_DONE#





 5975  0000000                   	LDA REG+1,X
 5976  0000000                   	I2C_X0_MOSI
 5977  0000000                   	BEQ I2C_X0_WRITE_NB_RAM2_NACK#
 5978  0000000                   	INX
 5979  0000000                   	JMP I2C_X0_WRITE_NB_RAM2_LOOP#
 5980  0000000                   I2C_X0_WRITE_NB_RAM2_DONE#:
 5981  0000000                   	LDA #01H
 5982  0000000                   	BRA END_I2C_X0_WRITE_NB_RAM2#
 5983  0000000                   
 5984  0000000                   I2C_X0_WRITE_NB_RAM2_NACK#:
 5985  0000000                   	LDA #00H
 5986  0000000                   
 5987  0000000                   END_I2C_X0_WRITE_NB_RAM2#:
 5988  0000000                   	ENDM
 5989  0000000                   ;--------------------------------------------------------
 5990  0000000                   I2C_X0_READ_NB_RAM MACRO NUM,REG
 5991  0000000                   	LDX #00H
 5992  0000000                   I2C_X0_READ_NB_RAM_LOOP#:
 5993  0000000                   	CPX #NUM-1
 5994  0000000                   	BNE 3
 5995  0000000                   	JMP END_I2C_X0_READ_NB_RAM#
 5996  0000000                   	I2C_X0_MISO
 5997  0000000                   	I2C_X0_MISO_ACK
 5998  0000000                   	TYA
 5999  0000000                   	STA REG,X
 6000  0000000                   	INX
 6001  0000000                   	JMP I2C_X0_READ_NB_RAM_LOOP#
 6002  0000000                   END_I2C_X0_READ_NB_RAM#:
 6003  0000000                   	I2C_X0_MISO
 6004  0000000                   	I2C_X0_MISO_NACK
 6005  0000000                   	TYA
 6006  0000000                   	STA REG,X
 6007  0000000                   	ENDM
 6008  0000000                   ;--------------------------------------------------------
 6009  0000000                   I2C_X0_READ_NB_RAM2 MACRO REG
 6010  0000000                   	LDX #00H
 6011  0000000                   I2C_X0_READ_NB_RAM2_LOOP#:
 6012  0000000                   	INX
 6013  0000000                   	CPX REG
 6014  0000000                   	BNE 3
 6015  0000000                   	JMP END_I2C_X0_READ_NB_RAM2#
 6016  0000000                   	DEX
 6017  0000000                   	I2C_X0_MISO
 6018  0000000                   	I2C_X0_MISO_ACK
 6019  0000000                   	TYA
 6020  0000000                   	STA REG+1,X
 6021  0000000                   	INX
 6022  0000000                   	JMP I2C_X0_READ_NB_RAM2_LOOP#
 6023  0000000                   END_I2C_X0_READ_NB_RAM2#:
 6024  0000000                   	DEX
 6025  0000000                   	I2C_X0_MISO
 6026  0000000                   	I2C_X0_MISO_NACK
 6027  0000000                   	TYA
 6028  0000000                   	STA REG+1,X
 6029  0000000                   	ENDM
 6030  0000000                   ;=====================================================================================
 6031  0000000                   ;=====================================================================================





 6032  0000000                   .IF (I2C_COMMAND_ENABLE .EQ. 1H)
 6033  0000000                   ;output: SCL output
 6034  0000000                   I2C_INIT MACRO
 6035  0000000                    	I2C_X0_INIT_PIN
 6036  0000000                    	ENDM
 6037  0000000                   ;------------------------------------------------------------------------------
 6038  0000000                   ;output: SDA output low,SCL output low
 6039  0000000                   I2C_ON	MACRO 
 6040  0000000                   	I2C_X0_START
 6041  0000000                   	ENDM
 6042  0000000                   ;------------------------------------------------------------------------------
 6043  0000000                   ;output: SDA output high,SCL output high
 6044  0000000                   I2C_OFF	MACRO 
 6045  0000000                   	I2C_X0_STOP
 6046  0000000                   	ENDM
 6047  0000000                   ;------------------------------------------------------------------------------
 6048  0000000                   ;input: SCL output low,
 6049  0000000                   ;output:SCL output low, SDA input
 6050  0000000                   ;	ack:acc=01;nack:acc=00
 6051  0000000                   I2C_WRITE MACRO DATA
 6052  0000000                   	LDA #DATA
 6053  0000000                   	I2C_X0_MOSI
 6054  0000000                   	ENDM
 6055  0000000                   ;------------------------------------------------------------------------------
 6056  0000000                   I2C_WRITE_RAM MACRO REG
 6057  0000000                   	LDA REG
 6058  0000000                   	I2C_X0_MOSI
 6059  0000000                   	ENDM
 6060  0000000                   ;------------------------------------------------------------------------------
 6061  0000000                   I2C_WRITE_NB_RAM MACRO NUM,REG
 6062  0000000                   	I2C_X0_WRITE_NB_RAM NUM,REG
 6063  0000000                   	ENDM
 6064  0000000                   ;------------------------------------------------------------------------------
 6065  0000000                   I2C_WRITE_NB_RAM2 MACRO REG
 6066  0000000                   	I2C_X0_WRITE_NB_RAM2 REG
 6067  0000000                   	ENDM
 6068  0000000                   ;------------------------------------------------------------------------------
 6069  0000000                   ;input: SCL output low,
 6070  0000000                   ;output:SCL output low, SDA output 1
 6071  0000000                   
 6072  0000000                   I2C_READ_NACK MACRO 
 6073  0000000                   	I2C_X0_MISO
 6074  0000000                   	I2C_X0_MISO_NACK
 6075  0000000                   	TYA
 6076  0000000                   	ENDM
 6077  0000000                   ;------------------------------------------------------------------------------
 6078  0000000                   I2C_READ MACRO 
 6079  0000000                   	I2C_READ_NACK
 6080  0000000                   	ENDM
 6081  0000000                   ;------------------------------------------------------------------------------
 6082  0000000                   I2C_READ_NACK_RAM MACRO REG
 6083  0000000                   	I2C_X0_MISO
 6084  0000000                   	I2C_X0_MISO_NACK
 6085  0000000                   	STY REG
 6086  0000000                   	ENDM
 6087  0000000                   ;------------------------------------------------------------------------------
 6088  0000000                   I2C_READ_RAM MACRO REG





 6089  0000000                   	I2C_READ_NACK_RAM REG
 6090  0000000                   	ENDM
 6091  0000000                   ;------------------------------------------------------------------------------
 6092  0000000                   I2C_READ_ACK MACRO 
 6093  0000000                   	I2C_X0_MISO
 6094  0000000                   	I2C_X0_MISO_ACK
 6095  0000000                   	TYA
 6096  0000000                   	ENDM
 6097  0000000                   ;------------------------------------------------------------------------------
 6098  0000000                   I2C_READ_ACK_RAM MACRO REG
 6099  0000000                   	I2C_X0_MISO
 6100  0000000                   	I2C_X0_MISO_ACK
 6101  0000000                   	STY REG
 6102  0000000                   	ENDM
 6103  0000000                   ;------------------------------------------------------------------------------
 6104  0000000                   I2C_READ_NB_RAM MACRO NUM,REG
 6105  0000000                   	I2C_X0_READ_NB_RAM NUM,REG
 6106  0000000                   	ENDM
 6107  0000000                   ;------------------------------------------------------------------------------
 6108  0000000                   I2C_READ_NB_RAM2 MACRO REG
 6109  0000000                   	I2C_X0_READ_NB_RAM2 REG
 6110  0000000                   	ENDM
 6111  0000000                   .ENDIF
 6112  0000000                   ;=====================================================================================
 6113  0000000                   ;=====================================================================================	
 6114  0000000                   
 6115  0000000                   
 6116  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\MACRO_INSTRUCTION.INI.APP"
 6117  0000000                   ;==============================================================================
 6118  0000000                   ;==============================================================================
 6119  0000000                   SET_STACK_POINTER_TO	MACRO	STACK_START_VALUE
 6120  0000000                   	LDX	#STACK_START_VALUE
 6121  0000000                   	TXS
 6122  0000000                   	ENDM
 6123  0000000                   ;------------------------------------------------------------------------------
 6124  0000000                   CLEAR_RAM_FROM_00H_TO	MACRO	CLEAR_RAM_END
 6125  0000000                   ;=== CLEAR RAMS ===
 6126  0000000                   	LDA	#.LOW.CLEAR_RAM_END
 6127  0000000                   	STA	<RR0			;keep the end address low byte
 6128  0000000                   	LDA	#.HIGH.CLEAR_RAM_END	
 6129  0000000                   	STA	<RR1			;keep the end address high byte
 6130  0000000                   CLEAR_LOOP#:
 6131  0000000                   	LDA	#00
 6132  0000000                   	STA	(<RR0)
 6133  0000000                   	LDA	<RR1
 6134  0000000                   	BNE	DEC_ADDR#
 6135  0000000                   	LDA	<RR0
 6136  0000000                   	CMP	#02H
 6137  0000000                   	BEQ	END_CLEAR#
 6138  0000000                   DEC_ADDR#:
 6139  0000000                   	SEC
 6140  0000000                   	LDA	<RR0
 6141  0000000                   	SBC	#01H
 6142  0000000                   	STA	<RR0
 6143  0000000                   	LDA	<RR1
 6144  0000000                   	SBC	#00H
 6145  0000000                   	STA	<RR1





 6146  0000000                   	.IF	 (CHIPBODY!='N588H000')
 6147  0000000                   	CMP	#01h
 6148  0000000                   	BNE	NOT_IN_01#	;I-f address is 01xx, change to 00xx
 6149  0000000                   	DEC	<RR1
 6150  0000000                   	.ENDIF
 6151  0000000                   NOT_IN_01#:
 6152  0000000                   	JMP	CLEAR_LOOP#
 6153  0000000                   END_CLEAR#:
 6154  0000000                   	LDA	#00h
 6155  0000000                   	STA	<RR0	;Clear address 00H and 01H
 6156  0000000                   	STA	<RR1
 6157  0000000                   	ENDM
 6158  0000000                   ;--------------------------------------------------------------
 6159  0000000                   CLEAR_RAM_RANGE MACRO CLEAR_RAM_BEGIN,CLEAR_RAM_END
 6160  0000000                   ;=== CLEAR RAMS ===
 6161  0000000                   	LDA	#.LOW.CLEAR_RAM_END
 6162  0000000                   	STA	<CLEAR_RAM_BEGIN			;keep the end address low byte
 6163  0000000                   	LDA	#.HIGH.CLEAR_RAM_END	
 6164  0000000                   	STA	<CLEAR_RAM_BEGIN+1			;keep the end address high byte
 6165  0000000                   CLEAR_LOOP_1#:
 6166  0000000                   	LDA	#00
 6167  0000000                   	STA	(<CLEAR_RAM_BEGIN)
 6168  0000000                   	LDA	<CLEAR_RAM_BEGIN+1
 6169  0000000                   	CMP 	#(.HIGH.CLEAR_RAM_BEGIN+2)
 6170  0000000                   	BNE 	DEC_ADDR_1#
 6171  0000000                   	LDA	<CLEAR_RAM_BEGIN
 6172  0000000                   	CMP	#(.LOW.CLEAR_RAM_BEGIN+2)
 6173  0000000                   	BEQ	END_CLEAR_1#
 6174  0000000                   DEC_ADDR_1#:
 6175  0000000                   	SEC
 6176  0000000                   	LDA	<CLEAR_RAM_BEGIN
 6177  0000000                   	SBC	#01H
 6178  0000000                   	STA	<CLEAR_RAM_BEGIN
 6179  0000000                   	LDA	<CLEAR_RAM_BEGIN+1
 6180  0000000                   	SBC	#00H
 6181  0000000                   	STA	<CLEAR_RAM_BEGIN+1
 6182  0000000                   	.IF	 (CHIPBODY!='N588H000')
 6183  0000000                   	CMP	#01h
 6184  0000000                   	BNE	NOT_IN_01#	;I-f address is 01xx, change to 00xx
 6185  0000000                   	DEC	<CLEAR_RAM_BEGIN+1
 6186  0000000                   	.ENDIF
 6187  0000000                   NOT_IN_01#:
 6188  0000000                   	JMP	CLEAR_LOOP_1#
 6189  0000000                   END_CLEAR_1#:
 6190  0000000                   	LDA	#00h
 6191  0000000                   	STA	<CLEAR_RAM_BEGIN	;Clear address 00H and 01H
 6192  0000000                   	STA	<CLEAR_RAM_BEGIN+1
 6193  0000000                   	ENDM
 6194  0000000                   ;===============================================================================
 6195  0000000                   ;===============================================================================
 6196  0000000                   EN_BP0X_PWM MACRO BP0X_VALUE,PWV_INDEX,DUTY,DIVISION,PAIR_PWM,BP0C_MODE
 6197  0000000                   	LDA !BP0D
 6198  0000000                   	BIT #BP0X_VALUE
 6199  0000000                   	BNE BP0X_PWM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6200  0000000                   
 6201  0000000                   	LDA !BP0
 6202  0000000                   	BIT #BP0X_VALUE





 6203  0000000                   	BNE BP0X_PWM_INIT_NEXT#
 6204  0000000                   
 6205  0000000                   	LDA #DUTY
 6206  0000000                   	EOR #FFH
 6207  0000000                   	BRA BP0X_PWM_INIT_CONST#
 6208  0000000                   
 6209  0000000                   BP0X_PWM_INIT#:	
 6210  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin
 6211  0000000                   	TRB !BP0D
 6212  0000000                   
 6213  0000000                   	.IFDEF       BPXM_RAM
 6214  0000000                   		TRB BP0M_BAK
 6215  0000000                   		LDA !BP0D
 6216  0000000                   		EOR #FFH
 6217  0000000                   		AND !BP0
 6218  0000000                   		ORA #BP0X_VALUE
 6219  0000000                   		ORA BP0M_BAK
 6220  0000000                   	.ELSE
 6221  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High
 6222  0000000                   		ORA !BP0
 6223  0000000                   		ORA !BP0D
 6224  0000000                   	.ENDIF
 6225  0000000                   	STA !BP0
 6226  0000000                   BP0X_PWM_INIT_NEXT#:
 6227  0000000                   	LDA #DUTY		;duty,low level
 6228  0000000                   BP0X_PWM_INIT_CONST#:
 6229  0000000                   	STA !(PWV0+PWV_INDEX)
 6230  0000000                   	LDA !PWMC
 6231  0000000                   	AND #3FH
 6232  0000000                   	ORA #(DIVISION-1)*64	;division type
 6233  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6234  0000000                   	STA !PWMC
 6235  0000000                   
 6236  0000000                   	LDA !PWMC
 6237  0000000                   	BIT #PAIR_PWM
 6238  0000000                   	BEQ EN_BP0X_PWM_END#
 6239  0000000                   	LDA #BP0C_MODE
 6240  0000000                   	TRB !BP0C
 6241  0000000                   
 6242  0000000                   EN_BP0X_PWM_END#:
 6243  0000000                   	ENDM
 6244  0000000                   ;------------------------------------------------------------------------------	
 6245  0000000                   EN_BP0X_PWM_RAM MACRO BP0X_VALUE,PWV_INDEX,DUTY_RAM,DIVISION,PAIR_PWM,BP0C_MODE
 6246  0000000                   	LDA !BP0D
 6247  0000000                   	BIT #BP0X_VALUE
 6248  0000000                   	BNE BP0X_PWM_RAM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6249  0000000                   
 6250  0000000                   	LDA !BP0
 6251  0000000                   	BIT #BP0X_VALUE
 6252  0000000                   	BNE BP0X_PWM_RAM_INIT_NEXT#
 6253  0000000                   
 6254  0000000                   	LDA !DUTY_RAM
 6255  0000000                   	EOR #FFH
 6256  0000000                   	BRA BP0X_PWM_RAM_INIT_CONST#
 6257  0000000                   
 6258  0000000                   BP0X_PWM_RAM_INIT#:
 6259  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin





 6260  0000000                   	TRB !BP0D
 6261  0000000                   	.IFDEF       BPXM_RAM
 6262  0000000                   		TRB BP0M_BAK
 6263  0000000                   		LDA !BP0D
 6264  0000000                   		EOR #FFH
 6265  0000000                   		AND !BP0
 6266  0000000                   		ORA #BP0X_VALUE
 6267  0000000                   		ORA BP0M_BAK
 6268  0000000                   	.ELSE
 6269  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High
 6270  0000000                   		ORA !BP0
 6271  0000000                   		ORA !BP0D
 6272  0000000                   	.ENDIF
 6273  0000000                   	STA !BP0
 6274  0000000                   BP0X_PWM_RAM_INIT_NEXT#:
 6275  0000000                   	LDA !DUTY_RAM		;duty,low level
 6276  0000000                   BP0X_PWM_RAM_INIT_CONST#:
 6277  0000000                   	STA !(PWV0+PWV_INDEX)
 6278  0000000                   	LDA !PWMC
 6279  0000000                   	AND #3FH
 6280  0000000                   	ORA #(DIVISION-1)*64	;division type
 6281  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6282  0000000                   	STA !PWMC
 6283  0000000                   
 6284  0000000                   	LDA !PWMC
 6285  0000000                   	BIT #PAIR_PWM
 6286  0000000                   	BEQ EN_BP0X_PWM_RAM_END#
 6287  0000000                   	LDA #BP0C_MODE
 6288  0000000                   	TRB !BP0C
 6289  0000000                   
 6290  0000000                   EN_BP0X_PWM_RAM_END#:
 6291  0000000                   	ENDM
 6292  0000000                   ;------------------------------------------------------------------------------		
 6293  0000000                   EN_BP0X_H_PWM MACRO BP0X_VALUE,PWV_INDEX,DUTY,DIVISION,PAIR_PWM,BP0C_MODE
 6294  0000000                   	LDA !BP0D
 6295  0000000                   	BIT #BP0X_VALUE
 6296  0000000                   	BNE BP0X_H_PWM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6297  0000000                   
 6298  0000000                   	LDA !BP0
 6299  0000000                   	BIT #BP0X_VALUE
 6300  0000000                   	BNE BP0X_H_PWM_INIT_NEXT#
 6301  0000000                   
 6302  0000000                   	LDA #DUTY
 6303  0000000                   	BRA BP0X_H_PWM_INIT_CONST#
 6304  0000000                   
 6305  0000000                   BP0X_H_PWM_INIT#:
 6306  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin
 6307  0000000                   	TRB !BP0D
 6308  0000000                   	.IFDEF       BPXM_RAM
 6309  0000000                   		TRB BP0M_BAK
 6310  0000000                   		LDA !BP0D
 6311  0000000                   		EOR #FFH
 6312  0000000                   		AND !BP0
 6313  0000000                   		ORA #BP0X_VALUE
 6314  0000000                   		ORA BP0M_BAK
 6315  0000000                   	.ELSE
 6316  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High





 6317  0000000                   		ORA !BP0
 6318  0000000                   		ORA !BP0D
 6319  0000000                   	.ENDIF
 6320  0000000                   	STA !BP0
 6321  0000000                   BP0X_H_PWM_INIT_NEXT#:
 6322  0000000                   	LDA #DUTY		;duty,low level
 6323  0000000                   	EOR #FFH
 6324  0000000                   BP0X_H_PWM_INIT_CONST#:
 6325  0000000                   	STA !(PWV0+PWV_INDEX)
 6326  0000000                   	LDA !PWMC
 6327  0000000                   	AND #3FH
 6328  0000000                   	ORA #(DIVISION-1)*64	;division type
 6329  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6330  0000000                   	STA !PWMC	
 6331  0000000                   
 6332  0000000                   	LDA !PWMC
 6333  0000000                   	BIT #PAIR_PWM
 6334  0000000                   	BEQ EN_BP0X_H_PWM_END#
 6335  0000000                   	LDA #BP0C_MODE
 6336  0000000                   	TRB !BP0C
 6337  0000000                   
 6338  0000000                   EN_BP0X_H_PWM_END#:
 6339  0000000                   	ENDM
 6340  0000000                   ;------------------------------------------------------------------------------	
 6341  0000000                   EN_BP0X_H_PWM_RAM MACRO BP0X_VALUE,PWV_INDEX,DUTY_RAM,DIVISION,PAIR_PWM,BP0C_MODE
 6342  0000000                   	LDA !BP0D
 6343  0000000                   	BIT #BP0X_VALUE
 6344  0000000                   	BNE BP0X_H_PWM_RAM_INIT#	;BP0D[]=1 =>BP0[] as input pin
 6345  0000000                   
 6346  0000000                   	LDA !BP0
 6347  0000000                   	BIT #BP0X_VALUE
 6348  0000000                   	BNE BP0X_H_PWM_RAM_INIT_NEXT#
 6349  0000000                   
 6350  0000000                   	LDA !DUTY_RAM
 6351  0000000                   	BRA BP0X_H_PWM_RAM_INIT_CONST#
 6352  0000000                   
 6353  0000000                   BP0X_H_PWM_RAM_INIT#:
 6354  0000000                   	LDA #BP0X_VALUE		;BP0D[]=0 =>BP0[] as output pin
 6355  0000000                   	TRB !BP0D
 6356  0000000                   	.IFDEF       BPXM_RAM
 6357  0000000                   		TRB BP0M_BAK
 6358  0000000                   		LDA !BP0D
 6359  0000000                   		EOR #FFH
 6360  0000000                   		AND !BP0
 6361  0000000                   		ORA #BP0X_VALUE
 6362  0000000                   		ORA BP0M_BAK
 6363  0000000                   	.ELSE
 6364  0000000                   		LDA #BP0X_VALUE		;BP0X=1 ->High
 6365  0000000                   		ORA !BP0
 6366  0000000                   		ORA !BP0D
 6367  0000000                   	.ENDIF
 6368  0000000                   	STA !BP0
 6369  0000000                   BP0X_H_PWM_RAM_INIT_NEXT#:
 6370  0000000                   	LDA !DUTY_RAM		;duty,low level
 6371  0000000                   	EOR #FFH
 6372  0000000                   BP0X_H_PWM_RAM_INIT_CONST#:
 6373  0000000                   	STA !(PWV0+PWV_INDEX)





 6374  0000000                   	LDA !PWMC
 6375  0000000                   	AND #3FH
 6376  0000000                   	ORA #(DIVISION-1)*64	;division type
 6377  0000000                   	ORA #BP0X_VALUE		;BP00 Port PWM enable
 6378  0000000                   	STA !PWMC	
 6379  0000000                   
 6380  0000000                   	LDA !PWMC
 6381  0000000                   	BIT #PAIR_PWM
 6382  0000000                   	BEQ EN_BP0X_H_PWM_RAM_END#
 6383  0000000                   	LDA #BP0C_MODE
 6384  0000000                   	TRB !BP0C
 6385  0000000                   
 6386  0000000                   EN_BP0X_H_PWM_RAM_END#:
 6387  0000000                   	ENDM
 6388  0000000                   ;------------------------------------------------------------------------------	
 6389  0000000                   ;------------------------------------------------------------------------------	
 6390  0000000                   EN_BP00_PWM MACRO DUTY, DIVISION
 6391  0000000                   	EN_BP0X_PWM BP00_PWM,0,DUTY,DIVISION,BP01_PWM,BP00_MOTOR
 6392  0000000                   	ENDM
 6393  0000000                   ;------------------------------------------------------------------------------
 6394  0000000                   EN_BP00_H_PWM MACRO DUTY, DIVISION
 6395  0000000                   	EN_BP0X_H_PWM BP00_PWM,0,DUTY,DIVISION,BP01_PWM,BP00_MOTOR
 6396  0000000                   	ENDM
 6397  0000000                   ;------------------------------------------------------------------------------
 6398  0000000                   EN_BP00_PWM_RAM MACRO DUTY_RAM, DIVISION
 6399  0000000                   	EN_BP0X_PWM_RAM BP00_PWM,0,DUTY_RAM,DIVISION,BP01_PWM,BP00_MOTOR
 6400  0000000                   	ENDM
 6401  0000000                   ;-------------------------------------------------------------	
 6402  0000000                   EN_BP00_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6403  0000000                   	EN_BP0X_H_PWM_RAM BP00_PWM,0,DUTY_RAM,DIVISION,BP01_PWM,BP00_MOTOR
 6404  0000000                   	ENDM
 6405  0000000                   ;------------------------------------------------------------------------------	
 6406  0000000                   DIS_BP00_PWM MACRO
 6407  0000000                   	LDA #BP00_PWM		
 6408  0000000                   	TRB !PWMC
 6409  0000000                   	ENDM
 6410  0000000                   ;------------------------------------------------------------------------------	
 6411  0000000                   ;------------------------------------------------------------------------------	
 6412  0000000                   EN_BP01_PWM MACRO DUTY, DIVISION
 6413  0000000                   	EN_BP0X_PWM BP01_PWM,0,DUTY,DIVISION,BP00_PWM,BP01_MOTOR
 6414  0000000                   	ENDM
 6415  0000000                   ;------------------------------------------------------------------------------
 6416  0000000                   EN_BP01_H_PWM MACRO DUTY, DIVISION
 6417  0000000                   	EN_BP0X_H_PWM BP01_PWM,0,DUTY,DIVISION,BP00_PWM,BP01_MOTOR
 6418  0000000                   	ENDM
 6419  0000000                   ;------------------------------------------------------------------------------
 6420  0000000                   EN_BP01_PWM_RAM MACRO DUTY_RAM, DIVISION
 6421  0000000                   	EN_BP0X_PWM_RAM BP01_PWM,0,DUTY_RAM,DIVISION,BP00_PWM,BP01_MOTOR
 6422  0000000                   	ENDM
 6423  0000000                   ;-------------------------------------------------------------	
 6424  0000000                   EN_BP01_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6425  0000000                   	EN_BP0X_H_PWM_RAM BP01_PWM,0,DUTY_RAM,DIVISION,BP00_PWM,BP01_MOTOR
 6426  0000000                   	ENDM
 6427  0000000                   ;-------------------------------------------------------------		
 6428  0000000                   DIS_BP01_PWM MACRO
 6429  0000000                   	LDA #BP01_PWM		
 6430  0000000                   	TRB !PWMC





 6431  0000000                   	ENDM
 6432  0000000                   ;------------------------------------------------------------------------------	
 6433  0000000                   ;------------------------------------------------------------------------------	
 6434  0000000                   EN_BP02_PWM MACRO DUTY, DIVISION
 6435  0000000                   	EN_BP0X_PWM BP02_PWM,1,DUTY,DIVISION,BP03_PWM,BP02_MOTOR
 6436  0000000                   	ENDM
 6437  0000000                   ;------------------------------------------------------------------------------
 6438  0000000                   EN_BP02_H_PWM MACRO DUTY, DIVISION
 6439  0000000                   	EN_BP0X_H_PWM BP02_PWM,1,DUTY,DIVISION,BP03_PWM,BP02_MOTOR
 6440  0000000                   	ENDM
 6441  0000000                   ;------------------------------------------------------------------------------
 6442  0000000                   EN_BP02_PWM_RAM MACRO DUTY_RAM, DIVISION
 6443  0000000                   	EN_BP0X_PWM_RAM BP02_PWM,1,DUTY_RAM,DIVISION,BP03_PWM,BP02_MOTOR
 6444  0000000                   	ENDM
 6445  0000000                   ;-------------------------------------------------------------	
 6446  0000000                   EN_BP02_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6447  0000000                   	EN_BP0X_H_PWM_RAM BP02_PWM,1,DUTY_RAM,DIVISION,BP03_PWM,BP02_MOTOR
 6448  0000000                   	ENDM
 6449  0000000                   ;-------------------------------------------------------------		
 6450  0000000                   DIS_BP02_PWM MACRO
 6451  0000000                   	LDA #BP02_PWM		
 6452  0000000                   	TRB !PWMC
 6453  0000000                   	ENDM
 6454  0000000                   ;------------------------------------------------------------------------------	
 6455  0000000                   ;------------------------------------------------------------------------------	
 6456  0000000                   EN_BP03_PWM MACRO DUTY, DIVISION
 6457  0000000                   	EN_BP0X_PWM BP03_PWM,1,DUTY,DIVISION,BP02_PWM,BP03_MOTOR
 6458  0000000                   	ENDM
 6459  0000000                   ;------------------------------------------------------------------------------
 6460  0000000                   EN_BP03_H_PWM MACRO DUTY, DIVISION
 6461  0000000                   	EN_BP0X_H_PWM BP03_PWM,1,DUTY,DIVISION,BP02_PWM,BP03_MOTOR
 6462  0000000                   	ENDM
 6463  0000000                   ;------------------------------------------------------------------------------
 6464  0000000                   EN_BP03_PWM_RAM MACRO DUTY_RAM, DIVISION
 6465  0000000                   	EN_BP0X_PWM_RAM BP03_PWM,1,DUTY_RAM,DIVISION,BP02_PWM,BP03_MOTOR
 6466  0000000                   	ENDM
 6467  0000000                   ;-------------------------------------------------------------	
 6468  0000000                   EN_BP03_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6469  0000000                   	EN_BP0X_H_PWM_RAM BP03_PWM,1,DUTY_RAM,DIVISION,BP02_PWM,BP03_MOTOR
 6470  0000000                   	ENDM
 6471  0000000                   ;-------------------------------------------------------------		
 6472  0000000                   DIS_BP03_PWM MACRO
 6473  0000000                   	LDA #BP03_PWM		
 6474  0000000                   	TRB !PWMC
 6475  0000000                   	ENDM
 6476  0000000                   ;------------------------------------------------------------------------------	
 6477  0000000                   ;------------------------------------------------------------------------------	
 6478  0000000                   EN_BP04_PWM MACRO DUTY, DIVISION
 6479  0000000                   	EN_BP0X_PWM BP04_PWM,2,DUTY,DIVISION,BP05_PWM,BP04_MOTOR
 6480  0000000                   	ENDM
 6481  0000000                   ;------------------------------------------------------------------------------
 6482  0000000                   EN_BP04_H_PWM MACRO DUTY, DIVISION
 6483  0000000                   	EN_BP0X_H_PWM BP04_PWM,2,DUTY,DIVISION,BP05_PWM,BP04_MOTOR
 6484  0000000                   	ENDM
 6485  0000000                   ;------------------------------------------------------------------------------
 6486  0000000                   EN_BP04_PWM_RAM MACRO DUTY_RAM, DIVISION
 6487  0000000                   	EN_BP0X_PWM_RAM BP04_PWM,2,DUTY_RAM,DIVISION,BP05_PWM,BP04_MOTOR





 6488  0000000                   	ENDM
 6489  0000000                   ;-------------------------------------------------------------	
 6490  0000000                   EN_BP04_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6491  0000000                   	EN_BP0X_H_PWM_RAM BP04_PWM,2,DUTY_RAM,DIVISION,BP05_PWM,BP04_MOTOR
 6492  0000000                   	ENDM
 6493  0000000                   ;-------------------------------------------------------------		
 6494  0000000                   DIS_BP04_PWM MACRO
 6495  0000000                   	LDA #BP04_PWM		
 6496  0000000                   	TRB !PWMC
 6497  0000000                   	ENDM
 6498  0000000                   ;------------------------------------------------------------------------------	
 6499  0000000                   ;------------------------------------------------------------------------------	
 6500  0000000                   EN_BP05_PWM MACRO DUTY, DIVISION
 6501  0000000                   	EN_BP0X_PWM BP05_PWM,2,DUTY,DIVISION,BP04_PWM,BP05_MOTOR
 6502  0000000                   	ENDM
 6503  0000000                   ;------------------------------------------------------------------------------
 6504  0000000                   EN_BP05_H_PWM MACRO DUTY, DIVISION
 6505  0000000                   	EN_BP0X_H_PWM BP05_PWM,2,DUTY,DIVISION,BP04_PWM,BP05_MOTOR
 6506  0000000                   	ENDM
 6507  0000000                   ;------------------------------------------------------------------------------
 6508  0000000                   EN_BP05_PWM_RAM MACRO DUTY_RAM, DIVISION
 6509  0000000                   	EN_BP0X_PWM_RAM BP05_PWM,2,DUTY_RAM,DIVISION,BP04_PWM,BP05_MOTOR
 6510  0000000                   	ENDM
 6511  0000000                   ;-------------------------------------------------------------	
 6512  0000000                   EN_BP05_H_PWM_RAM MACRO DUTY_RAM, DIVISION
 6513  0000000                   	EN_BP0X_H_PWM_RAM BP05_PWM,2,DUTY_RAM,DIVISION,BP04_PWM,BP05_MOTOR
 6514  0000000                   	ENDM
 6515  0000000                   ;-------------------------------------------------------------		
 6516  0000000                   DIS_BP05_PWM MACRO
 6517  0000000                   	LDA #BP05_PWM		
 6518  0000000                   	TRB !PWMC
 6519  0000000                   	ENDM
 6520  0000000                   ;===============================================================================
 6521  0000000                   ;===============================================================================
 6522  0000000                   RAMP_UP MACRO
 6523  0000000                   	STZ !SP0ALT
 6524  0000000                   	.IF	(CHIPSERIES = 'N588J')
 6525  0000000                   	.ELSE
 6526  0000000                   		STZ !SP0BLT
 6527  0000000                   		STZ !SP0CLT
 6528  0000000                   	.ENDIF
 6529  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 6530  0000000                   		STZ !SP0AL
 6531  0000000                   		.IF	(CHIPSERIES = 'N588J')
 6532  0000000                   		.ELSE
 6533  0000000                   			STZ !SP0BL
 6534  0000000                   			STZ !SP0CL
 6535  0000000                   		.ENDIF
 6536  0000000                   	.ENDIF
 6537  0000000                   
 6538  0000000                   	LDA #80H	
 6539  0000000                   	STA !SP0AT	
 6540  0000000                   	.IF	(CHIPSERIES = 'N588J')
 6541  0000000                   	.ELSE
 6542  0000000                   		STA !SP0BT	
 6543  0000000                   		STA !SP0CT
 6544  0000000                   	.ENDIF





 6545  0000000                   	.IF(WITH_ALL_MIXER_SFR .EQ. 1)
 6546  0000000                   		STA !SP0A
 6547  0000000                   		.IF	(CHIPSERIES = 'N588J')
 6548  0000000                   		.ELSE
 6549  0000000                   			STA !SP0B
 6550  0000000                   			STA !SP0C	
 6551  0000000                   		.ENDIF
 6552  0000000                   	.ENDIF
 6553  0000000                   
 6554  0000000                   	OPEN_SPEN
 6555  0000000                   
 6556  0000000                   .IF	 (WITH_DAC_ENABLE .EQ. 1)
 6557  0000000                   	LDA !SPEN
 6558  0000000                   	AND #WITH_SPEN_EFFECTIVE_BITS
 6559  0000000                   	BIT #SPEN_DAC
 6560  0000000                   	BEQ RAMP_UP_END#
 6561  0000000                   
 6562  0000000                   RAMP_UP_NEXT#:
 6563  0000000                   	LDA !RAMP			
 6564  0000000                   	BMI RAMP_UP_END#
 6565  0000000                   
 6566  0000000                   	.IFDEF WDTIMER
 6567  0000000                   	.IFDEF LVDEN
 6568  0000000                   		LDA #CTL_CPU_WDT
 6569  0000000                   		TSB RAM_CTL_CPU
 6570  0000000                   		LDA RAM_CTL_CPU
 6571  0000000                   		STA !CTL_CPU
 6572  0000000                   	.ELSE
 6573  0000000                   		LDA #CTL_CPU_WDT
 6574  0000000                   		TSB !CTL_CPU
 6575  0000000                   	.ENDIF 	
 6576  0000000                   	.ENDIF
 6577  0000000                   	LDY #60H
 6578  0000000                   	DEY
 6579  0000000                   	BNE -3
 6580  0000000                   
 6581  0000000                   	INC !RAMP
 6582  0000000                   	BRA RAMP_UP_NEXT#
 6583  0000000                   .ENDIF
 6584  0000000                   RAMP_UP_END#:
 6585  0000000                   	ENDM
 6586  0000000                   ;------------------------------------------------------------------------------
 6587  0000000                   RAMP_DOWN MACRO
 6588  0000000                   .IF	 (WITH_DAC_ENABLE .EQ. 1)
 6589  0000000                   	LDA !SPEN			;only pwm
 6590  0000000                   	AND #WITH_SPEN_EFFECTIVE_BITS
 6591  0000000                   	BIT #SPEN_DAC
 6592  0000000                   	BEQ RAMP_DOWN_END#
 6593  0000000                   
 6594  0000000                   RAMP_DOWN_NEXT#:
 6595  0000000                   	LDA !RAMP
 6596  0000000                   	BEQ RAMP_DOWN_END#
 6597  0000000                   
 6598  0000000                   	.IFDEF WDTIMER
 6599  0000000                   	.IFDEF LVDEN
 6600  0000000                   		LDA #CTL_CPU_WDT
 6601  0000000                   		TSB RAM_CTL_CPU





 6602  0000000                   		LDA RAM_CTL_CPU
 6603  0000000                   		STA !CTL_CPU
 6604  0000000                   	.ELSE
 6605  0000000                   		LDA #CTL_CPU_WDT
 6606  0000000                   		TSB !CTL_CPU
 6607  0000000                   	.ENDIF 	
 6608  0000000                   	.ENDIF	
 6609  0000000                   	LDY #60H
 6610  0000000                   	DEY
 6611  0000000                   	BNE -3
 6612  0000000                   
 6613  0000000                   	DEC !RAMP
 6614  0000000                   	BRA RAMP_DOWN_NEXT#
 6615  0000000                   .ENDIF
 6616  0000000                   RAMP_DOWN_END#:
 6617  0000000                   	CLOSE_SPEN
 6618  0000000                   	ENDM
 6619  0000000                   ;===============================================================================
 6620  0000000                   ;===============================================================================
 6621  0000000                   .IFDEF WITH_USER_PLAY
 6622  0000000                   INIT_DECODE_SPEECH8	MACRO	SPEECH_START
 6623  0000000                   	PSF_RESPONSE_LIMIT
 6624  0000000                   ;	PHP
 6625  0000000                   	PHA
 6626  0000000                   	PHX
 6627  0000000                   	PHY
 6628  0000000                   ;	SEI	
 6629  0000000                   
 6630  0000000                   	LDA	#.LOW.SPEECH_START
 6631  0000000                   	STA <USER_PLAY_DATA_ADDR
 6632  0000000                   	LDA	#.HIGH.SPEECH_START
 6633  0000000                   	STA <USER_PLAY_DATA_ADDR+1	
 6634  0000000                   	LDA	#.HIGH8.SPEECH_START
 6635  0000000                   	STA <USER_PLAY_BANK_ADDR
 6636  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6637  0000000                   	LDA	#.SEGHIGH.SPEECH_START
 6638  0000000                   	STA  <USER_PLAY_BANK_ADDR+1
 6639  0000000                   	.ENDIF
 6640  0000000                   	.IF (WITH_USER_PLAY_VOL_ADJ .EQ. 1H)
 6641  0000000                   	LDA #10H
 6642  0000000                   	STA <USER_PLAY_SP_VOLUME
 6643  0000000                   	.ENDIF
 6644  0000000                   
 6645  0000000                   	JSR PLAY_PHRASE_PROCEDURE
 6646  0000000                   
 6647  0000000                   	PLY
 6648  0000000                   	PLX
 6649  0000000                   	PLA
 6650  0000000                   ;	PLP
 6651  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6652  0000000                   	ENDM
 6653  0000000                   ;------------------------------------------------------------------------------	
 6654  0000000                   DECODE_ONE_SAMPLE MACRO
 6655  0000000                   	EXTERN	DECODE_ONE_SAMPLE_CH1
 6656  0000000                   	PSF_RESPONSE_LIMIT_JSR DECODE_ONE_SAMPLE_CH1
 6657  0000000                   	ENDM
 6658  0000000                   ;------------------------------------------------------------------------------





 6659  0000000                   SET_DECODE_VOL MACRO VOLUME_VALUE
 6660  0000000                   .IF (WITH_USER_PLAY_VOL_ADJ .EQ. 1)
 6661  0000000                   	LDA #VOLUME_VALUE
 6662  0000000                   	ASL A
 6663  0000000                   	STA <CH_R_FINAL_VOLUME_SP+VS0A_START
 6664  0000000                   .ENDIF
 6665  0000000                   	ENDM
 6666  0000000                   ;------------------------------------------------------------------------------
 6667  0000000                   SET_DECODE_VOL_RAM MACRO VOLUME_RAM
 6668  0000000                   .IF (WITH_USER_PLAY_VOL_ADJ .EQ. 1)
 6669  0000000                   	LDA VOLUME_RAM
 6670  0000000                   	ASL A
 6671  0000000                   	STA <CH_R_FINAL_VOLUME_SP+VS0A_START
 6672  0000000                   .ENDIF
 6673  0000000                   	ENDM
 6674  0000000                   .ELSE
 6675  0000000                   ;==============================================================================
 6676  0000000                   ;==============================================================================
 6677  0000000                   FXF13_ISR_PROC MACRO 
 6678  0000000                   ;------------------EVO PROC----------------------------
 6679  0000000                   	.IF (WITH_EVO .EQ. 1)
 6680  0000000                   			LDA <GLOBAL_PLAY
 6681  0000000                   			BIT #(EVO1_BZ+EVO2_BZ+EVO3_BZ)
 6682  0000000                   			BEQ FXF13_ISR_PROC_EVO_END#
 6683  0000000                   
 6684  0000000                   			EXTERN ISR_EVO_PROC
 6685  0000000                   			JMP ISR_EVO_PROC
 6686  0000000                   FXF13_ISR_PROC_EVO_END#:			
 6687  0000000                   	.ENDIF
 6688  0000000                   
 6689  0000000                   	PUBLIC FXF13_ISR_PROC_NEXT
 6690  0000000                   FXF13_ISR_PROC_NEXT:
 6691  0000000                   ;------------------MS PROC-----------------------------
 6692  0000000                   	.IF (WITH_MS .EQ. 1H)
 6693  0000000                   		EXTERN		RELOAD_FXF_ISR_DELAY_COUNT
 6694  0000000                   		LDA <GLOBAL_PLAY
 6695  0000000                   		BIT #MS_EXT
 6696  0000000                   		BNE FXF13_ISR_PROC_MS_CONT#
 6697  0000000                   		LDA <MS_START+CH_STATUS_MS
 6698  0000000                   		BIT #MS_BZ
 6699  0000000                   		BEQ FXF13_ISR_PROC_MS_END#		
 6700  0000000                   ;BIT #MS_PS
 6701  0000000                   ;BNE FXF13_ISR_PROC_MS_END#
 6702  0000000                   FXF13_ISR_PROC_MS_CONT#:
 6703  0000000                   		JMP RELOAD_FXF_ISR_DELAY_COUNT
 6704  0000000                   FXF13_ISR_PROC_MS_END#:		
 6705  0000000                   	.ENDIF	
 6706  0000000                   	ENDM
 6707  0000000                   ;------------------------------------------------------------------------------
 6708  0000000                   
 6709  0000000                   
 6710  0000000                   QUIT_LIB_FXF_ISR_CONT  MACRO
 6711  0000000                   ;------------------CHECK EVO BUSY----------------------
 6712  0000000                   	.IF (WITH_EVO .EQ. 1)
 6713  0000000                   			LDA <GLOBAL_PLAY
 6714  0000000                   			BIT #(EVO1_BZ+EVO2_BZ+EVO3_BZ)
 6715  0000000                   			BNE QUIT_LIB_FXF_ISR_CONT_END#





 6716  0000000                   	.ENDIF
 6717  0000000                   ;------------------CHECK MS_EXT BUSY-------------------
 6718  0000000                   	.IF (WITH_MS .EQ. 1H)	
 6719  0000000                   			LDA <GLOBAL_PLAY
 6720  0000000                   			BIT #MS_EXT
 6721  0000000                   			BNE QUIT_LIB_FXF_ISR_CONT_END#
 6722  0000000                   			LDA <MS_START+CH_STATUS_MS	
 6723  0000000                   			BIT #MS_BZ
 6724  0000000                   			BNE QUIT_LIB_FXF_ISR_CONT_END#
 6725  0000000                   	.ENDIF 
 6726  0000000                   
 6727  0000000                   	LDA #INT0_FXF13
 6728  0000000                   	TRB !IEF0
 6729  0000000                   	STA !EFC0
 6730  0000000                   
 6731  0000000                   QUIT_LIB_FXF_ISR_CONT_END#:
 6732  0000000                   	ENDM
 6733  0000000                   ;==============================================================================
 6734  0000000                   ;==============================================================================
 6735  0000000                   SP_VOLUME_REDUCE MACRO
 6736  0000000                   	.IF (WITH_VOL_REDUCE .EQ. 1)
 6737  0000000                   ;timer index
 6738  0000000                   	PLY 
 6739  0000000                   ;
 6740  0000000                   ;;update by angela 2006.03.03 for bug 0001117,0001142
 6741  0000000                   ;	EXTERN SP_TM_CH_MAP_TABLE
 6742  0000000                   ;	LDX !SP_TM_CH_MAP_TABLE,Y
 6743  0000000                   ;	TXA
 6744  0000000                   ;	TAY	
 6745  0000000                   ;	LDA !SP_CHANNEL_ADDR_TABLE, Y
 6746  0000000                   ;;update by angela 2006.03.03 for bug 0001117,0001142
 6747  0000000                   ;	BEQ END_VOL#
 6748  0000000                   ;	TAX
 6749  0000000                   ;	LDA <CH_STATUS_SP,X
 6750  0000000                   ;	BIT #(SP_DC_RAMP_UP+SP_DC_RAMP_DOWN+SP_ADSR)
 6751  0000000                   ;	BNE END_VOL#
 6752  0000000                   ;		
 6753  0000000                   ;	TYA		
 6754  0000000                   ;	INC A
 6755  0000000                   ;	BIT <COMMON_FLAG
 6756  0000000                   ;	BEQ END_VOL#
 6757  0000000                   ;		
 6758  0000000                   ;	.IF (WITH_T_BUFFER .EQ. 0)
 6759  0000000                   ;	LDA <CH_SP_PCM_TEMP_SP+1,X
 6760  0000000                   ;	.ELSE
 6761  0000000                   ;	EXTERN SP_HI_T_INDEX_TABLE
 6762  0000000                   ;	LDX !SP_HI_T_INDEX_TABLE,Y
 6763  0000000                   ;	LDA !SP_HI_T_START_ADDR,X
 6764  0000000                   ;	.ENDIF
 6765  0000000                   ;	EOR #80H
 6766  0000000                   ;
 6767  0000000                   ;	BMI NEG_PCM#
 6768  0000000                   ;	CLC
 6769  0000000                   ;	BRA STORE_REDUCE_VOL#
 6770  0000000                   ;NEG_PCM#:
 6771  0000000                   ;	SEC
 6772  0000000                   ;





 6773  0000000                   ;STORE_REDUCE_VOL#:
 6774  0000000                   ;	ROR A
 6775  0000000                   ;	EOR #80H
 6776  0000000                   ;	.IF (WITH_T_BUFFER .EQ. 0)
 6777  0000000                   ;	STA <CH_SP_PCM_TEMP_SP+1,X
 6778  0000000                   ;	.ELSE
 6779  0000000                   ;	STA !SP_HI_T_START_ADDR,X
 6780  0000000                   ;	.ENDIF
 6781  0000000                   ;
 6782  0000000                   ;	.IF (WITH_PCM_OUTPUT_SIZE .EQ. 2)
 6783  0000000                   ;	.IF(WITH_T_BUFFER .EQ. 0)
 6784  0000000                   ;	ROR <CH_SP_PCM_TEMP_SP,X
 6785  0000000                   ;	.ELSE
 6786  0000000                   ;	EXTERN SP_LO_T_INDEX_TABLE
 6787  0000000                   ;	LDX !SP_LO_T_INDEX_TABLE,Y
 6788  0000000                   ;	.IF (WITH_SP0XL_RESOLUTION .EQ. 1)
 6789  0000000                   ;		ROR !SP_LO_T_START_ADDR,X
 6790  0000000                   ;	.ENDIF
 6791  0000000                   ;	.IF (WITH_SP0XL_RESOLUTION .EQ. 2)
 6792  0000000                   ;		LDA !SP_LO_T_START_ADDR,X
 6793  0000000                   ;		ROR A
 6794  0000000                   ;		AND #FCH
 6795  0000000                   ;		STA !SP_LO_T_START_ADDR,X
 6796  0000000                   ;	.ENDIF
 6797  0000000                   ;	.IF (WITH_SP0XL_RESOLUTION .EQ. 3)
 6798  0000000                   ;		LDA !SP_LO_T_START_ADDR,X
 6799  0000000                   ;		ROR A
 6800  0000000                   ;		AND #F0H
 6801  0000000                   ;		STA !SP_LO_T_START_ADDR,X
 6802  0000000                   ;	.ENDIF
 6803  0000000                   ;	.ENDIF
 6804  0000000                   ;	.ENDIF
 6805  0000000                   ;END_VOL#:	
 6806  0000000                   	.ENDIF
 6807  0000000                   	ENDM
 6808  0000000                   ;==============================================================================
 6809  0000000                   ;==============================================================================
 6810  0000000                   TAIL_ON MACRO                                                                   
 6811  0000000                   	.IF (WITH_SP .EQ. 1) .OR. (WITH_MS .EQ. 1)
 6812  0000000                   	LDA #TAIL_OFF_DAC	
 6813  0000000                   	TRB <COMMON_FLAG
 6814  0000000                   	.ENDIF
 6815  0000000                   	ENDM
 6816  0000000                   ;------------------------------------------------------------------------------
 6817  0000000                   TAIL_OFF MACRO
 6818  0000000                   	.IF (WITH_SP .EQ. 1).OR.(WITH_MS .EQ. 1)
 6819  0000000                   	LDA #TAIL_OFF_DAC
 6820  0000000                   	TSB <COMMON_FLAG
 6821  0000000                   	.ENDIF
 6822  0000000                   	ENDM	
 6823  0000000                   ;==============================================================================
 6824  0000000                   ;==============================================================================
 6825  0000000                   .IF ((WITH_NOISE_SHAPING .EQ. 1)||(WITH_NOISE_SHAPING .EQ. 2))
 6826  0000000                   NOISE_SHAPING_ON MACRO SP_SR                           
 6827  0000000                   ;	SET_PWM_MODE_SP SP_SR
 6828  0000000                   ;	EXTERN OPEN_NOISE_SHAPING
 6829  0000000                   ;	JSR OPEN_NOISE_SHAPING		





 6830  0000000                   	ENDM
 6831  0000000                   ;------------------------------------------------------------------------------
 6832  0000000                   NOISE_SHAPING_OFF MACRO
 6833  0000000                   ;	EXTERN CLOSE_NOISE_SHAPING
 6834  0000000                   ;	JSR CLOSE_NOISE_SHAPING
 6835  0000000                   	ENDM
 6836  0000000                   .ENDIF	
 6837  0000000                   ;==============================================================================
 6838  0000000                   ;==============================================================================
 6839  0000000                   PLAY8	MACRO	SENTENCE_START
 6840  0000000                   	PSF_RESPONSE_LIMIT
 6841  0000000                   	PHP
 6842  0000000                   	SEI
 6843  0000000                   	PHA
 6844  0000000                   	PHX
 6845  0000000                   	PHY
 6846  0000000                   
 6847  0000000                   	LDA	#.LOW.SENTENCE_START
 6848  0000000                   	STA <TEMP_REG1
 6849  0000000                   	LDA	#.HIGH.SENTENCE_START
 6850  0000000                   	STA <TEMP_REG1+1
 6851  0000000                   
 6852  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6853  0000000                   	STA <TEMP_REG2
 6854  0000000                   
 6855  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6856  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6857  0000000                   	STA  <TEMP_REG2+1
 6858  0000000                   	.ENDIF
 6859  0000000                   
 6860  0000000                   	JSR PLAY_PHRASE_PROCEDURE;_IOSPI
 6861  0000000                   
 6862  0000000                   	PLY
 6863  0000000                   	PLX
 6864  0000000                   	PLA
 6865  0000000                   	PLP
 6866  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6867  0000000                   	ENDM
 6868  0000000                   ;------------------------------------------------------------------------------
 6869  0000000                   PLAY8_EXT_SPI	MACRO	SENTENCE_START
 6870  0000000                   	PSF_RESPONSE_LIMIT
 6871  0000000                   	PHP
 6872  0000000                   	SEI
 6873  0000000                   	PHA
 6874  0000000                   	PHX
 6875  0000000                   	PHY
 6876  0000000                   
 6877  0000000                   	.IFDEF       BPXM_RAM
 6878  0000000                   	LDA <BP0M_BAK
 6879  0000000                   	AND #BPn_SPI_MASK_1
 6880  0000000                   	ORA #BPn_SPI_MASK_2
 6881  0000000                   	STA <BP0M_BAK
 6882  0000000                   	.ENDIF
 6883  0000000                   
 6884  0000000                   	LDA	#.LOW.SENTENCE_START
 6885  0000000                   	STA <TEMP_REG1
 6886  0000000                   	LDA	#.HIGH.SENTENCE_START





 6887  0000000                   	STA <TEMP_REG1+1
 6888  0000000                   
 6889  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6890  0000000                   	STA <TEMP_REG2
 6891  0000000                   
 6892  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6893  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6894  0000000                   	STA  <TEMP_REG2+1
 6895  0000000                   	.ENDIF
 6896  0000000                   
 6897  0000000                   	JSR PLAY_PHRASE_PROCEDURE_IOSPI
 6898  0000000                   
 6899  0000000                   	PLY
 6900  0000000                   	PLX
 6901  0000000                   	PLA
 6902  0000000                   	PLP
 6903  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6904  0000000                   	ENDM
 6905  0000000                   ;------------------------------------------------------------------------------
 6906  0000000                   PLAY8TAILON	MACRO	SENTENCE_START
 6907  0000000                   	PSF_RESPONSE_LIMIT
 6908  0000000                   	PHP
 6909  0000000                   	SEI
 6910  0000000                   	PHA
 6911  0000000                   	PHX
 6912  0000000                   	PHY
 6913  0000000                   
 6914  0000000                   	LDA	#.LOW.SENTENCE_START
 6915  0000000                   	STA <TEMP_REG1
 6916  0000000                   	LDA	#.HIGH.SENTENCE_START
 6917  0000000                   	STA <TEMP_REG1+1
 6918  0000000                   
 6919  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6920  0000000                   	STA <TEMP_REG2
 6921  0000000                   
 6922  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6923  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6924  0000000                   	STA  <TEMP_REG2+1
 6925  0000000                   	.ENDIF
 6926  0000000                   
 6927  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 6928  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_ON
 6929  0000000                   	JSR PRE_PLAY_PHRASE_TAIL_ON
 6930  0000000                   
 6931  0000000                   	PLY
 6932  0000000                   	PLX
 6933  0000000                   	PLA
 6934  0000000                   	PLP
 6935  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6936  0000000                   	ENDM	
 6937  0000000                   ;------------------------------------------------------------------------------
 6938  0000000                   PLAY8TAILOFF	MACRO	SENTENCE_START
 6939  0000000                   	PSF_RESPONSE_LIMIT
 6940  0000000                   	PHP
 6941  0000000                   	SEI
 6942  0000000                   	PHA
 6943  0000000                   	PHX





 6944  0000000                   	PHY
 6945  0000000                   
 6946  0000000                   	LDA	#.LOW.SENTENCE_START
 6947  0000000                   	STA <TEMP_REG1
 6948  0000000                   	LDA	#.HIGH.SENTENCE_START
 6949  0000000                   	STA <TEMP_REG1+1
 6950  0000000                   
 6951  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6952  0000000                   	STA <TEMP_REG2
 6953  0000000                   
 6954  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6955  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 6956  0000000                   	STA  <TEMP_REG2+1
 6957  0000000                   	.ENDIF
 6958  0000000                   
 6959  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 6960  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_OFF
 6961  0000000                   	JSR PRE_PLAY_PHRASE_TAIL_OFF
 6962  0000000                   
 6963  0000000                   	PLY
 6964  0000000                   	PLX
 6965  0000000                   	PLA
 6966  0000000                   	PLP
 6967  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 6968  0000000                   	ENDM	
 6969  0000000                   ;------------------------------------------------------------------------------
 6970  0000000                   .IF(WITH_PLAYE .EQ. 1)
 6971  0000000                   PLAY8E	MACRO	SENTENCE_START
 6972  0000000                   	PSF_RESPONSE_LIMIT
 6973  0000000                   	PHP
 6974  0000000                   	SEI
 6975  0000000                   	PHA
 6976  0000000                   	PHX
 6977  0000000                   	PHY
 6978  0000000                   
 6979  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)	
 6980  0000000                   	LDA <TEMP_REG1
 6981  0000000                   	PHA
 6982  0000000                   	LDA <TEMP_REG1+1
 6983  0000000                   	PHA
 6984  0000000                   	LDA <TEMP_REG2
 6985  0000000                   	PHA
 6986  0000000                   	LDA <TEMP_REG2+1
 6987  0000000                   	PHA
 6988  0000000                   	.ENDIF
 6989  0000000                   
 6990  0000000                   	LDA	#.LOW.SENTENCE_START
 6991  0000000                   	STA <TEMP_REG1
 6992  0000000                   	LDA	#.HIGH.SENTENCE_START
 6993  0000000                   	STA <TEMP_REG1+1
 6994  0000000                   
 6995  0000000                   	LDA	#.HIGH8.SENTENCE_START
 6996  0000000                   	STA <TEMP_REG2
 6997  0000000                   
 6998  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 6999  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 7000  0000000                   	STA  <TEMP_REG2+1





 7001  0000000                   	.ENDIF
 7002  0000000                   
 7003  0000000                   	JSR PLAY_PHRASE_PROCEDURE
 7004  0000000                   
 7005  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)
 7006  0000000                   	PLA
 7007  0000000                   	STA <TEMP_REG2+1
 7008  0000000                   	PLA
 7009  0000000                   	STA <TEMP_REG2
 7010  0000000                   	PLA
 7011  0000000                   	STA <TEMP_REG1+1
 7012  0000000                   	PLA
 7013  0000000                   	STA <TEMP_REG1
 7014  0000000                   	.ENDIF
 7015  0000000                   
 7016  0000000                   	PLY
 7017  0000000                   	PLX
 7018  0000000                   	PLA
 7019  0000000                   	PLP
 7020  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7021  0000000                   	ENDM
 7022  0000000                   ;------------------------------------------------------------------------------	
 7023  0000000                   PLAY8ETAILON	MACRO	SENTENCE_START
 7024  0000000                   	PSF_RESPONSE_LIMIT
 7025  0000000                   	PHP
 7026  0000000                   	SEI
 7027  0000000                   	PHA
 7028  0000000                   	PHX
 7029  0000000                   	PHY
 7030  0000000                   
 7031  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)	
 7032  0000000                   	LDA <TEMP_REG1
 7033  0000000                   	PHA
 7034  0000000                   	LDA <TEMP_REG1+1
 7035  0000000                   	PHA
 7036  0000000                   	LDA <TEMP_REG2
 7037  0000000                   	PHA
 7038  0000000                   	LDA <TEMP_REG2+1
 7039  0000000                   	PHA
 7040  0000000                   	.ENDIF
 7041  0000000                   
 7042  0000000                   	LDA	#.LOW.SENTENCE_START
 7043  0000000                   	STA <TEMP_REG1
 7044  0000000                   	LDA	#.HIGH.SENTENCE_START
 7045  0000000                   	STA <TEMP_REG1+1
 7046  0000000                   
 7047  0000000                   	LDA	#.HIGH8.SENTENCE_START
 7048  0000000                   	STA <TEMP_REG2
 7049  0000000                   
 7050  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 7051  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 7052  0000000                   	STA  <TEMP_REG2+1
 7053  0000000                   	.ENDIF
 7054  0000000                   
 7055  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 7056  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_ON
 7057  0000000                   	JSR  PRE_PLAY_PHRASE_TAIL_ON





 7058  0000000                   
 7059  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)
 7060  0000000                   	PLA
 7061  0000000                   	STA <TEMP_REG2+1
 7062  0000000                   	PLA
 7063  0000000                   	STA <TEMP_REG2
 7064  0000000                   	PLA
 7065  0000000                   	STA <TEMP_REG1+1
 7066  0000000                   	PLA
 7067  0000000                   	STA <TEMP_REG1
 7068  0000000                   	.ENDIF
 7069  0000000                   
 7070  0000000                   	PLY
 7071  0000000                   	PLX
 7072  0000000                   	PLA
 7073  0000000                   	PLP
 7074  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7075  0000000                   	ENDM
 7076  0000000                   ;------------------------------------------------------------------------------
 7077  0000000                   PLAY8ETAILOFF	MACRO	SENTENCE_START
 7078  0000000                   	PSF_RESPONSE_LIMIT
 7079  0000000                   	PHP
 7080  0000000                   	SEI
 7081  0000000                   	PHA
 7082  0000000                   	PHX
 7083  0000000                   	PHY
 7084  0000000                   
 7085  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)	
 7086  0000000                   	LDA <TEMP_REG1
 7087  0000000                   	PHA
 7088  0000000                   	LDA <TEMP_REG1+1
 7089  0000000                   	PHA
 7090  0000000                   	LDA <TEMP_REG2
 7091  0000000                   	PHA
 7092  0000000                   	LDA <TEMP_REG2+1
 7093  0000000                   	PHA
 7094  0000000                   	.ENDIF
 7095  0000000                   
 7096  0000000                   	LDA	#.LOW.SENTENCE_START
 7097  0000000                   	STA <TEMP_REG1
 7098  0000000                   	LDA	#.HIGH.SENTENCE_START
 7099  0000000                   	STA <TEMP_REG1+1
 7100  0000000                   
 7101  0000000                   	LDA	#.HIGH8.SENTENCE_START
 7102  0000000                   	STA <TEMP_REG2
 7103  0000000                   
 7104  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1)
 7105  0000000                   	LDA	#.SEGHIGH.SENTENCE_START
 7106  0000000                   	STA  <TEMP_REG2+1
 7107  0000000                   	.ENDIF
 7108  0000000                   
 7109  0000000                   ;JSR PLAY_PHRASE_PROCEDURE
 7110  0000000                   	EXTERN PRE_PLAY_PHRASE_TAIL_OFF
 7111  0000000                   	JSR  PRE_PLAY_PHRASE_TAIL_OFF
 7112  0000000                   
 7113  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1)
 7114  0000000                   	PLA





 7115  0000000                   	STA <TEMP_REG2+1
 7116  0000000                   	PLA
 7117  0000000                   	STA <TEMP_REG2
 7118  0000000                   	PLA
 7119  0000000                   	STA <TEMP_REG1+1
 7120  0000000                   	PLA
 7121  0000000                   	STA <TEMP_REG1
 7122  0000000                   	.ENDIF
 7123  0000000                   
 7124  0000000                   	PLY
 7125  0000000                   	PLX
 7126  0000000                   	PLA
 7127  0000000                   	PLP
 7128  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7129  0000000                   	ENDM
 7130  0000000                   .ENDIF
 7131  0000000                   ;==============================================================================
 7132  0000000                   ;==============================================================================
 7133  0000000                   STOP_PLAY_SP_CHANNEL MACRO CHANNEL
 7134  0000000                   .IF(WITH_SP .EQ. 1)
 7135  0000000                   	PSF_RESPONSE_LIMIT
 7136  0000000                   	LDY #CHANNEL
 7137  0000000                   	EXTERNAL SP_CHANNEL_ADDR_TABLE
 7138  0000000                   	EXTERN STOP_PLAY_Y_SP_API
 7139  0000000                   	JSR STOP_PLAY_Y_SP_API 
 7140  0000000                   
 7141  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7142  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7143  0000000                   .ENDIF	
 7144  0000000                   	ENDM	
 7145  0000000                   ;------------------------------------------------------------------------------
 7146  0000000                   STOP_PLAY_EVO_CHANNEL MACRO CHANNEL
 7147  0000000                   .IF(WITH_EVO .EQ. 1)
 7148  0000000                   	PSF_RESPONSE_LIMIT
 7149  0000000                   	LDY #CHANNEL
 7150  0000000                   	EXTERNAL EVO_CHANNEL_ADDR_TABLE
 7151  0000000                   	EXTERN STOP_PLAY_Y_EVO_API
 7152  0000000                   	JSR STOP_PLAY_Y_EVO_API
 7153  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7154  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7155  0000000                   .ENDIF	
 7156  0000000                   	ENDM	
 7157  0000000                   ;------------------------------------------------------------------------------
 7158  0000000                   STOP_PLAY_MS MACRO
 7159  0000000                   .IF(WITH_MS .EQ. 1)
 7160  0000000                   	PSF_RESPONSE_LIMIT
 7161  0000000                   	EXTERN MS_CHANNEL_ADDR_TABLE
 7162  0000000                   	EXTERN STOP_PLAY_ALL_MS_API
 7163  0000000                   	JSR STOP_PLAY_ALL_MS_API
 7164  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7165  0000000                   .ENDIF	
 7166  0000000                   	ENDM
 7167  0000000                   ;------------------------------------------------------------------------------
 7168  0000000                   STOP_PLAY_ALL MACRO
 7169  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 7170  0000000                   .ELSE
 7171  0000000                   	PSF_RESPONSE_LIMIT





 7172  0000000                   	EXTERNAL SP_CHANNEL_ADDR_TABLE
 7173  0000000                   	EXTERNAL EVO_CHANNEL_ADDR_TABLE
 7174  0000000                   	EXTERNAL MS_MLDY_START_ADDR_TABLE
 7175  0000000                   	EXTERN STOP_PLAY_ALL_API
 7176  0000000                   	JSR STOP_PLAY_ALL_API
 7177  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7178  0000000                   .ENDIF	
 7179  0000000                   	ENDM
 7180  0000000                   ;==============================================================================
 7181  0000000                   ; Play Pause for Speech Channel: To set SP_PAUSE bit in 
 7182  0000000                   ; Check if speech channel, if not don't pause 
 7183  0000000                   ;==============================================================================
 7184  0000000                   .IF (WITH_PAUSE_RESUME .EQ. 1H)
 7185  0000000                   PAUSE_PLAY_Y_SP MACRO 
 7186  0000000                   	.IF (WITH_SP .EQ. 1H)
 7187  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7188  0000000                   		BEQ _@PAUSE_SP_END_#
 7189  0000000                   		LDA <CH_STATUS_SP,X
 7190  0000000                   		BIT #SP_BZ
 7191  0000000                   		BEQ _@PAUSE_SP_END_#
 7192  0000000                   ; check if play speech
 7193  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7194  0000000                   		BNE _@PAUSE_SP_END_#
 7195  0000000                   _@PAUSE_SPEECH_#:
 7196  0000000                   		BIT #SP_RESUME
 7197  0000000                   		BNE _@PAUSE_SPEECH_RESUME_DOING	
 7198  0000000                   		ORA #SP_PAUSE
 7199  0000000                   		STA <CH_STATUS_SP,X
 7200  0000000                   
 7201  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
 7202  0000000                   		LDA <CH_PREVIOUS_PCM_SP,X
 7203  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7204  0000000                   		LDA <CH_PREVIOUS_PCM_SP+1,X
 7205  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7206  0000000                   		.ELSE
 7207  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP,X
 7208  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7209  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP+1,X
 7210  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7211  0000000                   		.ENDIF
 7212  0000000                   		BRA _@PAUSE_SP_END_#
 7213  0000000                   
 7214  0000000                   _@PAUSE_SPEECH_RESUME_DOING:
 7215  0000000                   		AND #(FFH^SP_RESUME)
 7216  0000000                   		ORA #SP_PAUSE
 7217  0000000                   		STA <CH_STATUS_SP,X
 7218  0000000                   
 7219  0000000                   _@PAUSE_SP_END_#:
 7220  0000000                   	.ENDIF
 7221  0000000                   	ENDM
 7222  0000000                   ;------------------------------------------------------------------------------
 7223  0000000                   PAUSE_PLAY_ALL_SP MACRO 
 7224  0000000                   	.IF (WITH_SP .EQ. 1H)
 7225  0000000                   		LDY #FFh
 7226  0000000                   _@PAUSE_NEXT_SP#:
 7227  0000000                   		INY	
 7228  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y





 7229  0000000                   		BEQ _@PAUSE_ALL_SP_END#
 7230  0000000                   		LDA <CH_STATUS_SP,X
 7231  0000000                   		BIT #SP_BZ
 7232  0000000                   		BEQ _@PAUSE_NEXT_SP#
 7233  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7234  0000000                   		BNE _@PAUSE_NEXT_SP#
 7235  0000000                   _@TO_PAUSE_SP_#:
 7236  0000000                   		BIT #SP_RESUME
 7237  0000000                   		BNE _@PAUSE_SPEECH_RESUME_DOING_NEXT	
 7238  0000000                   		ORA #SP_PAUSE
 7239  0000000                   		STA <CH_STATUS_SP,X
 7240  0000000                   
 7241  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
 7242  0000000                   		LDA <CH_PREVIOUS_PCM_SP,X
 7243  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7244  0000000                   		LDA <CH_PREVIOUS_PCM_SP+1,X
 7245  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7246  0000000                   		.ELSE
 7247  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP,X
 7248  0000000                   		STA <CH_PAUSE_PCM_SP,X
 7249  0000000                   		LDA <CH_PREVIOUS_PCM_VOL_SP+1,X
 7250  0000000                   		STA <CH_PAUSE_PCM_SP+1,X
 7251  0000000                   		.ENDIF	
 7252  0000000                   		BRA _@PAUSE_NEXT_SP#
 7253  0000000                   
 7254  0000000                   _@PAUSE_SPEECH_RESUME_DOING_NEXT:
 7255  0000000                   		AND #(FFH^SP_RESUME)
 7256  0000000                   		ORA #SP_PAUSE
 7257  0000000                   		STA <CH_STATUS_SP,X
 7258  0000000                   		BRA _@PAUSE_NEXT_SP#
 7259  0000000                   
 7260  0000000                   _@PAUSE_ALL_SP_END#:
 7261  0000000                   	.ENDIF
 7262  0000000                   	ENDM
 7263  0000000                   ;------------------------------------------------------------------------------
 7264  0000000                   PAUSE_PLAY_SP_CHANNEL MACRO CHANNEL_ID
 7265  0000000                   	.IF (WITH_SP .EQ. 1H)
 7266  0000000                   		PHP
 7267  0000000                   		SEI
 7268  0000000                   		LDY #CHANNEL_ID
 7269  0000000                   		PAUSE_PLAY_Y_SP
 7270  0000000                   		PLP	
 7271  0000000                   		N55P_EXPANDER_PROCESS_RUNTIME
 7272  0000000                   	.ENDIF
 7273  0000000                   	ENDM
 7274  0000000                   ;------------------------------------------------------------------------------
 7275  0000000                   .IF (WITH_SP .EQ. 1)
 7276  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7277  0000000                   PAUSE_CH1 MACRO
 7278  0000000                   	PAUSE_PLAY_SP_CHANNEL 00H
 7279  0000000                   ENDM
 7280  0000000                   	.ENDIF
 7281  0000000                   ;------------------------------------------------------------------------------
 7282  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7283  0000000                   PAUSE_CH2 MACRO
 7284  0000000                   	PAUSE_PLAY_SP_CHANNEL 01H
 7285  0000000                   ENDM





 7286  0000000                   	.ENDIF
 7287  0000000                   ;------------------------------------------------------------------------------
 7288  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7289  0000000                   PAUSE_CH3 MACRO
 7290  0000000                   	PAUSE_PLAY_SP_CHANNEL 02H
 7291  0000000                   ENDM
 7292  0000000                   	.ENDIF
 7293  0000000                   .ENDIF
 7294  0000000                   ;==============================================================================
 7295  0000000                   PAUSE_PLAY_Y_EVO MACRO                                                                           
 7296  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7297  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE
 7298  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7299  0000000                   		BEQ _@PAUSE_EVO_END_#
 7300  0000000                   		LDA <CH_STATUS_EVO,X
 7301  0000000                   		BIT #EVO_BZ
 7302  0000000                   		BEQ _@PAUSE_EVO_END_#	
 7303  0000000                   _@PAUSE_EVO_#:		
 7304  0000000                   		ORA #EVO_PAUSE
 7305  0000000                   		STA <CH_STATUS_EVO,X
 7306  0000000                   _@PAUSE_EVO_END_#:
 7307  0000000                   	.ENDIF
 7308  0000000                   	ENDM
 7309  0000000                   ;------------------------------------------------------------------------------
 7310  0000000                   PAUSE_PLAY_ALL_EVO MACRO 
 7311  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7312  0000000                   		LDY #FFh
 7313  0000000                   _@PAUSE_NEXT_EVO#:
 7314  0000000                   		INY
 7315  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE		
 7316  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7317  0000000                   		BEQ _@PAUSE_ALL_EVO_END#
 7318  0000000                   		LDA <CH_STATUS_EVO,X
 7319  0000000                   		BIT #EVO_BZ
 7320  0000000                   		BEQ _@PAUSE_NEXT_EVO#
 7321  0000000                   _@TO_PAUSE_EVO_#:			
 7322  0000000                   		ORA #EVO_PAUSE
 7323  0000000                   		STA <CH_STATUS_EVO,X
 7324  0000000                   		BRA _@PAUSE_NEXT_EVO#
 7325  0000000                   _@PAUSE_ALL_EVO_END#:
 7326  0000000                   	.ENDIF
 7327  0000000                   	ENDM
 7328  0000000                   ;------------------------------------------------------------------------------
 7329  0000000                   PAUSE_PLAY_EVO_CHANNEL MACRO CHANNEL
 7330  0000000                   .IF(WITH_EVO .EQ. 1)
 7331  0000000                   	PHP
 7332  0000000                   	SEI
 7333  0000000                   	LDY #CHANNEL
 7334  0000000                   	PAUSE_PLAY_Y_EVO
 7335  0000000                   	PLP
 7336  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7337  0000000                   .ENDIF	
 7338  0000000                   	ENDM	
 7339  0000000                   ;------------------------------------------------------------------------------
 7340  0000000                   	.IF (WITH_EVO .EQ. 1)
 7341  0000000                   	.IF (WITH_CH0_EVO .EQ. 1)
 7342  0000000                   PAUSE_EVO1 MACRO





 7343  0000000                   	PAUSE_PLAY_EVO_CHANNEL 00H
 7344  0000000                   ENDM
 7345  0000000                   	.ENDIF
 7346  0000000                   	.ENDIF
 7347  0000000                   ;------------------------------------------------------------------------------
 7348  0000000                   	.IF (WITH_EVO .EQ. 1)
 7349  0000000                   	.IF (WITH_CH1_EVO .EQ. 1)
 7350  0000000                   PAUSE_EVO2 MACRO
 7351  0000000                   	PAUSE_PLAY_EVO_CHANNEL 01H
 7352  0000000                   ENDM
 7353  0000000                   	.ENDIF
 7354  0000000                   	.ENDIF
 7355  0000000                   ;------------------------------------------------------------------------------
 7356  0000000                   	.IF (WITH_EVO .EQ. 1)
 7357  0000000                   	.IF (WITH_CH2_EVO .EQ. 1)
 7358  0000000                   PAUSE_EVO3 MACRO
 7359  0000000                   	PAUSE_PLAY_EVO_CHANNEL 02H
 7360  0000000                   ENDM
 7361  0000000                   	.ENDIF
 7362  0000000                   	.ENDIF
 7363  0000000                   ;==============================================================================
 7364  0000000                   	.IF (WITH_MS .EQ. 1)
 7365  0000000                   PAUSE_MS MACRO
 7366  0000000                   	PSF_RESPONSE_LIMIT
 7367  0000000                   	PHP
 7368  0000000                   	SEI
 7369  0000000                   	EXTERN PAUSE_PLAY_ALL_MS_API
 7370  0000000                   	JSR PAUSE_PLAY_ALL_MS_API
 7371  0000000                   	PLP
 7372  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7373  0000000                   ENDM
 7374  0000000                   	.ENDIF
 7375  0000000                   ;==============================================================================
 7376  0000000                   PAUSE_PLAY_ALL_CHANNEL MACRO
 7377  0000000                   		PAUSE_PLAY_ALL_EVO
 7378  0000000                   		EXTERN PAUSE_PLAY_ALL_MS_API
 7379  0000000                   		JSR PAUSE_PLAY_ALL_MS_API
 7380  0000000                   		PAUSE_PLAY_ALL_SP
 7381  0000000                   ENDM
 7382  0000000                   ;------------------------------------------------------------------------------
 7383  0000000                   PAUSE_ALL MACRO
 7384  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 7385  0000000                   .ELSE
 7386  0000000                   	PHP
 7387  0000000                   	SEI
 7388  0000000                   	PAUSE_PLAY_ALL_CHANNEL	
 7389  0000000                   	PLP
 7390  0000000                   	N55P_EXPANDER_PROCESS_RUNTIME
 7391  0000000                   .ENDIF
 7392  0000000                   ENDM
 7393  0000000                   ;==============================================================================
 7394  0000000                   ; Play Pause: To set SP_PAUSE bit in 
 7395  0000000                   ;==============================================================================
 7396  0000000                   RESUME_PLAY_Y_SP MACRO 
 7397  0000000                   	.IF (WITH_SP .EQ. 1H)
 7398  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7399  0000000                   		BEQ _@END_RESEME_PLAY_Y_SP#





 7400  0000000                   		LDA <CH_STATUS_SP,X
 7401  0000000                   		BIT #SP_ADSR+SP_DC_RAMP_UP_FOR_MS
 7402  0000000                   		BNE _@END_RESEME_PLAY_Y_SP#
 7403  0000000                   		BIT #SP_PAUSE
 7404  0000000                   		BEQ END_RESEME_PLAY_Y_SP#
 7405  0000000                   		AND #FFh^(SP_PAUSE)
 7406  0000000                   		ORA #SP_RESUME
 7407  0000000                   		STA <CH_STATUS_SP,X 
 7408  0000000                   _@END_RESEME_PLAY_Y_SP#:
 7409  0000000                   	.ENDIF
 7410  0000000                   	ENDM
 7411  0000000                   ;------------------------------------------------------------------------------
 7412  0000000                   RESUME_PLAY_ALL_SP MACRO
 7413  0000000                   	.IF (WITH_SP .EQ. 1H)
 7414  0000000                   		LDY #FFh
 7415  0000000                   _@RESUME_NEXT_SP#:
 7416  0000000                   		INY
 7417  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7418  0000000                   		BEQ _@END_RESUME_ALL_SP#
 7419  0000000                   		LDA <CH_STATUS_SP,X
 7420  0000000                   		BIT #SP_ADSR+SP_DC_RAMP_UP_FOR_MS
 7421  0000000                   		BNE _@RESUME_NEXT_SP#
 7422  0000000                   		BIT #SP_PAUSE
 7423  0000000                   		BEQ _@RESUME_NEXT_SP#
 7424  0000000                   		AND #FFh^(SP_PAUSE)
 7425  0000000                   		ORA #SP_RESUME
 7426  0000000                   		STA <CH_STATUS_SP,X 
 7427  0000000                   		BRA _@RESUME_NEXT_SP#
 7428  0000000                   _@END_RESUME_ALL_SP#:		
 7429  0000000                   	.ENDIF
 7430  0000000                   	ENDM
 7431  0000000                   ;------------------------------------------------------------------------------
 7432  0000000                   RESUME_PLAY_SP_CHANNEL MACRO CHANNEL_ID
 7433  0000000                   	.IF (WITH_SP .EQ. 1H)
 7434  0000000                   		PHP
 7435  0000000                   		SEI
 7436  0000000                   		LDY #CHANNEL_ID
 7437  0000000                   		RESUME_PLAY_Y_SP
 7438  0000000                   		PLP
 7439  0000000                   	.ENDIF
 7440  0000000                   	ENDM
 7441  0000000                   ;------------------------------------------------------------------------------
 7442  0000000                   .IF (WITH_SP .EQ. 1)
 7443  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7444  0000000                   RESUME_CH1 MACRO
 7445  0000000                   	RESUME_PLAY_SP_CHANNEL 00H
 7446  0000000                   ENDM
 7447  0000000                   	.ENDIF
 7448  0000000                   ;------------------------------------------------------------------------------
 7449  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7450  0000000                   RESUME_CH2 MACRO
 7451  0000000                   	RESUME_PLAY_SP_CHANNEL 01H
 7452  0000000                   ENDM		
 7453  0000000                   	.ENDIF
 7454  0000000                   ;------------------------------------------------------------------------------
 7455  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7456  0000000                   RESUME_CH3 MACRO





 7457  0000000                   	RESUME_PLAY_SP_CHANNEL 02H
 7458  0000000                   ENDM		
 7459  0000000                   	.ENDIF
 7460  0000000                   .ENDIF
 7461  0000000                   ;==============================================================================
 7462  0000000                   ; Play Resume for Melody  To set ^MS_STOP bit in 
 7463  0000000                   ; Resume all melody polyphnote
 7464  0000000                   ;==============================================================================
 7465  0000000                   RESUME_PLAY_ALL_MS MACRO
 7466  0000000                   	.IF (WITH_MS .EQ. 1H)
 7467  0000000                   		LDA #MS_PS	
 7468  0000000                   		BIT <MS_START+CH_STATUS_MS
 7469  0000000                   		BEQ _@RESUME_END_ALL_MS#
 7470  0000000                   		TRB <MS_START+CH_STATUS_MS
 7471  0000000                   _@RESUME_END_ALL_MS#:
 7472  0000000                     	.ENDIF
 7473  0000000                   ENDM
 7474  0000000                   ;------------------------------------------------------------------------------
 7475  0000000                   	.IF (WITH_MS .EQ. 1)
 7476  0000000                   RESUME_MS MACRO
 7477  0000000                   	PSF_RESPONSE_LIMIT
 7478  0000000                   	PHP
 7479  0000000                   	SEI
 7480  0000000                   	EXTERN RESUME_PLAY_ALL_MS_API
 7481  0000000                   	JSR RESUME_PLAY_ALL_MS_API
 7482  0000000                   	PLP
 7483  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 7484  0000000                   ENDM
 7485  0000000                   	.ENDIF
 7486  0000000                   ;==============================================================================
 7487  0000000                   RESUME_PLAY_Y_EVO MACRO 
 7488  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7489  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE
 7490  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7491  0000000                   		BEQ _@END_RESEME_PLAY_Y_EVO#
 7492  0000000                   		LDA <CH_STATUS_EVO,X
 7493  0000000                   		AND #FFh^(EVO_PAUSE)
 7494  0000000                   		STA <CH_STATUS_EVO,X 
 7495  0000000                   _@END_RESEME_PLAY_Y_EVO#:
 7496  0000000                   	.ENDIF
 7497  0000000                   	ENDM
 7498  0000000                   ;------------------------------------------------------------------------------
 7499  0000000                   RESUME_PLAY_ALL_EVO MACRO 
 7500  0000000                   	.IF (WITH_EVO .EQ. 1H)
 7501  0000000                   		LDY #FFh
 7502  0000000                   _@RESUME_NEXT_EVO#:
 7503  0000000                   		INY
 7504  0000000                   		EXTERN EVO_CHANNEL_ADDR_TABLE
 7505  0000000                   		LDX !EVO_CHANNEL_ADDR_TABLE,Y
 7506  0000000                   		BEQ _@END_RESEME_PLAY_ALL_EVO#
 7507  0000000                   		LDA <CH_STATUS_EVO,X
 7508  0000000                   		AND #FFh^(EVO_PAUSE)
 7509  0000000                   		STA <CH_STATUS_EVO,X 
 7510  0000000                   		BRA _@RESUME_NEXT_EVO#
 7511  0000000                   _@END_RESEME_PLAY_ALL_EVO#:
 7512  0000000                   	.ENDIF
 7513  0000000                   	ENDM





 7514  0000000                   ;------------------------------------------------------------------------------
 7515  0000000                   RESUME_PLAY_EVO_CHANNEL MACRO CHANNEL
 7516  0000000                   .IF(WITH_EVO .EQ. 1)
 7517  0000000                   	PHP
 7518  0000000                   	SEI
 7519  0000000                   	LDY #CHANNEL
 7520  0000000                   	RESUME_PLAY_Y_EVO
 7521  0000000                   	PLP
 7522  0000000                   .ENDIF		
 7523  0000000                   	ENDM
 7524  0000000                   ;------------------------------------------------------------------------------
 7525  0000000                   	.IF (WITH_EVO .EQ. 1)
 7526  0000000                   	.IF (WITH_CH0_EVO .EQ. 1)
 7527  0000000                   RESUME_EVO1 MACRO
 7528  0000000                   	RESUME_PLAY_EVO_CHANNEL 00H
 7529  0000000                   ENDM
 7530  0000000                   	.ENDIF
 7531  0000000                   	.ENDIF
 7532  0000000                   ;------------------------------------------------------------------------------
 7533  0000000                   	.IF (WITH_EVO .EQ. 1)
 7534  0000000                   	.IF (WITH_CH1_EVO .EQ. 1)
 7535  0000000                   RESUME_EVO2 MACRO
 7536  0000000                   	RESUME_PLAY_EVO_CHANNEL 01H
 7537  0000000                   ENDM
 7538  0000000                   	.ENDIF
 7539  0000000                   	.ENDIF
 7540  0000000                   ;------------------------------------------------------------------------------
 7541  0000000                   	.IF (WITH_EVO .EQ. 1)
 7542  0000000                   	.IF (WITH_CH2_EVO .EQ. 1)
 7543  0000000                   RESUME_EVO3 MACRO
 7544  0000000                   	RESUME_PLAY_EVO_CHANNEL 02H
 7545  0000000                   ENDM
 7546  0000000                   	.ENDIF
 7547  0000000                   	.ENDIF
 7548  0000000                   ;==============================================================================
 7549  0000000                   RESUME_PLAY_ALL_CHANNEL MACRO
 7550  0000000                   		RESUME_PLAY_ALL_EVO
 7551  0000000                   		EXTERN RESUME_PLAY_ALL_MS_API
 7552  0000000                   		JSR RESUME_PLAY_ALL_MS_API
 7553  0000000                   		RESUME_PLAY_ALL_SP
 7554  0000000                   ENDM
 7555  0000000                   ;------------------------------------------------------------------------------
 7556  0000000                   RESUME_ALL MACRO
 7557  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 7558  0000000                   .ELSE
 7559  0000000                   	PHP
 7560  0000000                   	SEI
 7561  0000000                   	RESUME_PLAY_ALL_CHANNEL
 7562  0000000                   	PLP
 7563  0000000                   .ENDIF
 7564  0000000                   ENDM
 7565  0000000                   .ENDIF ;(WITH_PAUSE_RESUME .EQ. 1H)
 7566  0000000                   ;==============================================================================
 7567  0000000                   ; Set TMV of specified speech channel.
 7568  0000000                   ;==============================================================================
 7569  0000000                   SET_SP_SAMPLE_RATE_Y MACRO NEW_TMV
 7570  0000000                   	.IF (WITH_SP .EQ. 1H)	





 7571  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 7572  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 7573  0000000                   		PSF_RESPONSE_LIMIT
 7574  0000000                   		LDA #NEW_TMV
 7575  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 7576  0000000                   		PHP
 7577  0000000                   		SEI
 7578  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 7579  0000000                   		PLP
 7580  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 7581  0000000                   	.ENDIF
 7582  0000000                   	ENDM
 7583  0000000                   ;------------------------------------------------------------------------------
 7584  0000000                   SET_SP_SAMPLE_RATE MACRO NEW_TMV,CHANNEL_ID
 7585  0000000                   	.IF (WITH_SP .EQ. 1H)
 7586  0000000                   		LDY #CHANNEL_ID
 7587  0000000                   		SET_SP_SAMPLE_RATE_Y NEW_TMV
 7588  0000000                   	.ENDIF
 7589  0000000                   	ENDM
 7590  0000000                   ;------------------------------------------------------------------------------
 7591  0000000                   .IF (WITH_SP .EQ. 1)
 7592  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7593  0000000                   SET_SR1 MACRO NEW_TMV
 7594  0000000                   	SET_SP_SAMPLE_RATE NEW_TMV, 00H 
 7595  0000000                   ENDM		
 7596  0000000                   	.ENDIF
 7597  0000000                   ;------------------------------------------------------------------------------
 7598  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7599  0000000                   SET_SR2 MACRO NEW_TMV
 7600  0000000                   	SET_SP_SAMPLE_RATE NEW_TMV, 01H
 7601  0000000                   ENDM		
 7602  0000000                   	.ENDIF
 7603  0000000                   ;------------------------------------------------------------------------------
 7604  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7605  0000000                   SET_SR3 MACRO NEW_TMV
 7606  0000000                   	SET_SP_SAMPLE_RATE NEW_TMV, 02H
 7607  0000000                   ENDM
 7608  0000000                   	.ENDIF	
 7609  0000000                   .ENDIF	
 7610  0000000                   ;==============================================================================
 7611  0000000                   SET_SP_SAMPLE_RATE_Y_BY_RAM MACRO NEW_TMV_RAM
 7612  0000000                   	.IF (WITH_SP .EQ. 1H)
 7613  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 7614  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 7615  0000000                   		PSF_RESPONSE_LIMIT
 7616  0000000                   		LDA !NEW_TMV_RAM
 7617  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 7618  0000000                   		PHP
 7619  0000000                   		SEI
 7620  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 7621  0000000                   		PLP
 7622  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 7623  0000000                   	.ENDIF
 7624  0000000                   	ENDM
 7625  0000000                   ;------------------------------------------------------------------------------
 7626  0000000                   SET_SP_SAMPLE_RATE_BY_RAM MACRO NEW_TMV_RAM,CHANNEL_ID
 7627  0000000                   	.IF (WITH_SP .EQ. 1H)





 7628  0000000                   		LDY #CHANNEL_ID
 7629  0000000                   		SET_SP_SAMPLE_RATE_Y_BY_RAM NEW_TMV_RAM
 7630  0000000                   	.ENDIF
 7631  0000000                   	ENDM
 7632  0000000                   ;------------------------------------------------------------------------------
 7633  0000000                   .IF (WITH_SP .EQ. 1)
 7634  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7635  0000000                   SET_SR1_RAM MACRO NEW_TMV_RAM
 7636  0000000                   	SET_SP_SAMPLE_RATE_BY_RAM NEW_TMV_RAM, 00H
 7637  0000000                   ENDM		
 7638  0000000                   	.ENDIF
 7639  0000000                   ;------------------------------------------------------------------------------
 7640  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7641  0000000                   SET_SR2_RAM MACRO NEW_TMV_RAM
 7642  0000000                   	SET_SP_SAMPLE_RATE_BY_RAM NEW_TMV_RAM, 01H
 7643  0000000                   ENDM		
 7644  0000000                   	.ENDIF
 7645  0000000                   ;------------------------------------------------------------------------------
 7646  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7647  0000000                   SET_SR3_RAM MACRO NEW_TMV_RAM
 7648  0000000                   	SET_SP_SAMPLE_RATE_BY_RAM NEW_TMV_RAM, 02H
 7649  0000000                   ENDM		
 7650  0000000                   	.ENDIF
 7651  0000000                   .ENDIF
 7652  0000000                   ;==============================================================================
 7653  0000000                   ; Set delta-time decrease amount.             
 7654  0000000                   ; There are 2 parameters, amount and it's fraction.
 7655  0000000                   ;==============================================================================
 7656  0000000                   SET_TEMPO MACRO DT_DEC_AMOUNT,DT_DEC_FRACTION
 7657  0000000                   	.IF (WITH_MS .EQ. 1H)	              
 7658  0000000                   	.IF (WITH_CHANGE_TEMPO .EQ. 1)        
 7659  0000000                   		LDA #DT_DEC_AMOUNT            
 7660  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_MS
 7661  0000000                   		LDA #DT_DEC_FRACTION          
 7662  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_FRACTION_MS
 7663  0000000                   	.ENDIF                                
 7664  0000000                   	.ENDIF                                
 7665  0000000                   	ENDM                                 
 7666  0000000                   ;==============================================================================
 7667  0000000                   ; DT_DEC_AMOUNT_RAM : xxxxx111:integer  11111xxx:fraction
 7668  0000000                   ;==============================================================================
 7669  0000000                   SET_TEMPO_RAM MACRO DT_DEC_AMOUNT_RAM
 7670  0000000                   	.IF (WITH_MS .EQ. 1H)	              
 7671  0000000                   	.IF (WITH_CHANGE_TEMPO .EQ. 1)        
 7672  0000000                   		LDA !DT_DEC_AMOUNT_RAM        
 7673  0000000                   		AND #0000111b						
 7674  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_MS
 7675  0000000                   ; FRACTION
 7676  0000000                   		LDA !DT_DEC_AMOUNT_RAM
 7677  0000000                   		AND #11111000b			
 7678  0000000                   		STA <MS_START+CH_DT_DEC_AMOUNT_FRACTION_MS
 7679  0000000                   	.ENDIF
 7680  0000000                   	.ENDIF
 7681  0000000                   	ENDM	
 7682  0000000                   ;===============================================================================
 7683  0000000                   ; SET SPEECH VOLUME by Y Channel
 7684  0000000                   ;===============================================================================





 7685  0000000                   SET_LP8_VOLUME_Y MACRO VOLUME_VALUE
 7686  0000000                   	.IF (WITH_LP8 .EQ. 1H)
 7687  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7688  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7689  0000000                   		LDA 0,X
 7690  0000000                   		AND #GLOBAL_VOL_FLAG
 7691  0000000                   		ORA #VOLUME_VALUE
 7692  0000000                   		STA 0,X
 7693  0000000                   
 7694  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7695  0000000                   		LDA <CH_STATUS_SP,X
 7696  0000000                   		BIT #SP_BZ 
 7697  0000000                   		BEQ SET_LP8_VOLUME_Y_END_#
 7698  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7699  0000000                   		BNE SET_LP8_VOLUME_Y_END_#
 7700  0000000                   
 7701  0000000                   		LDA #VOLUME_VALUE
 7702  0000000                   		ASL A
 7703  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7704  0000000                   
 7705  0000000                   SET_LP8_VOLUME_Y_END_#:
 7706  0000000                   		SET_LP8_VOL_MUL_8X3_SP_ADDR _SP
 7707  0000000                   	.ENDIF
 7708  0000000                   	.ENDIF
 7709  0000000                   ENDM
 7710  0000000                   ;------------------------------------------------------------------------------
 7711  0000000                   ;update by angela for en/dis GLOBALVOL feature
 7712  0000000                   SET_SP_VOLUME_DELAY MACRO
 7713  0000000                   	LDY #FFH
 7714  0000000                   LOOP_#:
 7715  0000000                   	.IFDEF WDTIMER
 7716  0000000                   	.IFDEF LVDEN
 7717  0000000                   		LDA #CTL_CPU_WDT
 7718  0000000                   		TSB RAM_CTL_CPU
 7719  0000000                   		LDA RAM_CTL_CPU
 7720  0000000                   		STA !CTL_CPU
 7721  0000000                   	.ELSE
 7722  0000000                   		LDA #CTL_CPU_WDT
 7723  0000000                   		TSB !CTL_CPU
 7724  0000000                   	.ENDIF 	
 7725  0000000                   	.ENDIF
 7726  0000000                   	NOP
 7727  0000000                   	NOP
 7728  0000000                   	NOP
 7729  0000000                   	NOP
 7730  0000000                   	NOP
 7731  0000000                   	NOP
 7732  0000000                   	NOP
 7733  0000000                   	NOP
 7734  0000000                   	NOP
 7735  0000000                   	NOP
 7736  0000000                   	NOP
 7737  0000000                   	NOP
 7738  0000000                   	NOP
 7739  0000000                   	NOP
 7740  0000000                   	NOP
 7741  0000000                   	NOP





 7742  0000000                   	NOP
 7743  0000000                   	NOP
 7744  0000000                   	NOP
 7745  0000000                   	NOP
 7746  0000000                   	DEY
 7747  0000000                   	BNE LOOP_#
 7748  0000000                   ENDM
 7749  0000000                   ;------------------------------------------------------------------------------
 7750  0000000                   	EXTERN SP_GLOBAL_VOLUME_TABLE
 7751  0000000                   SET_SP_VOLUME_Y  MACRO VOLUME_VALUE	
 7752  0000000                   	.IF (WITH_SP .EQ. 1H)
 7753  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7754  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7755  0000000                   		LDA 0,X
 7756  0000000                   		AND #GLOBAL_VOL_FLAG
 7757  0000000                   		ORA #VOLUME_VALUE
 7758  0000000                   		STA 0,X
 7759  0000000                   
 7760  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y	
 7761  0000000                   		LDA <CH_STATUS_SP,X
 7762  0000000                   		BIT #SP_BZ 
 7763  0000000                   		BEQ SET_SP_VOLUME_Y_END_#
 7764  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7765  0000000                   		BNE SET_SP_VOLUME_Y_END_#
 7766  0000000                   
 7767  0000000                   COMPARE_VOLUME#:		
 7768  0000000                   		LDA <CH_R_FINAL_VOLUME_SP,X
 7769  0000000                   		LSR A
 7770  0000000                   		AND #FH
 7771  0000000                   		CMP #VOLUME_VALUE
 7772  0000000                   		BEQ SET_SP_VOLUME_Y_END_#
 7773  0000000                   		BCC INCREASE_#
 7774  0000000                   DECREASE_#:
 7775  0000000                   		SEC
 7776  0000000                   		SBC #1H
 7777  0000000                   		JMP SET_SP_VOLUME_Y_CONTINUE#
 7778  0000000                   INCREASE_#:
 7779  0000000                   		CLC 
 7780  0000000                   		ADC #1H
 7781  0000000                   SET_SP_VOLUME_Y_CONTINUE#:
 7782  0000000                   		ASL A
 7783  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7784  0000000                   		SET_SP_VOLUME_DELAY
 7785  0000000                   		JMP COMPARE_VOLUME#
 7786  0000000                   SET_SP_VOLUME_Y_END_#:
 7787  0000000                   	.ENDIF
 7788  0000000                   	.ENDIF
 7789  0000000                   ENDM
 7790  0000000                   ;------------------------------------------------------------------------------
 7791  0000000                   SET_SP_VOLUME MACRO VOLUME_VALUE,CHANNEL_ID
 7792  0000000                   	.IF (WITH_SP .EQ. 1H)
 7793  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7794  0000000                   		LDY #CHANNEL_ID
 7795  0000000                   		SET_SP_VOLUME_Y VOLUME_VALUE
 7796  0000000                   	.ENDIF
 7797  0000000                   	.ENDIF
 7798  0000000                   ENDM





 7799  0000000                   ;------------------------------------------------------------------------------
 7800  0000000                   .IF (WITH_SP .EQ. 1)
 7801  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7802  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7803  0000000                   SET_VOL1 MACRO NEW_VOL
 7804  0000000                   	SET_SP_VOLUME NEW_VOL, 00H
 7805  0000000                   ENDM		
 7806  0000000                   	.ENDIF
 7807  0000000                   ;------------------------------------------------------------------------------
 7808  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7809  0000000                   SET_VOL2 MACRO NEW_VOL
 7810  0000000                   	SET_SP_VOLUME NEW_VOL, 01H
 7811  0000000                   ENDM			
 7812  0000000                   	.ENDIF
 7813  0000000                   ;------------------------------------------------------------------------------
 7814  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7815  0000000                   SET_VOL3 MACRO NEW_VOL
 7816  0000000                   	SET_SP_VOLUME  NEW_VOL, 02H
 7817  0000000                   ENDM			
 7818  0000000                   	.ENDIF
 7819  0000000                   .ENDIF	
 7820  0000000                   .ENDIF
 7821  0000000                   ;------------------------------------------------------------------------------
 7822  0000000                   .IF (WITH_SP .EQ. 1)
 7823  0000000                   .IF (WITH_LP8 .EQ. 1H)
 7824  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7825  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7826  0000000                   SET_VOL1_LP8 MACRO NEW_VOL
 7827  0000000                   	LDY #00H
 7828  0000000                   	SET_LP8_VOLUME_Y NEW_VOL
 7829  0000000                   ENDM		
 7830  0000000                   	.ENDIF
 7831  0000000                   ;------------------------------------------------------------------------------
 7832  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7833  0000000                   SET_VOL2_LP8 MACRO NEW_VOL
 7834  0000000                   	LDY #01H
 7835  0000000                   	SET_LP8_VOLUME_Y NEW_VOL
 7836  0000000                   ENDM			
 7837  0000000                   	.ENDIF
 7838  0000000                   ;------------------------------------------------------------------------------
 7839  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7840  0000000                   SET_VOL3_LP8 MACRO NEW_VOL
 7841  0000000                   	LDY #02H
 7842  0000000                   	SET_LP8_VOLUME_Y NEW_VOL
 7843  0000000                   ENDM			
 7844  0000000                   	.ENDIF
 7845  0000000                   .ENDIF	
 7846  0000000                   .ENDIF
 7847  0000000                   .ENDIF
 7848  0000000                   ;===============================================================================
 7849  0000000                   SET_LP8_VOLUME_Y_BY_RAM MACRO VOLUME_RAM
 7850  0000000                   	.IF (WITH_LP8 .EQ. 1H)
 7851  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7852  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7853  0000000                   		LDA 0,X
 7854  0000000                   		AND #GLOBAL_VOL_FLAG
 7855  0000000                   		ORA VOLUME_RAM





 7856  0000000                   		STA 0,X
 7857  0000000                   
 7858  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7859  0000000                   		LDA <CH_STATUS_SP,X
 7860  0000000                   		BIT #SP_BZ 
 7861  0000000                   		BEQ SET_LP8_VOLUME_Y_BY_RAM_END_#
 7862  0000000                   		BIT #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7863  0000000                   		BNE SET_LP8_VOLUME_Y_BY_RAM_END_#
 7864  0000000                   
 7865  0000000                   		LDA VOLUME_RAM
 7866  0000000                   		ASL A
 7867  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7868  0000000                   
 7869  0000000                   SET_LP8_VOLUME_Y_BY_RAM_END_#:
 7870  0000000                   		SET_LP8_VOL_MUL_8X3_SP_ADDR _SP
 7871  0000000                   	.ENDIF
 7872  0000000                   	.ENDIF
 7873  0000000                   ENDM
 7874  0000000                   ;------------------------------------------------------------------------------
 7875  0000000                   SET_SP_VOLUME_Y_BY_RAM MACRO VOLUME_RAM	
 7876  0000000                   	.IF (WITH_SP .EQ. 1H)
 7877  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7878  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7879  0000000                   		LDA 0,X
 7880  0000000                   		AND #GLOBAL_VOL_FLAG
 7881  0000000                   		ORA !VOLUME_RAM
 7882  0000000                   		STA 0,X
 7883  0000000                   
 7884  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7885  0000000                   		LDA <CH_STATUS_SP,X
 7886  0000000                   		BIT #SP_BZ 
 7887  0000000                   		BEQ SET_SP_VOLUME_Y_BY_RAM_END_#	
 7888  0000000                   		BIT  #(SP_ADSR+SP_DC_RAMP_UP_FOR_MS+SP_DC_RAMP_DOWN)
 7889  0000000                   		BNE SET_SP_VOLUME_Y_BY_RAM_END_#
 7890  0000000                   
 7891  0000000                   COMPARE_VOLUME_RAM#:		
 7892  0000000                   		LDA <CH_R_FINAL_VOLUME_SP,X
 7893  0000000                   		LSR A
 7894  0000000                   		AND #FH
 7895  0000000                   		CMP !VOLUME_RAM
 7896  0000000                   		BEQ SET_SP_VOLUME_Y_BY_RAM_END_#
 7897  0000000                   		BCC INCREASE_RAM#
 7898  0000000                   DECREASE_RAM#:
 7899  0000000                   		SEC
 7900  0000000                   		SBC #1H
 7901  0000000                   		JMP SET_SP_VOLUME_Y_BY_RAM_CONTINUE#
 7902  0000000                   INCREASE_RAM#:
 7903  0000000                   		CLC 
 7904  0000000                   		ADC #1H
 7905  0000000                   SET_SP_VOLUME_Y_BY_RAM_CONTINUE#:
 7906  0000000                   		ASL A
 7907  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7908  0000000                   		SET_SP_VOLUME_DELAY
 7909  0000000                   		JMP COMPARE_VOLUME_RAM#
 7910  0000000                   SET_SP_VOLUME_Y_BY_RAM_END_#:
 7911  0000000                   	.ENDIF
 7912  0000000                   	.ENDIF





 7913  0000000                   ENDM	
 7914  0000000                   ;------------------------------------------------------------------------------
 7915  0000000                   SET_SP_VOLUME_BY_RAM MACRO VOLUME_RAM, CHANNEL_ID
 7916  0000000                   	.IF (WITH_SP .EQ. 1H)
 7917  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7918  0000000                   		LDY #CHANNEL_ID
 7919  0000000                   		SET_SP_VOLUME_Y_BY_RAM VOLUME_RAM
 7920  0000000                   	.ENDIF
 7921  0000000                   	.ENDIF
 7922  0000000                   ENDM	
 7923  0000000                   ;------------------------------------------------------------------------------
 7924  0000000                   .IF (WITH_SP .EQ. 1)
 7925  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7926  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7927  0000000                   SET_VOL1_RAM MACRO NEW_VOL_RAM
 7928  0000000                   	SET_SP_VOLUME_BY_RAM NEW_VOL_RAM, 00H
 7929  0000000                   ENDM			
 7930  0000000                   	.ENDIF
 7931  0000000                   ;------------------------------------------------------------------------------
 7932  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7933  0000000                   SET_VOL2_RAM MACRO NEW_VOL_RAM
 7934  0000000                   	SET_SP_VOLUME_BY_RAM NEW_VOL_RAM, 01H
 7935  0000000                   ENDM
 7936  0000000                   	.ENDIF
 7937  0000000                   ;------------------------------------------------------------------------------
 7938  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7939  0000000                   SET_VOL3_RAM MACRO NEW_VOL_RAM
 7940  0000000                   	SET_SP_VOLUME_BY_RAM  NEW_VOL_RAM, 02H
 7941  0000000                   ENDM			
 7942  0000000                   	.ENDIF
 7943  0000000                   .ENDIF
 7944  0000000                   .ENDIF	
 7945  0000000                   ;------------------------------------------------------------------------------
 7946  0000000                   .IF (WITH_SP .EQ. 1)
 7947  0000000                   .IF (WITH_LP8 .EQ. 1H)
 7948  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 7949  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 7950  0000000                   SET_VOL1_RAM_LP8 MACRO NEW_VOL_RAM
 7951  0000000                   	LDY #00H
 7952  0000000                   	SET_LP8_VOLUME_Y_BY_RAM NEW_VOL_RAM
 7953  0000000                   ENDM			
 7954  0000000                   	.ENDIF
 7955  0000000                   ;------------------------------------------------------------------------------
 7956  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 7957  0000000                   SET_VOL2_RAM_LP8 MACRO NEW_VOL_RAM
 7958  0000000                   	LDY #01H
 7959  0000000                   	SET_LP8_VOLUME_Y_BY_RAM NEW_VOL_RAM
 7960  0000000                   ENDM
 7961  0000000                   	.ENDIF
 7962  0000000                   ;------------------------------------------------------------------------------
 7963  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 7964  0000000                   SET_VOL3_RAM_LP8 MACRO NEW_VOL_RAM
 7965  0000000                   	LDY #02H
 7966  0000000                   	SET_LP8_VOLUME_Y_BY_RAM  NEW_VOL_RAM
 7967  0000000                   ENDM			
 7968  0000000                   	.ENDIF
 7969  0000000                   .ENDIF





 7970  0000000                   .ENDIF	
 7971  0000000                   .ENDIF
 7972  0000000                   ;==============================================================================
 7973  0000000                   	EXTERN SP_GLOBAL_VOLUME_TABLE
 7974  0000000                   SET_SP_VOLUME_Y_RT  MACRO VOLUME_VALUE	
 7975  0000000                   	.IF (WITH_SP .EQ. 1H)
 7976  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 7977  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 7978  0000000                   		LDA 0,X
 7979  0000000                   		AND #GLOBAL_VOL_FLAG
 7980  0000000                   		ORA #VOLUME_VALUE
 7981  0000000                   		STA 0,X
 7982  0000000                   
 7983  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 7984  0000000                   		LDA <CH_STATUS_SP,X
 7985  0000000                   		BIT #SP_BZ 
 7986  0000000                   		BEQ SET_SP_VOLUME_Y_RT_END_#
 7987  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 7988  0000000                   		BNE SET_SP_VOLUME_Y_RT_END_#
 7989  0000000                   
 7990  0000000                   		LDA #VOLUME_VALUE
 7991  0000000                   		ASL A
 7992  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 7993  0000000                   SET_SP_VOLUME_Y_RT_END_#:
 7994  0000000                   	.ENDIF
 7995  0000000                   	.ENDIF
 7996  0000000                   ENDM
 7997  0000000                   ;------------------------------------------------------------------------------
 7998  0000000                   SET_SP_VOLUME_RT MACRO VOLUME_VALUE,CHANNEL_ID
 7999  0000000                   	.IF (WITH_SP .EQ. 1H)
 8000  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 8001  0000000                   		LDY #CHANNEL_ID
 8002  0000000                   		SET_SP_VOLUME_Y_RT VOLUME_VALUE
 8003  0000000                   	.ENDIF
 8004  0000000                   	.ENDIF
 8005  0000000                   ENDM
 8006  0000000                   ;------------------------------------------------------------------------------
 8007  0000000                   .IF (WITH_SP .EQ. 1)
 8008  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8009  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8010  0000000                   SET_VOL1_RT MACRO NEW_VOL
 8011  0000000                   	SET_SP_VOLUME_RT NEW_VOL, 00H
 8012  0000000                   ENDM		
 8013  0000000                   	.ENDIF
 8014  0000000                   ;------------------------------------------------------------------------------
 8015  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8016  0000000                   SET_VOL2_RT MACRO NEW_VOL
 8017  0000000                   	SET_SP_VOLUME_RT NEW_VOL, 01H
 8018  0000000                   ENDM			
 8019  0000000                   	.ENDIF
 8020  0000000                   ;------------------------------------------------------------------------------
 8021  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8022  0000000                   SET_VOL3_RT MACRO NEW_VOL
 8023  0000000                   	SET_SP_VOLUME_RT  NEW_VOL, 02H
 8024  0000000                   ENDM			
 8025  0000000                   	.ENDIF
 8026  0000000                   .ENDIF	





 8027  0000000                   .ENDIF
 8028  0000000                   ;------------------------------------------------------------------------------
 8029  0000000                   SET_SP_VOLUME_Y_BY_RAM_RT MACRO VOLUME_RAM	
 8030  0000000                   	.IF (WITH_SP .EQ. 1H)
 8031  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 8032  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 8033  0000000                   		LDA 0,X
 8034  0000000                   		AND #GLOBAL_VOL_FLAG
 8035  0000000                   		ORA !VOLUME_RAM
 8036  0000000                   		STA 0,X
 8037  0000000                   
 8038  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8039  0000000                   		LDA <CH_STATUS_SP,X
 8040  0000000                   		BIT #SP_BZ 
 8041  0000000                   		BEQ SET_SP_VOLUME_Y_BY_RAM_RT_END_#
 8042  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8043  0000000                   		BNE SET_SP_VOLUME_Y_BY_RAM_RT_END_#
 8044  0000000                   
 8045  0000000                   		LDA VOLUME_RAM
 8046  0000000                   		ASL A
 8047  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8048  0000000                   
 8049  0000000                   SET_SP_VOLUME_Y_BY_RAM_RT_END_#:
 8050  0000000                   	.ENDIF
 8051  0000000                   	.ENDIF
 8052  0000000                   ENDM	
 8053  0000000                   ;------------------------------------------------------------------------------
 8054  0000000                   SET_SP_VOLUME_BY_RAM_RT MACRO VOLUME_RAM, CHANNEL_ID
 8055  0000000                   	.IF (WITH_SP .EQ. 1H)
 8056  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1)
 8057  0000000                   		LDY #CHANNEL_ID
 8058  0000000                   		SET_SP_VOLUME_Y_BY_RAM_RT VOLUME_RAM
 8059  0000000                   	.ENDIF
 8060  0000000                   	.ENDIF
 8061  0000000                   ENDM	
 8062  0000000                   ;------------------------------------------------------------------------------
 8063  0000000                   .IF (WITH_SP .EQ. 1)
 8064  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8065  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8066  0000000                   SET_VOL1_RAM_RT MACRO NEW_VOL_RAM
 8067  0000000                   	SET_SP_VOLUME_BY_RAM_RT NEW_VOL_RAM, 00H
 8068  0000000                   ENDM			
 8069  0000000                   	.ENDIF
 8070  0000000                   ;------------------------------------------------------------------------------
 8071  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8072  0000000                   SET_VOL2_RAM_RT MACRO NEW_VOL_RAM
 8073  0000000                   	SET_SP_VOLUME_BY_RAM_RT NEW_VOL_RAM, 01H
 8074  0000000                   ENDM
 8075  0000000                   	.ENDIF
 8076  0000000                   ;------------------------------------------------------------------------------
 8077  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8078  0000000                   SET_VOL3_RAM_RT MACRO NEW_VOL_RAM
 8079  0000000                   	SET_SP_VOLUME_BY_RAM_RT  NEW_VOL_RAM, 02H
 8080  0000000                   ENDM			
 8081  0000000                   	.ENDIF
 8082  0000000                   .ENDIF
 8083  0000000                   .ENDIF	





 8084  0000000                   ;==============================================================================
 8085  0000000                   ;==============================================================================
 8086  0000000                   DIS_SP_EQU_VOL_Y MACRO                                                         
 8087  0000000                   	.IF(WITH_SP .EQ. 1H)                                                   
 8088  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)                                              
 8089  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8090  0000000                   		LDA 0,X                                                        
 8091  0000000                   		ORA #GLOBAL_VOL_FLAG                                                      
 8092  0000000                   		STA 0,X                                                        
 8093  0000000                   
 8094  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8095  0000000                   		LDA <CH_STATUS_SP,X
 8096  0000000                   		BIT #SP_BZ 
 8097  0000000                   		BEQ DIS_SP_EQU_VOL_Y_END_#
 8098  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8099  0000000                   		BNE DIS_SP_EQU_VOL_Y_END_#
 8100  0000000                   
 8101  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8102  0000000                   		LDA 0,X                                                             
 8103  0000000                   		AND #7FH                                                       
 8104  0000000                   		ASL A                                                          
 8105  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y                                   
 8106  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8107  0000000                   DIS_SP_EQU_VOL_Y_END_#:                                    
 8108  0000000                   	.ENDIF                                                                 
 8109  0000000                   	.ENDIF                                                                 
 8110  0000000                   ENDM   
 8111  0000000                   ;------------------------------------------------------------------------------
 8112  0000000                   DIS_SP_EQU_VOL MACRO CHANNEL
 8113  0000000                   	.IF(WITH_SP .EQ. 1H)
 8114  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)    
 8115  0000000                   		LDY #CHANNEL
 8116  0000000                   		DIS_SP_EQU_VOL_Y 
 8117  0000000                   	.ENDIF
 8118  0000000                   	.ENDIF   
 8119  0000000                   ENDM
 8120  0000000                   ;------------------------------------------------------------------------------
 8121  0000000                   .IF (WITH_SP .EQ. 1)
 8122  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8123  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8124  0000000                   EN_GLOBALVOL_VOL1 MACRO
 8125  0000000                   	DIS_SP_EQU_VOL 00H
 8126  0000000                   ENDM
 8127  0000000                   	.ENDIF
 8128  0000000                   ;------------------------------------------------------------------------------
 8129  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8130  0000000                   EN_GLOBALVOL_VOL2 MACRO
 8131  0000000                   	DIS_SP_EQU_VOL 01H
 8132  0000000                   ENDM
 8133  0000000                   	.ENDIF
 8134  0000000                   ;------------------------------------------------------------------------------	
 8135  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8136  0000000                   EN_GLOBALVOL_VOL3 MACRO
 8137  0000000                   	DIS_SP_EQU_VOL 02H
 8138  0000000                   ENDM
 8139  0000000                   	.ENDIF
 8140  0000000                   .ENDIF





 8141  0000000                   .ENDIF		                                                                       
 8142  0000000                   ;==============================================================================
 8143  0000000                   EN_SP_EQU_VOL_Y MACRO                                                          
 8144  0000000                   	.IF(WITH_SP .EQ. 1H)                                                   
 8145  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)                                              
 8146  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8147  0000000                   		LDA 0,X                                                        
 8148  0000000                   		AND #7FH                                                       
 8149  0000000                   		STA 0,X                                                        
 8150  0000000                   	.ENDIF                                                                 
 8151  0000000                   	.ENDIF                                                                 
 8152  0000000                   ENDM	
 8153  0000000                   ;------------------------------------------------------------------------------	
 8154  0000000                   EN_SP_EQU_VOL MACRO CHANNEL
 8155  0000000                   	.IF(WITH_SP .EQ. 1H)
 8156  0000000                   	.IF(WITH_VOL_ADJ .EQ. 1H)
 8157  0000000                   		LDY #CHANNEL
 8158  0000000                   		EN_SP_EQU_VOL_Y
 8159  0000000                   	.ENDIF
 8160  0000000                   	.ENDIF 
 8161  0000000                   ENDM
 8162  0000000                   ;------------------------------------------------------------------------------	
 8163  0000000                   .IF (WITH_SP .EQ. 1)
 8164  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8165  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 8166  0000000                   DIS_GLOBALVOL_VOL1 MACRO
 8167  0000000                   	EN_SP_EQU_VOL 00H	
 8168  0000000                   ENDM
 8169  0000000                   	.ENDIF
 8170  0000000                   ;------------------------------------------------------------------------------
 8171  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 8172  0000000                   DIS_GLOBALVOL_VOL2 MACRO
 8173  0000000                   	EN_SP_EQU_VOL 01H
 8174  0000000                   ENDM
 8175  0000000                   	.ENDIF
 8176  0000000                   ;------------------------------------------------------------------------------
 8177  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 8178  0000000                   DIS_GLOBALVOL_VOL3 MACRO
 8179  0000000                   	EN_SP_EQU_VOL 02H
 8180  0000000                   ENDM
 8181  0000000                   	.ENDIF
 8182  0000000                   .ENDIF
 8183  0000000                   .ENDIF                                                                                                                                                                                                                                                                                                                                                     
 8184  0000000                   ;update by angela for en/dis GLOBALVOL feature
 8185  0000000                   ;===============================================================================
 8186  0000000                   ;===============================================================================
 8187  0000000                   SET_VOLM MACRO NEW_MS_VOL
 8188  0000000                   	.IF (WITH_MS .EQ. 1H)
 8189  0000000                   	.IF (WITH_VOL_ADJ_MS .EQ. 1H)
 8190  0000000                   		LDA <GLOBAL_MASTER_VOL_MS
 8191  0000000                   		AND #GLOBAL_VOL_MS_FLAG
 8192  0000000                   		ORA #NEW_MS_VOL
 8193  0000000                   		STA <GLOBAL_MASTER_VOL_MS
 8194  0000000                   	.ENDIF
 8195  0000000                   	.ENDIF
 8196  0000000                   	ENDM
 8197  0000000                   ;------------------------------------------------------------------------------





 8198  0000000                   SET_VOLM_RAM MACRO VOL_RAM
 8199  0000000                   	.IF (WITH_MS .EQ. 1H)
 8200  0000000                   	.IF (WITH_VOL_ADJ_MS .EQ. 1H)
 8201  0000000                   		LDA <GLOBAL_MASTER_VOL_MS
 8202  0000000                   		AND #GLOBAL_VOL_MS_FLAG
 8203  0000000                   		ORA !VOL_RAM
 8204  0000000                   		STA <GLOBAL_MASTER_VOL_MS
 8205  0000000                   	.ENDIF
 8206  0000000                   	.ENDIF
 8207  0000000                   	ENDM
 8208  0000000                   ;===============================================================================
 8209  0000000                   ;===============================================================================	
 8210  0000000                   EN_GLOBALVOL_VOLM MACRO
 8211  0000000                   	.IF(WITH_MS .EQ. 1H)
 8212  0000000                   	.IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8213  0000000                   		LDA #GLOBAL_VOL_MS_FLAG
 8214  0000000                   		TSB <GLOBAL_MASTER_VOL_MS
 8215  0000000                   	.ENDIF
 8216  0000000                   	.ENDIF	
 8217  0000000                   	ENDM
 8218  0000000                   ;------------------------------------------------------------------------------	
 8219  0000000                   DIS_GLOBALVOL_VOLM MACRO
 8220  0000000                   	.IF(WITH_MS .EQ. 1H)
 8221  0000000                   	.IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8222  0000000                   		LDA #GLOBAL_VOL_MS_FLAG
 8223  0000000                   		TRB <GLOBAL_MASTER_VOL_MS
 8224  0000000                   	.ENDIF
 8225  0000000                   	.ENDIF	
 8226  0000000                   	ENDM
 8227  0000000                   ;===============================================================================
 8228  0000000                   ;===============================================================================
 8229  0000000                   SET_VOL_ALL MACRO NEW_VOL
 8230  0000000                   .IF (WITH_SP .EQ. 1)
 8231  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8232  0000000                   		LDY #FFh
 8233  0000000                   SET_VOL_ALL_SP_NEXT#:
 8234  0000000                   		INY	
 8235  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8236  0000000                   		BEQ SET_VOL_ALL_SP_END#
 8237  0000000                   
 8238  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 8239  0000000                   		LDA 0,X
 8240  0000000                   		AND #GLOBAL_VOL_FLAG
 8241  0000000                   		ORA #NEW_VOL
 8242  0000000                   		STA 0,X
 8243  0000000                   
 8244  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8245  0000000                   		LDA <CH_STATUS_SP,X
 8246  0000000                   		BIT #SP_BZ 
 8247  0000000                   		BEQ SET_VOL_ALL_SP_NEXT#
 8248  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8249  0000000                   		BNE SET_VOL_ALL_SP_NEXT#
 8250  0000000                   
 8251  0000000                   		LDA #NEW_VOL
 8252  0000000                   		ASL A
 8253  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8254  0000000                   		BRA SET_VOL_ALL_SP_NEXT#





 8255  0000000                   
 8256  0000000                   SET_VOL_ALL_SP_END#:
 8257  0000000                   .ENDIF
 8258  0000000                   .ENDIF
 8259  0000000                   
 8260  0000000                   .IF(WITH_MS .EQ. 1H)
 8261  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8262  0000000                   	SET_VOLM NEW_VOL
 8263  0000000                   .ENDIF
 8264  0000000                   .ENDIF
 8265  0000000                   ENDM
 8266  0000000                   ;------------------------------------------------------------------------------
 8267  0000000                   SET_VOL_ALL_RAM MACRO VOLUME_RAM
 8268  0000000                   .IF (WITH_SP .EQ. 1)
 8269  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8270  0000000                   		LDY #FFh
 8271  0000000                   SET_VOL_ALL_RAM_SP_NEXT#:
 8272  0000000                   		INY	
 8273  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8274  0000000                   		BEQ SET_VOL_ALL_RAM_SP_END#
 8275  0000000                   
 8276  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y
 8277  0000000                   		LDA 0,X
 8278  0000000                   		AND #GLOBAL_VOL_FLAG
 8279  0000000                   		ORA !VOLUME_RAM
 8280  0000000                   		STA 0,X
 8281  0000000                   
 8282  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8283  0000000                   		LDA <CH_STATUS_SP,X
 8284  0000000                   		BIT #SP_BZ 
 8285  0000000                   		BEQ SET_VOL_ALL_RAM_SP_NEXT#
 8286  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8287  0000000                   		BNE SET_VOL_ALL_RAM_SP_NEXT#
 8288  0000000                   
 8289  0000000                   		LDA !VOLUME_RAM
 8290  0000000                   		ASL A
 8291  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8292  0000000                   		BRA SET_VOL_ALL_RAM_SP_NEXT#	
 8293  0000000                   
 8294  0000000                   SET_VOL_ALL_RAM_SP_END#:
 8295  0000000                   .ENDIF
 8296  0000000                   .ENDIF
 8297  0000000                   
 8298  0000000                   .IF(WITH_MS .EQ. 1H)
 8299  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8300  0000000                   	SET_VOLM_RAM VOLUME_RAM
 8301  0000000                   .ENDIF
 8302  0000000                   .ENDIF
 8303  0000000                   ENDM
 8304  0000000                   ;------------------------------------------------------------------------------
 8305  0000000                   EN_GLOBALVOL_VOL_ALL MACRO
 8306  0000000                   .IF (WITH_SP .EQ. 1)
 8307  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8308  0000000                   		LDY #FFh
 8309  0000000                   EN_GLOBALVOL_VOL_ALL_SP_NEXT#:
 8310  0000000                   		INY	
 8311  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y





 8312  0000000                   		BEQ EN_GLOBALVOL_VOL_ALL_SP_END#
 8313  0000000                   
 8314  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8315  0000000                   		LDA 0,X                                                        
 8316  0000000                   		ORA #GLOBAL_VOL_FLAG                                                      
 8317  0000000                   		STA 0,X                                         
 8318  0000000                   
 8319  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8320  0000000                   		LDA <CH_STATUS_SP,X
 8321  0000000                   		BIT #SP_BZ 
 8322  0000000                   		BEQ EN_GLOBALVOL_VOL_ALL_SP_NEXT#
 8323  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR+SP_DC_RAMP_DOWN)
 8324  0000000                   		BNE EN_GLOBALVOL_VOL_ALL_SP_NEXT#
 8325  0000000                   
 8326  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8327  0000000                   		LDA 0,X                                                             
 8328  0000000                   		AND #7FH                                                       
 8329  0000000                   		ASL A                                                          
 8330  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y                                   
 8331  0000000                   		STA <CH_R_FINAL_VOLUME_SP,X
 8332  0000000                   EN_GLOBALVOL_VOL_ALL_SP_END#:                        
 8333  0000000                   .ENDIF
 8334  0000000                   .ENDIF
 8335  0000000                   
 8336  0000000                   .IF(WITH_MS .EQ. 1H)
 8337  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8338  0000000                   	EN_GLOBALVOL_VOLM
 8339  0000000                   .ENDIF
 8340  0000000                   .ENDIF
 8341  0000000                   ENDM
 8342  0000000                   ;------------------------------------------------------------------------------
 8343  0000000                   DIS_GLOBALVOL_VOL_ALL MACRO
 8344  0000000                   .IF (WITH_SP .EQ. 1)
 8345  0000000                   .IF (WITH_VOL_ADJ .EQ. 1)
 8346  0000000                   	LDY #FFh
 8347  0000000                   DIS_GLOBALVOL_VOL_ALL_SP_NEXT#:
 8348  0000000                   		INY	
 8349  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 8350  0000000                   		BEQ DIS_GLOBALVOL_VOL_ALL_SP_END#
 8351  0000000                   
 8352  0000000                   		LDX !SP_GLOBAL_VOLUME_TABLE,Y                                  
 8353  0000000                   		LDA 0,X                                                        
 8354  0000000                   		AND #7FH                                                       
 8355  0000000                   		STA 0,X  
 8356  0000000                   DIS_GLOBALVOL_VOL_ALL_SP_END#:     
 8357  0000000                   .ENDIF
 8358  0000000                   .ENDIF
 8359  0000000                   
 8360  0000000                   .IF(WITH_MS .EQ. 1H)
 8361  0000000                   .IF(WITH_VOL_ADJ_MS .EQ. 1H)
 8362  0000000                   	DIS_GLOBALVOL_VOLM
 8363  0000000                   .ENDIF
 8364  0000000                   .ENDIF
 8365  0000000                   ENDM
 8366  0000000                   ;===============================================================================
 8367  0000000                   ;===============================================================================
 8368  0000000                   SET_MS_CHANNEL_VOLUME MACRO VOLUME_VALUE, CHANNEL





 8369  0000000                   	.IF (WITH_MS .EQ. 1H)
 8370  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8371  0000000                   		LDX #CHANNEL
 8372  0000000                   		EXTERN MS_CHANNEL_TABLE
 8373  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8374  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME#
 8375  0000000                   
 8376  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8377  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8378  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8379  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8380  0000000                   			AND #80H
 8381  0000000                   			ORA #VOLUME_VALUE
 8382  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8383  0000000                   		.ENDIF
 8384  0000000                   
 8385  0000000                   		LDA <GLOBAL_PLAY
 8386  0000000                   		BIT #MIDI_BZ+MS_EXT
 8387  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME#
 8388  0000000                   
 8389  0000000                   		LDA #VOLUME_VALUE
 8390  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8391  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME#
 8392  0000000                   
 8393  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8394  0000000                   		PSF_RESPONSE_LIMIT
 8395  0000000                   		TXA
 8396  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC
 8397  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8398  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8399  0000000                   
 8400  0000000                   END_SET_MS_CHANNEL_VOLUME#:
 8401  0000000                   	.ENDIF
 8402  0000000                   	.ENDIF
 8403  0000000                   	ENDM
 8404  0000000                   ;------------------------------------------------------------------------------
 8405  0000000                   	.IF (WITH_MS .EQ. 1H)
 8406  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8407  0000000                   SET_VOLM1 MACRO VOLUME_VALUE 
 8408  0000000                   	SET_MS_CHANNEL_VOLUME VOLUME_VALUE, 00
 8409  0000000                   ENDM
 8410  0000000                   ;------------------------------------------------------------------------------
 8411  0000000                   SET_VOLM2 MACRO VOLUME_VALUE 
 8412  0000000                   	SET_MS_CHANNEL_VOLUME VOLUME_VALUE, 01
 8413  0000000                   ENDM
 8414  0000000                   ;------------------------------------------------------------------------------
 8415  0000000                   SET_VOLM3 MACRO VOLUME_VALUE 
 8416  0000000                   	SET_MS_CHANNEL_VOLUME VOLUME_VALUE, 02
 8417  0000000                   ENDM
 8418  0000000                   	.ENDIF
 8419  0000000                   	.ENDIF
 8420  0000000                   ;===============================================================================
 8421  0000000                   SET_MS_CHANNEL_VOLUME_RAM MACRO VOLUME_RAM, CHANNEL
 8422  0000000                   	.IF (WITH_MS .EQ. 1H)
 8423  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8424  0000000                   		LDX #CHANNEL
 8425  0000000                   		EXTERN MS_CHANNEL_TABLE





 8426  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8427  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME_RAM#
 8428  0000000                   
 8429  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8430  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8431  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8432  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8433  0000000                   			AND #80H
 8434  0000000                   			ORA VOLUME_RAM
 8435  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8436  0000000                   		.ENDIF
 8437  0000000                   
 8438  0000000                   		LDA <GLOBAL_PLAY
 8439  0000000                   		BIT #MIDI_BZ+MS_EXT
 8440  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME_RAM#
 8441  0000000                   
 8442  0000000                   		LDA VOLUME_RAM
 8443  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8444  0000000                   		BEQ END_SET_MS_CHANNEL_VOLUME_RAM#
 8445  0000000                   
 8446  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8447  0000000                   		PSF_RESPONSE_LIMIT
 8448  0000000                   		TXA
 8449  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC
 8450  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8451  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8452  0000000                   
 8453  0000000                   END_SET_MS_CHANNEL_VOLUME_RAM#:
 8454  0000000                   	.ENDIF
 8455  0000000                   	.ENDIF
 8456  0000000                   	ENDM
 8457  0000000                   ;------------------------------------------------------------------------------
 8458  0000000                   	.IF (WITH_MS .EQ. 1H)
 8459  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8460  0000000                   SET_VOLM1_RAM MACRO VOLUME_RAM 
 8461  0000000                   	SET_MS_CHANNEL_VOLUME_RAM VOLUME_RAM, 00
 8462  0000000                   ENDM
 8463  0000000                   ;------------------------------------------------------------------------------
 8464  0000000                   SET_VOLM2_RAM MACRO VOLUME_RAM 
 8465  0000000                   	SET_MS_CHANNEL_VOLUME_RAM VOLUME_RAM, 01
 8466  0000000                   ENDM
 8467  0000000                   ;------------------------------------------------------------------------------
 8468  0000000                   SET_VOLM3_RAM MACRO VOLUME_RAM 
 8469  0000000                   	SET_MS_CHANNEL_VOLUME_RAM VOLUME_RAM, 02
 8470  0000000                   ENDM
 8471  0000000                   	.ENDIF
 8472  0000000                   	.ENDIF
 8473  0000000                   ;===============================================================================
 8474  0000000                   ;===============================================================================	
 8475  0000000                   EN_GLOBAL_CHANNEL_VOLM MACRO CHANNEL
 8476  0000000                   	.IF (WITH_MS .EQ. 1H)
 8477  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8478  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8479  0000000                   		LDX #CHANNEL
 8480  0000000                   		EXTERN MS_CHANNEL_TABLE
 8481  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8482  0000000                   		BEQ END_EN_GLOBAL_CHANNEL_VOLM#





 8483  0000000                   
 8484  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8485  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8486  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8487  0000000                   		ORA #80H
 8488  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8489  0000000                   
 8490  0000000                   		LDA <GLOBAL_PLAY
 8491  0000000                   		BIT #MIDI_BZ+MS_EXT
 8492  0000000                   		BEQ END_EN_GLOBAL_CHANNEL_VOLM#
 8493  0000000                   
 8494  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8495  0000000                   		AND #7FH
 8496  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8497  0000000                   
 8498  0000000                   END_EN_GLOBAL_CHANNEL_VOLM#:		
 8499  0000000                   	.ENDIF
 8500  0000000                   	.ENDIF	
 8501  0000000                   	.ENDIF	
 8502  0000000                   	ENDM
 8503  0000000                   ;------------------------------------------------------------------------------
 8504  0000000                   	.IF (WITH_MS .EQ. 1H)
 8505  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8506  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8507  0000000                   
 8508  0000000                   EN_GLOBALVOL_VOLM1 MACRO
 8509  0000000                   	EN_GLOBAL_CHANNEL_VOLM 00
 8510  0000000                   ENDM
 8511  0000000                   ;------------------------------------------------------------------------------
 8512  0000000                   EN_GLOBALVOL_VOLM2 MACRO
 8513  0000000                   	EN_GLOBAL_CHANNEL_VOLM 01
 8514  0000000                   ENDM
 8515  0000000                   ;------------------------------------------------------------------------------
 8516  0000000                   EN_GLOBALVOL_VOLM3 MACRO
 8517  0000000                   	EN_GLOBAL_CHANNEL_VOLM 02
 8518  0000000                   ENDM
 8519  0000000                   	.ENDIF
 8520  0000000                   	.ENDIF	
 8521  0000000                   	.ENDIF
 8522  0000000                   ;===============================================================================	
 8523  0000000                   DIS_GLOBAL_CHANNEL_VOLM MACRO CHANNEL
 8524  0000000                   	.IF (WITH_MS .EQ. 1H)
 8525  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8526  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8527  0000000                   		LDX #CHANNEL
 8528  0000000                   		EXTERN MS_CHANNEL_TABLE
 8529  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8530  0000000                   		BEQ END_DIS_GLOBAL_CHANNEL_VOLM#
 8531  0000000                   
 8532  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8533  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8534  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8535  0000000                   		AND #7FH
 8536  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8537  0000000                   END_DIS_GLOBAL_CHANNEL_VOLM#:		
 8538  0000000                   	.ENDIF
 8539  0000000                   	.ENDIF	





 8540  0000000                   	.ENDIF	
 8541  0000000                   	ENDM
 8542  0000000                   ;------------------------------------------------------------------------------
 8543  0000000                   	.IF (WITH_MS .EQ. 1H)
 8544  0000000                   	.IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8545  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8546  0000000                   
 8547  0000000                   DIS_GLOBALVOL_VOLM1 MACRO
 8548  0000000                   	DIS_GLOBAL_CHANNEL_VOLM 00
 8549  0000000                   ENDM
 8550  0000000                   ;------------------------------------------------------------------------------
 8551  0000000                   DIS_GLOBALVOL_VOLM2 MACRO
 8552  0000000                   	DIS_GLOBAL_CHANNEL_VOLM 01
 8553  0000000                   ENDM
 8554  0000000                   ;------------------------------------------------------------------------------
 8555  0000000                   DIS_GLOBALVOL_VOLM3 MACRO
 8556  0000000                   	DIS_GLOBAL_CHANNEL_VOLM 02
 8557  0000000                   ENDM
 8558  0000000                   	.ENDIF	
 8559  0000000                   	.ENDIF
 8560  0000000                   	.ENDIF
 8561  0000000                   ;==============================================================================
 8562  0000000                   SET_VOLMX_ALL MACRO VOLUME_VALUE 
 8563  0000000                   .IF (WITH_MS .EQ. 1H)
 8564  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8565  0000000                   		LDX #FFh
 8566  0000000                   SET_VOLMX_ALL_NEXT#:
 8567  0000000                   		INX
 8568  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8569  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8570  0000000                   		BEQ SET_VOLMX_ALL_END#
 8571  0000000                   
 8572  0000000                   		EXTERN MS_CHANNEL_TABLE
 8573  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8574  0000000                   		BEQ SET_VOLMX_ALL_NEXT#
 8575  0000000                   
 8576  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8577  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8578  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8579  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8580  0000000                   			AND #80H
 8581  0000000                   			ORA #VOLUME_VALUE
 8582  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8583  0000000                   		.ENDIF
 8584  0000000                   
 8585  0000000                   		LDA <GLOBAL_PLAY
 8586  0000000                   		BIT #MIDI_BZ+MS_EXT
 8587  0000000                   		BEQ SET_VOLMX_ALL_NEXT#
 8588  0000000                   
 8589  0000000                   		LDA #VOLUME_VALUE
 8590  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8591  0000000                   		BEQ SET_VOLMX_ALL_NEXT#
 8592  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8593  0000000                   
 8594  0000000                   		PSF_RESPONSE_LIMIT
 8595  0000000                   		TXA
 8596  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC





 8597  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8598  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8599  0000000                   		BRA SET_VOLMX_ALL_NEXT#
 8600  0000000                   
 8601  0000000                   SET_VOLMX_ALL_END#:
 8602  0000000                   .ENDIF
 8603  0000000                   .ENDIF
 8604  0000000                   ENDM
 8605  0000000                   ;------------------------------------------------------------------------------
 8606  0000000                   SET_VOLMX_ALL_RAM MACRO VOLUME_RAM
 8607  0000000                   .IF (WITH_MS .EQ. 1H)
 8608  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8609  0000000                   		LDX #FFh
 8610  0000000                   SET_VOLMX_ALL_RAM_NEXT#:
 8611  0000000                   		INX
 8612  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8613  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8614  0000000                   		BEQ SET_VOLMX_ALL_RAM_END#
 8615  0000000                   
 8616  0000000                   		EXTERN MS_CHANNEL_TABLE
 8617  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8618  0000000                   		BEQ SET_VOLMX_ALL_RAM_NEXT#
 8619  0000000                   
 8620  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8621  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8622  0000000                   			LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8623  0000000                   			LDA GLOBAL_CHANNEL_VOLM0,Y
 8624  0000000                   			AND #80H
 8625  0000000                   			ORA VOLUME_RAM
 8626  0000000                   			STA GLOBAL_CHANNEL_VOLM0,Y
 8627  0000000                   		.ENDIF
 8628  0000000                   
 8629  0000000                   		LDA <GLOBAL_PLAY
 8630  0000000                   		BIT #MIDI_BZ+MS_EXT
 8631  0000000                   		BEQ SET_VOLMX_ALL_RAM_NEXT#
 8632  0000000                   
 8633  0000000                   		LDA VOLUME_RAM
 8634  0000000                   		CMP !CH_CHANNEL_VOLUME,X
 8635  0000000                   		BEQ SET_VOLMX_ALL_RAM_NEXT#
 8636  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8637  0000000                   
 8638  0000000                   		PSF_RESPONSE_LIMIT
 8639  0000000                   		TXA
 8640  0000000                   		EXTERN UPDATE_CHANNEL_VOLUME_PROC
 8641  0000000                   		JSR UPDATE_CHANNEL_VOLUME_PROC
 8642  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8643  0000000                   		BRA SET_VOLMX_ALL_RAM_NEXT#
 8644  0000000                   
 8645  0000000                   SET_VOLMX_ALL_RAM_END#:
 8646  0000000                   .ENDIF
 8647  0000000                   .ENDIF
 8648  0000000                   ENDM
 8649  0000000                   ;------------------------------------------------------------------------------
 8650  0000000                   EN_GLOBALVOL_VOLMX_ALL MACRO
 8651  0000000                   .IF (WITH_MS .EQ. 1H)
 8652  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8653  0000000                   .IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)	





 8654  0000000                   		LDX #FFh
 8655  0000000                   EN_GLOBALVOL_VOLMX_ALL_NEXT#:
 8656  0000000                   		INX
 8657  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8658  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8659  0000000                   		BEQ EN_GLOBALVOL_VOLMX_ALL_END#
 8660  0000000                   
 8661  0000000                   		EXTERN MS_CHANNEL_TABLE
 8662  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8663  0000000                   		BEQ EN_GLOBALVOL_VOLMX_ALL_NEXT#
 8664  0000000                   
 8665  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8666  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8667  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8668  0000000                   		ORA #80H
 8669  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8670  0000000                   
 8671  0000000                   		LDA <GLOBAL_PLAY
 8672  0000000                   		BIT #MIDI_BZ+MS_EXT
 8673  0000000                   		BEQ EN_GLOBALVOL_VOLMX_ALL_NEXT#
 8674  0000000                   
 8675  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8676  0000000                   		AND #7FH
 8677  0000000                   		STA !CH_CHANNEL_VOLUME,X
 8678  0000000                   		BRA EN_GLOBALVOL_VOLMX_ALL_NEXT#
 8679  0000000                   
 8680  0000000                   EN_GLOBALVOL_VOLMX_ALL_END#:		
 8681  0000000                   .ENDIF
 8682  0000000                   .ENDIF
 8683  0000000                   .ENDIF
 8684  0000000                   ENDM
 8685  0000000                   ;------------------------------------------------------------------------------
 8686  0000000                   DIS_GLOBALVOL_VOLMX_ALL MACRO
 8687  0000000                   .IF (WITH_MS .EQ. 1H)
 8688  0000000                   .IF (WITH_CHANNEL_PRESSURE .EQ. 1H)
 8689  0000000                   .IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
 8690  0000000                   		LDX #FFh
 8691  0000000                   DIS_GLOBALVOL_VOLMX_ALL_NEXT#:
 8692  0000000                   		INX
 8693  0000000                   		EXTERN MS_CHANNEL_ADDR_TABLE	
 8694  0000000                   		LDY !MS_CHANNEL_ADDR_TABLE,X
 8695  0000000                   		BEQ DIS_GLOBALVOL_VOLMX_ALL_END#
 8696  0000000                   
 8697  0000000                   		EXTERN MS_CHANNEL_TABLE
 8698  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8699  0000000                   		BEQ DIS_GLOBALVOL_VOLMX_ALL_NEXT#
 8700  0000000                   
 8701  0000000                   		EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
 8702  0000000                   		LDY MS_GLOBAL_CHANNEL_VOLUME_TABLE,X
 8703  0000000                   		LDA GLOBAL_CHANNEL_VOLM0,Y
 8704  0000000                   		AND #7FH
 8705  0000000                   		STA GLOBAL_CHANNEL_VOLM0,Y
 8706  0000000                   		BRA DIS_GLOBALVOL_VOLMX_ALL_NEXT#
 8707  0000000                   DIS_GLOBALVOL_VOLMX_ALL_END#:
 8708  0000000                   .ENDIF
 8709  0000000                   .ENDIF
 8710  0000000                   .ENDIF





 8711  0000000                   ENDM
 8712  0000000                   ;==============================================================================
 8713  0000000                   ; Set pitch offset
 8714  0000000                   ;==============================================================================
 8715  0000000                   	.IF (WITH_MS .EQ. 1H)
 8716  0000000                   	.IF (WITH_NOTE_OFFSET .EQ. 1H)
 8717  0000000                   SET_PITCH_OFFSET MACRO PITCH_OFFSET	
 8718  0000000                   	LDA #PITCH_OFFSET
 8719  0000000                   	STA <MS_START+CH_NOTE_OFFSET_MS
 8720  0000000                   ENDM		
 8721  0000000                   	.ENDIF
 8722  0000000                   	.ENDIF
 8723  0000000                   ;------------------------------------------------------------------------------
 8724  0000000                   	.IF (WITH_MS .EQ. 1H)
 8725  0000000                   	.IF (WITH_NOTE_OFFSET .EQ. 1H)
 8726  0000000                   SET_PITCH_OFFSET_RAM MACRO PITCH_OFFSET_RAM	
 8727  0000000                   		LDA !PITCH_OFFSET_RAM
 8728  0000000                   		STA <MS_START+CH_NOTE_OFFSET_MS
 8729  0000000                   ENDM		
 8730  0000000                   	.ENDIF
 8731  0000000                   	.ENDIF	
 8732  0000000                   
 8733  0000000                   ;==============================================================================
 8734  0000000                   ; Set instrument of specific MIDI channel
 8735  0000000                   ;==============================================================================
 8736  0000000                   SET_CHANNEL_INSTRUMENT_Y MACRO INSTRUMENT_ID
 8737  0000000                   	.IF (WITH_MS .EQ. 1H)				
 8738  0000000                   		LDX #INSTRUMENT_ID
 8739  0000000                   		EXTERN INS_MAX_INDEX
 8740  0000000                   		CPX #(INS_MAX_INDEX+1)
 8741  0000000                   		BCS INVALID_GO_OUT_#
 8742  0000000                   
 8743  0000000                   		EXTERN INSTRUMENT_TYPE_LIST_TABLE
 8744  0000000                   		LDA !INSTRUMENT_TYPE_LIST_TABLE,X
 8745  0000000                   		CMP #FFH
 8746  0000000                   		BEQ INVALID_GO_OUT_#
 8747  0000000                   
 8748  0000000                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8749  0000000                   			EXTERN MS_CHANNEL_TABLE
 8750  0000000                   			LDA !MS_CHANNEL_TABLE,Y
 8751  0000000                   			BEQ INVALID_GO_OUT_#
 8752  0000000                   
 8753  0000000                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8754  0000000                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
 8755  0000000                   			LDA GLOBAL_CHANNEL_INS0,X
 8756  0000000                   			AND #80H
 8757  0000000                   			ORA #INSTRUMENT_ID
 8758  0000000                   			STA GLOBAL_CHANNEL_INS0,X
 8759  0000000                   		.ENDIF
 8760  0000000                   
 8761  0000000                   		LDA #INSTRUMENT_ID
 8762  0000000                   		STA !CH_CHANNEL_INSTRUMENT,Y
 8763  0000000                   INVALID_GO_OUT_#:
 8764  0000000                   	.ENDIF
 8765  0000000                   	ENDM
 8766  0000000                   ;------------------------------------------------------------------------------
 8767  0000000                   SET_CHANNEL_INSTRUMENT MACRO CHANNEL_ID,INSTRUMENT_ID





 8768  0000000                   	.IF (WITH_MS .EQ. 1H)
 8769  0000000                   		LDY #CHANNEL_ID
 8770  0000000                   		SET_CHANNEL_INSTRUMENT_Y INSTRUMENT_ID
 8771  0000000                   	.ENDIF
 8772  0000000                   	ENDM
 8773  0000000                   ;------------------------------------------------------------------------------
 8774  0000000                   .IF (WITH_MS .EQ. 1)
 8775  0000000                   	.IF (WITH_POLYPHONY .GT. 0H)
 8776  0000000                   SET_EVP1 MACRO NEW_EVP
 8777  0000000                   	SET_CHANNEL_INSTRUMENT 00H, NEW_EVP
 8778  0000000                   ENDM
 8779  0000000                   	.ENDIF		
 8780  0000000                   ;------------------------------------------------------------------------------
 8781  0000000                   	.IF (WITH_POLYPHONY .GT. 1H || WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8782  0000000                   SET_EVP2 MACRO NEW_EVP
 8783  0000000                   	SET_CHANNEL_INSTRUMENT 01H, NEW_EVP
 8784  0000000                   ENDM
 8785  0000000                   	.ENDIF
 8786  0000000                   ;------------------------------------------------------------------------------
 8787  0000000                   	.IF (WITH_POLYPHONY .GT. 2H ||WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8788  0000000                   SET_EVP3 MACRO NEW_EVP
 8789  0000000                   	SET_CHANNEL_INSTRUMENT 02H, NEW_EVP
 8790  0000000                   ENDM
 8791  0000000                   	.ENDIF
 8792  0000000                   .ENDIF
 8793  0000000                   ;==============================================================================
 8794  0000000                   SET_CHANNEL_INSTRUMENT_Y_BY_RAM MACRO INSTRUMENT_RAM
 8795  0000000                   	.IF (WITH_MS .EQ. 1H)
 8796  0000000                   		LDX INSTRUMENT_RAM
 8797  0000000                   		EXTERN INS_MAX_INDEX
 8798  0000000                   		CPX #(INS_MAX_INDEX+1)
 8799  0000000                   		BCS INVALID_GO_OUT_RAM_#
 8800  0000000                   
 8801  0000000                   		EXTERN INSTRUMENT_TYPE_LIST_TABLE
 8802  0000000                   		LDA !INSTRUMENT_TYPE_LIST_TABLE,X
 8803  0000000                   		CMP #FFH
 8804  0000000                   		BEQ INVALID_GO_OUT_RAM_#
 8805  0000000                   
 8806  0000000                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8807  0000000                   			EXTERN MS_CHANNEL_TABLE
 8808  0000000                   			LDA !MS_CHANNEL_TABLE,Y
 8809  0000000                   			BEQ INVALID_GO_OUT_RAM_#
 8810  0000000                   
 8811  0000000                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8812  0000000                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
 8813  0000000                   			LDA GLOBAL_CHANNEL_INS0,X
 8814  0000000                   			AND #80H
 8815  0000000                   			ORA INSTRUMENT_RAM
 8816  0000000                   			STA GLOBAL_CHANNEL_INS0,X
 8817  0000000                   		.ENDIF
 8818  0000000                   
 8819  0000000                   		LDA INSTRUMENT_RAM
 8820  0000000                   		STA !CH_CHANNEL_INSTRUMENT,Y
 8821  0000000                   INVALID_GO_OUT_RAM_#:
 8822  0000000                   	.ENDIF
 8823  0000000                   	ENDM
 8824  0000000                   ;------------------------------------------------------------------------------





 8825  0000000                   SET_CHANNEL_INSTRUMENT_BY_RAM MACRO CHANNEL_ID, INSTRUMENT_RAM
 8826  0000000                   	.IF (WITH_MS .EQ. 1H)
 8827  0000000                   		LDY #CHANNEL_ID
 8828  0000000                   		SET_CHANNEL_INSTRUMENT_Y_BY_RAM INSTRUMENT_RAM
 8829  0000000                   	.ENDIF
 8830  0000000                   	ENDM
 8831  0000000                   ;------------------------------------------------------------------------------
 8832  0000000                   .IF (WITH_MS .EQ. 1)
 8833  0000000                   	.IF (WITH_POLYPHONY .GT. 0H)
 8834  0000000                   SET_EVP1_RAM MACRO NEW_EVP_RAM
 8835  0000000                   	SET_CHANNEL_INSTRUMENT_BY_RAM 00H, NEW_EVP_RAM
 8836  0000000                   ENDM		
 8837  0000000                   	.ENDIF
 8838  0000000                   ;------------------------------------------------------------------------------
 8839  0000000                   	.IF (WITH_POLYPHONY .GT. 1H || WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8840  0000000                   SET_EVP2_RAM MACRO NEW_EVP_RAM	
 8841  0000000                   	SET_CHANNEL_INSTRUMENT_BY_RAM 01H, NEW_EVP_RAM
 8842  0000000                   ENDM		
 8843  0000000                   	.ENDIF
 8844  0000000                   ;------------------------------------------------------------------------------
 8845  0000000                   	.IF (WITH_POLYPHONY .GT. 2H || WITH_HQPC8 .EQ. 1H || WITH_VMDPC8 .EQ. 1H || WITH_PCSPC8 .EQ. 1H )
 8846  0000000                   SET_EVP3_RAM MACRO NEW_EVP_RAM	
 8847  0000000                   	SET_CHANNEL_INSTRUMENT_BY_RAM 02H, NEW_EVP_RAM
 8848  0000000                   ENDM		
 8849  0000000                   	.ENDIF	
 8850  0000000                   .ENDIF
 8851  0000000                   ;===============================================================================
 8852  0000000                   ;===============================================================================	
 8853  0000000                   EN_GLOBAL_CHANNEL_INS MACRO CHANNEL
 8854  0000000                   	.IF (WITH_MS .EQ. 1H)
 8855  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8856  0000000                   		LDX #CHANNEL
 8857  0000000                   		EXTERN MS_CHANNEL_TABLE
 8858  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8859  0000000                   		BEQ END_EN_GLOBAL_CHANNEL_INS#
 8860  0000000                   
 8861  0000000                   		EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8862  0000000                   		LDY MS_GLOBAL_CHANNEL_INS_TABLE,X
 8863  0000000                   		LDA GLOBAL_CHANNEL_INS0,Y
 8864  0000000                   		ORA #80H
 8865  0000000                   		STA GLOBAL_CHANNEL_INS0,Y
 8866  0000000                   
 8867  0000000                   		AND #7FH
 8868  0000000                   		STA !CH_CHANNEL_INSTRUMENT,X
 8869  0000000                   END_EN_GLOBAL_CHANNEL_INS#:		
 8870  0000000                   	.ENDIF
 8871  0000000                   	.ENDIF	
 8872  0000000                   	ENDM
 8873  0000000                   ;------------------------------------------------------------------------------
 8874  0000000                   	.IF (WITH_MS .EQ. 1H)
 8875  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8876  0000000                   
 8877  0000000                   EN_GLOBALINS_M1 MACRO
 8878  0000000                   	EN_GLOBAL_CHANNEL_INS 00
 8879  0000000                   ENDM
 8880  0000000                   ;------------------------------------------------------------------------------
 8881  0000000                   EN_GLOBALINS_M2 MACRO





 8882  0000000                   	EN_GLOBAL_CHANNEL_INS 01
 8883  0000000                   ENDM
 8884  0000000                   ;------------------------------------------------------------------------------
 8885  0000000                   EN_GLOBALINS_M3 MACRO
 8886  0000000                   	EN_GLOBAL_CHANNEL_INS 02
 8887  0000000                   ENDM
 8888  0000000                   	.ENDIF
 8889  0000000                   	.ENDIF
 8890  0000000                   ;===============================================================================	
 8891  0000000                   DIS_GLOBAL_CHANNEL_INS MACRO CHANNEL
 8892  0000000                   	.IF (WITH_MS .EQ. 1H)
 8893  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8894  0000000                   		LDX #CHANNEL
 8895  0000000                   		EXTERN MS_CHANNEL_TABLE
 8896  0000000                   		LDA !MS_CHANNEL_TABLE,X
 8897  0000000                   		BEQ END_DIS_GLOBAL_CHANNEL_INS#
 8898  0000000                   
 8899  0000000                   		EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
 8900  0000000                   		LDY MS_GLOBAL_CHANNEL_INS_TABLE,X
 8901  0000000                   		LDA GLOBAL_CHANNEL_INS0,Y
 8902  0000000                   		AND #7FH
 8903  0000000                   		STA GLOBAL_CHANNEL_INS0,Y
 8904  0000000                   END_DIS_GLOBAL_CHANNEL_INS#:		
 8905  0000000                   	.ENDIF
 8906  0000000                   	.ENDIF	
 8907  0000000                   	ENDM
 8908  0000000                   ;------------------------------------------------------------------------------
 8909  0000000                   	.IF (WITH_MS .EQ. 1H)
 8910  0000000                   	.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
 8911  0000000                   DIS_GLOBALINS_M1 MACRO
 8912  0000000                   	DIS_GLOBAL_CHANNEL_INS 00
 8913  0000000                   ENDM
 8914  0000000                   ;------------------------------------------------------------------------------
 8915  0000000                   DIS_GLOBALINS_M2 MACRO
 8916  0000000                   	DIS_GLOBAL_CHANNEL_INS 01
 8917  0000000                   ENDM
 8918  0000000                   ;------------------------------------------------------------------------------
 8919  0000000                   DIS_GLOBALINS_M3 MACRO
 8920  0000000                   	DIS_GLOBAL_CHANNEL_INS 02
 8921  0000000                   ENDM
 8922  0000000                   	.ENDIF
 8923  0000000                   	.ENDIF
 8924  0000000                   ;===============================================================================
 8925  0000000                   ; For external midi note on/off
 8926  0000000                   ;===============================================================================		
 8927  0000000                   EXT_NOTE_ON_WCF1 MACRO CHANNEL,NOTE,VELOCITY
 8928  0000000                   	.IF (WITH_MS .EQ. 1H)
 8929  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 8930  0000000                   		PSF_RESPONSE_LIMIT
 8931  0000000                   		PHP
 8932  0000000                   		SEI
 8933  0000000                   		EXTERNAL INIT_EXT_MIDI_API
 8934  0000000                   		JSR INIT_EXT_MIDI_API
 8935  0000000                   	.IF (WITH_MULTI_CHANNEL .EQ. 0H)
 8936  0000000                   		LDA #CHANNEL
 8937  0000000                   	.ELSE
 8938  0000000                   		LDY #CHANNEL





 8939  0000000                   		EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 8940  0000000                   		LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 8941  0000000                   		LDA CH_SYNTH_CHANNEL0,X
 8942  0000000                   	.ENDIF
 8943  0000000                   		STA <MS_START+CH_EXT_MIDI_STATUS_MS
 8944  0000000                   		LDA #NOTE
 8945  0000000                   		STA <MS_START+CH_EXT_MIDI_DATA1_MS
 8946  0000000                   		LDA #VELOCITY
 8947  0000000                   		ASL A
 8948  0000000                   		ASL A
 8949  0000000                   		ASL A
 8950  0000000                   	    	ASL A
 8951  0000000                   		ASL A
 8952  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8953  0000000                   		ASL A
 8954  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8955  0000000                   		ROL <MS_START+CH_EXT_MIDI_STATUS_MS
 8956  0000000                   		ASL A
 8957  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8958  0000000                   		ROL <MS_START+CH_EXT_MIDI_STATUS_MS
 8959  0000000                   		ASL A
 8960  0000000                   		ROL <MS_START+CH_EXT_MIDI_DATA1_MS
 8961  0000000                   		ROL <MS_START+CH_EXT_MIDI_STATUS_MS
 8962  0000000                   		PLP
 8963  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8964  0000000                   	.ENDIF
 8965  0000000                   	.ENDIF
 8966  0000000                   	ENDM
 8967  0000000                   ;------------------------------------------------------------------------------
 8968  0000000                   	.IF (WITH_MS .EQ. 1H)
 8969  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 8970  0000000                   NOTE_ON MACRO CHANNEL,NOTE,VELOCITY
 8971  0000000                   	EXT_NOTE_ON_WCF1 CHANNEL-1,NOTE,VELOCITY
 8972  0000000                   ENDM
 8973  0000000                   	.ENDIF
 8974  0000000                   	.ENDIF
 8975  0000000                   ;===============================================================================
 8976  0000000                   EXT_NOTE_OFF_WCF1 MACRO CHANNEL,NOTE
 8977  0000000                   	.IF (WITH_MS .EQ. 1H)
 8978  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 8979  0000000                   		PSF_RESPONSE_LIMIT
 8980  0000000                   		PHP
 8981  0000000                   		SEI
 8982  0000000                   	.IF (WITH_MULTI_CHANNEL .EQ. 0H)
 8983  0000000                   		LDA #CHANNEL
 8984  0000000                   	.ELSE
 8985  0000000                   		LDY #CHANNEL
 8986  0000000                   		EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 8987  0000000                   		LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 8988  0000000                   		LDA CH_SYNTH_CHANNEL0,X
 8989  0000000                   	.ENDIF
 8990  0000000                   		ASL A
 8991  0000000                   		ASL A
 8992  0000000                   		ASL A
 8993  0000000                   		ORA #85H	;10nnn101
 8994  0000000                   		STA <MS_START+CH_EXT_MIDI_STATUS_MS
 8995  0000000                   		PLP





 8996  0000000                   		PSF_RESPONSE_LIMIT_RELEASE
 8997  0000000                   	.ENDIF
 8998  0000000                   	.ENDIF
 8999  0000000                   	ENDM
 9000  0000000                   ;------------------------------------------------------------------------------
 9001  0000000                   	.IF (WITH_MS .EQ. 1H)
 9002  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
 9003  0000000                   NOTE_OFF MACRO CHANNEL,NOTE
 9004  0000000                   	EXT_NOTE_OFF_WCF1 CHANNEL-1,NOTE
 9005  0000000                   ENDM
 9006  0000000                   	.ENDIF
 9007  0000000                   	.ENDIF	
 9008  0000000                   ;===============================================================================
 9009  0000000                   ;===============================================================================
 9010  0000000                   	.IF (WITH_SP .EQ. 1)
 9011  0000000                   EN_ULTRAIO_EVENT MACRO CHANNEL
 9012  0000000                   	LDY #CHANNEL-1
 9013  0000000                   	EXTERN DIS_UIO_EVENT_FLAG
 9014  0000000                   	LDA !DIS_UIO_EVENT_FLAG,Y
 9015  0000000                   	TRB <COMMON_FLAG2 
 9016  0000000                   
 9017  0000000                   	PSF_RESPONSE_LIMIT
 9018  0000000                   	LDA #SPEECH_TYPE
 9019  0000000                   	EXTERN UIO_START
 9020  0000000                   	JSR UIO_START
 9021  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 9022  0000000                   	ENDM
 9023  0000000                   ;------------------------------------------------------------------------------		
 9024  0000000                   DIS_ULTRAIO_EVENT MACRO CHANNEL
 9025  0000000                   	LDY #CHANNEL-1
 9026  0000000                   	EXTERN DIS_UIO_EVENT_FLAG
 9027  0000000                   	LDA !DIS_UIO_EVENT_FLAG,Y
 9028  0000000                   	TSB <COMMON_FLAG2 
 9029  0000000                   
 9030  0000000                   	PSF_RESPONSE_LIMIT
 9031  0000000                   	LDA #SPEECH_TYPE
 9032  0000000                   	EXTERN UIO_STOP
 9033  0000000                   	JSR UIO_STOP
 9034  0000000                   	PSF_RESPONSE_LIMIT_RELEASE
 9035  0000000                   	ENDM
 9036  0000000                   	.ENDIF	
 9037  0000000                   ;===============================================================================
 9038  0000000                   ;===============================================================================
 9039  0000000                   .IF (WITH_MS .EQ. 1)
 9040  0000000                   GET_NOTE MACRO
 9041  0000000                            LDA <MS_START+CH_MIDI_NOTE_MS
 9042  0000000                            ENDM
 9043  0000000                   ;------------------------------------------------------------------------------	 
 9044  0000000                   GET_NOTE_BY_RAM MACRO NOTE_RAM        
 9045  0000000                            LDA <MS_START+CH_MIDI_NOTE_MS
 9046  0000000                            STA NOTE_RAM
 9047  0000000                            ENDM
 9048  0000000                   
 9049  0000000                   .ENDIF   
 9050  0000000                   ;===============================================================================
 9051  0000000                   ;===============================================================================
 9052  0000000                   EN_ULTRAIO_PIN MACRO INDEX





 9053  0000000                   	EXTERN UIO_PIN_NUM
 9054  0000000                   	EXTERN UIO_USED_PIN_|INDEX
 9055  0000000                   	LDA #INDEX-1
 9056  0000000                   	CMP #UIO_PIN_NUM
 9057  0000000                   	BCS EN_ULTRAIO_PIN_END#
 9058  0000000                   	LDA #UIO_USED_PIN_|INDEX
 9059  0000000                   	BEQ EN_ULTRAIO_PIN_END#
 9060  0000000                   .ifndef	FW_BAM_TIMER
 9061  0000000                   	EXTERN UIO_PIN_CH_FLAG_|INDEX
 9062  0000000                   	EXTERN UIO_SET_PIN_ENABLE_VALUE_|INDEX
 9063  0000000                   	LDA #7FH
 9064  0000000                   	AND !UIO_PIN_CH_FLAG_|INDEX
 9065  0000000                   	STA !UIO_PIN_CH_FLAG_|INDEX
 9066  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_SET_PIN_ENABLE_VALUE_|INDEX
 9067  0000000                   .else
 9068  0000000                   	EXTERN UIO_ENABLE_PIN_|INDEX
 9069  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_ENABLE_PIN_|INDEX
 9070  0000000                   .endif
 9071  0000000                   
 9072  0000000                   EN_ULTRAIO_PIN_END#:
 9073  0000000                   	ENDM
 9074  0000000                   ;------------------------------------------------------------------------------		
 9075  0000000                   DIS_ULTRAIO_PIN MACRO INDEX
 9076  0000000                   	EXTERN UIO_PIN_NUM
 9077  0000000                   	EXTERN UIO_USED_PIN_|INDEX
 9078  0000000                   	EXTERN UIO_SET_PIN_DISABLE_VALUE_|INDEX
 9079  0000000                   	LDA #INDEX-1	
 9080  0000000                   	CMP #UIO_PIN_NUM
 9081  0000000                   	BCS DIS_ULTRAIO_PIN_END#
 9082  0000000                   	LDA #UIO_USED_PIN_|INDEX
 9083  0000000                   	BEQ DIS_ULTRAIO_PIN_END#
 9084  0000000                   .ifndef	FW_BAM_TIMER
 9085  0000000                   	EXTERN UIO_PIN_CH_FLAG_|INDEX
 9086  0000000                   	LDA #80H
 9087  0000000                   	ORA !UIO_PIN_CH_FLAG_|INDEX
 9088  0000000                   	STA !UIO_PIN_CH_FLAG_|INDEX
 9089  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_SET_PIN_DISABLE_VALUE_|INDEX
 9090  0000000                   .else
 9091  0000000                   	EXTERN UIO_DISABLE_PIN_|INDEX
 9092  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_DISABLE_PIN_|INDEX
 9093  0000000                   .endif
 9094  0000000                   
 9095  0000000                   DIS_ULTRAIO_PIN_END#:
 9096  0000000                   	ENDM
 9097  0000000                   ;------------------------------------------------------------------------------	
 9098  0000000                   EN_ULTRAIO_CURVE MACRO INDEX	
 9099  0000000                   	EN_ULTRAIO_PIN INDEX
 9100  0000000                   	ENDM
 9101  0000000                   
 9102  0000000                   DIS_ULTRAIO_CURVE MACRO INDEX
 9103  0000000                   	DIS_ULTRAIO_PIN INDEX
 9104  0000000                   	ENDM
 9105  0000000                   ;------------------------------------------------------------------------------	
 9106  0000000                   SET_ULTRAIO_CURVE_PIN MACRO INDEX, PIN_MAPPING
 9107  0000000                   	EXTERN UIO_PIN_NUM
 9108  0000000                   	EXTERN UIO_MULTI_PIN_|INDEX
 9109  0000000                   	EXTERN UIO_PIN_|INDEX





 9110  0000000                   	EXTERN UIO_EN_MULTI_PIN_|INDEX
 9111  0000000                   	EXTERN UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9112  0000000                   	LDA #INDEX-1
 9113  0000000                   	CMP #UIO_PIN_NUM
 9114  0000000                   	BCS SET_ULTRAIO_CURVE_PIN_END#
 9115  0000000                   	LDA #UIO_MULTI_PIN_|INDEX
 9116  0000000                   	BEQ SET_ULTRAIO_CURVE_PIN_END#
 9117  0000000                   
 9118  0000000                   	LDA #PIN_MAPPING
 9119  0000000                   	AND #UIO_PIN_|INDEX
 9120  0000000                   	STA !UIO_EN_MULTI_PIN_|INDEX
 9121  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9122  0000000                   SET_ULTRAIO_CURVE_PIN_END#:
 9123  0000000                   	ENDM
 9124  0000000                   ;------------------------------------------------------------------------------	
 9125  0000000                   ;SET_ULTRAIO_CURVE_PIN_RAM MACRO INDEX, PIN_MAPPING_RAM
 9126  0000000                   ;	EXTERN UIO_PIN_NUM
 9127  0000000                   ;	EXTERN UIO_MULTI_PIN_|INDEX
 9128  0000000                   ;	EXTERN UIO_PIN_|INDEX
 9129  0000000                   ;	EXTERN UIO_EN_MULTI_PIN_|INDEX
 9130  0000000                   ;	EXTERN UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9131  0000000                   ;	LDA #INDEX-1
 9132  0000000                   ;	CMP #UIO_PIN_NUM
 9133  0000000                   ;	BCS SET_ULTRAIO_CURVE_PIN_RAM_END#
 9134  0000000                   ;	LDA #UIO_MULTI_PIN_|INDEX
 9135  0000000                   ;	BEQ SET_ULTRAIO_CURVE_PIN_RAM_END#
 9136  0000000                   ;	
 9137  0000000                   ;	LDA !PIN_MAPPING_RAM
 9138  0000000                   ;	AND #UIO_PIN_|INDEX
 9139  0000000                   ;	STA !UIO_EN_MULTI_PIN_|INDEX
 9140  0000000                   ;	PSF_RESPONSE_LIMIT_JSR UIO_SET_DIS_PIN_STOP_VALUE_|INDEX
 9141  0000000                   ;SET_ULTRAIO_CURVE_PIN_RAM_END#:
 9142  0000000                   ;	ENDM
 9143  0000000                   ;------------------------------------------------------------------------------	
 9144  0000000                   STOP_KEEP_LEVEL_PIN MACRO INDEX
 9145  0000000                   	EXTERN UIO_PIN_NUM
 9146  0000000                   	EXTERN UIO_USED_PIN_|INDEX
 9147  0000000                   	EXTERN UIO_STOP_KEEP_LEVEL_PIN_|INDEX
 9148  0000000                   	LDA #INDEX-1
 9149  0000000                   	CMP #UIO_PIN_NUM
 9150  0000000                   	BCS STOP_KEEP_LEVEL_PIN_END#
 9151  0000000                   	LDA #UIO_USED_PIN_|INDEX
 9152  0000000                   	BEQ STOP_KEEP_LEVEL_PIN_END#
 9153  0000000                   
 9154  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_STOP_KEEP_LEVEL_PIN_|INDEX
 9155  0000000                   STOP_KEEP_LEVEL_PIN_END#:	
 9156  0000000                   	ENDM
 9157  0000000                   ;------------------------------------------------------------------------------	
 9158  0000000                   STOP_ALL_KEEP_LEVEL_PIN MACRO
 9159  0000000                   	EXTERN UIO_STOP_ALL_KEEP_LEVEL_PIN
 9160  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_STOP_ALL_KEEP_LEVEL_PIN
 9161  0000000                   	ENDM
 9162  0000000                   ;===============================================================================
 9163  0000000                   ;===============================================================================
 9164  0000000                   ASSIGN_MELODY_CHANNEL MACRO MIDI_CHANNEL, NEW_MIDI_CHANNEL
 9165  0000000                   .IF (WITH_MULTI_CHANNEL .EQ. 1H)
 9166  0000000                   .IF (WITH_MS .EQ. 1H)





 9167  0000000                   	LDY #MIDI_CHANNEL
 9168  0000000                   	EXTERN MS_CHANNEL_TABLE
 9169  0000000                   	LDA !MS_CHANNEL_TABLE,Y
 9170  0000000                   	BEQ END_ASSIGN_MELODY_CHANNEL#
 9171  0000000                   
 9172  0000000                   	LDA #NEW_MIDI_CHANNEL
 9173  0000000                   	CMP #09H
 9174  0000000                   	BNE ASSIGN_MELODY_CHANNEL_CONTINUE#	
 9175  0000000                   
 9176  0000000                   	.IF (WITH_ONE_HQ .EQ. 0)
 9177  0000000                   		CPY #MS_CH2	;PERCUSSION CHANNEL
 9178  0000000                   	.ELSE
 9179  0000000                   		CPY #MS_CH1
 9180  0000000                   	.ENDIF
 9181  0000000                   	BNE END_ASSIGN_MELODY_CHANNEL#
 9182  0000000                   
 9183  0000000                   ASSIGN_MELODY_CHANNEL_CONTINUE#:
 9184  0000000                   	EXTERN NOTE_OFF_ASSIGN_MELODY_CHANNEL_API	
 9185  0000000                   	PSF_RESPONSE_LIMIT_JSR NOTE_OFF_ASSIGN_MELODY_CHANNEL_API
 9186  0000000                   
 9187  0000000                   	EXTERN ASSIGN_MELODY_CHANNEL_TABLE
 9188  0000000                   	LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
 9189  0000000                   	LDA #NEW_MIDI_CHANNEL
 9190  0000000                   	STA CH_SYNTH_CHANNEL0,X
 9191  0000000                   END_ASSIGN_MELODY_CHANNEL#:
 9192  0000000                   .ENDIF	
 9193  0000000                   .ENDIF	
 9194  0000000                   ENDM
 9195  0000000                   ;------------------------------------------------------------------------------	
 9196  0000000                   .IF (WITH_MULTI_CHANNEL .EQ. 1H)
 9197  0000000                   ASSIGN_MELODY_CH1 MACRO NEW_MIDI_CHANNEL
 9198  0000000                   	ASSIGN_MELODY_CHANNEL 00,NEW_MIDI_CHANNEL-1
 9199  0000000                   ENDM
 9200  0000000                   ;------------------------------------------------------------------------------	
 9201  0000000                   ASSIGN_MELODY_CH2 MACRO NEW_MIDI_CHANNEL
 9202  0000000                   	ASSIGN_MELODY_CHANNEL 01,NEW_MIDI_CHANNEL-1
 9203  0000000                   ENDM
 9204  0000000                   ;------------------------------------------------------------------------------	
 9205  0000000                   ASSIGN_MELODY_CH3 MACRO NEW_MIDI_CHANNEL
 9206  0000000                   	ASSIGN_MELODY_CHANNEL 02,NEW_MIDI_CHANNEL-1
 9207  0000000                   ENDM
 9208  0000000                   .ENDIF
 9209  0000000                   
 9210  0000000                   
 9211  0000000                   ;===============================================================================
 9212  0000000                   ;===============================================================================
 9213  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9214  0000000                   CHK_BUSY_CH1 MACRO 
 9215  0000000                   	LDA <GLOBAL_PLAY
 9216  0000000                   	BIT #SP1_BZ
 9217  0000000                   	ENDM
 9218  0000000                   	.ENDIF
 9219  0000000                   ;------------------------------------------------------------------------------	
 9220  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9221  0000000                   CHK_BUSY_CH2 MACRO 
 9222  0000000                   	LDA <GLOBAL_PLAY
 9223  0000000                   	BIT #SP2_BZ





 9224  0000000                   	ENDM
 9225  0000000                   	.ENDIF
 9226  0000000                   ;------------------------------------------------------------------------------	
 9227  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9228  0000000                   CHK_BUSY_CH3 MACRO 
 9229  0000000                   	LDA <GLOBAL_PLAY
 9230  0000000                   	BIT #SP3_BZ
 9231  0000000                   	ENDM
 9232  0000000                   	.ENDIF
 9233  0000000                   ;------------------------------------------------------------------------------	
 9234  0000000                   ;------------------------------------------------------------------------------
 9235  0000000                   .IF (WITH_MS .EQ. 1H)
 9236  0000000                   CHK_BUSY_MS MACRO
 9237  0000000                   	LDA <GLOBAL_PLAY
 9238  0000000                   	BIT #(MIDI_BZ+MS_EXT)	
 9239  0000000                   	ENDM
 9240  0000000                   .ENDIF
 9241  0000000                   ;------------------------------------------------------------------------------	
 9242  0000000                   ;------------------------------------------------------------------------------	
 9243  0000000                   .IF (WITH_CH0_EVO .EQ. 1)
 9244  0000000                   CHK_BUSY_EVO1 MACRO
 9245  0000000                   	LDA <GLOBAL_PLAY
 9246  0000000                   	BIT #EVO1_BZ
 9247  0000000                   	ENDM
 9248  0000000                   .ENDIF
 9249  0000000                   ;------------------------------------------------------------------------------	
 9250  0000000                   .IF (WITH_CH1_EVO .EQ. 1)
 9251  0000000                   CHK_BUSY_EVO2 MACRO
 9252  0000000                   	LDA <GLOBAL_PLAY
 9253  0000000                   	BIT #EVO2_BZ
 9254  0000000                   	ENDM
 9255  0000000                   .ENDIF
 9256  0000000                   ;------------------------------------------------------------------------------
 9257  0000000                   .IF (WITH_CH2_EVO .EQ. 1)
 9258  0000000                   CHK_BUSY_EVO3 MACRO
 9259  0000000                   	LDA <GLOBAL_PLAY
 9260  0000000                   	BIT #EVO3_BZ
 9261  0000000                   	ENDM
 9262  0000000                   .ENDIF
 9263  0000000                   ;------------------------------------------------------------------------------	
 9264  0000000                   ;------------------------------------------------------------------------------	
 9265  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0) && (WITH_EVO .EQ. 0))
 9266  0000000                   .ELSE
 9267  0000000                   CHK_BUSY_ALL MACRO
 9268  0000000                   	LDA <GLOBAL_PLAY
 9269  0000000                   	ENDM
 9270  0000000                   .ENDIF
 9271  0000000                   ;===============================================================================
 9272  0000000                   ;===============================================================================
 9273  0000000                   .IF((WITH_SP .EQ. 1) && (WITH_MDR .EQ. 1))
 9274  0000000                   EN_PLAY_REVERSE MACRO CHANNEL
 9275  0000000                   	LDX #CHANNEL-1
 9276  0000000                   	EXTERN PLAY_BACK_FLAG_TABLE
 9277  0000000                   	LDA !PLAY_BACK_FLAG_TABLE,X
 9278  0000000                   	TSB <COMMON_FLAG2
 9279  0000000                   	ENDM
 9280  0000000                   ;------------------------------------------------------------------------------	





 9281  0000000                   DIS_PLAY_REVERSE MACRO CHANNEL
 9282  0000000                   	LDX #CHANNEL-1
 9283  0000000                   	EXTERN PLAY_BACK_FLAG_TABLE
 9284  0000000                   	LDA !PLAY_BACK_FLAG_TABLE,X
 9285  0000000                   	TRB <COMMON_FLAG2
 9286  0000000                   	ENDM
 9287  0000000                   .ENDIF
 9288  0000000                   ;===============================================================================
 9289  0000000                   ;===============================================================================
 9290  0000000                   .IF (WITH_MS_CODA .EQ. 1)
 9291  0000000                   SET_START MACRO 
 9292  0000000                   	LDA <CH_DATA_ADDR_MS+MS_START
 9293  0000000                   	STA CODA_START_ADDR
 9294  0000000                   	LDA <CH_DATA_ADDR_MS+1+MS_START
 9295  0000000                   	STA CODA_START_ADDR+1
 9296  0000000                   	LDA <CH_DATA_BANK_MS+MS_START
 9297  0000000                   	STA CODA_START_BANK
 9298  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 9299  0000000                   		LDA <CH_DATA_BANK1_MS+MS_START
 9300  0000000                   		STA CODA_START_BANK1
 9301  0000000                   	.ENDIF
 9302  0000000                   	ENDM 
 9303  0000000                   ;----------------------------------------------------------------
 9304  0000000                   GOTO_START MACRO 
 9305  0000000                   	EXTERN MIDI_NOTE_OFF_API
 9306  0000000                   	PSF_RESPONSE_LIMIT_JSR MIDI_NOTE_OFF_API
 9307  0000000                   
 9308  0000000                   	LDA CODA_START_ADDR
 9309  0000000                   	STA <CH_DATA_ADDR_MS+MS_START
 9310  0000000                   	LDA CODA_START_ADDR+1
 9311  0000000                   	STA <CH_DATA_ADDR_MS+1+MS_START
 9312  0000000                   	LDA CODA_START_BANK
 9313  0000000                   	STA <CH_DATA_BANK_MS+MS_START
 9314  0000000                   	.IF (WITH_EXT64M_SPI .EQ. 1H)
 9315  0000000                   		LDA CODA_START_BANK1
 9316  0000000                   		STA <CH_DATA_BANK1_MS+MS_START
 9317  0000000                   	.ENDIF
 9318  0000000                   	ENDM 	
 9319  0000000                   .ENDIF
 9320  0000000                   
 9321  0000000                   ;===============================================================================
 9322  0000000                   ;===============================================================================
 9323  0000000                   .IF (WITH_SP_SKIP .EQ. 1)	
 9324  0000000                   SET_PLAY_SEGMENT_CH MACRO CHANNEL_ID,INDEX
 9325  0000000                   	LDY #CHANNEL_ID-1
 9326  0000000                   	EXTERN SPEECH_PLAY_SEGMENT_ENABLE_TABLE
 9327  0000000                   	LDA !SPEECH_PLAY_SEGMENT_ENABLE_TABLE,Y
 9328  0000000                   	BEQ END_SET_PLAY_SEGMENT_CH#
 9329  0000000                   
 9330  0000000                   	LDA #INDEX
 9331  0000000                   	STA CH|CHANNEL_ID|_PLAY_SEGMENT
 9332  0000000                   
 9333  0000000                   	EXTERN GOTO_PLAY_SEGMENT
 9334  0000000                   	PSF_RESPONSE_LIMIT_JSR GOTO_PLAY_SEGMENT
 9335  0000000                   END_SET_PLAY_SEGMENT_CH#:
 9336  0000000                   ENDM
 9337  0000000                   ;----------------------------------------------------------------	





 9338  0000000                   SET_PLAY_SEGMENT_CH_RAM MACRO CHANNEL_ID,INDEX_RAM
 9339  0000000                   	LDY #CHANNEL_ID-1
 9340  0000000                   	EXTERN SPEECH_PLAY_SEGMENT_ENABLE_TABLE
 9341  0000000                   	LDA !SPEECH_PLAY_SEGMENT_ENABLE_TABLE,Y
 9342  0000000                   	BEQ END_SET_PLAY_SEGMENT_CH_RAM#
 9343  0000000                   
 9344  0000000                   	LDA INDEX_RAM
 9345  0000000                   	STA CH|CHANNEL_ID|_PLAY_SEGMENT
 9346  0000000                   
 9347  0000000                   	EXTERN GOTO_PLAY_SEGMENT
 9348  0000000                   	PSF_RESPONSE_LIMIT_JSR GOTO_PLAY_SEGMENT
 9349  0000000                   END_SET_PLAY_SEGMENT_CH_RAM#:
 9350  0000000                   ENDM
 9351  0000000                   ;----------------------------------------------------------------		
 9352  0000000                   .IF (WITH_SP_NUM .GT. 0)
 9353  0000000                   SET_PLAY_SEGMENT_CH1 MACRO INDEX
 9354  0000000                   	SET_PLAY_SEGMENT_CH 1,INDEX
 9355  0000000                   ENDM
 9356  0000000                   .ENDIF
 9357  0000000                   ;----------------------------------------------------------------
 9358  0000000                   .IF (WITH_SP_NUM .GT. 1)
 9359  0000000                   SET_PLAY_SEGMENT_CH2 MACRO INDEX
 9360  0000000                   	SET_PLAY_SEGMENT_CH 2,INDEX
 9361  0000000                   ENDM
 9362  0000000                   .ENDIF
 9363  0000000                   ;----------------------------------------------------------------
 9364  0000000                   .IF (WITH_SP_NUM .GT. 2)
 9365  0000000                   SET_PLAY_SEGMENT_CH3 MACRO INDEX
 9366  0000000                   	SET_PLAY_SEGMENT_CH 3,INDEX
 9367  0000000                   ENDM
 9368  0000000                   .ENDIF
 9369  0000000                   ;----------------------------------------------------------------		
 9370  0000000                   .IF (WITH_SP_NUM .GT. 0)
 9371  0000000                   SET_PLAY_SEGMENT_CH1_RAM MACRO INDEX_RAM
 9372  0000000                   	SET_PLAY_SEGMENT_CH_RAM 1,INDEX_RAM
 9373  0000000                   ENDM
 9374  0000000                   .ENDIF
 9375  0000000                   ;----------------------------------------------------------------
 9376  0000000                   .IF (WITH_SP_NUM .GT. 1)
 9377  0000000                   SET_PLAY_SEGMENT_CH2_RAM MACRO INDEX_RAM
 9378  0000000                   	SET_PLAY_SEGMENT_CH_RAM 2,INDEX_RAM
 9379  0000000                   ENDM
 9380  0000000                   .ENDIF
 9381  0000000                   ;----------------------------------------------------------------
 9382  0000000                   .IF (WITH_SP_NUM .GT. 2)
 9383  0000000                   SET_PLAY_SEGMENT_CH3_RAM MACRO INDEX_RAM
 9384  0000000                   	SET_PLAY_SEGMENT_CH_RAM 3,INDEX_RAM
 9385  0000000                   ENDM
 9386  0000000                   .ENDIF
 9387  0000000                   .ENDIF
 9388  0000000                   ;==============================================================================
 9389  0000000                   ; Set TMC/TMV of specified speech channel.
 9390  0000000                   ;==============================================================================
 9391  0000000                   SET_SP_SR_HZ_Y MACRO NEW_TMC,NEW_TMV
 9392  0000000                   	.IF (WITH_SP .EQ. 1H)
 9393  0000000                   	.IF (WITH_SP_GLOBAL_SR .EQ. 1H)
 9394  0000000                   		EXTERN 	SPEECH_GLOBAL_SR_TMC_TABLE





 9395  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y
 9396  0000000                   		LDA CH1_GLOBAL_TMC,X
 9397  0000000                   		AND #GLOBAL_SR_FLAG
 9398  0000000                   		ORA #NEW_TMC
 9399  0000000                   		STA CH1_GLOBAL_TMC,X
 9400  0000000                   		LDA #NEW_TMV
 9401  0000000                   		STA CH1_GLOBAL_TMV,X
 9402  0000000                   
 9403  0000000                   		EXTERN SET_SP_SR_HZ_PROC
 9404  0000000                   		PSF_RESPONSE_LIMIT_JSR SET_SP_SR_HZ_PROC
 9405  0000000                   	.ELSE
 9406  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 9407  0000000                   		LDA <CH_STATUS_SP,X
 9408  0000000                   		BIT #SP_BZ 
 9409  0000000                   		BNE 3
 9410  0000000                   		JMP SET_SP_SR_HZ_Y_END_#
 9411  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR)
 9412  0000000                   		BEQ 3
 9413  0000000                   		JMP SET_SP_SR_HZ_Y_END_#
 9414  0000000                   
 9415  0000000                   		PSF_RESPONSE_LIMIT
 9416  0000000                   		STORE_SW_CS
 9417  0000000                   		LDA   !BANK
 9418  0000000                   	     	PHA
 9419  0000000                   ;		LDA <TEMP_REG1
 9420  0000000                   ;		PHA
 9421  0000000                   ;	    	LDA <TEMP_REG1+1
 9422  0000000                   ;		PHA
 9423  0000000                   ;		LDA <TEMP_REG2
 9424  0000000                   ;		PHA
 9425  0000000                   ;	   	LDA <TEMP_REG2+1
 9426  0000000                   ;		PHA
 9427  0000000                   
 9428  0000000                   		SET_SENTENCE_BANK1 CH_DATA_BANK_SP
 9429  0000000                   ;-------- REWIND CH_DATA_ADDR/BANK -------------------
 9430  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP,X
 9431  0000000                   		STA <TEMP_REG1
 9432  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP+1,X
 9433  0000000                   		STA <TEMP_REG1+1
 9434  0000000                   		LDA <CH_SENTENCE_START_BANK_SP,X
 9435  0000000                   		STA <TEMP_REG2
 9436  0000000                   
 9437  0000000                   		LDA_DP_ILI_SIM TEMP_REG1
 9438  0000000                   		AND #38H
 9439  0000000                   		.IF (WITH_SIL .EQ. 1)
 9440  0000000                   		CMP #RESTYPE_SIL<<3
 9441  0000000                   		BNE 3 
 9442  0000000                   		JMP SET_SP_SR_HZ_Y_CHANGE_END_#
 9443  0000000                   		.ENDIF
 9444  0000000                   		.IF (WITH_VC4 .EQ. 1)
 9445  0000000                   		CMP #RESTYPE_VC4<<3
 9446  0000000                   		BNE 3 
 9447  0000000                   		JMP SET_SP_SR_HZ_Y_CHANGE_END_#
 9448  0000000                   		.ENDIF
 9449  0000000                   
 9450  0000000                   		.IF (WITH_NM4S .EQ. 1)
 9451  0000000                   		CMP #RESTYPE_NM4S<<3





 9452  0000000                   		BEQ SET_SP_SR_HZ_2#
 9453  0000000                   		.ENDIF
 9454  0000000                   		.IF (WITH_NM4 .EQ. 1)
 9455  0000000                   		CMP #RESTYPE_NM4<<3
 9456  0000000                   		BEQ SET_SP_SR_HZ_2#
 9457  0000000                   		.ENDIF
 9458  0000000                   
 9459  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 9460  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9461  0000000                   		EXTERN SP_STZ_TMC_PROC_TABLE
 9462  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 9463  0000000                   		EXTERN SP_SET_TMC_PROC_TABLE
 9464  0000000                   		PHP
 9465  0000000                   		SEI
 9466  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9467  0000000                   		LDA #NEW_TMV
 9468  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9469  0000000                   SET_SP_SR_HZ_TMC#:
 9470  0000000                   		LDA #NEW_TMC
 9471  0000000                   		AND #07H
 9472  0000000                   		ASL A
 9473  0000000                   		ORA #01H
 9474  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9475  0000000                   		PLP
 9476  0000000                   		BRA SET_SP_SR_HZ_Y_CHANGE_END_#
 9477  0000000                   
 9478  0000000                   SET_SP_SR_HZ_2#:
 9479  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9480  0000000                   		PHP
 9481  0000000                   		SEI
 9482  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9483  0000000                   		LDA #NEW_TMV
 9484  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9485  0000000                   		LDA #NEW_TMC
 9486  0000000                   		AND #38H
 9487  0000000                   		CMP #38H
 9488  0000000                   		BNE SET_SP_SR_HZ_2_NOTDIV2#
 9489  0000000                   SET_SP_SR_HZ_2_DIV2#:	
 9490  0000000                   		LDA #NEW_TMV
 9491  0000000                   		LSR A
 9492  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9493  0000000                   		BRA SET_SP_SR_HZ_TMC#
 9494  0000000                   
 9495  0000000                   SET_SP_SR_HZ_2_NOTDIV2#:
 9496  0000000                   		LSR A
 9497  0000000                   		LSR A
 9498  0000000                   		ORA #01H
 9499  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9500  0000000                   		PLP
 9501  0000000                   
 9502  0000000                   SET_SP_SR_HZ_Y_CHANGE_END_#:		
 9503  0000000                   ;		PLA 
 9504  0000000                   ;		STA <TEMP_REG2+1
 9505  0000000                   ;		PLA 
 9506  0000000                   ;		STA <TEMP_REG2
 9507  0000000                   ;		PLA 
 9508  0000000                   ;		STA <TEMP_REG1+1





 9509  0000000                   ;		PLA 
 9510  0000000                   ;		STA <TEMP_REG1
 9511  0000000                   		PLA
 9512  0000000                   	     	STA   !BANK
 9513  0000000                   	     	RELOAD_SW_CS
 9514  0000000                   	     	PSF_RESPONSE_LIMIT_RELEASE
 9515  0000000                   
 9516  0000000                   SET_SP_SR_HZ_Y_END_#:
 9517  0000000                   	.ENDIF
 9518  0000000                   	.ENDIF
 9519  0000000                   	ENDM
 9520  0000000                   ;------------------------------------------------------------------------------
 9521  0000000                   SET_SP_SR_HZ MACRO NEW_TMC,NEW_TMV,CHANNEL_ID
 9522  0000000                   	.IF (WITH_SP .EQ. 1H)
 9523  0000000                   		LDY #CHANNEL_ID
 9524  0000000                   		SET_SP_SR_HZ_Y NEW_TMC,NEW_TMV
 9525  0000000                   	.ENDIF
 9526  0000000                   	ENDM
 9527  0000000                   ;------------------------------------------------------------------------------
 9528  0000000                   .IF (WITH_SP .EQ. 1)
 9529  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9530  0000000                   SET_SR1_HZ MACRO NEW_TMC,NEW_TMV
 9531  0000000                   	SET_SP_SR_HZ NEW_TMC,NEW_TMV, 00H 
 9532  0000000                   ENDM		
 9533  0000000                   	.ENDIF
 9534  0000000                   ;------------------------------------------------------------------------------
 9535  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9536  0000000                   SET_SR2_HZ MACRO NEW_TMC,NEW_TMV
 9537  0000000                   	SET_SP_SR_HZ NEW_TMC,NEW_TMV, 01H
 9538  0000000                   ENDM		
 9539  0000000                   	.ENDIF
 9540  0000000                   ;------------------------------------------------------------------------------
 9541  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9542  0000000                   SET_SR3_HZ MACRO NEW_TMC,NEW_TMV
 9543  0000000                   	SET_SP_SR_HZ NEW_TMC,NEW_TMV, 02H
 9544  0000000                   ENDM
 9545  0000000                   	.ENDIF	
 9546  0000000                   .ENDIF	
 9547  0000000                   ;==============================================================================
 9548  0000000                   SET_SP_SR_HZ_Y_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9549  0000000                   	.IF (WITH_SP .EQ. 1H)
 9550  0000000                   	.IF (WITH_SP_GLOBAL_SR .EQ. 1H)
 9551  0000000                   		EXTERN 	SPEECH_GLOBAL_SR_TMC_TABLE
 9552  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y
 9553  0000000                   		LDA CH1_GLOBAL_TMC,X
 9554  0000000                   		AND #GLOBAL_SR_FLAG
 9555  0000000                   		ORA NEW_TMC_RAM
 9556  0000000                   		STA CH1_GLOBAL_TMC,X
 9557  0000000                   		LDA NEW_TMV_RAM
 9558  0000000                   		STA CH1_GLOBAL_TMV,X
 9559  0000000                   
 9560  0000000                   		EXTERN SET_SP_SR_HZ_PROC
 9561  0000000                   		PSF_RESPONSE_LIMIT_JSR SET_SP_SR_HZ_PROC
 9562  0000000                   	.ELSE
 9563  0000000                   
 9564  0000000                   		LDX !SP_CHANNEL_ADDR_TABLE,Y
 9565  0000000                   		LDA <CH_STATUS_SP,X





 9566  0000000                   		BIT #SP_BZ 
 9567  0000000                   		BNE 3
 9568  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_END_#
 9569  0000000                   		BIT #(SP_DC_RAMP_UP_FOR_MS+SP_ADSR)
 9570  0000000                   		BEQ 3
 9571  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_END_#
 9572  0000000                   
 9573  0000000                   		PSF_RESPONSE_LIMIT
 9574  0000000                   		STORE_SW_CS
 9575  0000000                   		LDA   !BANK
 9576  0000000                   	     	PHA
 9577  0000000                   ;		LDA <TEMP_REG1
 9578  0000000                   ;		PHA
 9579  0000000                   ;	    	LDA <TEMP_REG1+1
 9580  0000000                   ;		PHA
 9581  0000000                   ;		LDA <TEMP_REG2
 9582  0000000                   ;		PHA
 9583  0000000                   ;	   	LDA <TEMP_REG2+1
 9584  0000000                   ;		PHA
 9585  0000000                   
 9586  0000000                   		SET_SENTENCE_BANK1 CH_DATA_BANK_SP
 9587  0000000                   ;-------- REWIND CH_DATA_ADDR/BANK -------------------
 9588  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP,X
 9589  0000000                   		STA <TEMP_REG1
 9590  0000000                   		LDA <CH_SENTENCE_START_ADDR_SP+1,X
 9591  0000000                   		STA <TEMP_REG1+1
 9592  0000000                   		LDA <CH_SENTENCE_START_BANK_SP,X
 9593  0000000                   		STA <TEMP_REG2
 9594  0000000                   
 9595  0000000                   		LDA_DP_ILI_SIM TEMP_REG1
 9596  0000000                   		AND #38H
 9597  0000000                   		.IF (WITH_SIL .EQ. 1)
 9598  0000000                   		CMP #RESTYPE_SIL<<3
 9599  0000000                   		BNE 3 
 9600  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_CHANGE_END_#
 9601  0000000                   		.ENDIF
 9602  0000000                   		.IF (WITH_VC4 .EQ. 1)
 9603  0000000                   		CMP #RESTYPE_VC4<<3
 9604  0000000                   		BNE 3 
 9605  0000000                   		JMP SET_SP_SR_HZ_Y_RAM_CHANGE_END_#
 9606  0000000                   		.ENDIF
 9607  0000000                   
 9608  0000000                   		.IF (WITH_NM4S .EQ. 1)
 9609  0000000                   		CMP #RESTYPE_NM4S<<3
 9610  0000000                   		BEQ SET_SP_SR_HZ_RAM_2#
 9611  0000000                   		.ENDIF
 9612  0000000                   		.IF (WITH_NM4 .EQ. 1)
 9613  0000000                   		CMP #RESTYPE_NM4<<3
 9614  0000000                   		BEQ SET_SP_SR_HZ_RAM_2#
 9615  0000000                   		.ENDIF
 9616  0000000                   
 9617  0000000                   		EXTERN SP_CHANNEL_ID_TABLE_2
 9618  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9619  0000000                   		EXTERN SP_STZ_TMC_PROC_TABLE
 9620  0000000                   		EXTERN SP_SET_TMV_PROC_TABLE
 9621  0000000                   		EXTERN SP_SET_TMC_PROC_TABLE
 9622  0000000                   		PHP





 9623  0000000                   		SEI
 9624  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9625  0000000                   		LDA NEW_TMV_RAM
 9626  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9627  0000000                   SET_SP_SR_HZ_RAM_TMC#:
 9628  0000000                   		LDA NEW_TMC_RAM
 9629  0000000                   		AND #07H
 9630  0000000                   		ASL A
 9631  0000000                   		ORA #01H
 9632  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9633  0000000                   		PLP
 9634  0000000                   		BRA SET_SP_SR_HZ_Y_RAM_CHANGE_END_#
 9635  0000000                   
 9636  0000000                   SET_SP_SR_HZ_RAM_2#:
 9637  0000000                   		LDX !SP_CHANNEL_ID_TABLE_2, Y
 9638  0000000                   		PHP
 9639  0000000                   		SEI
 9640  0000000                   		JSR_AII_X SP_STZ_TMC_PROC_TABLE
 9641  0000000                   		LDA NEW_TMV_RAM
 9642  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9643  0000000                   		LDA NEW_TMC_RAM
 9644  0000000                   		AND #38H
 9645  0000000                   		CMP #38H
 9646  0000000                   		BNE SET_SP_SR_HZ_RAM_2_NOTDIV2#
 9647  0000000                   SET_SP_SR_HZ_RAM_2_DIV2#:	
 9648  0000000                   		LDA NEW_TMV_RAM
 9649  0000000                   		LSR A
 9650  0000000                   		JSR_AII_X_SA SP_SET_TMV_PROC_TABLE,TEMP_REG1
 9651  0000000                   		BRA SET_SP_SR_HZ_RAM_TMC#
 9652  0000000                   
 9653  0000000                   SET_SP_SR_HZ_RAM_2_NOTDIV2#:
 9654  0000000                   		LSR A
 9655  0000000                   		LSR A
 9656  0000000                   		ORA #01H
 9657  0000000                   		JSR_AII_X_SA SP_SET_TMC_PROC_TABLE,TEMP_REG1
 9658  0000000                   		PLP
 9659  0000000                   
 9660  0000000                   SET_SP_SR_HZ_Y_RAM_CHANGE_END_#:		
 9661  0000000                   ;		PLA 
 9662  0000000                   ;		STA <TEMP_REG2+1
 9663  0000000                   ;		PLA 
 9664  0000000                   ;		STA <TEMP_REG2
 9665  0000000                   ;		PLA 
 9666  0000000                   ;		STA <TEMP_REG1+1
 9667  0000000                   ;		PLA 
 9668  0000000                   ;		STA <TEMP_REG1
 9669  0000000                   		PLA
 9670  0000000                   	     	STA   !BANK
 9671  0000000                   	     	RELOAD_SW_CS
 9672  0000000                   	     	PSF_RESPONSE_LIMIT_RELEASE
 9673  0000000                   
 9674  0000000                   SET_SP_SR_HZ_Y_RAM_END_#:
 9675  0000000                   	.ENDIF
 9676  0000000                   	.ENDIF
 9677  0000000                   	ENDM
 9678  0000000                   ;------------------------------------------------------------------------------
 9679  0000000                   SET_SP_SR_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM,CHANNEL_ID





 9680  0000000                   	.IF (WITH_SP .EQ. 1H)
 9681  0000000                   		LDY #CHANNEL_ID
 9682  0000000                   		SET_SP_SR_HZ_Y_RAM NEW_TMC_RAM,NEW_TMV_RAM
 9683  0000000                   	.ENDIF
 9684  0000000                   	ENDM
 9685  0000000                   ;------------------------------------------------------------------------------
 9686  0000000                   .IF (WITH_SP .EQ. 1)
 9687  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9688  0000000                   SET_SR1_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9689  0000000                   	SET_SP_SR_HZ_RAM NEW_TMC_RAM,NEW_TMV_RAM, 00H
 9690  0000000                   ENDM		
 9691  0000000                   	.ENDIF
 9692  0000000                   ;------------------------------------------------------------------------------
 9693  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9694  0000000                   SET_SR2_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9695  0000000                   	SET_SP_SR_HZ_RAM NEW_TMC_RAM,NEW_TMV_RAM, 01H
 9696  0000000                   ENDM		
 9697  0000000                   	.ENDIF
 9698  0000000                   ;------------------------------------------------------------------------------
 9699  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9700  0000000                   SET_SR3_HZ_RAM MACRO NEW_TMC_RAM,NEW_TMV_RAM
 9701  0000000                   	SET_SP_SR_HZ_RAM NEW_TMC_RAM,NEW_TMV_RAM, 02H
 9702  0000000                   ENDM		
 9703  0000000                   	.ENDIF
 9704  0000000                   .ENDIF
 9705  0000000                   ;==============================================================================
 9706  0000000                   ;==============================================================================
 9707  0000000                   DIS_SP_EQU_SR_Y MACRO                                                         
 9708  0000000                   	.IF(WITH_SP .EQ. 1H)  
 9709  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)  
 9710  0000000                   		EXTERN 	SPEECH_GLOBAL_SR_TMC_TABLE                                                                                          
 9711  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y                                  
 9712  0000000                   		LDA CH1_GLOBAL_TMC,X                                                        
 9713  0000000                   		ORA #GLOBAL_SR_FLAG                                                     
 9714  0000000                   		STA CH1_GLOBAL_TMC,X                                                        
 9715  0000000                   
 9716  0000000                   DIS_SP_EQU_SR_Y_END_#:
 9717  0000000                   	.ENDIF    
 9718  0000000                   	.ENDIF                                                                 
 9719  0000000                   ENDM   
 9720  0000000                   ;------------------------------------------------------------------------------
 9721  0000000                   DIS_SP_EQU_SR MACRO CHANNEL
 9722  0000000                   	.IF(WITH_SP .EQ. 1H) 
 9723  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)  
 9724  0000000                   		LDY #CHANNEL
 9725  0000000                   		DIS_SP_EQU_SR_Y 
 9726  0000000                   	.ENDIF
 9727  0000000                   	.ENDIF       
 9728  0000000                   ENDM
 9729  0000000                   ;------------------------------------------------------------------------------
 9730  0000000                   .IF (WITH_SP .EQ. 1)
 9731  0000000                   .IF(WITH_SP_GLOBAL_SR .EQ. 1H)  
 9732  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9733  0000000                   EN_GLOBALSR_SR1 MACRO
 9734  0000000                   	DIS_SP_EQU_SR 00H
 9735  0000000                   ENDM
 9736  0000000                   	.ENDIF





 9737  0000000                   ;------------------------------------------------------------------------------
 9738  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9739  0000000                   EN_GLOBALSR_SR2 MACRO
 9740  0000000                   	DIS_SP_EQU_SR 01H
 9741  0000000                   ENDM
 9742  0000000                   	.ENDIF
 9743  0000000                   ;------------------------------------------------------------------------------	
 9744  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9745  0000000                   EN_GLOBALSR_SR3 MACRO
 9746  0000000                   	DIS_SP_EQU_SR 02H
 9747  0000000                   ENDM
 9748  0000000                   	.ENDIF
 9749  0000000                   .ENDIF
 9750  0000000                   .ENDIF  		                                                                       
 9751  0000000                   ;==============================================================================
 9752  0000000                   EN_SP_EQU_SR_Y MACRO                                                          
 9753  0000000                   	.IF(WITH_SP .EQ. 1H) 
 9754  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)
 9755  0000000                   		EXTERN SPEECH_GLOBAL_SR_TMC_TABLE                                                                                      
 9756  0000000                   		LDX !SPEECH_GLOBAL_SR_TMC_TABLE,Y                                  
 9757  0000000                   		LDA CH1_GLOBAL_TMC,X                                                        
 9758  0000000                   		AND #(FFH^GLOBAL_SR_FLAG)                                                    
 9759  0000000                   		STA CH1_GLOBAL_TMC,X                                                                                                                   
 9760  0000000                   	.ENDIF  
 9761  0000000                   	.ENDIF                                                                
 9762  0000000                   ENDM	
 9763  0000000                   ;------------------------------------------------------------------------------	
 9764  0000000                   EN_SP_EQU_SR MACRO CHANNEL
 9765  0000000                   	.IF(WITH_SP .EQ. 1H)
 9766  0000000                   	.IF(WITH_SP_GLOBAL_SR .EQ. 1H)
 9767  0000000                   		LDY #CHANNEL
 9768  0000000                   		EN_SP_EQU_SR_Y
 9769  0000000                   	.ENDIF 
 9770  0000000                   	.ENDIF 
 9771  0000000                   ENDM
 9772  0000000                   ;------------------------------------------------------------------------------	
 9773  0000000                   .IF (WITH_SP .EQ. 1)
 9774  0000000                   .IF(WITH_SP_GLOBAL_SR .EQ. 1H)
 9775  0000000                   	.IF (WITH_SP_NUM .GT. 0)
 9776  0000000                   DIS_GLOBALSR_SR1 MACRO
 9777  0000000                   	EN_SP_EQU_SR 00H	
 9778  0000000                   ENDM
 9779  0000000                   	.ENDIF
 9780  0000000                   ;------------------------------------------------------------------------------
 9781  0000000                   	.IF (WITH_SP_NUM .GT. 1)
 9782  0000000                   DIS_GLOBALSR_SR2 MACRO
 9783  0000000                   	EN_SP_EQU_SR 01H
 9784  0000000                   ENDM
 9785  0000000                   	.ENDIF
 9786  0000000                   ;------------------------------------------------------------------------------
 9787  0000000                   	.IF (WITH_SP_NUM .GT. 2)
 9788  0000000                   DIS_GLOBALSR_SR3 MACRO
 9789  0000000                   	EN_SP_EQU_SR 02H
 9790  0000000                   ENDM
 9791  0000000                   	.ENDIF
 9792  0000000                   .ENDIF 
 9793  0000000                   .ENDIF                                                                                                                                                                                                                                                                                                                                                 





 9794  0000000                   ;update by angela for en/dis GLOBALSR feature
 9795  0000000                   ;===============================================================================
 9796  0000000                   ;===============================================================================
 9797  0000000                   .IF (N55P_DEVICE_NUM .GT. 0H)
 9798  0000000                   	EXTERN N55P_X0_INIT_PIN
 9799  0000000                   	EXTERN N55P_X0_ON
 9800  0000000                   	EXTERN N55P_X0_OFF
 9801  0000000                   	EXTERN N55P_X0_MISO
 9802  0000000                   	EXTERN N55P_X0_MOSI
 9803  0000000                   ;--------------------------------------------------------	
 9804  0000000                   N55P_INIT MACRO 
 9805  0000000                   	JSR N55P_X0_INIT_PIN
 9806  0000000                   	ENDM
 9807  0000000                   ;--------------------------------------------------------
 9808  0000000                   N55P_COMMAND_WRITE_CONST MACRO COMMAND,DATA
 9809  0000000                   	JSR N55P_X0_ON
 9810  0000000                   	LDA #COMMAND+80H
 9811  0000000                   	JSR N55P_X0_MOSI
 9812  0000000                   	LDA #DATA
 9813  0000000                   	JSR N55P_X0_MOSI
 9814  0000000                   	JSR N55P_X0_OFF
 9815  0000000                   	ENDM
 9816  0000000                   ;--------------------------------------------------------
 9817  0000000                   N55P_COMMAND_WRITE_RAM MACRO COMMAND,DATA_ADDR
 9818  0000000                   	JSR N55P_X0_ON
 9819  0000000                   	LDA #COMMAND+80H
 9820  0000000                   	JSR N55P_X0_MOSI
 9821  0000000                   	LDA DATA_ADDR
 9822  0000000                   	JSR N55P_X0_MOSI
 9823  0000000                   	JSR N55P_X0_OFF
 9824  0000000                   	ENDM
 9825  0000000                   ;--------------------------------------------------------
 9826  0000000                   N55P_COMMAND_READ MACRO COMMAND
 9827  0000000                   	JSR N55P_X0_ON
 9828  0000000                   	LDA #COMMAND&7Fh
 9829  0000000                   	JSR N55P_X0_MOSI
 9830  0000000                   	JSR N55P_X0_MISO
 9831  0000000                   	JSR N55P_X0_OFF
 9832  0000000                   	TYA
 9833  0000000                   	ENDM
 9834  0000000                   ;--------------------------------------------------------
 9835  0000000                   N55P_COMMAND_READ_RAM MACRO COMMAND,RAM
 9836  0000000                   	JSR N55P_X0_ON
 9837  0000000                   	LDA #COMMAND&7Fh
 9838  0000000                   	JSR N55P_X0_MOSI
 9839  0000000                   	JSR N55P_X0_MISO
 9840  0000000                   	JSR N55P_X0_OFF
 9841  0000000                   	STY RAM
 9842  0000000                   	ENDM	
 9843  0000000                   ;--------------------------------------------------------
 9844  0000000                   N55P_COMMAND_WRITE_UPDATE MACRO ADDR,BIT_MASK,DATA
 9845  0000000                   	N55P_COMMAND_READ ADDR
 9846  0000000                   
 9847  0000000                   	PHA		
 9848  0000000                   	JSR N55P_X0_ON
 9849  0000000                   	LDA #ADDR+80H
 9850  0000000                   	JSR N55P_X0_MOSI





 9851  0000000                   	PLA
 9852  0000000                   	AND #(FFH^BIT_MASK)
 9853  0000000                   	ORA #DATA
 9854  0000000                   	JSR N55P_X0_MOSI
 9855  0000000                   	JSR N55P_X0_OFF
 9856  0000000                   	ENDM
 9857  0000000                   ;--------------------------------------------------------	
 9858  0000000                   ;--------------------------------------------------------
 9859  0000000                   N55P_DEVICE_0 MACRO
 9860  0000000                   	N55P_COMMAND_WRITE_CONST 4Ch, FFh   
 9861  0000000                   	ENDM
 9862  0000000                   ;--------------------------------------------------------	
 9863  0000000                   N55P_DEVICE_1 MACRO
 9864  0000000                   	N55P_COMMAND_WRITE_CONST 4Dh, FFh
 9865  0000000                   	ENDM
 9866  0000000                   
 9867  0000000                   ;--------------------------------------------------------
 9868  0000000                   N55P_RESET MACRO
 9869  0000000                   	N55P_COMMAND_WRITE_CONST 4Fh, FFH
 9870  0000000                   	ENDM
 9871  0000000                   ;--------------------------------------------------------	
 9872  0000000                   ;--------------------------------------------------------		
 9873  0000000                   N55P_SET_PORT_CONST_CURRENT MACRO XPORT,XPINS
 9874  0000000                   	N55P_COMMAND_WRITE_CONST P242CNST_BPA+XPORT,XPINS
 9875  0000000                   	ENDM
 9876  0000000                   ;--------------------------------------------------------
 9877  0000000                   N55P_SET_STATUS MACRO XPORT,XPORT_MASK,B_VALUE,D_VALUE,A_VALUE
 9878  0000000                   	N55P_COMMAND_WRITE_CONST P242BPA_B+XPORT,B_VALUE
 9879  0000000                   	N55P_COMMAND_WRITE_CONST P242BPA_D+XPORT,D_VALUE
 9880  0000000                   	N55P_COMMAND_WRITE_CONST P242BPA_A+XPORT,A_VALUE
 9881  0000000                   	ENDM
 9882  0000000                   ;--------------------------------------------------------
 9883  0000000                   N55P_AND_BUFFER MACRO XPORT,B_VALUE
 9884  0000000                   	N55P_COMMAND_WRITE_CONST P242AND_BPA_B+XPORT,B_VALUE
 9885  0000000                   	ENDM	
 9886  0000000                   ;--------------------------------------------------------
 9887  0000000                   N55P_AND_BUFFER_RAM MACRO XPORT,B_VALUE_RAM
 9888  0000000                   	N55P_COMMAND_WRITE_RAM P242AND_BPA_B+XPORT,B_VALUE_RAM
 9889  0000000                   	ENDM	
 9890  0000000                   ;--------------------------------------------------------
 9891  0000000                   N55P_OR_BUFFER MACRO XPORT,B_VALUE
 9892  0000000                   	N55P_COMMAND_WRITE_CONST P242OR_BPA_B+XPORT,B_VALUE
 9893  0000000                   	ENDM	
 9894  0000000                   ;--------------------------------------------------------
 9895  0000000                   N55P_OR_BUFFER_RAM MACRO XPORT,B_VALUE_RAM
 9896  0000000                   	N55P_COMMAND_WRITE_RAM P242OR_BPA_B+XPORT,B_VALUE_RAM
 9897  0000000                   	ENDM		
 9898  0000000                   ;--------------------------------------------------------
 9899  0000000                   N55P_SET_BPAB_PWM_RATE MACRO PCKAB_MASK,PCKAB_VALUE
 9900  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMCK_BPA,PCKAB_MASK,PCKAB_VALUE
 9901  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMCK_BPA,PCKAB_VALUE
 9902  0000000                   	ENDM
 9903  0000000                   ;--------------------------------------------------------
 9904  0000000                   N55P_SET_BPC_PWM_RATE MACRO PCKC_MASK,PCKC_VALUE
 9905  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMCK_BPC,PCKC_MASK,PCKC_VALUE
 9906  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMCK_BPC,PCKC_VALUE
 9907  0000000                   	ENDM





 9908  0000000                   ;--------------------------------------------------------
 9909  0000000                   N55P_EN_PWM_PIN MACRO XPORT,XPWMX	
 9910  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMEN_BPA+XPORT,XPWMX,XPWMX
 9911  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMEN_BPA+XPORT,XPWMX
 9912  0000000                   	ENDM
 9913  0000000                   ;--------------------------------------------------------
 9914  0000000                   N55P_DIS_PWM_PIN MACRO XPORT,XPWMX
 9915  0000000                   ;	N55P_COMMAND_WRITE_UPDATE P242PWMEN_BPA+XPORT,XPWMX,XPWMX
 9916  0000000                   	N55P_COMMAND_WRITE_CONST P242PWMEN_BPA+XPORT,0	
 9917  0000000                   	ENDM
 9918  0000000                   ;--------------------------------------------------------	
 9919  0000000                   ;--------------------------------------------------------
 9920  0000000                   N55P_SET_PWM_VALUE MACRO XPORT, XPWMX,VALUE
 9921  0000000                   	N55P_COMMAND_WRITE_CONST P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,VALUE
 9922  0000000                   	ENDM
 9923  0000000                   ;--------------------------------------------------------
 9924  0000000                   N55P_SET_PWM_VALUE_RAM MACRO XPORT,XPWMX_RAM,RAM
 9925  0000000                   ;	N55P_COMMAND_WRITE_RAM P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,RAM
 9926  0000000                   	JSR N55P_X0_ON
 9927  0000000                   	CLC
 9928  0000000                   	LDA #80H+P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)
 9929  0000000                   	ADC XPWMX_RAM
 9930  0000000                   	JSR N55P_X0_MOSI
 9931  0000000                   	LDA RAM
 9932  0000000                   	JSR N55P_X0_MOSI
 9933  0000000                   	JSR N55P_X0_OFF
 9934  0000000                   	ENDM
 9935  0000000                   ;--------------------------------------------------------
 9936  0000000                   N55P_SET_PWM_VALUE_RAM2 MACRO XPORT,XPWMX_RAM,VALUE
 9937  0000000                   ;	N55P_COMMAND_WRITE_RAM P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,RAM
 9938  0000000                   	JSR N55P_X0_ON
 9939  0000000                   	CLC
 9940  0000000                   	LDA #80H+P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)
 9941  0000000                   	ADC XPWMX_RAM
 9942  0000000                   	JSR N55P_X0_MOSI
 9943  0000000                   	LDA #VALUE
 9944  0000000                   	JSR N55P_X0_MOSI
 9945  0000000                   	JSR N55P_X0_OFF
 9946  0000000                   	ENDM
 9947  0000000                   ;--------------------------------------------------------
 9948  0000000                   N55P_SET_PWM_VALUE_RAM3 MACRO XPORT,XPWMX,RAM
 9949  0000000                   	N55P_COMMAND_WRITE_RAM P242PWM_BPA0+(((.LOW.XPORT)&0Fh)<<3)+XPWMX,RAM
 9950  0000000                   	ENDM
 9951  0000000                   .ENDIF
 9952  0000000                   ;--------------------------------------------------------
 9953  0000000                   N55P_EXPANDER_PROCESS_RUNTIME MACRO
 9954  0000000                   .IF (N55P_DEVICE_UIO_USED .GT. 0H)
 9955  0000000                   .IFDEF WDTIMER
 9956  0000000                   .IFDEF LVDEN
 9957  0000000                   	LDA #CTL_CPU_WDT
 9958  0000000                   	TSB RAM_CTL_CPU
 9959  0000000                   	LDA RAM_CTL_CPU
 9960  0000000                   	STA !CTL_CPU
 9961  0000000                   .ELSE
 9962  0000000                   	LDA #CTL_CPU_WDT
 9963  0000000                   	TSB !CTL_CPU
 9964  0000000                   .ENDIF 	





 9965  0000000                   .ENDIF  
 9966  0000000                   
 9967  0000000                   	EXTERN UIO_N55P_PROCESS_NEXT
 9968  0000000                   	JSR UIO_N55P_PROCESS_NEXT
 9969  0000000                   .ENDIF
 9970  0000000                   	ENDM 	
 9971  0000000                   ;--------------------------------------------------------
 9972  0000000                   N55P_EXPANDER_PROCESS MACRO 
 9973  0000000                   .IF (N55P_DEVICE_UIO_USED .GT. 0H)
 9974  0000000                   .IFDEF WDTIMER
 9975  0000000                   .IFDEF LVDEN
 9976  0000000                   	LDA #CTL_CPU_WDT
 9977  0000000                   	TSB RAM_CTL_CPU
 9978  0000000                   	LDA RAM_CTL_CPU
 9979  0000000                   	STA !CTL_CPU
 9980  0000000                   .ELSE
 9981  0000000                   	LDA #CTL_CPU_WDT
 9982  0000000                   	TSB !CTL_CPU
 9983  0000000                   .ENDIF 	
 9984  0000000                   .ENDIF   
 9985  0000000                   
 9986  0000000                   .IF (WITH_PSF_PROJECT .EQ. 1)
 9987  0000000                   .IFDEF ABANDON_STACK
 9988  0000000                   	LDA ABANDON_STACK_FLAG
 9989  0000000                   	BIT #6CH
 9990  0000000                   	BNE N55P_EXPANDER_PROCESS_END#
 9991  0000000                   .ENDIF
 9992  0000000                   .ENDIF
 9993  0000000                   	EXTERN UIO_N55P_PROCESS
 9994  0000000                   	PSF_RESPONSE_LIMIT_JSR UIO_N55P_PROCESS
 9995  0000000                   N55P_EXPANDER_PROCESS_END#:
 9996  0000000                   .ENDIF
 9997  0000000                   	ENDM
 9998  0000000                   ;===============================================================================
 9999  0000000                   ;===============================================================================
10000  0000000                   SET_PORT_FLOATING MACRO PORT_INDEX,PIN_MASK
10001  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10002  0000000                   		LDA #PIN_MASK
10003  0000000                   		TSB !BP0D	;set input
10004  0000000                   		.IFDEF       BPXM_RAM
10005  0000000                   			TRB BP0M_BAK	;set floating
10006  0000000                   			LDA !BP0D
10007  0000000                   			EOR #FFH
10008  0000000                   			AND !BP0
10009  0000000                   			ORA BP0M_BAK
10010  0000000                   			STA !BP0
10011  0000000                   		.ELSE	
10012  0000000                   			LDA !BP0
10013  0000000                   			ORA !BP0D
10014  0000000                   			AND #(FFH^ PIN_MASK)
10015  0000000                   			STA !BP0	
10016  0000000                   		.ENDIF	
10017  0000000                   	.ENDIF
10018  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10019  0000000                   		LDA #PIN_MASK
10020  0000000                   		TSB !BP1D	;set input
10021  0000000                   		.IFDEF       BPXM_RAM





10022  0000000                   			TRB BP1M_BAK	;set floating
10023  0000000                   			LDA !BP1D
10024  0000000                   			EOR #FFH
10025  0000000                   			AND !BP1
10026  0000000                   			ORA BP1M_BAK
10027  0000000                   			STA !BP1
10028  0000000                   		.ELSE	
10029  0000000                   			LDA !BP1
10030  0000000                   			ORA !BP1D
10031  0000000                   			AND #(FFH^ PIN_MASK)
10032  0000000                   			STA !BP1	
10033  0000000                   		.ENDIF	
10034  0000000                   	.ENDIF
10035  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10036  0000000                   		LDA #00H
10037  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10038  0000000                   			ORA #01H
10039  0000000                   		.ENDIF
10040  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)
10041  0000000                   			ORA #02H
10042  0000000                   		.ENDIF
10043  0000000                   		CMP !BP2D
10044  0000000                   		BEQ SET_PORT_FLOATING_BP2_NEXT#
10045  0000000                   		TSB !BP2D	;set input
10046  0000000                   		.IFDEF       BPXM_RAM
10047  0000000                   			 LDA #00H
10048  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10049  0000000                   				ORA #0FH
10050  0000000                   			.ENDIF
10051  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10052  0000000                   				ORA #F0H
10053  0000000                   			.ENDIF
10054  0000000                   			TSB BP2M_BAK	;set pull-high
10055  0000000                   SET_PORT_FLOATING_BP2_NEXT#:
10056  0000000                   			LDA #PIN_MASK
10057  0000000                   			TRB BP2M_BAK	;set floating
10058  0000000                   			LDX !BP2D
10059  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10060  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10061  0000000                   			AND !BP2
10062  0000000                   			ORA BP2M_BAK
10063  0000000                   			STA !BP2
10064  0000000                   		.ELSE
10065  0000000                   SET_PORT_FLOATING_BP2_NEXT#:	
10066  0000000                   			LDX !BP2D
10067  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10068  0000000                   			LDA !BP2
10069  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10070  0000000                   			AND #(FFH^ PIN_MASK)
10071  0000000                   			STA !BP2	
10072  0000000                   		.ENDIF	
10073  0000000                   	.ENDIF
10074  0000000                   	ENDM 	
10075  0000000                   ;--------------------------------------------------------
10076  0000000                   SET_PORT_PULL_HIGH MACRO PORT_INDEX,PIN_MASK
10077  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10078  0000000                   		LDA #PIN_MASK





10079  0000000                   		TSB !BP0D	;set input
10080  0000000                   		.IFDEF       BPXM_RAM
10081  0000000                   			TSB BP0M_BAK	;set pull-high
10082  0000000                   			LDA !BP0D
10083  0000000                   			EOR #FFH
10084  0000000                   			AND !BP0
10085  0000000                   			ORA BP0M_BAK
10086  0000000                   			STA !BP0
10087  0000000                   		.ELSE	
10088  0000000                   			LDA !BP0
10089  0000000                   			ORA !BP0D
10090  0000000                   			STA !BP0	
10091  0000000                   		.ENDIF	
10092  0000000                   	.ENDIF
10093  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10094  0000000                   		LDA #PIN_MASK
10095  0000000                   		TSB !BP1D	;set input
10096  0000000                   		.IFDEF       BPXM_RAM
10097  0000000                   			TSB BP1M_BAK	;set pull-high
10098  0000000                   			LDA !BP1D
10099  0000000                   			EOR #FFH
10100  0000000                   			AND !BP1
10101  0000000                   			ORA BP1M_BAK
10102  0000000                   			STA !BP1
10103  0000000                   		.ELSE	
10104  0000000                   			LDA !BP1
10105  0000000                   			ORA !BP1D
10106  0000000                   			STA !BP1
10107  0000000                   		.ENDIF	
10108  0000000                   	.ENDIF
10109  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10110  0000000                   		LDA #00H
10111  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10112  0000000                   			ORA #01H
10113  0000000                   		.ENDIF
10114  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)
10115  0000000                   			ORA #02H
10116  0000000                   		.ENDIF
10117  0000000                   		CMP !BP2D
10118  0000000                   		BEQ SET_PORT_PULL_HIGH_BP2_NEXT#
10119  0000000                   		TSB !BP2D	;set input
10120  0000000                   		.IFDEF       BPXM_RAM
10121  0000000                   			LDA #00H
10122  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10123  0000000                   				ORA #0FH
10124  0000000                   			.ENDIF
10125  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10126  0000000                   				ORA #F0H
10127  0000000                   			.ENDIF
10128  0000000                   			TSB BP2M_BAK	;set pull-high
10129  0000000                   SET_PORT_PULL_HIGH_BP2_NEXT#:
10130  0000000                   			LDA #PIN_MASK
10131  0000000                   			TSB BP2M_BAK	;set pull-high
10132  0000000                   			LDX !BP2D
10133  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10134  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10135  0000000                   			AND !BP2





10136  0000000                   			ORA BP2M_BAK
10137  0000000                   			STA !BP2
10138  0000000                   		.ELSE	
10139  0000000                   SET_PORT_PULL_HIGH_BP2_NEXT#:
10140  0000000                   			LDX !BP2D
10141  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10142  0000000                   			LDA !BP2
10143  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10144  0000000                   			ORA #PIN_MASK
10145  0000000                   			STA !BP2	
10146  0000000                   		.ENDIF	
10147  0000000                   	.ENDIF
10148  0000000                   	ENDM 	
10149  0000000                   ;--------------------------------------------------------
10150  0000000                   SET_PORT_OUTPUT_0  MACRO PORT_INDEX,PIN_MASK
10151  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10152  0000000                   		LDA #PIN_MASK
10153  0000000                   		TRB !BP0D	;set output
10154  0000000                   		.IFDEF       BPXM_RAM
10155  0000000                   			TRB BP0M_BAK
10156  0000000                   			LDA !BP0D
10157  0000000                   			EOR #FFH
10158  0000000                   			AND !BP0
10159  0000000                   			ORA BP0M_BAK
10160  0000000                   			AND #(FFH^ PIN_MASK)
10161  0000000                   			STA !BP0
10162  0000000                   		.ELSE	
10163  0000000                   			LDA !BP0
10164  0000000                   			AND #(FFH^ PIN_MASK)
10165  0000000                   			ORA !BP0D
10166  0000000                   			STA !BP0	
10167  0000000                   		.ENDIF	
10168  0000000                   	.ENDIF
10169  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10170  0000000                   		LDA #PIN_MASK
10171  0000000                   		TRB !BP1D	;set output
10172  0000000                   		.IFDEF       BPXM_RAM
10173  0000000                   			TRB BP1M_BAK
10174  0000000                   			LDA !BP1D
10175  0000000                   			EOR #FFH
10176  0000000                   			AND !BP1
10177  0000000                   			ORA BP1M_BAK
10178  0000000                   			AND #(FFH^ PIN_MASK)
10179  0000000                   			STA !BP1
10180  0000000                   		.ELSE	
10181  0000000                   			LDA !BP1
10182  0000000                   			AND #(FFH^ PIN_MASK)
10183  0000000                   			ORA !BP1D
10184  0000000                   			STA !BP1	
10185  0000000                   		.ENDIF	
10186  0000000                   	.ENDIF
10187  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10188  0000000                   		LDA #00H
10189  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10190  0000000                   			ORA #01H
10191  0000000                   		.ENDIF
10192  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)





10193  0000000                   			ORA #02H
10194  0000000                   		.ENDIF
10195  0000000                   		TRB !BP2D	;set output
10196  0000000                   		.IFDEF       BPXM_RAM
10197  0000000                   			LDA #00H
10198  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10199  0000000                   				ORA #0FH
10200  0000000                   			.ENDIF
10201  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10202  0000000                   				ORA #F0H
10203  0000000                   			.ENDIF
10204  0000000                   			TRB BP2M_BAK
10205  0000000                   			LDX !BP2D
10206  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10207  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10208  0000000                   			AND !BP2
10209  0000000                   			ORA BP2M_BAK
10210  0000000                   			AND #(FFH^ PIN_MASK)
10211  0000000                   			STA !BP2
10212  0000000                   		.ELSE	
10213  0000000                   			LDX !BP2D
10214  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10215  0000000                   			LDA !BP2
10216  0000000                   			AND #(FFH^ PIN_MASK)
10217  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10218  0000000                   			STA !BP2	
10219  0000000                   		.ENDIF	
10220  0000000                   	.ENDIF
10221  0000000                   	ENDM 	
10222  0000000                   ;--------------------------------------------------------
10223  0000000                   SET_PORT_OUTPUT_1  MACRO PORT_INDEX,PIN_MASK
10224  0000000                   	.IF	 (PORT_INDEX .EQ. 0)
10225  0000000                   		LDA #PIN_MASK
10226  0000000                   		TRB !BP0D	;set output
10227  0000000                   		.IFDEF       BPXM_RAM
10228  0000000                   			TRB BP0M_BAK
10229  0000000                   			LDA !BP0D
10230  0000000                   			EOR #FFH
10231  0000000                   			AND !BP0
10232  0000000                   			ORA #PIN_MASK
10233  0000000                   			ORA BP0M_BAK
10234  0000000                   			STA !BP0
10235  0000000                   		.ELSE	
10236  0000000                   			LDA !BP0
10237  0000000                   			ORA #PIN_MASK
10238  0000000                   			ORA !BP0D
10239  0000000                   			STA !BP0	
10240  0000000                   		.ENDIF	
10241  0000000                   	.ENDIF
10242  0000000                   	.IF	 (PORT_INDEX .EQ. 1)
10243  0000000                   		LDA #PIN_MASK
10244  0000000                   		TRB !BP1D	;set output
10245  0000000                   		.IFDEF       BPXM_RAM
10246  0000000                   			TRB BP1M_BAK	
10247  0000000                   			LDA !BP1D
10248  0000000                   			EOR #FFH
10249  0000000                   			AND !BP1





10250  0000000                   			ORA #PIN_MASK
10251  0000000                   			ORA BP1M_BAK
10252  0000000                   			STA !BP1
10253  0000000                   		.ELSE	
10254  0000000                   			LDA !BP1
10255  0000000                   			ORA #PIN_MASK
10256  0000000                   			ORA !BP1D
10257  0000000                   			STA !BP1
10258  0000000                   		.ENDIF	
10259  0000000                   	.ENDIF
10260  0000000                   	.IF	 (PORT_INDEX .EQ. 2)
10261  0000000                   		LDA #00H
10262  0000000                   		.IF	 ((PIN_MASK&0Fh).GT. 0H)
10263  0000000                   			ORA #01H
10264  0000000                   		.ENDIF
10265  0000000                   		.IF	 ((PIN_MASK&F0h).GT. 0H)
10266  0000000                   			ORA #02H
10267  0000000                   		.ENDIF
10268  0000000                   		TRB !BP2D	;set output
10269  0000000                   		.IFDEF       BPXM_RAM
10270  0000000                   			LDA #00H
10271  0000000                   			.IF	 ((PIN_MASK&0Fh).GT. 0H)
10272  0000000                   				ORA #0FH
10273  0000000                   			.ENDIF
10274  0000000                   			.IF	 ((PIN_MASK&F0h).GT. 0H)
10275  0000000                   				ORA #F0H
10276  0000000                   			.ENDIF
10277  0000000                   			TRB BP2M_BAK
10278  0000000                   			LDX !BP2D
10279  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10280  0000000                   			LDA !BP2D_OUTPUT_TABLE,X
10281  0000000                   			AND !BP2
10282  0000000                   			ORA #PIN_MASK
10283  0000000                   			ORA BP2M_BAK
10284  0000000                   			STA !BP2
10285  0000000                   		.ELSE	
10286  0000000                   			LDX !BP2D
10287  0000000                   			EXTERN BP2D_OUTPUT_TABLE
10288  0000000                   			LDA !BP2
10289  0000000                   			ORA !BP2D_OUTPUT_TABLE,X
10290  0000000                   			ORA #PIN_MASK
10291  0000000                   			STA !BP2	
10292  0000000                   		.ENDIF	
10293  0000000                   	.ENDIF
10294  0000000                   	ENDM 	
10295  0000000                   ;--------------------------------------------------------
10296  0000000                   ;===============================================================================
10297  0000000                   ;===============================================================================
10298  0000000                   .ENDIF
10299  0000000                   ;(WITH_USER_PLAY)
10300  0000000                   
10301  0000000                   
10302  0000000                       .IF (WITH_FW_CAP_SENSOR_KEYS .GT. 0)
10303  0000000                       .IF (WITH_PSF_PROJECT .EQ. 0)
10304  0000000                   ;---------------------------------
10305  0000000                   ; Cap Include File
10306  0000000                   ;---------------------------------





10307  0000000                       	.IF (CAP_SENSOR_IMPLEMENTATION .EQ. 1)
10308  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\CAP_SENSOR_MACROS_1.INI.APP"
10309  0000000                       	.ENDIF
10310  0000000                       	.IF (CAP_SENSOR_IMPLEMENTATION .EQ. 2)
10311  0000000                   	INCLUDE	"C:\NUVOTON\N588H SDS\V3.12.000\INCLUDE\CAP_SENSOR_MACROS_2.INI.APP"
10312  0000000                       	.ENDIF
10313  0000000                       .ENDIF
10314  0000000                       .ENDIF
10315  0000000                   
10316  0000000                   RR0	EQU	00H
10317  0000000                   RR1	EQU	01H
10318  0000000                   ;-------------------------------------------------------------------------------------------------------
10319  0000000                   	.IF (WITH_SP .EQ. 1H)
10320  0000000                   ; [Add] N588J chip series
10321  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
10322  0000000                   	.IF	(CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
10323  0000000                   		.IF (((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 0))||(WITH_SP_MIDI_SIMUL .EQ. 0))
10324  0000000                   			.IF (WITH_ISR_VS1A .EQ. 1)
10325  0000000                   CH1_STATUS EQU VS1A_START
10326  0000000                   			.ENDIF	
10327  0000000                   			.IF (WITH_ISR_VS2A .EQ. 1)		
10328  0000000                   CH2_STATUS EQU VS2A_START
10329  0000000                   			.ENDIF
10330  0000000                   			.IF (WITH_ISR_VS0A .EQ. 1)
10331  0000000                   CH3_STATUS EQU VS0A_START
10332  0000000                   			.ENDIF		
10333  0000000                   		.ELSE
10334  0000000                   			.IF (WITH_ISR_VS0A .EQ. 1)
10335  0000000                   CH1_STATUS EQU VS0A_START
10336  0000000                   			.ENDIF
10337  0000000                   			.IF (WITH_ISR_VS1A .EQ. 1)		
10338  0000000                   CH2_STATUS EQU VS1A_START
10339  0000000                   			.ENDIF
10340  0000000                   			.IF (WITH_ISR_VS2A .EQ. 1)		
10341  0000000                   CH3_STATUS EQU VS2A_START	
10342  0000000                   			.ENDIF	
10343  0000000                   		.ENDIF
10344  0000000                   	.ENDIF
10345  0000000                   	.ENDIF
10346  0000000                   ;-------------------------------------------------------------------------------------------------------
10347  0000000                   	.IF (WITH_MS .EQ. 1H)
10348  0000000                   MS_STATUS  EQU MS_START+CH_STATUS_MS
10349  0000000                   	.IF (WITH_MS_EXT_MIDI .EQ. 1H)
10350  0000000                   EXT_MIDI_STATUS  EQU MS_START+CH_EXT_MIDI_STATUS_MS
10351  0000000                   	.ENDIF
10352  0000000                   	.ENDIF
10353  0000000                   
10354  0000000                   .IF (WITH_MS .EQ. 1H)
10355  0000000                   ; [Add] N588J chip series
10356  0000000                   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
10357  0000000                       .IF (CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
10358  0000000                            .IF  (((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 0)&&(WITH_SP .EQ. 0))||((WITH_SP_MIDI_SIMUL .EQ. 0)&&(WITH_TONE .EQ. 0)))              
10359  0000000                                     .IF (WITH_VS0A_TONE .EQ. 1) .OR. (WITH_VS0A_HQPC8 .EQ. 1) .OR. (WITH_VS0A_VMDPC8 .EQ. 1) .OR. (WITH_VS0A_PCSPC8 .EQ. 1)
10360  0000000                   MS_CH1_STATUS EQU VS0A_START
10361  0000000                                     .ENDIF
10362  0000000                                     .IF (WITH_VS2A_TONE .EQ. 1) .OR. (WITH_VS2A_HQPC8 .EQ. 1) .OR. (WITH_VS2A_VMDPC8 .EQ. 1) .OR. (WITH_VS2A_PCSPC8 .EQ. 1)
10363  0000000                   MS_CH2_STATUS EQU VS2A_START





10364  0000000                                     .ENDIF
10365  0000000                                     .IF (WITH_VS1A_TONE .EQ. 1) .OR. (WITH_VS1A_HQPC8 .EQ. 1) .OR. (WITH_VS1A_VMDPC8 .EQ. 1) .OR. (WITH_VS1A_PCSPC8 .EQ. 1)
10366  0000000                   MS_CH3_STATUS EQU VS1A_START   
10367  0000000                                     .ENDIF 
10368  0000000                            .ENDIF
10369  0000000                            .IF (((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 0)&&(WITH_SP .EQ. 1))||((WITH_SP_MIDI_SIMUL .EQ. 0)&&(WITH_TONE .EQ. 1)))
10370  0000000                                     .IF (WITH_VS1A_TONE .EQ. 1) .OR. (WITH_VS1A_HQPC8 .EQ. 1) .OR. (WITH_VS1A_VMDPC8 .EQ. 1) .OR. (WITH_VS1A_PCSPC8 .EQ. 1)
10371  0000000                   MS_CH1_STATUS EQU VS1A_START
10372  0000000                                     .ENDIF
10373  0000000                                     .IF (WITH_VS2A_TONE .EQ. 1) .OR. (WITH_VS2A_HQPC8 .EQ. 1) .OR. (WITH_VS2A_VMDPC8 .EQ. 1) .OR. (WITH_VS2A_PCSPC8 .EQ. 1) 
10374  0000000                   MS_CH2_STATUS EQU VS2A_START
10375  0000000                                     .ENDIF
10376  0000000                                     .IF (WITH_VS0A_TONE .EQ. 1) .OR. (WITH_VS0A_HQPC8 .EQ. 1) .OR. (WITH_VS0A_VMDPC8 .EQ. 1) .OR. (WITH_VS0A_PCSPC8 .EQ. 1)
10377  0000000                   MS_CH3_STATUS EQU VS0A_START   
10378  0000000                                     .ENDIF  
10379  0000000                            .ENDIF
10380  0000000                            .IF  ((WITH_SP_MIDI_SIMUL .EQ. 1)&&(WITH_TONE .EQ. 1))
10381  0000000                                .IF (WITH_VS2A_TONE .EQ. 1) .OR. (WITH_VS2A_HQPC8 .EQ. 1) .OR. (WITH_VS2A_VMDPC8 .EQ. 1) .OR. (WITH_VS2A_PCSPC8 .EQ. 1)
10382  0000000                   MS_CH1_STATUS EQU VS2A_START
10383  0000000                                .ENDIF   
10384  0000000                                .IF (WITH_VS1A_TONE .EQ. 1) .OR. (WITH_VS1A_HQPC8 .EQ. 1) .OR. (WITH_VS1A_VMDPC8 .EQ. 1) .OR. (WITH_VS1A_PCSPC8 .EQ. 1) 
10385  0000000                   MS_CH2_STATUS EQU VS1A_START
10386  0000000                                .ENDIF
10387  0000000                                .IF (WITH_VS0A_TONE .EQ. 1) .OR. (WITH_VS0A_HQPC8 .EQ. 1) .OR. (WITH_VS0A_VMDPC8 .EQ. 1) .OR. (WITH_VS0A_PCSPC8 .EQ. 1) 
10388  0000000                   MS_CH3_STATUS EQU VS0A_START
10389  0000000                                .ENDIF                  
10390  0000000                            .ENDIF
10391  0000000                       .ENDIF
10392  0000000                   .ENDIF
10393  0000000                   ;-------------------------------------------------------------------------------------------------------	
10394  0000000                   	.IF (WITH_EVO .EQ. 1H)
10395  0000000                   		.IF (WITH_CH0_EVO .EQ. 1)
10396  0000000                   EVO1_STATUS  EQU EVO0_START
10397  0000000                   		.ENDIF	
10398  0000000                   		.IF (WITH_CH1_EVO .EQ. 1)
10399  0000000                   EVO2_STATUS  EQU EVO1_START
10400  0000000                   		.ENDIF	
10401  0000000                   		.IF (WITH_CH2_EVO .EQ. 1)
10402  0000000                   EVO3_STATUS  EQU EVO2_START
10403  0000000                   		.ENDIF	
10404  0000000                   	.ENDIF
10405  0000000                   ;--------------------------------------------------------------------------------------------------------
10406  0000000                   
10407  0000000                   DAC_5mA			EQU	01H
10408  0000000                   DAC_3mA			EQU 	05H
10409  0000000                   DAC_5MA			EQU	01H
10410  0000000                   DAC_3MA			EQU 	05H
10411  0000000                   EPWM			EQU	02H
10412  0000000                   PWM			EQU	02H
10413  0000000                   
10414  0000000                   ;;=== FOR COMMON USE ===
10415  0000000                   .EXTERNAL		PLAY_PHRASE_PROCEDURE
10416  0000000                   .EXTERNAL		PLAY_PHRASE_PROCEDURE_IOSPI
10417  0000000                   .EXTERNAL		SP_CHANNEL_QUIT_TABLE
10418  0000000                   .EXTERN			SP_CHANNEL_ADDR_TABLE
10419  0000000                   .EXTERN			STOP_SP_CHANNEL_PROC
10420  0000000                   .EXTERN			SP_CHANNEL_ID_TABLE_2





10421  0000000                   .EXTERN			SP_TM_CH_MAP_TABLE
10422  0000000                   
10423  0000000                   .EXTERNAL		STOP_ALL_SP
10424  0000000                   .EXTERNAL		STOP_MS
10425  0000000                   .EXTERNAL		STOP_ALL
10426  0000000                   .EXTERNAL		STOP_PLAY_Y_EVO_API
10427  0000000                   .EXTERNAL		STOP_PLAY_Y_SP_API
10428  0000000                   .EXTERNAL		STOP_PLAY_ALL_MS_API
10429  0000000                   .EXTERNAL		STOP_PLAY_ALL_API
10430  0000000                   
10431  0000000                   .EXTERNAL		PAUSE_PLAY_Y_SP_API
10432  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_SP_API
10433  0000000                   .EXTERNAL		PAUSE_PLAY_Y_EVO_API
10434  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_EVO_API
10435  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_MS_API
10436  0000000                   .EXTERNAL		PAUSE_PLAY_ALL_API	
10437  0000000                   .EXTERNAL		RESUME_PLAY_Y_SP_API
10438  0000000                   .EXTERNAL		RESUME_PLAY_ALL_SP_API
10439  0000000                   .EXTERNAL		RESUME_PLAY_Y_EVO_API
10440  0000000                   .EXTERNAL		RESUME_PLAY_ALL_EVO_API
10441  0000000                   .EXTERNAL		RESUME_PLAY_ALL_MS_API
10442  0000000                   .EXTERNAL		RESUME_PLAY_ALL_API
10443  0000000                   
10444  0000000                   .EXTERNAL		NOTE_OFF_ASSIGN_MELODY_CHANNEL_API
10445  0000000                   
10446  0000000                   .EXTERNAL		CH1_SPEED_UP
10447  0000000                   .EXTERNAL		CH1_PITCH_UP
10448  0000000                   .EXTERNAL		CH1_SPEED_DOWN
10449  0000000                   .EXTERNAL		CH1_PITCH_DOWN
10450  0000000                   .EXTERNAL		CH1_SPEED_MODE
10451  0000000                   .EXTERNAL		CH1_PITCH_MODE
10452  0000000                   .EXTERNAL		CH1_PAM_NORMAL
10453  0000000                   
10454  0000000                   
10455  0000000                   .EXTERNAL		CH2_SPEED_UP
10456  0000000                   .EXTERNAL		CH2_PITCH_UP
10457  0000000                   .EXTERNAL		CH2_SPEED_DOWN
10458  0000000                   .EXTERNAL		CH2_PITCH_DOWN
10459  0000000                   .EXTERNAL		CH2_SPEED_MODE
10460  0000000                   .EXTERNAL		CH2_PITCH_MODE
10461  0000000                   .EXTERNAL		CH2_PAM_NORMAL
10462  0000000                   
10463  0000000                   
10464  0000000                   .EXTERNAL		CH3_SPEED_UP
10465  0000000                   .EXTERNAL		CH3_PITCH_UP
10466  0000000                   .EXTERNAL		CH3_SPEED_DOWN
10467  0000000                   .EXTERNAL		CH3_PITCH_DOWN
10468  0000000                   .EXTERNAL		CH3_SPEED_MODE
10469  0000000                   .EXTERNAL		CH3_PITCH_MODE
10470  0000000                   .EXTERNAL		CH3_PAM_NORMAL
10471  0000000                   
10472  0000000                   .EXTERNAL		STOP_CH1
10473  0000000                   .EXTERNAL		STOP_CH2
10474  0000000                   .EXTERNAL		STOP_CH3
10475  0000000                   .EXTERNAL		STOP_EVO1
10476  0000000                   .EXTERNAL		STOP_EVO2
10477  0000000                   .EXTERNAL		STOP_EVO3





10478  0000000                   
10479  0000000                   ;----------------------------------------------------------------------------------------------
10480  0000000                   SPECIAL_REGISTERS_INIT MACRO
10481  0000000                   	.IF (WITH_SIM_SP .EQ. 1H)
10482  0000000                   		LDA #RDPC_WSC+WITH_RDPC_VALUE
10483  0000000                   		STA !RDPC
10484  0000000                   		.IF (WITH_SIM_TYPE .EQ. 0)
10485  0000000                   	      		LDA #SIC_EN
10486  0000000                   	      		STA !SIC
10487  0000000                   	      		.IF (WITH_EXT32MBIT .EQ. 1)
10488  0000000                   	      			LDA #01H
10489  0000000                   	      			TRB !BP2D
10490  0000000                   	        	.ENDIF
10491  0000000                   	        .ENDIF
10492  0000000                   		.IF (WITH_SIM_TYPE .EQ. 1)
10493  0000000                   		        LDA #(SIC_EN+SIC_SPI)
10494  0000000                   		      	STA !SIC
10495  0000000                   		.ENDIF
10496  0000000                   	.ENDIF		
10497  0000000                   
10498  0000000                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0))
10499  0000000                   .ELSE
10500  0000000                   	.IF(WITH_SPEAKER_SWITCH .EQ. 1)
10501  0000000                   		LDA <SPEN_TMP
10502  0000000                   		BNE END_STORE_SPEAKER#
10503  0000000                   		LDA #WITH_SPEAKER_OUTPUT_TYPE
10504  0000000                   		STA <SPEN_TMP	;set the of type mixer output
10505  0000000                   END_STORE_SPEAKER#:
10506  0000000                   	.ENDIF
10507  0000000                   		STZ !SPEN
10508  0000000                   
10509  0000000                   .ENDIF
10510  0000000                   
10511  0000000                   .IF(WITH_PSF_PROJECT .EQ. 0)
10512  0000000                   	LDA #FFH
10513  0000000                   	STA !BP0
10514  0000000                   	STA !BP1
10515  0000000                   	.IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
10516  0000000                   		STA !BP2
10517  0000000                   	.ENDIF
10518  0000000                   .ENDIF
10519  0000000                   
10520  0000000                   	EXTERN	UIO_INIT
10521  0000000                   	JSR 	UIO_INIT
10522  0000000                   
10523  0000000                   	.IF (N55P_DEVICE_NUM .GT. 0H)
10524  0000000                   	EXTERN	UIO_N55P_INIT
10525  0000000                   	JSR 	UIO_N55P_INIT
10526  0000000                   	.ENDIF
10527  0000000                   
10528  0000000                   .IF(WITH_PSF_PROJECT .EQ. 0)
10529  0000000                   .IFDEF       BPXM_RAM	
10530  0000000                   	.IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
10531  0000000                   	LDX !BP2D
10532  0000000                   	EXTERN BP2M_BAK_TABLE
10533  0000000                   	LDA !BP2M_BAK_TABLE,X
10534  0000000                   	STA <BP2M_BAK





10535  0000000                   	.ENDIF
10536  0000000                   
10537  0000000                   	LDX !BP1D
10538  0000000                   	EXTERN BP1M_BAK_TABLE
10539  0000000                   	LDA !BP1M_BAK_TABLE,X
10540  0000000                   	STA <BP1M_BAK
10541  0000000                   
10542  0000000                   	LDX !BP0D
10543  0000000                   	EXTERN BP0M_BAK_TABLE
10544  0000000                   	LDA !BP0M_BAK_TABLE,X
10545  0000000                   	STA <BP0M_BAK
10546  0000000                   .ENDIF
10547  0000000                   .ENDIF
10548  0000000                   
10549  0000000                   ; for Drum Table used and not used now, but current library will acess thes table name	
10550  0000000                   	PUBLIC		DRUM_LIST_TABLE_LOW
10551  0000000                   	PUBLIC		DRUM_LIST_TABLE_HIGH
10552  0000000                   	PUBLIC		DRUM_LIST_TABLE_HIGH8
10553  0000000                   DRUM_LIST_TABLE_LOW:
10554  0000000                   DRUM_LIST_TABLE_HIGH:
10555  0000000                   DRUM_LIST_TABLE_HIGH8:
10556  0000000                   
10557  0000000                   	.IF (WITH_VS0B .EQ. 1H)	; 5S channel
10558  0000000                   ; VS0A -> Time
10559  0000000                   		PUBLIC		LIB_VS0B_ISR
10560  0000000                   		PUBLIC		LIB_VS1B_ISR
10561  0000000                   		PUBLIC		LIB_VS2B_ISR
10562  0000000                   		PUBLIC		QUIT_LIB_VS0_ISR
10563  0000000                   		PUBLIC		QUIT_LIB_VS1_ISR
10564  0000000                   		PUBLIC		QUIT_LIB_VS2_ISR
10565  0000000                   
10566  0000000                   		LDA #.LOW.LIB_VS0B_ISR
10567  0000000                   		STA <VS0A_START+CH_ISR_SYNTH_START_SP
10568  0000000                   		LDA #.HIGH.LIB_VS0B_ISR
10569  0000000                   		STA <VS0A_START+CH_ISR_SYNTH_START_SP+1
10570  0000000                   
10571  0000000                   		LDA #.LOW.QUIT_LIB_VS0_ISR
10572  0000000                   		STA <VS0B_START+CH_ISR_SYNTH_START_SP
10573  0000000                   		LDA #.HIGH.QUIT_LIB_VS0_ISR
10574  0000000                   		STA <VS0B_START+CH_ISR_SYNTH_START_SP+1
10575  0000000                   
10576  0000000                   		LDA #.LOW.LIB_VS1B_ISR
10577  0000000                   		STA <VS1A_START+CH_ISR_SYNTH_START_SP
10578  0000000                   		LDA #.HIGH.LIB_VS1B_ISR
10579  0000000                   		STA <VS1A_START+CH_ISR_SYNTH_START_SP+1
10580  0000000                   
10581  0000000                   		LDA #.LOW.QUIT_LIB_VS1_ISR
10582  0000000                   		STA <VS1B_START+CH_ISR_SYNTH_START_SP
10583  0000000                   		LDA #.HIGH.QUIT_LIB_VS1_ISR
10584  0000000                   		STA <VS1B_START+CH_ISR_SYNTH_START_SP+1
10585  0000000                   
10586  0000000                   		LDA #.LOW.LIB_VS2B_ISR
10587  0000000                   		STA <VS2A_START+CH_ISR_SYNTH_START_SP
10588  0000000                   		LDA #.HIGH.LIB_VS2B_ISR
10589  0000000                   		STA <VS2A_START+CH_ISR_SYNTH_START_SP+1
10590  0000000                   
10591  0000000                   ;For 6S MD5





10592  0000000                   		LDA #80H
10593  0000000                   		STA <VS0A_START+CH_OLD_SAMPLE_EMM+1
10594  0000000                   		STA <VS0B_START+CH_OLD_SAMPLE_EMM+1
10595  0000000                   		STA <VS1A_START+CH_OLD_SAMPLE_EMM+1
10596  0000000                   		STA <VS1B_START+CH_OLD_SAMPLE_EMM+1
10597  0000000                   		STA <VS2A_START+CH_OLD_SAMPLE_EMM+1
10598  0000000                   		STA <VS2B_START+CH_OLD_SAMPLE_EMM+1
10599  0000000                   
10600  0000000                   	.ELSE 
10601  0000000                   ;		PUBLIC		QUIT_LIB_VS0_ISR
10602  0000000                   ;		PUBLIC		QUIT_LIB_VS1_ISR
10603  0000000                   ;		PUBLIC		QUIT_LIB_VS2_ISR
10604  0000000                   
10605  0000000                   		.IF (WITH_ISR_VS0A .EQ. 1H)
10606  0000000                   			PUBLIC		QUIT_LIB_VS0_ISR
10607  0000000                   			LDA #.LOW.QUIT_LIB_VS0_ISR
10608  0000000                   			STA <VS0A_START+CH_ISR_SYNTH_START_SP
10609  0000000                   			LDA #.HIGH.QUIT_LIB_VS0_ISR
10610  0000000                   			STA <VS0A_START+CH_ISR_SYNTH_START_SP+1
10611  0000000                   		.ENDIF
10612  0000000                   		.IF (WITH_ISR_VS1A .EQ. 1H)
10613  0000000                   			PUBLIC		QUIT_LIB_VS1_ISR
10614  0000000                   			LDA #.LOW.QUIT_LIB_VS1_ISR
10615  0000000                   			STA <VS1A_START+CH_ISR_SYNTH_START_SP
10616  0000000                   			LDA #.HIGH.QUIT_LIB_VS1_ISR
10617  0000000                   			STA <VS1A_START+CH_ISR_SYNTH_START_SP+1
10618  0000000                   		.ENDIF
10619  0000000                   		.IF (WITH_ISR_VS2A .EQ. 1H)
10620  0000000                   			PUBLIC		QUIT_LIB_VS2_ISR
10621  0000000                   			LDA #.LOW.QUIT_LIB_VS2_ISR
10622  0000000                   			STA <VS2A_START+CH_ISR_SYNTH_START_SP
10623  0000000                   			LDA #.HIGH.QUIT_LIB_VS2_ISR
10624  0000000                   			STA <VS2A_START+CH_ISR_SYNTH_START_SP+1
10625  0000000                   		.ENDIF
10626  0000000                   	.ENDIF
10627  0000000                   
10628  0000000                   	.IF (WITH_SP .EQ. 1).OR.(WITH_MS .EQ. 1)
10629  0000000                   	LDY #FFH
10630  0000000                   INIT_PCM#:
10631  0000000                   	INY
10632  0000000                   	LDX !SP_CHANNEL_ADDR_TABLE,Y		;X=STOP CHANNEL ADDRESS
10633  0000000                   	BEQ END_INIT_PCM#
10634  0000000                   
10635  0000000                   	LDA #80H
10636  0000000                   	STA <CH_PREVIOUS_PCM_SP+1,X
10637  0000000                   	STZ <CH_PREVIOUS_PCM_SP,X
10638  0000000                   	.IF (WITH_VOL_ADJ .EQ. 1H)
10639  0000000                   	LDA #80H
10640  0000000                   	STA <CH_PREVIOUS_PCM_VOL_SP+1,X
10641  0000000                   	STZ <CH_PREVIOUS_PCM_VOL_SP,X
10642  0000000                   	.ENDIF
10643  0000000                   	BRA INIT_PCM#
10644  0000000                   END_INIT_PCM#:
10645  0000000                   	.ENDIF
10646  0000000                   
10647  0000000                   	.IF (WITH_GLOBAL_CHANNEL_VOLM == 1 || WITH_GLOBAL_CHANNEL_INS == 1 ||WITH_MULTI_CHANNEL == 1)
10648  0000000                   		LDY #FFH





10649  0000000                   INIT_GLOBAL_CHANNEL_SETTING#:
10650  0000000                   		INY
10651  0000000                   		CPY #03H
10652  0000000                   		BCS END_INIT_GLOBAL_CHANNEL_SETTING#
10653  0000000                   
10654  0000000                   		EXTERN MS_CHANNEL_TABLE
10655  0000000                   		LDA !MS_CHANNEL_TABLE,Y
10656  0000000                   		BEQ INIT_GLOBAL_CHANNEL_SETTING#
10657  0000000                   
10658  0000000                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
10659  0000000                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
10660  0000000                   			LDX MS_GLOBAL_CHANNEL_VOLUME_TABLE,Y
10661  0000000                   			LDA #7FH
10662  0000000                   			STA GLOBAL_CHANNEL_VOLM0,X
10663  0000000                   		.ENDIF
10664  0000000                   
10665  0000000                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
10666  0000000                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
10667  0000000                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
10668  0000000                   			STZ GLOBAL_CHANNEL_INS0,X
10669  0000000                   		.ENDIF
10670  0000000                   
10671  0000000                   		.IF (WITH_MULTI_CHANNEL .EQ. 1H)
10672  0000000                   			EXTERN ASSIGN_MELODY_CHANNEL_TABLE
10673  0000000                   			LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
10674  0000000                   			TYA
10675  0000000                   			STA CH_SYNTH_CHANNEL0,X
10676  0000000                   		.ENDIF
10677  0000000                   
10678  0000000                   		BRA INIT_GLOBAL_CHANNEL_SETTING#
10679  0000000                   END_INIT_GLOBAL_CHANNEL_SETTING#:
10680  0000000                   	.ENDIF
10681  0000000                   ENDM
10682  0000000                   ;------------------------------------------------------------------
10683  0000000                   STORE_PCM_TO_TBUF MACRO CHANNEL_VSXA,VSXA_START,TBUF_LOW,TBUF_HI
10684  0000000                   	.IF (WITH_VOL_REDUCE .EQ. 1)	
10685  0000000                   		LDY #CHANNEL_VSXA
10686  0000000                   		EXTERN SP_TM_CH_MAP_TABLE
10687  0000000                   		LDA !SP_TM_CH_MAP_TABLE,Y
10688  0000000                   		INC A
10689  0000000                   		BIT <COMMON_FLAG
10690  0000000                   		BEQ VSXA_STORE_PCM#
10691  0000000                   
10692  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
10693  0000000                   			LDA <(CH_PREVIOUS_PCM_SP+1+VSXA_START)
10694  0000000                   		.ELSE
10695  0000000                   			LDA <(CH_PREVIOUS_PCM_VOL_SP+1+VSXA_START)
10696  0000000                   		.ENDIF
10697  0000000                   		EOR #80H
10698  0000000                   		BMI NEG_PCM#
10699  0000000                   		CLC
10700  0000000                   		BRA STORE_REDUCE_VOL#
10701  0000000                   NEG_PCM#:
10702  0000000                   		SEC
10703  0000000                   
10704  0000000                   STORE_REDUCE_VOL#:
10705  0000000                   		ROR A





10706  0000000                   		EOR #80H
10707  0000000                   		STA !TBUF_HI
10708  0000000                   
10709  0000000                   		.IF (WITH_VOL_ADJ .EQ. 0)
10710  0000000                   			LDA <(CH_PREVIOUS_PCM_SP+VSXA_START)
10711  0000000                   		.ELSE
10712  0000000                   			LDA <(CH_PREVIOUS_PCM_VOL_SP+VSXA_START)
10713  0000000                   		.ENDIF
10714  0000000                   		ROR A
10715  0000000                   		BRA STORE_LOW_PCM_TO_TBUF#
10716  0000000                   	.ENDIF
10717  0000000                   
10718  0000000                   VSXA_STORE_PCM#:	
10719  0000000                   	.IF (WITH_VOL_ADJ .EQ. 0)
10720  0000000                   		LDA <(CH_PREVIOUS_PCM_SP+1+VSXA_START)
10721  0000000                   	.ELSE
10722  0000000                   		LDA <(CH_PREVIOUS_PCM_VOL_SP+1+VSXA_START)
10723  0000000                   	.ENDIF
10724  0000000                   		STA !TBUF_HI
10725  0000000                   
10726  0000000                   	.IF (WITH_VOL_ADJ .EQ. 0)
10727  0000000                   		LDA <(CH_PREVIOUS_PCM_SP+VSXA_START)
10728  0000000                   	.ELSE
10729  0000000                   		LDA <(CH_PREVIOUS_PCM_VOL_SP+VSXA_START)
10730  0000000                   	.ENDIF
10731  0000000                   
10732  0000000                   STORE_LOW_PCM_TO_TBUF#:
10733  0000000                   	.IF (WITH_SP0XL_RESOLUTION .EQ. 2)
10734  0000000                   		AND #FCH
10735  0000000                   	.ENDIF
10736  0000000                   	.IF (WITH_SP0XL_RESOLUTION .EQ. 3)
10737  0000000                   		AND #F0H
10738  0000000                   	.ENDIF
10739  0000000                   	STA !TBUF_LOW
10740  0000000                   ENDM
10741  0000000                   
10742  0000000                   ;------------------------------------------------------------------
10743  0000000                   ;JMP_TMG_ISR_ACTION: when TMG interrupt to do ISR function
10744  0000000                   ;1. Check VS0A if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10745  0000000                   ;2. Check VS0B if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10746  0000000                   ;------------------------------------------------------------------
10747  0000000                   JMP_CH1_ISR_ACTION MACRO
10748  0000000                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
10749  0000000                   	.ELSE
10750  0000000                   	.IF (WITH_VS0A .EQ. 0H)
10751  0000000                   		JMP QUIT_LIB_ISR
10752  0000000                   	.ENDIF
10753  0000000                   VS0A_NEXT_ACTION:
10754  0000000                   	LDA <(CH_STATUS_SP+VS0A_START)
10755  0000000                   	BIT #SP_BZ
10756  0000000                   	BEQ LIB_VS0B_ISR	
10757  0000000                   
10758  0000000                   	BIT #SP_ADSR
10759  0000000                   	BNE VS0A_NEXT_ACTION_CONST
10760  0000000                   
10761  0000000                   	.IF (WITH_ISR_VS0A .EQ. 1H) 
10762  0000000                   		STORE_PCM_TO_TBUF CHANNEL_VS0A,VS0A_START,SP0CLT,SP0CT	





10763  0000000                   	.ENDIF
10764  0000000                   
10765  0000000                   	LDY #CHANNEL_VS0A
10766  0000000                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
10767  0000000                   		LDA <(CH_STATUS_SP+VS0A_START)
10768  0000000                   		BIT #SP_PAUSE
10769  0000000                   		BEQ 3
10770  0000000                   		EXTERN SP_PAUSE_RAMP_PROC
10771  0000000                   		JMP SP_PAUSE_RAMP_PROC
10772  0000000                   		BIT #SP_RESUME
10773  0000000                   		BEQ VS0A_NEXT_ACTION_CONST
10774  0000000                   		EXTERN SP_RESUME_RAMP_PROC
10775  0000000                   		JMP SP_RESUME_RAMP_PROC
10776  0000000                   	.ENDIF
10777  0000000                   
10778  0000000                   VS0A_NEXT_ACTION_CONST:
10779  0000000                   	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS0A_START)
10780  0000000                   
10781  0000000                   LIB_VS0B_ISR:
10782  0000000                   QUIT_LIB_VS0_ISR:
10783  0000000                   	JMP QUIT_LIB_ISR
10784  0000000                   	.ENDIF
10785  0000000                   ENDM
10786  0000000                   
10787  0000000                   ;------------------------------------------------------------------
10788  0000000                   ;JMP_TM0_ISR_ACTION: when TM0 interrupt to do ISR function
10789  0000000                   ;1. Check VS1A if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10790  0000000                   ;2. Check VS1B if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10791  0000000                   ;------------------------------------------------------------------
10792  0000000                   JMP_CH2_ISR_ACTION MACRO
10793  0000000                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
10794  0000000                   	.ELSE
10795  0000000                   	.IF (WITH_VS1A .EQ. 0H)
10796  0000000                   		JMP QUIT_LIB_ISR
10797  0000000                   	.ENDIF
10798  0000000                   VS1A_NEXT_ACTION:
10799  0000000                   	LDA <(CH_STATUS_SP+VS1A_START)
10800  0000000                   	BIT #SP_BZ
10801  0000000                   	BEQ LIB_VS1B_ISR
10802  0000000                   
10803  0000000                   	BIT #SP_ADSR
10804  0000000                   	BNE VS1A_NEXT_ACTION_CONST
10805  0000000                   
10806  0000000                   	.IF (WITH_ISR_VS1A .EQ. 1H) 
10807  0000000                   		STORE_PCM_TO_TBUF CHANNEL_VS1A,VS1A_START,SP0ALT,SP0AT
10808  0000000                   	.ENDIF
10809  0000000                   
10810  0000000                   	LDY #CHANNEL_VS1A
10811  0000000                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
10812  0000000                   		LDA <(CH_STATUS_SP+VS1A_START)
10813  0000000                   		BIT #SP_PAUSE
10814  0000000                   		BEQ 3
10815  0000000                   		EXTERN SP_PAUSE_RAMP_PROC
10816  0000000                   		JMP SP_PAUSE_RAMP_PROC
10817  0000000                   		BIT #SP_RESUME
10818  0000000                   		BEQ VS1A_NEXT_ACTION_CONST
10819  0000000                   		EXTERN SP_RESUME_RAMP_PROC





10820  0000000                   		JMP SP_RESUME_RAMP_PROC
10821  0000000                   	.ENDIF
10822  0000000                   
10823  0000000                   VS1A_NEXT_ACTION_CONST:
10824  0000000                   	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS1A_START)
10825  0000000                   
10826  0000000                   LIB_VS1B_ISR:
10827  0000000                   QUIT_LIB_VS1_ISR:
10828  0000000                   	JMP QUIT_LIB_ISR
10829  0000000                   	.ENDIF
10830  0000000                   ENDM
10831  0000000                   
10832  0000000                   ;------------------------------------------------------------------
10833  0000000                   ;JMP_TM1_ISR_ACTION: when TM1 interrupt to do ISR function
10834  0000000                   ;1. Check VS2A if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10835  0000000                   ;2. Check VS2B if Pause, to QUIT_ISR/RES_ISR_SYNTEH
10836  0000000                   ;------------------------------------------------------------------
10837  0000000                   JMP_CH3_ISR_ACTION MACRO
10838  0000000                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
10839  0000000                   	.ELSE
10840  0000000                   	.IF (WITH_VS2A .EQ. 0H)
10841  0000000                   		JMP QUIT_LIB_ISR
10842  0000000                   	.ENDIF
10843  0000000                   VS2A_NEXT_ACTION:
10844  0000000                   	LDA <(CH_STATUS_SP+VS2A_START)
10845  0000000                   	BIT #SP_BZ
10846  0000000                   	BEQ LIB_VS2B_ISR
10847  0000000                   
10848  0000000                   	BIT #SP_ADSR
10849  0000000                   	BNE VS2A_NEXT_ACTION_CONST
10850  0000000                   
10851  0000000                   	.IF (WITH_ISR_VS2A .EQ. 1H) 
10852  0000000                   		STORE_PCM_TO_TBUF CHANNEL_VS2A,VS2A_START,SP0BLT,SP0BT
10853  0000000                   	.ENDIF
10854  0000000                   
10855  0000000                   	LDY #CHANNEL_VS2A
10856  0000000                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
10857  0000000                   		LDA <(CH_STATUS_SP+VS2A_START)
10858  0000000                   		BIT #SP_PAUSE
10859  0000000                   		BEQ 3
10860  0000000                   		EXTERN SP_PAUSE_RAMP_PROC
10861  0000000                   		JMP SP_PAUSE_RAMP_PROC
10862  0000000                   		BIT #SP_RESUME
10863  0000000                   		BEQ VS2A_NEXT_ACTION_CONST
10864  0000000                   		EXTERN SP_RESUME_RAMP_PROC
10865  0000000                   		JMP SP_RESUME_RAMP_PROC
10866  0000000                   	.ENDIF
10867  0000000                   
10868  0000000                   VS2A_NEXT_ACTION_CONST:
10869  0000000                   	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS2A_START)
10870  0000000                   
10871  0000000                   LIB_VS2B_ISR:
10872  0000000                   QUIT_LIB_VS2_ISR:
10873  0000000                   	JMP QUIT_LIB_ISR
10874  0000000                   	.ENDIF
10875  0000000                   ENDM
10876  0000000                   ;=====================================================================================





10877  0000000                   
10878  0000000                   
10879  0000000                   
10880  0000000                   
10881  0000000                   	EXTERN		FXF_ISR_DELAY_COUNT_DEFAULT
10882  0000000                   	EXTERN		STOP_TM_FXF_PROC
10883  0000000                   	EXTERN		INIT_TM_FXF_PROC
10884  0000000                   
10885  0000000                   	EXTERN		VC_TMV_TABLE
10886  0000000                   	EXTERN		VC_TMC_TABLE
10887  0000000                   
10888  0000000                   .ifdef	FW_PWM_TIMER_FXF10
10889  0000000                   	EXTERN		FW_PWM_TIMER_DOWNCOUNT
10890  0000000                   	PUBLIC		FW_TIMER_DWONCOUNT_RET
10891  0000000                   .endif
10892  0000000                   .ifdef	FW_PWM_TIMER_TM0
10893  0000000                   	EXTERN		FW_PWM_TIMER_DOWNCOUNT
10894  0000000                   	PUBLIC		FW_TIMER_DWONCOUNT_RET
10895  0000000                   .endif
10896  0000000                   .ifdef	FW_PWM_TIMER_TM1
10897  0000000                   	EXTERN		FW_PWM_TIMER_DOWNCOUNT
10898  0000000                   	PUBLIC		FW_TIMER_DWONCOUNT_RET
10899  0000000                   .endif
10900  0000000                   .ifdef	FW_PWM_TIMER_TMG0
10901  0000000                   	EXTERN		FW_PWM_TIMER_DOWNCOUNT
10902  0000000                   	PUBLIC		FW_TIMER_DWONCOUNT_RET
10903  0000000                   .endif
10904  0000000                   .ifdef	FW_BAM_TIMER
10905  0000000                   	EXTERN		UIO_TIMER_INT
10906  0000000                   	EXTERN		UIO_BIT_COUNT
10907  0000000                   	EXTERN		UIO_TIMER_CH_FLAG
10908  0000000                   	EXTERN		IEF0_BAK
10909  0000000                   	EXTERN		IEF0_FLAG
10910  0000000                   .endif
10911  0000000                   
10912  0000000                   	PUBLIC		QUIT_LIB_ISR
10913  0000000                   ;==========================================================================
10914  0000000                   ; Initial For Main.asm Macro
10915  0000000                   ;--------------------------------------------------------------------------
10916  0000000                   
10917  0000000                   
10918  0000000                   ;==========================================================================
10919  0000000                   ;	DECLARE VARIABLES INSIDE THIS SECTION
10920  0000000                   ;	EXAMPLE => VAR1	DS	3
10921  0000000                   ;		   VAR2	DS	1
10922  0000000                   ;==========================================================================
10923  0000000                   	USER_RAM: SECTION             
10924  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\ALL_CONST_FILES.H.APP"
10925  0000000                   ; <<<<<<< 1.6.1.4 >>>>>>>>>>> 
10926  0000000                   ; Create Time: 2018/10/23 ÐÇÆÚ¶þ ÉÏÎç 10:35:10
10927  0000000                   
10928  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\IDE_CONST.H.APP"
10929  0000000                   External_MIDI_Note EQU	0
10930  0000000                   ;=1 : N567H_V106083 IDE: support NOTE_ON,NOTE_OFF
10931  0000000                   C_SPCH1_ENABLE EQU	1
10932  0000000                   C_SPCH2_ENABLE EQU	0
10933  0000000                   C_SPCH3_ENABLE EQU	0





10934  0000000                   
10935  0000000                   C_SPCH1_LP8	EQU	0
10936  0000000                   C_SPCH2_LP8	EQU	0
10937  0000000                   C_SPCH3_LP8	EQU	0
10938  0000000                   C_MS_ENABLE EQU	0
10939  0000000                   C_NOTEONOFF_EN	EQU	0
10940  0000000                   
10941  0000000                   Speech_Volume_Adjustment EQU 0
10942  0000000                   
10943  0000000                   
10944  0000000                   C_MS_SPCH1_MIX_EN 		EQU		0
10945  0000000                   
10946  0000000                   ;C_SPK_SWITCH_EN	EQU	0
10947  0000000                   
10948  0000000                   C_AVAILABLE_RAMS EQU	139 ;rewrite it
10949  0000000                   C_RESERVE_BYTE_USER_STACK EQU 12; **pls rewrite it according your request
10950  0000000                   C_BP0_ULTRAIO_EN	EQU	1
10951  0000000                   C_BP1_ULTRAIO_EN	EQU	0
10952  0000000                   C_BP2_ULTRAIO_EN	EQU	0
10953  0000000                   
10954  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_MODULE.H.APP"
10955  0000000                   ; <<<<<<< 1.6.1.4 >>>>>>>>>>> 
10956  0000000                   ; Create Time: 2018/10/23 ÐÇÆÚ¶þ ÉÏÎç 10:35:10
10957  0000000                   
10958  0000000                   C_COMMON_EN	EQU	1
10959  0000000                   C_WAITKEY_EN	EQU	1
10960  0000000                   C_USER_EN	EQU	1
10961  0000000                   C_PROJ_EN	EQU	1
10962  0000000                   C_AUTOSLEEP_EN	EQU	1
10963  0000000                   C_PWOFF_EN	EQU	1
10964  0000000                   C_MAIN0_EN	EQU	1
10965  0000000                   C_MODE0_EN	EQU	1
10966  0000000                   C_CHKSKEY_EN	EQU	1
10967  0000000                   
10968  0000000                   
10969  0000000                   
10970  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\COMMON_CONST.H.APP"
10971  0000000                   ;----------------------
10972  0000000                   ; CONST
10973  0000000                   ;-----------------------------
10974  0000000                   C_TRUE	EQU	1
10975  0000000                   C_FALSE	EQU	0
10976  0000000                   
10977  0000000                   
10978  0000000                   C_GAPTIME	EQU	5
10979  0000000                   ;	according to Fosc
10980  0000000                   ;5: 5.33MS
10981  0000000                   ;8: 8MS
10982  0000000                   ;81: 8.192MS
10983  0000000                   C_W567BS	EQU	0
10984  0000000                   C_W588AS	EQU	1
10985  0000000                   C_W588CD	EQU	2
10986  0000000                   C_N567GHK	EQU	3
10987  0000000                   C_W567CJ	EQU	4
10988  0000000                   C_N588H		EQU	5
10989  0000000                   C_N588L		EQU	6
10990  0000000                   





10991  0000000                   C_CHIP	EQU	C_N588H
10992  0000000                   
10993  0000000                   ;=====================================
10994  0000000                   ;=====================================
10995  0000000                   ;
10996  0000000                   ; Function configure
10997  0000000                   ;
10998  0000000                   ;=====================================
10999  0000000                   ;=======================================
11000  0000000                   
11001  0000000                   
11002  0000000                   C_TMG0_EN EQU	0
11003  0000000                   
11004  0000000                   
11005  0000000                   
11006  0000000                   
11007  0000000                   CONST_10US_NOP	EQU	30
11008  0000000                   
11009  0000000                   C_KEYCH_MAX		EQU	3
11010  0000000                   
11011  0000000                   
11012  0000000                   
11013  0000000                   
11014  0000000                   
11015  0000000                   ;--------------------- min 1 port EN,×îÉÙÓÐÒ»¸öÔÊÐí¡£
11016  0000000                   C_BP0_STATUS_EN	EQU	1; 
11017  0000000                   C_BP1_STATUS_EN	EQU	1;
11018  0000000                   C_BP2_STATUS_EN	EQU	0;
11019  0000000                   ;------------------------------------------
11020  0000000                   
11021  0000000                   .IF ( C_BP0_ULTRAIO_EN .EQ. 0 )
11022  0000000                   C_R_BP0_USED EQU 1
11023  0000000                   .ENDIF
11024  0000000                   .IF ( C_BP1_ULTRAIO_EN .EQ. 0 )
11025  0000000                   C_R_BP1_USED EQU 1
11026  0000000                   .ENDIF
11027  0000000                   .IF ( C_BP2_ULTRAIO_EN .EQ. 0 )
11028  0000000                   C_R_BP2_USED EQU 0
11029  0000000                   .ENDIF
11030  0000000                   
11031  0000000                   
11032  0000000                   
11033  0000000                   
11034  0000000                   
11035  0000000                   ;========================
11036  0000000                   ;	EQU_RAM.H
11037  0000000                   ;========================
11038  0000000                   
11039  0000000                   C_EQU_PWOFF_EN	EQU	0
11040  0000000                   
11041  0000000                   
11042  0000000                   
11043  0000000                   
11044  0000000                   
11045  0000000                   ;========================
11046  0000000                   ;	AUTOSLEEP_RAM.H
11047  0000000                   ;========================





11048  0000000                   C_AUTOSLEEP_WAITKEY_EN EQU	0
11049  0000000                   
11050  0000000                   
11051  0000000                   
11052  0000000                   
11053  0000000                   C_SCORE_2_3DIGIT_EN	EQU	0
11054  0000000                   C_SCORE_2_4DIGIT_EN	EQU	0
11055  0000000                   
11056  0000000                   
11057  0000000                   ;----------------------
11058  0000000                   ; CONST
11059  0000000                   ;-----------------------------
11060  0000000                   C_NOP				EQU	0FFH
11061  0000000                   XXH				EQU	0FEH ; °´¼üÎ»ÖÃ¿Õ
11062  0000000                   
11063  0000000                   
11064  0000000                   ;=============================================
11065  0000000                   
11066  0000000                   C_BIT0			EQU	01H
11067  0000000                   C_BIT1			EQU	02H
11068  0000000                   C_BIT2			EQU	04H
11069  0000000                   C_BIT3			EQU	08H
11070  0000000                   C_BIT4			EQU	10H
11071  0000000                   C_BIT5			EQU	20H
11072  0000000                   C_BIT6			EQU	40H
11073  0000000                   C_BIT7			EQU	80H
11074  0000000                   
11075  0000000                   C_BIT0V			EQU	11111110B
11076  0000000                   C_BIT1V			EQU	11111101B
11077  0000000                   C_BIT2V			EQU	11111011B
11078  0000000                   C_BIT3V			EQU	11110111B
11079  0000000                   C_BIT4V			EQU	11101111B
11080  0000000                   C_BIT5V			EQU	11011111B
11081  0000000                   C_BIT6V			EQU	10111111B
11082  0000000                   C_BIT7V			EQU	01111111B
11083  0000000                   
11084  0000000                   .IF(C_GAPTIME .EQ. 81)
11085  0000000                   ;*8.192
11086  0000000                   CNT_STOP		EQU	0000000h
11087  0000000                   
11088  0000000                   T005000MS		EQU	0FFFD8Fh
11089  0000000                   T000256MS		EQU	0FFFFE0h
11090  0000000                   
11091  0000000                   T060000MS		EQU	0FFE364h
11092  0000000                   T030000MS		EQU	0FFF1B2H
11093  0000000                   
11094  0000000                   T010000MS		EQU	0FFFB3CH
11095  0000000                   T180000MS		EQU	0FFAA2Ch
11096  0000000                   
11097  0000000                   
11098  0000000                   ;
11099  0000000                   .ENDIF
11100  0000000                   
11101  0000000                   .IF(C_GAPTIME .EQ. 8)
11102  0000000                   ;*8
11103  0000000                   CNT_STOP		EQU	0000000h
11104  0000000                   ;





11105  0000000                   T000032MS		EQU	0FFFFFCh
11106  0000000                   T000040MS		EQU	0FFFFFBh
11107  0000000                   T000056MS		EQU	0FFFFF9h
11108  0000000                   T000064MS		EQU	0FFFFF8h
11109  0000000                   T000072MS		EQU	0FFFFF7h
11110  0000000                   T000088MS		EQU	0FFFFF5h
11111  0000000                   T000104MS		EQU	0FFFFF3h
11112  0000000                   T000128MS		EQU	0FFFFF0h
11113  0000000                   T000152MS		EQU	0FFFFEDh
11114  0000000                   T000168MS		EQU	0FFFFEBh
11115  0000000                   T000200MS		EQU	0FFFFE7h
11116  0000000                   T000256MS		EQU	0FFFFE0h
11117  0000000                   T000304MS		EQU	0FFFFDAh
11118  0000000                   T000320MS		EQU	0FFFFD8h
11119  0000000                   T000352MS		EQU	0FFFFD4h
11120  0000000                   T000504MS		EQU	0FFFFC1h
11121  0000000                   T000552MS		EQU	0FFFFBBh
11122  0000000                   T000600MS		EQU	0FFFFB5h
11123  0000000                   T000624MS		EQU	0FFFFB2h
11124  0000000                   T000752MS		EQU	0FFFFA2h
11125  0000000                   T000800MS		EQU	0FFFF9Ch
11126  0000000                   T001000MS		EQU	0FFFF83h
11127  0000000                   T001128MS		EQU	0FFFF73h
11128  0000000                   T001256MS		EQU	0FFFF63h
11129  0000000                   T001384MS		EQU	0FFFF53h
11130  0000000                   T001504MS		EQU	0FFFF44h
11131  0000000                   T001512MS		EQU	0FFFF43h
11132  0000000                   T002000MS		EQU	0FFFF06h
11133  0000000                   T002504MS		EQU	0FFFEC7h
11134  0000000                   T003000MS		EQU	0FFFE89h
11135  0000000                   T004000MS		EQU	0FFFE0Ch
11136  0000000                   T005000MS		EQU	0FFFD8Fh
11137  0000000                   T010000MS		EQU	0FFFB1Eh
11138  0000000                   T020000MS		EQU	0FFF63Ch
11139  0000000                   T050000MS		EQU	0FFE796h
11140  0000000                   
11141  0000000                   
11142  0000000                   ;
11143  0000000                   .ENDIF
11144  0000000                   
11145  0000000                   .IF(C_GAPTIME .EQ. 5)
11146  0000000                   ;*5.33MS
11147  0000000                   CNT_STOP		EQU	00000000h
11148  0000000                   ;
11149  0000000                   T000032MS		EQU	0FFFFFAh
11150  0000000                   T000064MS		EQU	0FFFFF4H
11151  0000000                   T000096MS		EQU	0FFFFEEH
11152  0000000                   T000128MS		EQU	0FFFFE8H
11153  0000000                   
11154  0000000                   T000056MS		EQU	0FFFFF6h
11155  0000000                   
11156  0000000                   T000072MS		EQU	0FFFFF3h
11157  0000000                   
11158  0000000                   T000104MS		EQU	0FFFFE7H
11159  0000000                   T000200MS		EQU	0FFFFDBH
11160  0000000                   T000256MS		EQU	0FFFFD0H
11161  0000000                   T000300MS		EQU	0FFFFC8H





11162  0000000                   T000504MS		EQU	0FFFFA2h
11163  0000000                   T000580MS		EQU	0FFFF93H
11164  0000000                   T000800MS		EQU	0FFFF6AH
11165  0000000                   T000850MS		EQU	0FFFF61H
11166  0000000                   T000950MS		EQU	0FFFF4EH
11167  0000000                   T001000MS		EQU	0FFFF45H
11168  0000000                   
11169  0000000                   T000152MS	EQU	0FFFFE4H
11170  0000000                   T001500MS	EQU	0FFFEE7H
11171  0000000                   T002000MS	EQU	0FFFE89H
11172  0000000                   T003000MS	EQU	0FFFDCEH
11173  0000000                   T005000MS	EQU	0FFFC56H
11174  0000000                   
11175  0000000                   ;T002000MS	EQU	0FFFE89H
11176  0000000                   T004000MS	EQU	0FFFD12H
11177  0000000                   
11178  0000000                   T000650MS	EQU	0FFFF86H
11179  0000000                   T000680MS	EQU	0FFFF81H
11180  0000000                   T000150MS EQU 0FFFFE4H
11181  0000000                   
11182  0000000                   
11183  0000000                   T006000MS	EQU	0FFFB9BH
11184  0000000                   T007000MS	EQU	0FFFADFH
11185  0000000                   T008000MS	EQU	0FFFA23H
11186  0000000                   T009000MS	EQU	0FFF968H
11187  0000000                   
11188  0000000                   ;-----------------------------
11189  0000000                   T010000MS	EQU	0FFF8ACH
11190  0000000                   T015000MS	EQU	0FFF502H
11191  0000000                   T020000MS	EQU	0FFF158H
11192  0000000                   
11193  0000000                   T060000MS	EQU	0FFD407H
11194  0000000                   T120000MS	EQU	0FFA80EH
11195  0000000                   T300000MS	EQU	0FF2423H
11196  0000000                   T600000MS	EQU	0FE4846H
11197  0000000                   T900000MS	EQU	0FD6C69H
11198  0000000                   T180000MS	EQU	0FF7C15H
11199  0000000                   T210000MS	EQU	0FF6619H
11200  0000000                   
11201  0000000                   ;T001500MS	EQU	0FFFEE7H
11202  0000000                   ;T000800MS	EQU	0FFFF6AH
11203  0000000                   T000700MS	EQU	0FFFF7DH
11204  0000000                   T000600MS	EQU 0FFFF8FH
11205  0000000                   T000400MS	EQU	0FFFFB5H
11206  0000000                   ;T000300MS	EQU	0FFFFC8H
11207  0000000                   T030000MS	EQU	0FFEA04H
11208  0000000                   
11209  0000000                   
11210  0000000                   ;
11211  0000000                   .ENDIF
11212  0000000                   .IF(C_GAPTIME .EQ. 10)
11213  0000000                   ;*10.66MS
11214  0000000                   CNT_STOP		EQU	00000000h
11215  0000000                   ;
11216  0000000                   T000032MS		EQU	0FFFFFDh
11217  0000000                   ;
11218  0000000                   T000056MS		EQU	0FFFFFBh





11219  0000000                   ;
11220  0000000                   T000104MS		EQU	0FFFFF6H
11221  0000000                   T000200MS		EQU	0FFFFEEH
11222  0000000                   T000256MS		EQU	0FFFFE8H
11223  0000000                   
11224  0000000                   T000300MS		EQU	0FFFFE4H
11225  0000000                   T000400MS		EQU	0FFFFDAH
11226  0000000                   
11227  0000000                   ;
11228  0000000                   T000512MS		EQU	0FFFFD0H
11229  0000000                   T000600MS		EQU	0FFFFC8H
11230  0000000                   T000700MS		EQU	0FFFFBEH
11231  0000000                   T000752MS		EQU	0FFFFB9H
11232  0000000                   
11233  0000000                   T000800MS		EQU	0FFFFB5H
11234  0000000                   
11235  0000000                   T001000MS		EQU	0FFFFA2H
11236  0000000                   T001500MS		EQU	0FFFF73H
11237  0000000                   T002000MS		EQU	0FFFF45H
11238  0000000                   
11239  0000000                   T005000MS		EQU	0FFFE2BH
11240  0000000                   ;
11241  0000000                   ;T000152MS	EQU	0FFFFE4H
11242  0000000                   ;T003000MS	EQU	0FFFDCEH
11243  0000000                   ;T005000MS	EQU	0FFFC56h
11244  0000000                   ;
11245  0000000                   ;T010000MS	EQU	0FFF8ACH
11246  0000000                   ;
11247  0000000                   ;T020000MS	EQU	0FFF158H
11248  0000000                   ;
11249  0000000                   ;T060000MS	EQU	0FFD407H
11250  0000000                   ;T300000MS	EQU	0FF2423H
11251  0000000                   ;T600000MS	EQU	0FE4846H
11252  0000000                   ;T900000MS	EQU	0FD6C69H
11253  0000000                   ;T180000MS	EQU	0FF7C15H
11254  0000000                   
11255  0000000                   T000504MS		EQU	0FFFFD1h
11256  0000000                   
11257  0000000                   ;
11258  0000000                   .ENDIF
11259  0000000                   
11260  0000000                   ; * 85ms
11261  0000000                   T120S_85	EQU	0FFFA7DH
11262  0000000                   T001S_85	EQU	0FFFFF4H
11263  0000000                   T002S_85	EQU	0FFFFE8H
11264  0000000                   T010S_85	EQU	0FFFF8AH
11265  0000000                   T020S_85	EQU	0FFFF15H
11266  0000000                   
11267  0000000                   .IF (C_CHIP.EQ.C_N588H)
11268  0000000                   ; IEF0
11269  0000000                   PORT_INT_BIT	EQU	01H
11270  0000000                   TIMER0_INT_BIT	EQU	02H
11271  0000000                   TIMER1_INT_BIT	EQU	04H
11272  0000000                   TIMERG0_INT_BIT	EQU	08H
11273  0000000                   FXF13_INT_BIT	EQU	10H
11274  0000000                   FXF10_INT_BIT	EQU	20H
11275  0000000                   ;





11276  0000000                   FXF15_INT_BIT	EQU	80H
11277  0000000                   
11278  0000000                   .ENDIF
11279  0000000                   
11280  0000000                   ; *21.3ms
11281  0000000                   T0001S_21	EQU	0FFD1H ;47
11282  0000000                   T0005S_21	EQU	0FF15H ;
11283  0000000                   T0020S_21	EQU	0FC55H ;
11284  0000000                   T0300S_21	EQU	0C833H ;
11285  0000000                   
11286  0000000                   ; *42.6ms
11287  0000000                   T0001S_42	EQU	0FFE8H ;24
11288  0000000                   T0003S_42	EQU	0FFB9H ;71
11289  0000000                   T0005S_42	EQU	0FF88H ;120
11290  0000000                   T0006S_42	EQU	0FF73H ;141
11291  0000000                   T0009S_42	EQU	0FF2DH;211
11292  0000000                   T0020S_42	EQU	0FE20H ;480
11293  0000000                   T1200S_42 EQU	091F7H;28169
11294  0000000                   T1800S_42	EQU	05898H;
11295  0000000                   T2400S_42 EQU	023EEH;56338
11296  0000000                   
11297  0000000                   ;==========================================
11298  0000000                   C_ORGAN_KEY_ST						EQU	00H
11299  0000000                   C_DRUM_KEY_ST						EQU	30H
11300  0000000                   C_DRUM_KEY_END					EQU	3FH+1
11301  0000000                   C_INS_KEY_ST						EQU	40H ; ´ÓÕâ¸ö¼ü¿ªÊ¼Ö»ÓÐÒ»¸ö¼üÓÐÐ§.
11302  0000000                   
11303  0000000                   ;--- ´ÓÕâ¸ö¼ü¿ªÊ¼Ö»ÓÐÒ»¸ö¼üÓÐÐ§.ÔÚ¹¦ÄÜÉÏ·ÀÖ¹ËÄ½Ç´í¼üµ½¹¦ÄÜ¼ü¡£¹Ä¼ü¶à¼üÓÐÐ§.
11304  0000000                   ;C_SINGLE_KEY_ST						EQU	C_INS_KEY_ST
11305  0000000                   ;--- ´ÓÕâ¸ö¼ü¿ªÊ¼Ö»ÓÐÒ»¸ö¼üÓÐÐ§.ÔÚÎ»ÖÃÉÏ(°ÑÇÙ¼üµ¥¶ÀÅÅÔÚÒ»¸ö¾ØÕóÖÐ)·ÀÖ¹ËÄ½Ç´í¼üµ½¹¦ÄÜ¼ü¡£¹Ä¼üÖ»ÓÐÒ»¸ö¼üÓÐÐ§
11306  0000000                   C_SINGLE_KEY_ST						EQU	C_NOP
11307  0000000                   
11308  0000000                   
11309  0000000                   C_RHY_KEY_ST						EQU	50H
11310  0000000                   C_FUNC_KEY_ST					EQU	60H;
11311  0000000                   
11312  0000000                   
11313  0000000                   
11314  0000000                   
11315  0000000                   
11316  0000000                   
11317  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\WAITKEY_CONST.H.APP"
11318  0000000                   ;=======================================
11319  0000000                   ;	<< WAITKEY_CONST.ASM >>
11320  0000000                   ;===========================================
11321  0000000                   
11322  0000000                   
11323  0000000                   C_DLYCNT0_ENABLE	EQU	1
11324  0000000                   C_DLYCNT1_ENABLE	EQU	0
11325  0000000                   C_DLYCNT2_ENABLE	EQU	0
11326  0000000                   C_DLYCNT3_ENABLE	EQU	0
11327  0000000                   C_DLYCNT4_ENABLE	EQU	0
11328  0000000                   C_DLYCNT5_ENABLE	EQU	0
11329  0000000                   
11330  0000000                   ;
11331  0000000                   
11332  0000000                   B_USER_MS1_BUSY	EQU	C_BIT7





11333  0000000                   
11334  0000000                   ;========================================
11335  0000000                   C_AUTO_CNT_BIT	EQU	C_BIT7
11336  0000000                   C_CNT0_BIT		EQU	C_BIT0
11337  0000000                   C_CNT1_BIT		EQU	C_BIT1
11338  0000000                   C_CNT2_BIT		EQU	C_BIT2
11339  0000000                   C_CNT3_BIT		EQU	C_BIT3
11340  0000000                   C_CNT4_BIT		EQU	C_BIT4
11341  0000000                   
11342  0000000                   C_FG0_BIT		EQU	C_BIT5
11343  0000000                   C_FG1_BIT		EQU	C_BIT6
11344  0000000                   
11345  0000000                   C_EQU_CNT_BIT			EQU	C_BIT5
11346  0000000                   
11347  0000000                   
11348  0000000                   C_SPCH1_BIT		EQU	C_BIT0
11349  0000000                   C_SPCH2_BIT		EQU	C_BIT1
11350  0000000                   C_SPCH3_BIT		EQU	C_BIT2
11351  0000000                   C_MS1_BIT		EQU	C_BIT3
11352  0000000                   
11353  0000000                   C_CHK_SPCH1_BIT		EQU	C_BIT0
11354  0000000                   C_CHK_SPCH2_BIT		EQU	C_BIT1
11355  0000000                   C_CHK_SPCH3_BIT		EQU	C_BIT2
11356  0000000                   C_CHK_MS1_BIT		EQU	C_BIT3
11357  0000000                   
11358  0000000                   C_KEYCH0_BIT	EQU	C_BIT4
11359  0000000                   C_KEYCH1_BIT	EQU	C_BIT5
11360  0000000                   C_KEYCH2_BIT	EQU	C_BIT6
11361  0000000                   C_KEYCH3_BIT	EQU	C_BIT7
11362  0000000                   
11363  0000000                   C_MS_SP_AUTOS		EQU	C_BIT0
11364  0000000                   C_NOTEONCH0_AUTOS	EQU	C_BIT1
11365  0000000                   C_NOTEONCH1_AUTOS	EQU	C_BIT2
11366  0000000                   	.IF (C_CHIP.EQ.C_W567BS)
11367  0000000                   FXF15_INT_BIT	EQU	0200H
11368  0000000                   	.ENDIF
11369  0000000                   	.IF (C_CHIP.EQ.C_N567GHK)
11370  0000000                   FXF15_INT_BIT	EQU	0020H
11371  0000000                   	.ENDIF
11372  0000000                   	.IF (C_CHIP.EQ.C_W588AS)
11373  0000000                   FXF15_INT_BIT	EQU	0200H
11374  0000000                   	.ENDIF
11375  0000000                   	.IF (C_CHIP.EQ.C_W588CD)
11376  0000000                   FXF15_INT_BIT	EQU	0200H
11377  0000000                   	.ENDIF
11378  0000000                   	.IF (C_CHIP.EQ.C_W567CJ)
11379  0000000                   FXF15_INT_BIT	EQU	0100H
11380  0000000                   	.ENDIF
11381  0000000                   
11382  0000000                   	.IF (C_CHIP.EQ.C_W567BS)
11383  0000000                   PORT_INT_BIT	EQU	0001H
11384  0000000                   	.ENDIF
11385  0000000                   	.IF (C_CHIP.EQ.C_N567GHK)
11386  0000000                   PORT_INT_BIT	EQU	0001H
11387  0000000                   	.ENDIF
11388  0000000                   	.IF (C_CHIP.EQ.C_W588AS)
11389  0000000                   PORT_INT_BIT	EQU	0001H





11390  0000000                   	.ENDIF
11391  0000000                   	.IF (C_CHIP.EQ.C_W588CD)
11392  0000000                   PORT_INT_BIT	EQU	0001H
11393  0000000                   	.ENDIF
11394  0000000                   	.IF (C_CHIP.EQ.C_W567CJ)
11395  0000000                   PORT_INT_BIT	EQU	0001H
11396  0000000                   	.ENDIF
11397  0000000                   
11398  0000000                   	.IF (C_CHIP.EQ.C_N567GHK)
11399  0000000                   TMG1_INT_BIT	EQU	0004H
11400  0000000                   	.ENDIF
11401  0000000                   
11402  0000000                   	.IF (C_CHIP.EQ.C_N567GHK)
11403  0000000                   C_TMG1C_DIV2	EQU	00H
11404  0000000                   C_TMG1C_DIV4	EQU	08H
11405  0000000                   C_TMG1C_DIV8	EQU	02H
11406  0000000                   C_TMG1C_DIV64	EQU	04H
11407  0000000                   C_TMG1C_DIV512	EQU	06H
11408  0000000                   C_TMG1C_DIV8192	EQU	0CH
11409  0000000                   	.ENDIF
11410  0000000                   
11411  0000000                   
11412  0000000                   
11413  0000000                   
11414  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_CONST.H.APP"
11415  0000000                   ;=====================================
11416  0000000                   ;	<< PROJ_CONST.H >>
11417  0000000                   ;===========================================
11418  0000000                   
11419  0000000                   
11420  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_CONST1.H.APP"
11421  0000000                   ;=======================================
11422  0000000                   ;	<< PROJ_CONST.H >>
11423  0000000                   ;===========================================
11424  0000000                   ;	IO¿Ú ÅäÖÃ
11425  0000000                   ;=========================================
11426  0000000                   ;ÉÏµç×´Ì¬
11427  0000000                   ;==================================================
11428  0000000                   ;IO configure:
11429  0000000                   
11430  0000000                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
11431  0000000                   C_PWON_BP0D		EQU	00000000B
11432  0000000                   C_PWON_BP0M_BAK	EQU	00000000B ; 1: input:pullhigh / 0:output / Floating
11433  0000000                   C_PWON_BP0_OP	EQU	11111111B
11434  0000000                   
11435  0000000                   .ELSE
11436  0000000                   C_PWON_BP0D		EQU	00000000B
11437  0000000                   C_PWON_R_BP0	EQU	11111111B;1: input:pullhigh / output: CMOS
11438  0000000                   .ENDIF
11439  0000000                   
11440  0000000                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
11441  0000000                   
11442  0000000                   C_PWON_BP1D		EQU	11111111B
11443  0000000                   C_PWON_BP1M_BAK	EQU	11111111B; 1: input:pullhigh / 0:output / Floating
11444  0000000                   C_PWON_BP1_OP	EQU	11111111B
11445  0000000                   .ELSE
11446  0000000                   C_PWON_BP1D		EQU	11111111B





11447  0000000                   C_PWON_R_BP1	EQU	11111111B;1: input:pullhigh ; BP10 input floating
11448  0000000                   .ENDIF
11449  0000000                   
11450  0000000                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )
11451  0000000                   
11452  0000000                   C_PWON_BP2D		EQU	11B;BP2D[0], and BP24~BP27 by BP2D[1]
11453  0000000                   C_PWON_BP2M_BAK	EQU	11111111B; 1: input:pullhigh / 0:output / Floating
11454  0000000                   C_PWON_BP1_OP	EQU	11111111B
11455  0000000                   .ELSE
11456  0000000                   C_PWON_BP2D		EQU	11B;BP2D[0], and BP24~BP27 by BP2D[1]
11457  0000000                   C_PWON_R_BP2	EQU	11111111B;1: input:pullhigh
11458  0000000                   .ENDIF
11459  0000000                   
11460  0000000                   ;=============================================
11461  0000000                   ;»½ÐÑ×´Ì¬£º
11462  0000000                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
11463  0000000                   C_WAKEUP_BP0D		EQU	00000000B
11464  0000000                   C_WAKEUP_BP0M_BAK	EQU	00000000B ; 1: input:pullhigh / 0:output / Floating
11465  0000000                   C_WAKEUP_BP0_OP	EQU	11111111B
11466  0000000                   
11467  0000000                   C_WAKEUP1_BP0D		EQU	C_WAKEUP_BP0D
11468  0000000                   C_WAKEUP1_BP0M_BAK	EQU	C_WAKEUP_BP0M_BAK
11469  0000000                   C_WAKEUP1_BP0_OP	EQU	C_WAKEUP_BP0_OP
11470  0000000                   
11471  0000000                   .ELSE
11472  0000000                   C_WAKEUP_BP0D		EQU	00000000B
11473  0000000                   C_WAKEUP_R_BP0	EQU	11111111B;1: input:pullhigh / output: CMOS
11474  0000000                   
11475  0000000                   C_WAKEUP1_BP0D		EQU	C_WAKEUP_BP0D
11476  0000000                   C_WAKEUP1_R_BP0	EQU	C_WAKEUP_R_BP0;1: input:pullhigh / output: CMOS
11477  0000000                   .ENDIF
11478  0000000                   
11479  0000000                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
11480  0000000                   
11481  0000000                   C_WAKEUP_BP1D		EQU	11111111B
11482  0000000                   C_WAKEUP_BP1M_BAK	EQU	11111111B; 1: input:pullhigh / 0:output / Floating
11483  0000000                   C_WAKEUP_BP1_OP	EQU	11111111B
11484  0000000                   
11485  0000000                   C_WAKEUP1_BP1D		EQU	C_WAKEUP_BP1D
11486  0000000                   C_WAKEUP1_BP1M_BAK	EQU	C_WAKEUP_BP1M_BAK
11487  0000000                   C_WAKEUP1_BP1_OP	EQU	C_WAKEUP_BP1_OP
11488  0000000                   
11489  0000000                   .ELSE
11490  0000000                   C_WAKEUP_BP1D		EQU	11111111B
11491  0000000                   C_WAKEUP_R_BP1	EQU	11111111B;1: input:pullhigh ; BP10 input floating
11492  0000000                   
11493  0000000                   C_WAKEUP1_BP1D		EQU	C_WAKEUP_BP1D
11494  0000000                   C_WAKEUP1_R_BP1	EQU	C_WAKEUP_R_BP1 ;input:pullhigh;float
11495  0000000                   .ENDIF
11496  0000000                   
11497  0000000                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )
11498  0000000                   
11499  0000000                   C_WAKEUP_BP2D		EQU	11B;BP2D[0], and BP24~BP27 by BP2D[1]
11500  0000000                   C_WAKEUP_BP2M_BAK	EQU	11111111B; 1: input:pullhigh / 0:output / Floating
11501  0000000                   C_WAKEUP_BP1_OP	EQU	11111111B
11502  0000000                   
11503  0000000                   C_WAKEUP1_BP2D		EQU	C_WAKEUP_BP2D;BP2D[0], and BP24~BP27 by BP2D[1]





11504  0000000                   C_WAKEUP1_BP2M_BAK	EQU	C_WAKEUP_BP2M_BAK; 1: input:pullhigh / 0:output / Floating
11505  0000000                   C_WAKEUP1_BP1_OP	EQU	C_WAKEUP_BP1_OP
11506  0000000                   
11507  0000000                   .ELSE
11508  0000000                   C_WAKEUP_BP2D		EQU	11B;BP2D[0], and BP24~BP27 by BP2D[1]
11509  0000000                   C_WAKEUP_R_BP2	EQU	11111111B;1: input:pullhigh
11510  0000000                   
11511  0000000                   C_WAKEUP1_BP2D		EQU	C_WAKEUP_BP2D;BP2D[0], and BP24~BP27 by BP2D[1]
11512  0000000                   C_WAKEUP1_R_BP2	EQU	C_WAKEUP_R_BP2;1: input:pullhigh
11513  0000000                   .ENDIF
11514  0000000                   ;
11515  0000000                   
11516  0000000                   ;
11517  0000000                   ;=========================================
11518  0000000                   ;ÐÝÃß×´Ì¬£º
11519  0000000                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
11520  0000000                   C_PWOFF_BP0D		EQU	00000000B
11521  0000000                   C_PWOFF_BP0M_BAK	EQU	00000000B ; 1: input:pullhigh / 0:output / Floating
11522  0000000                   C_PWOFF_BP0_OP	EQU	11111111B
11523  0000000                   .ELSE
11524  0000000                   C_PWOFF_BP0D	EQU	00000000B
11525  0000000                   C_PWOFF_R_BP0	EQU	11111111B ; 
11526  0000000                   .ENDIF
11527  0000000                   
11528  0000000                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
11529  0000000                   C_PWOFF_BP1D		EQU	00000000B
11530  0000000                   C_PWOFF_BP1M_BAK	EQU	00000000B ; 1: input:pullhigh / 0:output / Floating
11531  0000000                   C_PWOFF_BP1_OP	EQU	11111111B
11532  0000000                   .ELSE
11533  0000000                   C_PWOFF_BP1D		EQU	11111111B;Ö»ÓÐBP1²ÅÄÜ»½ÐÑ
11534  0000000                   C_PWOFF_R_BP1	EQU	11111111B ;
11535  0000000                   .ENDIF
11536  0000000                   
11537  0000000                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )
11538  0000000                   C_PWOFF_BP2D		EQU	00000000B
11539  0000000                   C_PWOFF_BP2M_BAK	EQU	00000000B ; 1: input:pullhigh / 0:output / Floating
11540  0000000                   C_PWOFF_BP2_OP	EQU	11111111B
11541  0000000                   .ELSE
11542  0000000                   C_PWOFF_BP2D	EQU	11B;BP2D[0], BP20~BP23 by BP2D[0] and BP24~BP27 by BP2D[1]
11543  0000000                   C_PWOFF_R_BP2	EQU	11111111B;1: input:pullhigh
11544  0000000                   .ENDIF
11545  0000000                   
11546  0000000                   ; For 'BK0_STORE_BPX_WO_BOND'
11547  0000000                   C_BP0_BOND EQU	00000000B
11548  0000000                   C_BP1_BOND EQU	00000000B
11549  0000000                   C_BP2_BOND EQU	00000000B
11550  0000000                   
11551  0000000                   ;================================
11552  0000000                   ;»½ÐÑÔÊÐí£ºwakeup enable
11553  0000000                   C_BP1EN_PWOFF	EQU	00000011B
11554  0000000                   
11555  0000000                   ;==========================================
11556  0000000                   
11557  0000000                   
11558  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\MAIN0_CONST.H.APP"
11559  0000000                   
11560  0000000                   C_MODESWITCH_CHK_EN EQU 0





11561  0000000                   
11562  0000000                   
11563  0000000                   
11564  0000000                   
11565  0000000                   
11566  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\ALL_RAM_FILES.H.APP"
11567  0000000                   ; <<<<<<< 1.6.1.4 >>>>>>>>>>> 
11568  0000000                   ; Create Time: 2018/10/23 ÐÇÆÚ¶þ ÉÏÎç 10:35:10
11569  0000000                   
11570  0000000                   ;==========================================================
11571  0000000                   R_USER_RAM_ST	DS	0
11572  0000000                   
11573  0000000                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\WAITKEY_RAM.H.APP"
11574  0000000                   
11575  0000000                   C_DRUMLED_LEN	EQU	T000504MS
11576  0000000                   ;----------------------
11577  0000000                   ; RAM
11578  0000000                   ;-----------------------------
11579  0000000                   ;.IF ( C_EVP_DLY_EN .EQ. 1 )
11580  0000000                   ;Õ¼ÓÃÒ»¸öRAM
11581  0000000                   ;WB_EVP_DLYCNT	DS	1
11582  0000000                   
11583  0000000                   ;.ENDIF
11584  0000000                   
11585  0000000                   ;===========================================
11586  0000000                   ;pls define below RAMs
11587  0000000                   .IF ( C_DLYCNT0_ENABLE .EQ. 1 )
11588  0000000                   WB_DLYCNT0	DS	2
11589  0000002                   WB_DLYCNT0_IDX DS	1
11590  0000003                   .ENDIF
11591  0000003                   
11592  0000003                   .IF ( C_DLYCNT1_ENABLE .EQ. 1 )
11593  0000003                   WB_DLYCNT1	DS	2
11594  0000003                   WB_DLYCNT1_IDX DS	1
11595  0000003                   .ENDIF
11596  0000003                   
11597  0000003                   .IF ( C_DLYCNT2_ENABLE .EQ. 1 )
11598  0000003                   WB_DLYCNT2	DS	2
11599  0000003                   WB_DLYCNT2_IDX DS 1
11600  0000003                   .ENDIF
11601  0000003                   .IF ( C_DLYCNT3_ENABLE .EQ. 1 )
11602  0000003                   WB_DLYCNT3	DS	2
11603  0000003                   .ENDIF
11604  0000003                   .IF ( C_DLYCNT4_ENABLE .EQ. 1 )
11605  0000003                   WB_DLYCNT4	DS	2
11606  0000003                   .ENDIF
11607  0000003                   
11608  0000003                   
11609  0000003                   USER_FLAG_A	DS	1
11610  0000004                   ;.0=1: CH1 END
11611  0000004                   ;.1=1: CH2 END
11612  0000004                   ;.2=1: MS END
11613  0000004                   ;.3=1: CH3 END
11614  0000004                   ;.4=1: new KEY1
11615  0000004                   ;.5=1: new KEY2
11616  0000004                   ;.6=1: new KEY3
11617  0000004                   ;.7=1: new KEY4





11618  0000004                   
11619  0000004                   USER_FLAG_B	DS	1
11620  0000005                   ;.0: CNT0
11621  0000005                   ;.1: CNT1
11622  0000005                   ;.2: CNT2
11623  0000005                   ;.3: CNT3
11624  0000005                   ;.4: CNT4
11625  0000005                   ;.5: EQU_CNT
11626  0000005                   ;.6: EXT0;; share for user
11627  0000005                   ;.7: auto CNT REACH
11628  0000005                   
11629  0000005                   
11630  0000005                   
11631  0000005                   USER_FLAG10	DS	1
11632  0000006                   ;.4 -.7=1: 8MS/8.192/5.33MS
11633  0000006                   ;.0=1: CHECK CH1
11634  0000006                   ;.1=1: CHECK CH2
11635  0000006                   ;.2=1: CHECK MS ; share for used
11636  0000006                   ;.3=1: CHECK CH3; share for used
11637  0000006                   
11638  0000006                   
11639  0000006                   USER_INT_FLAG0	DS	1
11640  0000007                   ;.2=1: TMG0 2MS REACH
11641  0000007                   ;.3=1: 5.33M REACH
11642  0000007                   
11643  0000007                   
11644  0000007                   
11645  0000007                   .IF ( C_BP0_ULTRAIO_EN .EQ. 0 )
11646  0000007                   .IFNDEF R_BP0
11647  0000007                   	.IF ( C_R_BP0_USED .EQ. 1 )
11648  0000007                   R_BP0	DS	1
11649  0000007                   	.ENDIF
11650  0000007                   .ENDIF
11651  0000007                   .ENDIF
11652  0000007                   
11653  0000007                   .IF ( C_BP1_ULTRAIO_EN .EQ. 0 )
11654  0000007                   .IFNDEF R_BP1
11655  0000007                   	.IF ( C_R_BP1_USED .EQ. 1 )
11656  0000007                   R_BP1	DS	1
11657  0000008                   	.ENDIF
11658  0000008                   .ENDIF
11659  0000008                   .ENDIF
11660  0000008                   .IF ( C_BP2_ULTRAIO_EN .EQ. 0 )
11661  0000008                   .IFNDEF R_BP2
11662  0000008                   	.IF ( C_R_BP2_USED .EQ. 1 )
11663  0000008                   R_BP2	DS	1
11664  0000008                   	.ENDIF
11665  0000008                   .ENDIF
11666  0000008                   .ENDIF
11667  0000008                   
11668  0000008                   .IF ( C_BP0_STATUS_EN .EQ. 1 )
11669  0000008                   BP0_STATUS	DS	1
11670  0000009                   .ENDIF
11671  0000009                   .IF ( C_BP1_STATUS_EN .EQ. 1 )
11672  0000009                   BP1_STATUS	DS	1
11673  000000A                   .ENDIF
11674  000000A                   .IF ( C_BP2_STATUS_EN .EQ. 1 )





11675  000000A                   BP2_STATUS	DS	1
11676  000000A                   .ENDIF
11677  000000A                   
11678  000000A                   WB_KEYCH_CODE	DS	C_KEYCH_MAX ;not include matrix KEY
11679  000000D                   
11680  000000D                   
11681  000000D                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_RAM.H.APP"
11682  000000D                   ;=======================================
11683  000000D                   ;	<< PROJ_RAM.ASM >>
11684  000000D                   ;===========================================
11685  000000D                   
11686  000000D                   
11687  000000D                   CONST_LED0_ON	EQU	00100000B
11688  000000D                   CONST_LED1_ON	EQU	00010000B
11689  000000D                   CONST_LED2_ON	EQU	00110000B
11690  000000D                   CONST_ALL_LED_ON EQU	00000000B
11691  000000D                   CONST_ALL_LED_OFF EQU	00110000B
11692  000000D                   
11693  000000D                   
11694  000000D                   ;===========================================
11695  000000D                   ;C_MAX_VOL_IDX	EQU	0A0H
11696  000000D                   ;C_MAX_TPO_IDX	EQU	0AH
11697  000000D                   ;===========================================
11698  000000D                   ;C_DEFAULT_TPO_IDX	EQU	05H
11699  000000D                   ;C_DEFAULT_VOL_IDX	EQU	90H
11700  000000D                   
11701  000000D                   ;===================================
11702  000000D                   ;
11703  000000D                   C_PWON_MODE	EQU	00H
11704  000000D                   
11705  000000D                   
11706  000000D                   
11707  000000D                   ;VOL_TPO_IDX	DS	1
11708  000000D                   ;.3:.0:TPO LEVEL
11709  000000D                   ;.7:.4:VOL LEVEL
11710  000000D                   
11711  000000D                   
11712  000000D                   SYS_MODE_NO	DS	1
11713  000000E                   ;.7:.5:SUB MODE
11714  000000E                   ;.4:.0: mode
11715  000000E                   ;SYS_EVENT_CNT DS	1
11716  000000E                   
11717  000000E                   
11718  000000E                   SPCH1_SOUND_NO	DS	1
11719  000000F                   SPCH2_SOUND_NO	DS	1
11720  0000010                   
11721  0000010                   
11722  0000010                   
11723  0000010                   ;USER_FLAG20	DS	1
11724  0000010                   ;.7 = 0/1: SPEECH / EQU
11725  0000010                   ;.6 = 0/1: normal eqution / EVT driver equation
11726  0000010                   ;.5 = 0 / 1: CMPB ;detect
11727  0000010                   ;.4 = 0 / 1: CMPA ;detect
11728  0000010                   
11729  0000010                   ;.3=0/1: VOL + / -
11730  0000010                   ;.1=0: 
11731  0000010                   





11732  0000010                   ;.0 = 0/1: POWER OFF /POWER ON
11733  0000010                   
11734  0000010                   REG_EA		DS	1
11735  0000011                   REG_HL		DS	1
11736  0000012                   
11737  0000012                   
11738  0000012                   R_LED_TBL_CNT	DS	1
11739  0000013                   ;0:normal
11740  0000013                   ;1-x: flash led
11741  0000013                   
11742  0000013                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\AUTOSLEEP_RAM.H.APP"
11743  0000013                   
11744  0000013                   
11745  0000013                   
11746  0000013                   
11747  0000013                   
11748  0000013                   
11749  0000013                   ;==================================
11750  0000013                   ;	N588H ºÍ N567H Í³Ò»
11751  0000013                   ;=====================================
11752  0000013                   C_AUTOSLEEP_MS1_BIT	EQU	C_BIT2
11753  0000013                   C_AUTOSLEEP_DRUMP_BIT	EQU	C_BIT3
11754  0000013                   
11755  0000013                   C_AS_DRUMP_RP_CH_BIT	EQU	C_BIT7
11756  0000013                   
11757  0000013                   
11758  0000013                   C_AUTOSLEEP_1B EQU	0
11759  0000013                   C_AUTOSLEEP_2B EQU	1
11760  0000013                   
11761  0000013                   C_AUTOSLEEP_FLAG_EN EQU	0
11762  0000013                   
11763  0000013                   
11764  0000013                   .IF ( C_AUTOSLEEP_FLAG_EN .EQ. 1 )
11765  0000013                   AUTOSLEEP_FLAG	DS	1
11766  0000013                   ;.0=0/1:SPEECH CH1 NOT PLAYING/PLAYING
11767  0000013                   ;.1=0/1:SPEECH CH2 NOT PLAYING/PLAYING
11768  0000013                   ;.2=0/1:MS1 NOT PLAYING/PLAYING
11769  0000013                   ;.3=0/1:SPEECH CH3 NOT PLAYING/PLAYING
11770  0000013                   ;
11771  0000013                   ;.4=0/1:NOTEON CH1 NOT PLAYING/PLAYING
11772  0000013                   ;.5=0/1:NOTEON CH2 NOT PLAYING/PLAYING
11773  0000013                   ;.6=0/1:NOTEON CH3 NOT PLAYING/PLAYING
11774  0000013                   ;.7=0/1:NOTEON CH4 NOT PLAYING/PLAYING
11775  0000013                   
11776  0000013                   AUTOSLEEP_FLAG_BK	DS	1
11777  0000013                   .ENDIF
11778  0000013                   
11779  0000013                   WB_AUTOCNT0	DS	1
11780  0000014                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
11781  0000014                   WB_AUTOCNT01	DS	1
11782  0000015                   .ENDIF
11783  0000015                   
11784  0000015                   
11785  0000015                   
11786  0000015                   
11787  0000015                   
11788  0000015                   





11789  0000015                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\CHKSKEY_RAM.H.APP"
11790  0000015                   
11791  0000015                   
11792  0000015                   
11793  0000015                   
11794  0000015                   ;--------------------------------------
11795  0000015                   ;>>>> 	configure    <<<<
11796  0000015                   ;--------------------------------------
11797  0000015                   ;¹ØÓÚÉ¨Ãè°´¼üÍ¨µÀºÍÉ¨Ãè×´Ì¬
11798  0000015                   ;
11799  0000015                   ;¹ØÓÚÉ¨Ãè°´¼üÍ¨µÀ:
11800  0000015                   ; ÊÇÒ»¸ö´¥·¢×´Ì¬£¬ÓÐ¶ÔÓ¦µÄÊÂ¼þ´¦Àí£º
11801  0000015                   ;
11802  0000015                   ;¹ØÓÚÉ¨Ãè×´Ì¬:
11803  0000015                   ; ¸üÐÂ×´Ì¬£¬¼ÇÂ¼×´Ì¬£¬²»Ò»¶¨ÐèÒª´¦Àí
11804  0000015                   ;
11805  0000015                   ;
11806  0000015                   ;--------------------------------
11807  0000015                   ;	input port
11808  0000015                   ;-------------------------------
11809  0000015                   
11810  0000015                   ;=========================================
11811  0000015                   
11812  0000015                   ;=========================================
11813  0000015                   C_S_KEY1_ENABLE	EQU	1
11814  0000015                   C_S_KEY2_ENABLE	EQU	1
11815  0000015                   C_S_KEY3_ENABLE	EQU	0
11816  0000015                   C_S_KEY4_ENABLE	EQU	0
11817  0000015                   C_S_KEY5_ENABLE	EQU	0
11818  0000015                   C_S_KEY6_ENABLE	EQU	0
11819  0000015                   C_S_KEY7_ENABLE	EQU	0
11820  0000015                   C_S_KEY8_ENABLE	EQU	0
11821  0000015                   C_S_KEY9_ENABLE	EQU	0
11822  0000015                   C_S_KEY10_ENABLE	EQU	0
11823  0000015                   C_S_KEY11_ENABLE	EQU	0
11824  0000015                   C_S_KEY12_ENABLE	EQU	0
11825  0000015                   C_S_KEY13_ENABLE	EQU	0
11826  0000015                   C_S_KEY14_ENABLE	EQU	0
11827  0000015                   C_S_KEY15_ENABLE	EQU	0
11828  0000015                   C_S_KEY16_ENABLE	EQU	0
11829  0000015                   C_S_KEY17_ENABLE	EQU	0
11830  0000015                   C_S_KEY18_ENABLE	EQU	0
11831  0000015                   C_S_KEY19_ENABLE	EQU	0
11832  0000015                   C_S_KEY20_ENABLE	EQU	0
11833  0000015                   C_S_KEY21_ENABLE	EQU	0
11834  0000015                   C_S_KEY22_ENABLE	EQU	0
11835  0000015                   C_S_KEY23_ENABLE	EQU	0
11836  0000015                   C_S_KEY24_ENABLE	EQU	0
11837  0000015                   
11838  0000015                   
11839  0000015                   
11840  0000015                   ;=========================================
11841  0000015                   ;debounce * 5.33ms
11842  0000015                   .IF ( C_S_KEY1_ENABLE .EQ. 1)
11843  0000015                   B_S_KEY1	EQU	C_BIT0
11844  0000015                   SR_S_KEY1_PORT	EQU	BP1
11845  0000015                   R_S_KEY1_STATUS	EQU	BP1_STATUS





11846  0000015                   C_S_KEY1_DEBOUNCE	EQU	0F9H ;* 5.33ms ;MODE
11847  0000015                   R_S_KEY1_DEBOUNCE	DS	1
11848  0000016                   .ENDIF
11849  0000016                   .IF ( C_S_KEY2_ENABLE .EQ. 1)
11850  0000016                   B_S_KEY2	EQU	C_BIT1
11851  0000016                   SR_S_KEY2_PORT	EQU	BP1
11852  0000016                   R_S_KEY2_STATUS	EQU	BP1_STATUS
11853  0000016                   C_S_KEY2_DEBOUNCE	EQU	0F9H
11854  0000016                   R_S_KEY2_DEBOUNCE	DS	1
11855  0000017                   .ENDIF
11856  0000017                   .IF ( C_S_KEY3_ENABLE .EQ. 1)
11857  0000017                   B_S_KEY3	EQU	C_BIT6
11858  0000017                   SR_S_KEY3_PORT	EQU	BP1
11859  0000017                   R_S_KEY3_STATUS	EQU	BP1_STATUS
11860  0000017                   C_S_KEY3_DEBOUNCE	EQU	0F9H
11861  0000017                   R_S_KEY3_DEBOUNCE	DS	1
11862  0000017                   .ENDIF
11863  0000017                   .IF ( C_S_KEY4_ENABLE .EQ. 1)
11864  0000017                   B_S_KEY4	EQU	C_BIT7
11865  0000017                   SR_S_KEY4_PORT	EQU	BP1
11866  0000017                   R_S_KEY4_STATUS	EQU	BP1_STATUS
11867  0000017                   C_S_KEY4_DEBOUNCE	EQU	0F9H
11868  0000017                   R_S_KEY4_DEBOUNCE	DS	1
11869  0000017                   .ENDIF
11870  0000017                   .IF ( C_S_KEY5_ENABLE .EQ. 1)
11871  0000017                   B_S_KEY5	EQU	C_BIT4
11872  0000017                   SR_S_KEY5_PORT	EQU	BP1
11873  0000017                   R_S_KEY5_STATUS	EQU	BP1_STATUS
11874  0000017                   C_S_KEY5_DEBOUNCE	EQU	0F9H
11875  0000017                   R_S_KEY5_DEBOUNCE	DS	1
11876  0000017                   .ENDIF
11877  0000017                   .IF ( C_S_KEY6_ENABLE .EQ. 1)
11878  0000017                   B_S_KEY6	EQU	C_BIT6
11879  0000017                   SR_S_KEY6_PORT	EQU	BP1
11880  0000017                   R_S_KEY6_STATUS	EQU	BP1_STATUS
11881  0000017                   C_S_KEY6_DEBOUNCE	EQU	0F9H
11882  0000017                   R_S_KEY6_DEBOUNCE	DS	1
11883  0000017                   .ENDIF
11884  0000017                   ;
11885  0000017                   .IF ( C_S_KEY7_ENABLE .EQ. 1)
11886  0000017                   B_S_KEY7	EQU	C_BIT7
11887  0000017                   SR_S_KEY7_PORT	EQU	BP1
11888  0000017                   R_S_KEY7_STATUS	EQU	BP1_STATUS
11889  0000017                   C_S_KEY7_DEBOUNCE	EQU	0F9H
11890  0000017                   R_S_KEY7_DEBOUNCE	DS	1
11891  0000017                   .ENDIF
11892  0000017                   
11893  0000017                   .IF ( C_S_KEY8_ENABLE .EQ. 1)
11894  0000017                   B_S_KEY8	EQU	C_BIT7
11895  0000017                   SR_S_KEY8_PORT	EQU	BP1
11896  0000017                   R_S_KEY8_STATUS	EQU	BP1_STATUS
11897  0000017                   C_S_KEY8_DEBOUNCE	EQU	0F9H
11898  0000017                   R_S_KEY8_DEBOUNCE	DS	1
11899  0000017                   .ENDIF
11900  0000017                   
11901  0000017                   .IF ( C_S_KEY9_ENABLE .EQ. 1)
11902  0000017                   B_S_KEY9	EQU	C_BIT6





11903  0000017                   SR_S_KEY9_PORT	EQU	BP1
11904  0000017                   R_S_KEY9_STATUS	EQU	BP1_STATUS
11905  0000017                   C_S_KEY9_DEBOUNCE	EQU	0F9H
11906  0000017                   R_S_KEY9_DEBOUNCE	DS	1
11907  0000017                   .ENDIF
11908  0000017                   
11909  0000017                   .IF ( C_S_KEY10_ENABLE .EQ. 1)
11910  0000017                   B_S_KEY10	EQU	C_BIT7
11911  0000017                   SR_S_KEY10_PORT	EQU	BP1
11912  0000017                   R_S_KEY10_STATUS	EQU	BP1_STATUS
11913  0000017                   C_S_KEY10_DEBOUNCE	EQU	0F9H
11914  0000017                   R_S_KEY10_DEBOUNCE	DS	1
11915  0000017                   .ENDIF
11916  0000017                   
11917  0000017                   .IF ( C_S_KEY11_ENABLE .EQ. 1)
11918  0000017                   B_S_KEY11	EQU	C_BIT7
11919  0000017                   SR_S_KEY11_PORT	EQU	BP0
11920  0000017                   R_S_KEY11_STATUS	EQU	BP0_STATUS
11921  0000017                   C_S_KEY11_DEBOUNCE	EQU	0F9H
11922  0000017                   R_S_KEY11_DEBOUNCE	DS	1
11923  0000017                   .ENDIF
11924  0000017                   
11925  0000017                   .IF ( C_S_KEY12_ENABLE .EQ. 1)
11926  0000017                   B_S_KEY12	EQU	C_BIT2
11927  0000017                   SR_S_KEY12_PORT	EQU	BP1
11928  0000017                   R_S_KEY12_STATUS	EQU	BP1_STATUS
11929  0000017                   C_S_KEY12_DEBOUNCE	EQU	0FBH
11930  0000017                   R_S_KEY12_DEBOUNCE	DS	1
11931  0000017                   .ENDIF
11932  0000017                   
11933  0000017                   .IF ( C_S_KEY13_ENABLE .EQ. 1)
11934  0000017                   B_S_KEY13	EQU	C_BIT2
11935  0000017                   SR_S_KEY13_PORT	EQU	BP1
11936  0000017                   R_S_KEY13_STATUS	EQU	BP1_STATUS
11937  0000017                   C_S_KEY13_DEBOUNCE	EQU	0FBH
11938  0000017                   R_S_KEY13_DEBOUNCE	DS	1
11939  0000017                   .ENDIF
11940  0000017                   
11941  0000017                   .IF ( C_S_KEY14_ENABLE .EQ. 1)
11942  0000017                   B_S_KEY14	EQU	C_BIT2
11943  0000017                   SR_S_KEY14_PORT	EQU	BP1
11944  0000017                   R_S_KEY14_STATUS	EQU	BP1_STATUS
11945  0000017                   C_S_KEY14_DEBOUNCE	EQU	0FBH
11946  0000017                   R_S_KEY14_DEBOUNCE	DS	1
11947  0000017                   .ENDIF
11948  0000017                   
11949  0000017                   .IF ( C_S_KEY15_ENABLE .EQ. 1)
11950  0000017                   B_S_KEY15	EQU	C_BIT2
11951  0000017                   SR_S_KEY15_PORT	EQU	BP1
11952  0000017                   R_S_KEY15_STATUS	EQU	BP1_STATUS
11953  0000017                   C_S_KEY15_DEBOUNCE	EQU	0FBH
11954  0000017                   R_S_KEY15_DEBOUNCE	DS	1
11955  0000017                   .ENDIF
11956  0000017                   
11957  0000017                   .IF ( C_S_KEY16_ENABLE .EQ. 1)
11958  0000017                   B_S_KEY16	EQU	C_BIT2
11959  0000017                   SR_S_KEY16_PORT	EQU	BP1





11960  0000017                   R_S_KEY16_STATUS	EQU	BP1_STATUS
11961  0000017                   C_S_KEY16_DEBOUNCE	EQU	0FBH
11962  0000017                   R_S_KEY16_DEBOUNCE	DS	1
11963  0000017                   .ENDIF
11964  0000017                   
11965  0000017                   .IF ( C_S_KEY17_ENABLE .EQ. 1)
11966  0000017                   B_S_KEY17	EQU	C_BIT2
11967  0000017                   SR_S_KEY17_PORT	EQU	BP1
11968  0000017                   R_S_KEY17_STATUS	EQU	BP1_STATUS
11969  0000017                   C_S_KEY17_DEBOUNCE	EQU	0FBH
11970  0000017                   R_S_KEY17_DEBOUNCE	DS	1
11971  0000017                   .ENDIF
11972  0000017                   
11973  0000017                   .IF ( C_S_KEY18_ENABLE .EQ. 1)
11974  0000017                   B_S_KEY18	EQU	C_BIT2
11975  0000017                   SR_S_KEY18_PORT	EQU	BP1
11976  0000017                   R_S_KEY18_STATUS	EQU	BP1_STATUS
11977  0000017                   C_S_KEY18_DEBOUNCE	EQU	0FBH
11978  0000017                   R_S_KEY18_DEBOUNCE	DS	1
11979  0000017                   .ENDIF
11980  0000017                   
11981  0000017                   .IF ( C_S_KEY19_ENABLE .EQ. 1)
11982  0000017                   B_S_KEY19	EQU	C_BIT2
11983  0000017                   SR_S_KEY19_PORT	EQU	BP1
11984  0000017                   R_S_KEY19_STATUS	EQU	BP1_STATUS
11985  0000017                   C_S_KEY19_DEBOUNCE	EQU	0FBH
11986  0000017                   R_S_KEY19_DEBOUNCE	DS	1
11987  0000017                   .ENDIF
11988  0000017                   
11989  0000017                   .IF ( C_S_KEY20_ENABLE .EQ. 1)
11990  0000017                   B_S_KEY20	EQU	C_BIT2
11991  0000017                   SR_S_KEY20_PORT	EQU	BP1
11992  0000017                   R_S_KEY20_STATUS	EQU	BP1_STATUS
11993  0000017                   C_S_KEY20_DEBOUNCE	EQU	0FBH
11994  0000017                   R_S_KEY20_DEBOUNCE	DS	1
11995  0000017                   .ENDIF
11996  0000017                   
11997  0000017                   .IF ( C_S_KEY21_ENABLE .EQ. 1)
11998  0000017                   B_S_KEY21	EQU	C_BIT2
11999  0000017                   SR_S_KEY21_PORT	EQU	BP1
12000  0000017                   R_S_KEY21_STATUS	EQU	BP1_STATUS
12001  0000017                   C_S_KEY21_DEBOUNCE	EQU	0FBH
12002  0000017                   R_S_KEY21_DEBOUNCE	DS	1
12003  0000017                   .ENDIF
12004  0000017                   
12005  0000017                   .IF ( C_S_KEY22_ENABLE .EQ. 1)
12006  0000017                   B_S_KEY22	EQU	C_BIT2
12007  0000017                   SR_S_KEY22_PORT	EQU	BP1
12008  0000017                   R_S_KEY22_STATUS	EQU	BP1_STATUS
12009  0000017                   C_S_KEY22_DEBOUNCE	EQU	0FBH
12010  0000017                   R_S_KEY22_DEBOUNCE	DS	1
12011  0000017                   .ENDIF
12012  0000017                   
12013  0000017                   .IF ( C_S_KEY23_ENABLE .EQ. 1)
12014  0000017                   B_S_KEY23	EQU	C_BIT2
12015  0000017                   SR_S_KEY23_PORT	EQU	BP1
12016  0000017                   R_S_KEY23_STATUS	EQU	BP1_STATUS





12017  0000017                   C_S_KEY23_DEBOUNCE	EQU	0FBH
12018  0000017                   R_S_KEY23_DEBOUNCE	DS	1
12019  0000017                   .ENDIF
12020  0000017                   
12021  0000017                   .IF ( C_S_KEY24_ENABLE .EQ. 1)
12022  0000017                   B_S_KEY24	EQU	C_BIT2
12023  0000017                   SR_S_KEY24_PORT	EQU	BP1
12024  0000017                   R_S_KEY24_STATUS	EQU	BP1_STATUS
12025  0000017                   C_S_KEY24_DEBOUNCE	EQU	0FBH
12026  0000017                   R_S_KEY24_DEBOUNCE	DS	1
12027  0000017                   .ENDIF
12028  0000017                   
12029  0000017                   
12030  0000017                   
12031  0000017                   
12032  0000017                   
12033  0000017                   R_USER_STACK_ST	DS	0
12034  0000017                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\ALL_MR_FILES.H.APP"
12035  0000017                   ; <<<<<<< 1.6.1.4 >>>>>>>>>>> 
12036  0000017                   ; Create Time: 2018/10/23 ÐÇÆÚ¶þ ÉÏÎç 10:35:10
12037  0000017                   
12038  0000017                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\COMMON_MR.H.APP"
12039  0000017                   
12040  0000017                   
12041  0000017                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\WAITKEY_MR.H.APP"
12042  0000017                   ;----------------------
12043  0000017                   ; MACRO
12044  0000017                   ;-----------------------------
12045  0000017                   MACRO_CLOSE_SPK MACRO
12046  0000017                   	.IF (C_CHIP.EQ.C_W567BS)
12047  0000017                   	STZ	S0EN
12048  0000017                   	.ENDIF
12049  0000017                   	.IF (C_CHIP.EQ.C_N567GHK)
12050  0000017                   ;	STZ	SPEN
12051  0000017                   	.ENDIF
12052  0000017                   	.IF (C_CHIP.EQ.C_N588L)
12053  0000017                   ;	STZ	SPEN
12054  0000017                   	.ENDIF
12055  0000017                   	.IF (C_CHIP.EQ.C_N588H)
12056  0000017                   ;	STZ	SPEN
12057  0000017                   	.ENDIF
12058  0000017                   	.IF (C_CHIP.EQ.C_W588AS)
12059  0000017                   	STZ	S0EN
12060  0000017                   	.ENDIF
12061  0000017                   	.IF (C_CHIP.EQ.C_W588CD)
12062  0000017                   	STZ	SPEN
12063  0000017                   	.ENDIF
12064  0000017                   	ENDM
12065  0000017                   MACRO_SET_SPK MACRO
12066  0000017                   	.IF (C_CHIP.EQ.C_W567BS)
12067  0000017                   	SET_SPEAKER_OUTPUT_TYPE_TO DAC_5mA	;USER S OPTION (DAC_5mA/ DAC_3mA/ PWM)
12068  0000017                   	.ENDIF
12069  0000017                   	.IF (C_CHIP.EQ.C_N567GHK)
12070  0000017                   ;	SET_SPEAKER_OUTPUT_TYPE_TO DAC_5mA	;USER S OPTION (DAC_5mA/ DAC_3mA/ PWM)
12071  0000017                   	.ENDIF
12072  0000017                   	.IF (C_CHIP.EQ.C_N588L)
12073  0000017                   ;	SET_SPEAKER_OUTPUT_TYPE_TO DAC_5mA	;USER S OPTION (DAC_5mA/ DAC_3mA/ PWM)





12074  0000017                   	.ENDIF
12075  0000017                   	.IF (C_CHIP.EQ.C_N588H)
12076  0000017                   ;	SET_SPEAKER_OUTPUT_TYPE_TO DAC_5mA	;USER S OPTION (DAC_5mA/ DAC_3mA/ PWM)
12077  0000017                   	.ENDIF
12078  0000017                   	.IF (C_CHIP.EQ.C_W588AS)
12079  0000017                   	SET_SPEAKER_OUTPUT_TYPE_TO DAC_5mA	;USER S OPTION (DAC_5mA/ DAC_3mA/ PWM)
12080  0000017                   	.ENDIF
12081  0000017                   	.IF (C_CHIP.EQ.C_W588CD)
12082  0000017                   	NOP
12083  0000017                   	.ENDIF
12084  0000017                   	ENDM
12085  0000017                   
12086  0000017                   MACRO_CLR_WDT MACRO
12087  0000017                   	.IF (C_CHIP.EQ.C_W567BS)
12088  0000017                   	LDA #1
12089  0000017                   	STA !WDTC
12090  0000017                   	.ENDIF
12091  0000017                   	.IF (C_CHIP.EQ.C_N567GHK)
12092  0000017                   	LDA #CTL_CPU_WDT
12093  0000017                   	TSB !CTL_CPU
12094  0000017                   	.ENDIF
12095  0000017                   	.IF (C_CHIP.EQ.C_N588L)
12096  0000017                   	LDA #CTL_CPU_WDT
12097  0000017                   	TSB !CTL_CPU
12098  0000017                   	.ENDIF
12099  0000017                   	.IF (C_CHIP.EQ.C_N588H)
12100  0000017                   	LDA #CTL_CPU_WDT
12101  0000017                   	TSB !CTL_CPU
12102  0000017                   	.ENDIF
12103  0000017                   	.IF (C_CHIP.EQ.C_W588AS)
12104  0000017                   	LDA #1
12105  0000017                   	STA !WDTC
12106  0000017                   	.ENDIF
12107  0000017                   	.IF (C_CHIP.EQ.C_W588CD)
12108  0000017                   	LDA #1
12109  0000017                   	STA !WDTC
12110  0000017                   	.ENDIF
12111  0000017                   	ENDM
12112  0000017                   MACRO_ENTER_STOP MACRO
12113  0000017                   	.IF (C_CHIP.EQ.C_W567BS)
12114  0000017                   	LDA	#1
12115  0000017                   	STA	STOP
12116  0000017                   	.ENDIF
12117  0000017                   	.IF (C_CHIP.EQ.C_N567GHK)
12118  0000017                   	LDA #CTL_CPU_STOP
12119  0000017                   	TSB !CTL_CPU
12120  0000017                   	.ENDIF
12121  0000017                   	.IF (C_CHIP.EQ.C_N588L)
12122  0000017                   	LDA #CTL_CPU_STOP
12123  0000017                   	TSB !CTL_CPU
12124  0000017                   	.ENDIF
12125  0000017                   	.IF (C_CHIP.EQ.C_N588H)
12126  0000017                   	LDA #CTL_CPU_STOP
12127  0000017                   	TSB !CTL_CPU
12128  0000017                   	.ENDIF
12129  0000017                   	.IF (C_CHIP.EQ.C_W588AS)
12130  0000017                   	LDA	#1





12131  0000017                   	STA	STOP
12132  0000017                   	.ENDIF
12133  0000017                   	.IF (C_CHIP.EQ.C_W588CD)
12134  0000017                   	LDA	#1
12135  0000017                   	STA	STOP
12136  0000017                   	.ENDIF
12137  0000017                   	ENDM
12138  0000017                   MACRO_INT_ENABLE MACRO VALUE
12139  0000017                   	.IF (C_CHIP.EQ.C_N588H)
12140  0000017                   	LDA	#.LOW.VALUE
12141  0000017                   	TSB	!IEF0
12142  0000017                   	.ENDIF
12143  0000017                   	ENDM
12144  0000017                   MACRO_INT_DISABLE MACRO VALUE
12145  0000017                   	.IF (C_CHIP.EQ.C_N588H)
12146  0000017                   	LDA	#.LOW.VALUE
12147  0000017                   	TRB	!IEF0
12148  0000017                   	.ENDIF
12149  0000017                   	ENDM
12150  0000017                   
12151  0000017                   MR_SET_DLYCNT0 MACRO VALUE
12152  0000017                   	LDA	#.LOW.VALUE
12153  0000017                   	STA	WB_DLYCNT0
12154  0000017                   	LDA	#.HIGH.VALUE
12155  0000017                   	STA	WB_DLYCNT0+1
12156  0000017                   	LDA	#C_CNT0_BIT
12157  0000017                   
12158  0000017                   	TRB	<USER_FLAG_B
12159  0000017                   	ENDM
12160  0000017                   
12161  0000017                   MR_SET_DLYCNT0_IDX MACRO VALUE,IDX
12162  0000017                   	LDA	#.LOW.VALUE
12163  0000017                   	STA	WB_DLYCNT0
12164  0000017                   	LDA	#.HIGH.VALUE
12165  0000017                   	STA	WB_DLYCNT0+1
12166  0000017                   	LDA	#C_CNT0_BIT
12167  0000017                   	TRB	<USER_FLAG_B
12168  0000017                   	LDA	#IDX
12169  0000017                   	STA	WB_DLYCNT0_IDX
12170  0000017                   
12171  0000017                   	ENDM
12172  0000017                   
12173  0000017                   MR_SET_DLYCNT1 MACRO VALUE
12174  0000017                   	LDA	#.LOW.VALUE
12175  0000017                   	STA	WB_DLYCNT1
12176  0000017                   	LDA	#.HIGH.VALUE
12177  0000017                   	STA	WB_DLYCNT1+1
12178  0000017                   	LDA	#C_CNT1_BIT
12179  0000017                   
12180  0000017                   	TRB	<USER_FLAG_B
12181  0000017                   	ENDM
12182  0000017                   
12183  0000017                   MR_SET_DLYCNT1_IDX MACRO VALUE,IDX
12184  0000017                   	LDA	#.LOW.VALUE
12185  0000017                   	STA	WB_DLYCNT1
12186  0000017                   	LDA	#.HIGH.VALUE
12187  0000017                   	STA	WB_DLYCNT1+1





12188  0000017                   	LDA	#C_CNT1_BIT
12189  0000017                   	TRB	<USER_FLAG_B
12190  0000017                   	LDA	#IDX
12191  0000017                   	STA	WB_DLYCNT1_IDX
12192  0000017                   	ENDM
12193  0000017                   
12194  0000017                   MR_SET_DLYCNT2 MACRO VALUE
12195  0000017                   	LDA	#.LOW.VALUE
12196  0000017                   	STA	WB_DLYCNT2
12197  0000017                   	LDA	#.HIGH.VALUE
12198  0000017                   	STA	WB_DLYCNT2+1
12199  0000017                   	LDA	#C_CNT2_BIT
12200  0000017                   	TRB	<USER_FLAG_B
12201  0000017                   	ENDM
12202  0000017                   
12203  0000017                   MR_SET_DLYCNT2_IDX MACRO VALUE,IDX
12204  0000017                   	LDA	#.LOW.VALUE
12205  0000017                   	STA	WB_DLYCNT2
12206  0000017                   	LDA	#.HIGH.VALUE
12207  0000017                   	STA	WB_DLYCNT2+1
12208  0000017                   	LDA	#C_CNT2_BIT
12209  0000017                   	TRB	<USER_FLAG_B
12210  0000017                   	LDA	#IDX
12211  0000017                   	STA	WB_DLYCNT2_IDX
12212  0000017                   	ENDM
12213  0000017                   
12214  0000017                   MR_SET_DLYCNT3 MACRO VALUE
12215  0000017                   	LDA	#.LOW.VALUE
12216  0000017                   	STA	WB_DLYCNT3
12217  0000017                   	LDA	#.HIGH.VALUE
12218  0000017                   	STA	WB_DLYCNT3+1
12219  0000017                   	LDA	#C_CNT3_BIT
12220  0000017                   
12221  0000017                   	TRB	<USER_FLAG_B
12222  0000017                   	ENDM
12223  0000017                   MR_SET_DLYCNT4 MACRO VALUE
12224  0000017                   	LDA	#.LOW.VALUE
12225  0000017                   	STA	WB_DLYCNT4
12226  0000017                   	LDA	#.HIGH.VALUE
12227  0000017                   	STA	WB_DLYCNT4+1
12228  0000017                   	LDA	#C_CNT4_BIT
12229  0000017                   
12230  0000017                   	TRB	<USER_FLAG_B
12231  0000017                   	ENDM
12232  0000017                   MR_SET_FG0_FLAG MACRO
12233  0000017                   	LDA	#C_FG0_BIT
12234  0000017                   	TSB	<USER_FLAG_B
12235  0000017                   	ENDM
12236  0000017                   MR_SET_FG1_FLAG MACRO
12237  0000017                   	LDA	#C_FG1_BIT
12238  0000017                   	TSB	<USER_FLAG_B
12239  0000017                   	ENDM
12240  0000017                   MR_CLR_FG0_FLAG MACRO
12241  0000017                   	LDA	#C_FG0_BIT
12242  0000017                   	TRB	<USER_FLAG_B
12243  0000017                   	ENDM
12244  0000017                   MR_CLR_FG1_FLAG MACRO





12245  0000017                   	LDA	#C_FG1_BIT
12246  0000017                   	TRB	<USER_FLAG_B
12247  0000017                   	ENDM
12248  0000017                   
12249  0000017                   MACRO_SET_KEYCH0 MACRO
12250  0000017                   	LDA	#C_KEYCH0_BIT
12251  0000017                   	TSB	USER_FLAG_A
12252  0000017                   	ENDM
12253  0000017                   MACRO_SET_KEYCH1 MACRO
12254  0000017                   	LDA	#C_KEYCH1_BIT
12255  0000017                   	TSB	USER_FLAG_A
12256  0000017                   	ENDM
12257  0000017                   MACRO_SET_KEYCH2 MACRO
12258  0000017                   	LDA	#C_KEYCH2_BIT
12259  0000017                   	TSB	USER_FLAG_A
12260  0000017                   	ENDM
12261  0000017                   MACRO_SET_KEYCH3 MACRO
12262  0000017                   	LDA	#C_KEYCH3_BIT
12263  0000017                   	TSB	USER_FLAG_A
12264  0000017                   	ENDM
12265  0000017                   MR_SET_GAPTIME_FLAG MACRO
12266  0000017                   	LDA	#C_BIT3
12267  0000017                   	TSB	<USER_INT_FLAG0
12268  0000017                   	ENDM
12269  0000017                   MR_CLR_GAPTIME_FLAG MACRO
12270  0000017                   	LDA	#C_BIT3
12271  0000017                   	TRB	<USER_INT_FLAG0
12272  0000017                   	ENDM
12273  0000017                   MR_TEST_GAPTIME_FLAG MACRO
12274  0000017                   	LDA	#C_BIT3
12275  0000017                   	BIT	<USER_INT_FLAG0
12276  0000017                   	ENDM
12277  0000017                   MR_SET_TMG0_GAP_FLAG MACRO
12278  0000017                   	LDA #C_BIT2
12279  0000017                   	TSB <USER_INT_FLAG0
12280  0000017                   	ENDM
12281  0000017                   MR_CLR_TMG0_GAP_FLAG MACRO
12282  0000017                   	LDA	#C_BIT2
12283  0000017                   	TRB	<USER_INT_FLAG0
12284  0000017                   	ENDM
12285  0000017                   MR_TEST_TMG0_GAP_FLAG MACRO
12286  0000017                   	LDA	#C_BIT2
12287  0000017                   	BIT	<USER_INT_FLAG0
12288  0000017                   	ENDM
12289  0000017                   
12290  0000017                   MACRO_CHECK_CH1_ENABLE MACRO
12291  0000017                   	LDA	#C_CHK_SPCH1_BIT
12292  0000017                   	TSB	USER_FLAG10
12293  0000017                   	LDA	#C_SPCH1_BIT
12294  0000017                   	TRB	USER_FLAG_A
12295  0000017                   	ENDM
12296  0000017                   MACRO_CHECK_CH2_ENABLE MACRO
12297  0000017                   	LDA	#C_CHK_SPCH2_BIT
12298  0000017                   	TSB	USER_FLAG10
12299  0000017                   	LDA	#C_SPCH2_BIT
12300  0000017                   	TRB	USER_FLAG_A
12301  0000017                   	ENDM





12302  0000017                   MACRO_CHECK_MS_ENABLE MACRO
12303  0000017                   	LDA	#C_CHK_MS1_BIT
12304  0000017                   	TSB	USER_FLAG10
12305  0000017                   	LDA	#C_MS1_BIT
12306  0000017                   	TRB	USER_FLAG_A
12307  0000017                   	ENDM
12308  0000017                   MACRO_CHECK_CH1_DISABLE MACRO
12309  0000017                   	LDA	#C_CHK_SPCH1_BIT
12310  0000017                   	TRB	USER_FLAG10
12311  0000017                   	LDA	#C_SPCH1_BIT
12312  0000017                   	TRB	USER_FLAG_A
12313  0000017                   	ENDM
12314  0000017                   MACRO_CHECK_CH2_DISABLE MACRO
12315  0000017                   	LDA	#C_CHK_SPCH2_BIT
12316  0000017                   	TRB	USER_FLAG10
12317  0000017                   	LDA	#C_SPCH2_BIT
12318  0000017                   	TRB	USER_FLAG_A
12319  0000017                   	ENDM
12320  0000017                   MACRO_CHECK_MS_DISABLE MACRO
12321  0000017                   	LDA	#C_CHK_MS1_BIT
12322  0000017                   	TRB	USER_FLAG10
12323  0000017                   	LDA	#C_MS1_BIT
12324  0000017                   	TRB	USER_FLAG_A
12325  0000017                   	ENDM
12326  0000017                   
12327  0000017                   MACRO_CLR_CNT0_FLAG MACRO
12328  0000017                   	LDA	#C_BIT0
12329  0000017                   	TRB	<USER_FLAG_B
12330  0000017                   	ENDM
12331  0000017                   MACRO_CLR_CNT1_FLAG MACRO
12332  0000017                   	LDA	#C_BIT1
12333  0000017                   	TRB	<USER_FLAG_B
12334  0000017                   	ENDM
12335  0000017                   MACRO_CLR_CNT2_FLAG MACRO
12336  0000017                   	LDA	#C_BIT2
12337  0000017                   	TRB	<USER_FLAG_B
12338  0000017                   	ENDM
12339  0000017                   MACRO_CLR_CNT3_FLAG MACRO
12340  0000017                   	LDA	#C_BIT3
12341  0000017                   	TRB	<USER_FLAG_B
12342  0000017                   	ENDM
12343  0000017                   MACRO_CLR_CNT4_FLAG MACRO
12344  0000017                   	LDA	#C_BIT4
12345  0000017                   	TRB	<USER_FLAG_B
12346  0000017                   	ENDM
12347  0000017                   
12348  0000017                   MR_CLR_EQU_CNT_FLAG MACRO
12349  0000017                   	LDA	#C_EQU_CNT_BIT
12350  0000017                   	TRB	<USER_FLAG_B
12351  0000017                   	ENDM
12352  0000017                   
12353  0000017                   MACRO_CLR_AUTOCNT_FLAG MACRO
12354  0000017                   	LDA	#C_AUTO_CNT_BIT
12355  0000017                   	TRB	<USER_FLAG_B
12356  0000017                   	ENDM
12357  0000017                   
12358  0000017                   ;





12359  0000017                   MACRO_CLR_CH1_FLAG MACRO
12360  0000017                   	LDA	#C_SPCH1_BIT
12361  0000017                   	TRB	USER_FLAG_A
12362  0000017                   	ENDM
12363  0000017                   MACRO_CLR_CH2_FLAG MACRO
12364  0000017                   	LDA	#C_SPCH2_BIT
12365  0000017                   	TRB	USER_FLAG_A
12366  0000017                   	ENDM
12367  0000017                   MACRO_CLR_MS_FLAG MACRO
12368  0000017                   	LDA	#C_MS1_BIT
12369  0000017                   	TRB	USER_FLAG_A
12370  0000017                   	ENDM
12371  0000017                   MACRO_CLR_KEYCH0_FLAG MACRO
12372  0000017                   	LDA	#C_KEYCH0_BIT
12373  0000017                   	TRB	USER_FLAG_A
12374  0000017                   	ENDM
12375  0000017                   MACRO_CLR_KEYCH1_FLAG MACRO
12376  0000017                   	LDA	#C_KEYCH1_BIT
12377  0000017                   	TRB	USER_FLAG_A
12378  0000017                   	ENDM
12379  0000017                   MACRO_CLR_KEYCH2_FLAG MACRO
12380  0000017                   	LDA	#C_KEYCH2_BIT
12381  0000017                   	TRB	USER_FLAG_A
12382  0000017                   	ENDM
12383  0000017                   MACRO_CLR_KEYCH3_FLAG MACRO
12384  0000017                   	LDA	#C_KEYCH3_BIT
12385  0000017                   	TRB	USER_FLAG_A
12386  0000017                   	ENDM
12387  0000017                   
12388  0000017                   
12389  0000017                   ;==================================
12390  0000017                   
12391  0000017                   MR_SET_SUB_MODE_NO	MACRO VALUE
12392  0000017                   	LDA	<SYS_MODE_NO
12393  0000017                   	AND	#0F0H
12394  0000017                   	ORA	#VALUE
12395  0000017                   	STA	<SYS_MODE_NO
12396  0000017                   	ENDM
12397  0000017                   
12398  0000017                   MR_SET_MODE_NO	MACRO VALUE
12399  0000017                   	LDA	#VALUE
12400  0000017                   	STA	<SYS_MODE_NO
12401  0000017                   	ENDM
12402  0000017                   
12403  0000017                   MR_CMP_MODE_NO	MACRO VALUE
12404  0000017                   	LDA	<SYS_MODE_NO
12405  0000017                   	CMP	#VALUE
12406  0000017                   	ENDM
12407  0000017                   
12408  0000017                   ;========================================
12409  0000017                   
12410  0000017                   
12411  0000017                   
12412  0000017                   ;MR_RESET_IDLE MACRO
12413  0000017                   ;	
12414  0000017                   ;	MR_SET_DLYCNT0 T010000MS ; IDLE
12415  0000017                   ;





12416  0000017                   ;	ENDM
12417  0000017                   
12418  0000017                   
12419  0000017                   
12420  0000017                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_MR.H.APP"
12421  0000017                   ;=======================================
12422  0000017                   ;	<< PROJ_MACRO.ASM >>
12423  0000017                   ;===========================================
12424  0000017                   
12425  0000017                   
12426  0000017                   
12427  0000017                   MR_DET_MUTE MACRO
12428  0000017                   	LDA	#1
12429  0000017                   	ENDM
12430  0000017                   
12431  0000017                   
12432  0000017                   
12433  0000017                   MR_SET_TM1_05MS MACRO
12434  0000017                   	LDA	#
12435  0000017                   	STA	TM1C
12436  0000017                   	LDA	#
12437  0000017                   	STA	TM1V
12438  0000017                   	LDA #INT0_TM1
12439  0000017                   	TSB !IEF0     			;SET IEF FLAG
12440  0000017                   
12441  0000017                   
12442  0000017                   	ENDM
12443  0000017                   
12444  0000017                   MR_LED1_ON  MACRO
12445  0000017                   ;	SET_PORT_OUTPUT_0 0, 00000001b
12446  0000017                   
12447  0000017                   	ENDM
12448  0000017                   MR_LED1_OFF  MACRO
12449  0000017                   ;	SET_PORT_OUTPUT_1 0, 00000001b
12450  0000017                   	ENDM
12451  0000017                   
12452  0000017                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\AUTOSLEEP_MR.H.APP"
12453  0000017                   
12454  0000017                   
12455  0000017                   MR_SET_AUTOCNT_2B MACRO VALUE
12456  0000017                   ; * 42.6ms
12457  0000017                   	LDA	#.LOW.VALUE
12458  0000017                   	STA	WB_AUTOCNT0
12459  0000017                   	LDA	#.HIGH.VALUE
12460  0000017                   	STA	WB_AUTOCNT01
12461  0000017                   	LDA	#C_AUTO_CNT_BIT
12462  0000017                   	TRB	<USER_FLAG_B
12463  0000017                   	ENDM
12464  0000017                   
12465  0000017                   MR_SET_AUTOCNT_1B MACRO VALUE
12466  0000017                   ; * 42.6ms
12467  0000017                   	LDA	#.LOW.VALUE
12468  0000017                   	STA	WB_AUTOCNT0
12469  0000017                   	LDA	#C_AUTO_CNT_BIT
12470  0000017                   	TRB	<USER_FLAG_B
12471  0000017                   	ENDM
12472  0000017                   





12473  0000017                   
12474  0000017                   MR_SET_AUTOCNT1 MACRO
12475  0000017                   ; * 42.6ms
12476  0000017                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
12477  0000017                   	MR_SET_AUTOCNT_1B T0001S_21
12478  0000017                   .ENDIF
12479  0000017                   
12480  0000017                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
12481  0000017                   	MR_SET_AUTOCNT_2B T0001S_21
12482  0000017                   .ENDIF
12483  0000017                   
12484  0000017                   	ENDM
12485  0000017                   
12486  0000017                   
12487  0000017                   MR_SET_AUTOCNT2 MACRO
12488  0000017                   ;for no midi / note / speech playing.
12489  0000017                   ; * 42.6ms
12490  0000017                   
12491  0000017                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
12492  0000017                   	MR_SET_AUTOCNT_1B T0005S_21
12493  0000017                   .ENDIF
12494  0000017                   
12495  0000017                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
12496  0000017                   	MR_SET_AUTOCNT_2B T0020S_21
12497  0000017                   ;debug
12498  0000017                   	MR_SET_AUTOCNT_2B T0020S_21
12499  0000017                   .ENDIF
12500  0000017                   
12501  0000017                   	ENDM
12502  0000017                   
12503  0000017                   
12504  0000017                   MR_SET_AUTOCNT2_TEST MACRO
12505  0000017                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
12506  0000017                   	MR_SET_AUTOCNT_1B T0005S_42
12507  0000017                   .ENDIF
12508  0000017                   
12509  0000017                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
12510  0000017                   ;	MR_SET_AUTOCNT_2B T0020S_42
12511  0000017                   	MR_SET_AUTOCNT_2B T0020S_21
12512  0000017                   .ENDIF
12513  0000017                   ENDM
12514  0000017                   
12515  0000017                   
12516  0000017                   MR_STOP_AUTOCNT MACRO
12517  0000017                   
12518  0000017                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
12519  0000017                   	MR_SET_AUTOCNT_1B CNT_STOP
12520  0000017                   .ENDIF
12521  0000017                   
12522  0000017                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
12523  0000017                   	MR_SET_AUTOCNT_2B CNT_STOP
12524  0000017                   .ENDIF
12525  0000017                   
12526  0000017                   	ENDM
12527  0000017                   
12528  0000017                   
12529  0000017                   MR_AUTOSLEEP_SPCH3_BUSY MACRO





12530  0000017                   	LDA	#08H
12531  0000017                   	TSB	<AUTOSLEEP_FLAG
12532  0000017                   
12533  0000017                   	MACRO_CHECK_CH3_ENABLE
12534  0000017                   
12535  0000017                   	ENDM
12536  0000017                   MR_AUTOSLEEP_SPCH3_FREE MACRO
12537  0000017                   	LDA	#08H
12538  0000017                   	TRB	<AUTOSLEEP_FLAG
12539  0000017                   	ENDM
12540  0000017                   
12541  0000017                   MR_AUTOSLEEP_SPCH1_BUSY MACRO
12542  0000017                   	LDA	#01H
12543  0000017                   	TSB	<AUTOSLEEP_FLAG
12544  0000017                   
12545  0000017                   	MACRO_CHECK_CH1_ENABLE
12546  0000017                   
12547  0000017                   	ENDM
12548  0000017                   
12549  0000017                   MR_AUTOSLEEP_SPCH1_FREE MACRO
12550  0000017                   	LDA	#01H
12551  0000017                   	TRB	<AUTOSLEEP_FLAG
12552  0000017                   	ENDM
12553  0000017                   MR_AUTOSLEEP_SPCH2_BUSY MACRO
12554  0000017                   	LDA	#02H
12555  0000017                   	TSB	<AUTOSLEEP_FLAG
12556  0000017                   
12557  0000017                   	MACRO_CHECK_CH2_ENABLE
12558  0000017                   
12559  0000017                   	ENDM
12560  0000017                   MR_AUTOSLEEP_SPCH2_FREE MACRO
12561  0000017                   	LDA	#02H
12562  0000017                   	TRB	<AUTOSLEEP_FLAG
12563  0000017                   	ENDM
12564  0000017                   MR_AUTOSLEEP_MS1_BUSY MACRO
12565  0000017                   	LDA	#04H
12566  0000017                   	TSB	<AUTOSLEEP_FLAG
12567  0000017                   	ENDM
12568  0000017                   MR_AUTOSLEEP_MS1_FREE MACRO
12569  0000017                   	LDA	#04H
12570  0000017                   	TRB	<AUTOSLEEP_FLAG
12571  0000017                   	ENDM
12572  0000017                   
12573  0000017                   MR_AUTOSLEEP_NOTEON1_BUSY MACRO
12574  0000017                   	LDA	#10H
12575  0000017                   	TSB	<AUTOSLEEP_FLAG
12576  0000017                   	ENDM
12577  0000017                   MR_AUTOSLEEP_NOTEON1_FREE MACRO
12578  0000017                   	LDA	#10H
12579  0000017                   	TRB	<AUTOSLEEP_FLAG
12580  0000017                   	ENDM
12581  0000017                   
12582  0000017                   MR_AUTOSLEEP_NOTEON2_BUSY MACRO
12583  0000017                   	LDA	#20H
12584  0000017                   	TSB	<AUTOSLEEP_FLAG
12585  0000017                   	ENDM
12586  0000017                   MR_AUTOSLEEP_NOTEON2_FREE MACRO





12587  0000017                   	LDA	#20H
12588  0000017                   	TRB	<AUTOSLEEP_FLAG
12589  0000017                   	ENDM
12590  0000017                   
12591  0000017                   MR_AUTOSLEEP_NOTEON3_BUSY MACRO
12592  0000017                   	LDA	#40H
12593  0000017                   	TSB	<AUTOSLEEP_FLAG
12594  0000017                   	ENDM
12595  0000017                   MR_AUTOSLEEP_NOTEON3_FREE MACRO
12596  0000017                   	LDA	#40H
12597  0000017                   	TRB	<AUTOSLEEP_FLAG
12598  0000017                   	ENDM
12599  0000017                   
12600  0000017                   MR_AUTOSLEEP_NOTEON4_BUSY MACRO
12601  0000017                   	LDA	#80H
12602  0000017                   	TSB	<AUTOSLEEP_FLAG
12603  0000017                   	ENDM
12604  0000017                   MR_AUTOSLEEP_NOTEON4_FREE MACRO
12605  0000017                   	LDA	#80H
12606  0000017                   	TRB	<AUTOSLEEP_FLAG
12607  0000017                   	ENDM
12608  0000017                   
12609  0000017                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\CHKSKEY_MR.H.APP"
12610  0000017                   
12611  0000017                   
12612  0000017                   
12613  0000017                   
12614  0000017                   
12615  0000017                   
12616  0000017                   
12617  0000017                   ;-----------------------
12618  0000017                   ; User s RAM for Program
12619  0000017                   ;-----------------------
12620  0000017                   
12621  0000017                   
12622  0000017                   
12623  0000017                   
12624  0000017                   	ENDS
12625  0000000                   
12626  0000000                   .IF	(WITH_RAM_OVER_STACK .EQ. 1)
12627  0000000                   	USER_RAM_AFTER_RESERVED: SECTION
12628  0000000                   
12629  0000000                   	ENDS
12630  0000000                   .ENDIF
12631  0000000                   
12632  0000000                   ;=======================================================================
12633  0000000                   ;	WRITE PROGRAM CODES & TABLES INSIDE THIS SECTION
12634  0000000                   ;==========================================================================
12635  0000000                   	CODE: SECTION
12636  0000000                   
12637  0000000                   
12638  0000000                   ;==================================================
12639  0000000                   FXF15_ISR:
12640  0000000                   ;*********   pls insert your FXF15 USER ISR  **********
12641  0000000                   
12642  0000000  A9 80			LDA #INT0_FXF15
12643  0000002  8D 16 08     	STA !EFC0					;CLEAR EVF OF FXF15





12644  0000005                   	ENABLE_BAM_INT_EXCEPT				;User can insert program from here
12645  0000005                   .ifdef	FW_BAM_TIMER
12646  0000005                   	LDA <UIO_TIMER_CH_FLAG				
12647  0000005                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12648  0000005                   	LDA <IEF0_FLAG					
12649  0000005                   	BIT #20H					
12650  0000005                   	BEQ ENABLE_BAM_INT_EXCEPT_NEXT#			
12651  0000005                   	LDA #10H					
12652  0000005                   	TSB <IEF0_FLAG					
12653  0000005                   	BRA END_ENABLE_BAM_INT_EXCEPT#			
12654  0000005                   ENABLE_BAM_INT_EXCEPT_NEXT#:
12655  0000005                   	LDA <UIO_BIT_COUNT				
12656  0000005                   	AND #07H					
12657  0000005                   	EXTERN BAM_INT_LONG
12658  0000005                   	CMP #BAM_INT_LONG				
12659  0000005                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12660  0000005                   	CMP #00H					
12661  0000005                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12662  0000005                   	LDA #80H					
12663  0000005                   	TSB <IEF0_FLAG					
12664  0000005                   	LDA !IEF0					
12665  0000005                   	STA <IEF0_BAK					
12666  0000005                   	AND #UIO_TIMER_INT				
12667  0000005                   	STA !IEF0 					
12668  0000005                   	CLI						
12669  0000005                   END_ENABLE_BAM_INT_EXCEPT#:
12670  0000005                   .endif
12671  0000005                   	;ENDM
12672  0000005                   
12673  0000005                   	MR_SET_GAPTIME_FLAG
12674  0000005  A9 08			LDA	#C_BIT3
12675  0000007  04 06			TSB	<USER_INT_FLAG0
12676  0000009                   	;ENDM
12677  0000009                   
12678  0000009                   	QUIT_ENABLE_BAM_INT_EXCEPT
12679  0000009                   .ifdef	FW_BAM_TIMER
12680  0000009                   	LDA <IEF0_FLAG					
12681  0000009                   	BIT #C0H					
12682  0000009                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
12683  0000009                   	BIT #40H					
12684  0000009                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
12685  0000009                   	LDA #40H					
12686  0000009                   	TRB <IEF0_FLAG					
12687  0000009                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12688  0000009                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
12689  0000009                   	SEI						
12690  0000009                   	LDA <IEF0_BAK					
12691  0000009                   	AND #(FFH^UIO_TIMER_INT)			
12692  0000009                   	ORA !IEF0					
12693  0000009                   	STA !IEF0					
12694  0000009                   	LDA #80H					
12695  0000009                   	TRB <IEF0_FLAG					
12696  0000009                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12697  0000009                   NEXT_CHECK_BAM_INT_EXCEPT#:
12698  0000009                   	BIT #30H					
12699  0000009                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12700  0000009                   	BIT #10H					





12701  0000009                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
12702  0000009                   	LDA #10H					
12703  0000009                   	TRB <IEF0_FLAG					
12704  0000009                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12705  0000009                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
12706  0000009                   	SEI						
12707  0000009                   	LDA <IEF0_BAK					
12708  0000009                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
12709  0000009                   	ORA #UIO_TIMER_INT				
12710  0000009                   	ORA !IEF0					
12711  0000009                   	STA !IEF0					
12712  0000009                   	LDA #20H					
12713  0000009                   	TRB <IEF0_FLAG					
12714  0000009                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
12715  0000009                   .endif
12716  0000009                   	;ENDM
12717  0000009  68           	PLA
12718  000000A  40           	RTI
12719  000000B                   ;==================================================
12720  000000B                   FXF10_ISR:
12721  000000B  A9 20			LDA #INT0_FXF10
12722  000000D  8D 16 08     	STA !EFC0					;CLEAR EVF OF FXF10
12723  0000010                   	ENABLE_BAM_INT_EXCEPT		;User can insert program from here
12724  0000010                   .ifdef	FW_BAM_TIMER
12725  0000010                   	LDA <UIO_TIMER_CH_FLAG				
12726  0000010                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12727  0000010                   	LDA <IEF0_FLAG					
12728  0000010                   	BIT #20H					
12729  0000010                   	BEQ ENABLE_BAM_INT_EXCEPT_NEXT#			
12730  0000010                   	LDA #10H					
12731  0000010                   	TSB <IEF0_FLAG					
12732  0000010                   	BRA END_ENABLE_BAM_INT_EXCEPT#			
12733  0000010                   ENABLE_BAM_INT_EXCEPT_NEXT#:
12734  0000010                   	LDA <UIO_BIT_COUNT				
12735  0000010                   	AND #07H					
12736  0000010                   	EXTERN BAM_INT_LONG
12737  0000010                   	CMP #BAM_INT_LONG				
12738  0000010                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12739  0000010                   	CMP #00H					
12740  0000010                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12741  0000010                   	LDA #80H					
12742  0000010                   	TSB <IEF0_FLAG					
12743  0000010                   	LDA !IEF0					
12744  0000010                   	STA <IEF0_BAK					
12745  0000010                   	AND #UIO_TIMER_INT				
12746  0000010                   	STA !IEF0 					
12747  0000010                   	CLI						
12748  0000010                   END_ENABLE_BAM_INT_EXCEPT#:
12749  0000010                   .endif
12750  0000010                   	;ENDM
12751  0000010                   
12752  0000010                   .ifdef	FW_PWM_TIMER_FXF10
12753  0000010                   	JMP FW_PWM_TIMER_DOWNCOUNT
12754  0000010                   FW_TIMER_DWONCOUNT_RET:
12755  0000010                   .endif
12756  0000010                   
12757  0000010                   	QUIT_ENABLE_BAM_INT_EXCEPT





12758  0000010                   .ifdef	FW_BAM_TIMER
12759  0000010                   	LDA <IEF0_FLAG					
12760  0000010                   	BIT #C0H					
12761  0000010                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
12762  0000010                   	BIT #40H					
12763  0000010                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
12764  0000010                   	LDA #40H					
12765  0000010                   	TRB <IEF0_FLAG					
12766  0000010                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12767  0000010                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
12768  0000010                   	SEI						
12769  0000010                   	LDA <IEF0_BAK					
12770  0000010                   	AND #(FFH^UIO_TIMER_INT)			
12771  0000010                   	ORA !IEF0					
12772  0000010                   	STA !IEF0					
12773  0000010                   	LDA #80H					
12774  0000010                   	TRB <IEF0_FLAG					
12775  0000010                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12776  0000010                   NEXT_CHECK_BAM_INT_EXCEPT#:
12777  0000010                   	BIT #30H					
12778  0000010                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12779  0000010                   	BIT #10H					
12780  0000010                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
12781  0000010                   	LDA #10H					
12782  0000010                   	TRB <IEF0_FLAG					
12783  0000010                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12784  0000010                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
12785  0000010                   	SEI						
12786  0000010                   	LDA <IEF0_BAK					
12787  0000010                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
12788  0000010                   	ORA #UIO_TIMER_INT				
12789  0000010                   	ORA !IEF0					
12790  0000010                   	STA !IEF0					
12791  0000010                   	LDA #20H					
12792  0000010                   	TRB <IEF0_FLAG					
12793  0000010                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
12794  0000010                   .endif
12795  0000010                   	;ENDM
12796  0000010  68           	PLA
12797  0000011  40           	RTI	
12798  0000012                   ;=================================================================
12799  0000012                   ;PORT ISR
12800  0000012                   ;==================================================================
12801  0000012                   PORT_ISR:
12802  0000012  48           	PHA
12803  0000013  A9 01			LDA #INT0_PORT
12804  0000015  8D 16 08     	STA !EFC0
12805  0000018                   	ENABLE_BAM_INT_EXCEPT			;User can insert program from here
12806  0000018                   .ifdef	FW_BAM_TIMER
12807  0000018                   	LDA <UIO_TIMER_CH_FLAG				
12808  0000018                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12809  0000018                   	LDA <IEF0_FLAG					
12810  0000018                   	BIT #20H					
12811  0000018                   	BEQ ENABLE_BAM_INT_EXCEPT_NEXT#			
12812  0000018                   	LDA #10H					
12813  0000018                   	TSB <IEF0_FLAG					
12814  0000018                   	BRA END_ENABLE_BAM_INT_EXCEPT#			





12815  0000018                   ENABLE_BAM_INT_EXCEPT_NEXT#:
12816  0000018                   	LDA <UIO_BIT_COUNT				
12817  0000018                   	AND #07H					
12818  0000018                   	EXTERN BAM_INT_LONG
12819  0000018                   	CMP #BAM_INT_LONG				
12820  0000018                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12821  0000018                   	CMP #00H					
12822  0000018                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12823  0000018                   	LDA #80H					
12824  0000018                   	TSB <IEF0_FLAG					
12825  0000018                   	LDA !IEF0					
12826  0000018                   	STA <IEF0_BAK					
12827  0000018                   	AND #UIO_TIMER_INT				
12828  0000018                   	STA !IEF0 					
12829  0000018                   	CLI						
12830  0000018                   END_ENABLE_BAM_INT_EXCEPT#:
12831  0000018                   .endif
12832  0000018                   	;ENDM
12833  0000018                   
12834  0000018                   	QUIT_ENABLE_BAM_INT_EXCEPT
12835  0000018                   .ifdef	FW_BAM_TIMER
12836  0000018                   	LDA <IEF0_FLAG					
12837  0000018                   	BIT #C0H					
12838  0000018                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
12839  0000018                   	BIT #40H					
12840  0000018                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
12841  0000018                   	LDA #40H					
12842  0000018                   	TRB <IEF0_FLAG					
12843  0000018                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12844  0000018                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
12845  0000018                   	SEI						
12846  0000018                   	LDA <IEF0_BAK					
12847  0000018                   	AND #(FFH^UIO_TIMER_INT)			
12848  0000018                   	ORA !IEF0					
12849  0000018                   	STA !IEF0					
12850  0000018                   	LDA #80H					
12851  0000018                   	TRB <IEF0_FLAG					
12852  0000018                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12853  0000018                   NEXT_CHECK_BAM_INT_EXCEPT#:
12854  0000018                   	BIT #30H					
12855  0000018                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12856  0000018                   	BIT #10H					
12857  0000018                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
12858  0000018                   	LDA #10H					
12859  0000018                   	TRB <IEF0_FLAG					
12860  0000018                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12861  0000018                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
12862  0000018                   	SEI						
12863  0000018                   	LDA <IEF0_BAK					
12864  0000018                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
12865  0000018                   	ORA #UIO_TIMER_INT				
12866  0000018                   	ORA !IEF0					
12867  0000018                   	STA !IEF0					
12868  0000018                   	LDA #20H					
12869  0000018                   	TRB <IEF0_FLAG					
12870  0000018                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
12871  0000018                   .endif





12872  0000018                   	;ENDM
12873  0000018  68           	PLA
12874  0000019  40           	RTI	
12875  000001A                   ;***************************************************************
12876  000001A                   ; INTERRUPT SERVICE ROUTINES
12877  000001A                   ;***************************************************************
12878  000001A                   IRQ_ISR:
12879  000001A  48           	PHA
12880  000001B                   
12881  000001B  AD 1E 08     	LDA !IEF0
12882  000001E  2D 20 08     	AND !EVF0
12883  0000021                   
12884  0000021  89 10		 	BIT #INT0_FXF13
12885  0000023  D0 10			BNE FXF13_ISR
12886  0000025                   
12887  0000025  89 80			BIT #INT0_FXF15
12888  0000027  F0 03			BEQ 3
12889  0000029  4C 00 00     	JMP FXF15_ISR
12890  000002C                   
12891  000002C  89 20			BIT #INT0_FXF10
12892  000002E  F0 03			BEQ 3
12893  0000030  4C 0B 00     	JMP FXF10_ISR
12894  0000033                   
12895  0000033                   PLA_RTI:
12896  0000033  68           	PLA
12897  0000034  40               	RTI
12898  0000035                   
12899  0000035                   ;===============================================================
12900  0000035                   ;  SR_NAME: FXF13_ISR				;FXF13_ISR FOR MELODY
12901  0000035                   ;  INPUT  : MS_DATA_ADDR			;OUTPUT : SP0AT, SP0BT
12902  0000035                   ;===============================================================
12903  0000035                   FXF13_ISR:
12904  0000035  A9 10			LDA #INT0_FXF13
12905  0000037  8D 16 08     	STA !EFC0     					;CLEAR EVF OF FXF13
12906  000003A                   
12907  000003A                   .IF ((WITH_MS .EQ. 0)&&(WITH_EVO .EQ. 0))
12908  000003A                   	ENABLE_BAM_INT_EXCEPT
12909  000003A                   .ifdef	FW_BAM_TIMER
12910  000003A                   	LDA <UIO_TIMER_CH_FLAG				
12911  000003A                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12912  000003A                   	LDA <IEF0_FLAG					
12913  000003A                   	BIT #20H					
12914  000003A                   	BEQ ENABLE_BAM_INT_EXCEPT_NEXT#			
12915  000003A                   	LDA #10H					
12916  000003A                   	TSB <IEF0_FLAG					
12917  000003A                   	BRA END_ENABLE_BAM_INT_EXCEPT#			
12918  000003A                   ENABLE_BAM_INT_EXCEPT_NEXT#:
12919  000003A                   	LDA <UIO_BIT_COUNT				
12920  000003A                   	AND #07H					
12921  000003A                   	EXTERN BAM_INT_LONG
12922  000003A                   	CMP #BAM_INT_LONG				
12923  000003A                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12924  000003A                   	CMP #00H					
12925  000003A                   	BEQ END_ENABLE_BAM_INT_EXCEPT#			
12926  000003A                   	LDA #80H					
12927  000003A                   	TSB <IEF0_FLAG					
12928  000003A                   	LDA !IEF0					





12929  000003A                   	STA <IEF0_BAK					
12930  000003A                   	AND #UIO_TIMER_INT				
12931  000003A                   	STA !IEF0 					
12932  000003A                   	CLI						
12933  000003A                   END_ENABLE_BAM_INT_EXCEPT#:
12934  000003A                   .endif
12935  000003A                   	;ENDM
12936  000003A                   .ENDIF
12937  000003A                   
12938  000003A                   	.IF(WITH_MS .EQ. 1).OR.(WITH_EVO .EQ. 1)
12939  000003A                   		PHX
12940  000003A                   		PHY
12941  000003A                   
12942  000003A                   		STORE_SW_CS		
12943  000003A                   		LDA !BANK
12944  000003A                   		PHA
12945  000003A                   
12946  000003A                   		.IF	 (PARTNO='N588H000')	
12947  000003A                   		    	LDA !IEF1			;DISABLE FXF15
12948  000003A                   			PHA
12949  000003A                   		    	STZ !IEF1
12950  000003A                   		.ENDIF
12951  000003A                   
12952  000003A                   	    	LDA !IEF0
12953  000003A                   		PHA
12954  000003A                   		AND #(INT0_TM0+INT0_TM1+INT0_TMG0)	;KEEP TMG0/G1/0/1 INTERRUPT ONLY
12955  000003A                   		STA !IEF0 
12956  000003A                   
12957  000003A                   		CLI					;ENABLE INTERRUPT
12958  000003A                   
12959  000003A                   		FXF13_ISR_PROC
12960  000003A                   ;-------------------------------------------------------------------------
12961  000003A                   		PUBLIC		QUIT_LIB_FXF_ISR
12962  000003A                   QUIT_LIB_FXF_ISR:
12963  000003A                   		SEI
12964  000003A                   
12965  000003A                   		PLA
12966  000003A                   		AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)
12967  000003A                   		ORA !IEF0
12968  000003A                   		STA !IEF0
12969  000003A                   
12970  000003A                   		QUIT_LIB_FXF_ISR_CONT
12971  000003A                   
12972  000003A                   QUIT_LIB_FXF_ISR_END:
12973  000003A                   		.IF	 (PARTNO='N588H000')	
12974  000003A                   		PLA					;RESTORE FXF15
12975  000003A                   		STA !IEF1
12976  000003A                   		.ENDIF
12977  000003A                   
12978  000003A                   		PLA
12979  000003A                   		STA !BANK
12980  000003A                   		RELOAD_SW_CS
12981  000003A                   		PLY
12982  000003A                   		PLX
12983  000003A                   	.ENDIF 
12984  000003A                   
12985  000003A                   .IF ((WITH_MS .EQ. 0)&&(WITH_EVO .EQ. 0))





12986  000003A                   	QUIT_ENABLE_BAM_INT_EXCEPT
12987  000003A                   .ifdef	FW_BAM_TIMER
12988  000003A                   	LDA <IEF0_FLAG					
12989  000003A                   	BIT #C0H					
12990  000003A                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
12991  000003A                   	BIT #40H					
12992  000003A                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
12993  000003A                   	LDA #40H					
12994  000003A                   	TRB <IEF0_FLAG					
12995  000003A                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
12996  000003A                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
12997  000003A                   	SEI						
12998  000003A                   	LDA <IEF0_BAK					
12999  000003A                   	AND #(FFH^UIO_TIMER_INT)			
13000  000003A                   	ORA !IEF0					
13001  000003A                   	STA !IEF0					
13002  000003A                   	LDA #80H					
13003  000003A                   	TRB <IEF0_FLAG					
13004  000003A                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13005  000003A                   NEXT_CHECK_BAM_INT_EXCEPT#:
13006  000003A                   	BIT #30H					
13007  000003A                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13008  000003A                   	BIT #10H					
13009  000003A                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
13010  000003A                   	LDA #10H					
13011  000003A                   	TRB <IEF0_FLAG					
13012  000003A                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13013  000003A                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
13014  000003A                   	SEI						
13015  000003A                   	LDA <IEF0_BAK					
13016  000003A                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
13017  000003A                   	ORA #UIO_TIMER_INT				
13018  000003A                   	ORA !IEF0					
13019  000003A                   	STA !IEF0					
13020  000003A                   	LDA #20H					
13021  000003A                   	TRB <IEF0_FLAG					
13022  000003A                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
13023  000003A                   .endif
13024  000003A                   	;ENDM
13025  000003A                   .ENDIF
13026  000003A  68           	PLA 
13027  000003B  40           	RTI
13028  000003C                   
13029  000003C                   ;===============================================================
13030  000003C                   ;  SR_NAME: TIMERG1_ISR			;
13031  000003C                   ;===============================================================
13032  000003C                   .IF	 (PARTNO='N588H000')	
13033  000003C                   TMG1_ISR:
13034  000003C                   	PHA
13035  000003C                   	LDA #INT0_TMG1
13036  000003C                   	STA !EFC0							;CLEAR EVF OF TIMERG1
13037  000003C                   ;User can insert program from here
13038  000003C                   	PLA
13039  000003C                   	RTI
13040  000003C                   .ENDIF 
13041  000003C                   ;===============================================================
13042  000003C                   ;  SR_NAME: TIMERG0_ISR			;





13043  000003C                   ;  INPUT  : ISR0_NEXT_SYNTH_START	;OUTPUT : SP0CLT, SP0CT
13044  000003C                   ;===============================================================
13045  000003C                   TMG0_ISR:
13046  000003C                   ;*********   pls insert your TMG0 USER ISR  **********
13047  000003C                   
13048  000003C                   LIB_VS0_ISR:
13049  000003C                   LIB_VS0A_ISR:
13050  000003C  48           	PHA
13051  000003D  A9 08			LDA #INT0_TMG0
13052  000003F  8D 16 08     	STA !EFC0				;CLEAR EVF OF TIMERG
13053  0000042                   ;SET 2MS FLAGd
13054  0000042                   
13055  0000042                   	MR_SET_TMG0_GAP_FLAG
13056  0000042  A9 04			LDA #C_BIT2
13057  0000044  04 06			TSB <USER_INT_FLAG0
13058  0000046                   	;ENDM
13059  0000046                   
13060  0000046                   .ifdef	FW_BAM_TIMER	
13061  0000046                   .ifndef	FW_PWM_TIMER_TMG0	
13062  0000046                   	ENABLE_BAM_INT_EXCEPT
13063  0000046                   .endif
13064  0000046                   .ifdef	FW_PWM_TIMER_TMG0	
13065  0000046                   	ENABLE_SPEECH_INT_EXCEPT
13066  0000046                   .endif
13067  0000046                   .endif
13068  0000046                   
13069  0000046                   .IF(WITH_FW_CAP_SENSOR_KEYS .GT. 0)
13070  0000046                       CAP_TMG_OVER
13071  0000046                   .ENDIF 
13072  0000046                   
13073  0000046                   .ifdef	FW_PWM_TIMER_TMG0
13074  0000046                   	JMP FW_PWM_TIMER_DOWNCOUNT
13075  0000046                   FW_TIMER_DWONCOUNT_RET:
13076  0000046                   .endif  	
13077  0000046                   
13078  0000046                   .IF (WITH_VS0A .EQ. 1H)
13079  0000046                   	PHX
13080  0000046                   	PHY
13081  0000046                   
13082  0000046                   	STORE_SW_CS
13083  0000046                   	LDA !BANK
13084  0000046                   	PHA
13085  0000046                   
13086  0000046                   	JMP_CH1_ISR_ACTION
13087  0000046                   .ENDIF 
13088  0000046                   
13089  0000046                   	QUIT_ENABLE_BAM_INT_EXCEPT
13090  0000046                   .ifdef	FW_BAM_TIMER
13091  0000046                   	LDA <IEF0_FLAG					
13092  0000046                   	BIT #C0H					
13093  0000046                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
13094  0000046                   	BIT #40H					
13095  0000046                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
13096  0000046                   	LDA #40H					
13097  0000046                   	TRB <IEF0_FLAG					
13098  0000046                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13099  0000046                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:





13100  0000046                   	SEI						
13101  0000046                   	LDA <IEF0_BAK					
13102  0000046                   	AND #(FFH^UIO_TIMER_INT)			
13103  0000046                   	ORA !IEF0					
13104  0000046                   	STA !IEF0					
13105  0000046                   	LDA #80H					
13106  0000046                   	TRB <IEF0_FLAG					
13107  0000046                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13108  0000046                   NEXT_CHECK_BAM_INT_EXCEPT#:
13109  0000046                   	BIT #30H					
13110  0000046                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13111  0000046                   	BIT #10H					
13112  0000046                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
13113  0000046                   	LDA #10H					
13114  0000046                   	TRB <IEF0_FLAG					
13115  0000046                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13116  0000046                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
13117  0000046                   	SEI						
13118  0000046                   	LDA <IEF0_BAK					
13119  0000046                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
13120  0000046                   	ORA #UIO_TIMER_INT				
13121  0000046                   	ORA !IEF0					
13122  0000046                   	STA !IEF0					
13123  0000046                   	LDA #20H					
13124  0000046                   	TRB <IEF0_FLAG					
13125  0000046                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
13126  0000046                   .endif
13127  0000046                   	;ENDM
13128  0000046  68           	PLA
13129  0000047  40           	RTI
13130  0000048                   ;===============================================================
13131  0000048                   ;  SR_NAME: TIMER0_ISR			;
13132  0000048                   ;  INPUT  : ISR1_NEXT_SYNTH_START	;OUTPUT : SP0ALT, SP0AT
13133  0000048                   ;===============================================================
13134  0000048                   TM0_ISR:
13135  0000048                   LIB_VS1_ISR:
13136  0000048                   LIB_VS1A_ISR:
13137  0000048  48           	PHA
13138  0000049  A9 02			LDA #INT0_TM0
13139  000004B  8D 16 08     	STA !EFC0			;CLEAR EVF OF TIMERG
13140  000004E                   
13141  000004E                   .ifdef	FW_BAM_TIMER	
13142  000004E                   .ifndef	FW_PWM_TIMER_TM0	
13143  000004E                   	ENABLE_BAM_INT_EXCEPT
13144  000004E                   .endif
13145  000004E                   .ifdef	FW_PWM_TIMER_TM0	
13146  000004E                   	ENABLE_SPEECH_INT_EXCEPT
13147  000004E                   .endif
13148  000004E                   .endif
13149  000004E                   
13150  000004E                   .ifdef	FW_PWM_TIMER_TM0
13151  000004E                   	JMP FW_PWM_TIMER_DOWNCOUNT
13152  000004E                   FW_TIMER_DWONCOUNT_RET:
13153  000004E                   .endif
13154  000004E                   
13155  000004E                   .IF (WITH_VS1A .EQ. 1H)	
13156  000004E  DA           	PHX





13157  000004F  5A           	PHY
13158  0000050                   
13159  0000050                   	STORE_SW_CS
13160  0000050                   .IF (WITH_EXT32MBIT .EQ. 1)
13161  0000050                   	LDA !BANK	
13162  0000050                   	CMP #80H
13163  0000050                   	BCC END_STORE_SW_CS#
13164  0000050                   	LDA !BP2
13165  0000050                   	AND #08H
13166  0000050                   	PHA
13167  0000050                   END_STORE_SW_CS#:
13168  0000050                   .ELSE
13169  0000050                   .IF (WITH_EXT64M_SPI .EQ. 1H)
13170  0000050                   	LDA !BANK1
13171  0000050                   	AND #03H
13172  0000050                   	PHA
13173  0000050                   .ENDIF
13174  0000050                   .ENDIF
13175  0000050                   	;ENDM
13176  0000050  AD 18 08     	LDA !BANK
13177  0000053  48           	PHA
13178  0000054                   
13179  0000054                   	JMP_CH2_ISR_ACTION
13180  0000054                   	.IF (WITH_SP .EQ. 0H && WITH_MS .EQ. 0H)
13181  0000054                   	.ELSE
13182  0000054                   	.IF (WITH_VS1A .EQ. 0H)
13183  0000054                   		JMP QUIT_LIB_ISR
13184  0000054                   	.ENDIF
13185  0000054                   VS1A_NEXT_ACTION:
13186  0000054  A5 08			LDA <(CH_STATUS_SP+VS1A_START)
13187  0000056  89 00			BIT #SP_BZ
13188  0000058  F0 13			BEQ LIB_VS1B_ISR
13189  000005A  89 00			BIT #SP_ADSR
13190  000005C  D0 0C			BNE VS1A_NEXT_ACTION_CONST
13191  000005E                   	.IF (WITH_ISR_VS1A .EQ. 1H) 
13192  000005E                   		STORE_PCM_TO_TBUF CHANNEL_VS1A,VS1A_START,SP0ALT,SP0AT
13193  000005E                   	.IF (WITH_VOL_REDUCE .EQ. 1)	
13194  000005E                   		LDY #CHANNEL_VS1A
13195  000005E                   		EXTERN SP_TM_CH_MAP_TABLE
13196  000005E                   		LDA !SP_TM_CH_MAP_TABLE,Y
13197  000005E                   		INC A
13198  000005E                   		BIT <COMMON_FLAG
13199  000005E                   		BEQ VSXA_STORE_PCM#
13200  000005E                   		.IF (WITH_VOL_ADJ .EQ. 0)
13201  000005E                   			LDA <(CH_PREVIOUS_PCM_SP+1+VS1A_START)
13202  000005E                   		.ELSE
13203  000005E                   			LDA <(CH_PREVIOUS_PCM_VOL_SP+1+VS1A_START)
13204  000005E                   		.ENDIF
13205  000005E                   		EOR #80H
13206  000005E                   		BMI NEG_PCM#
13207  000005E                   		CLC
13208  000005E                   		BRA STORE_REDUCE_VOL#
13209  000005E                   NEG_PCM#:
13210  000005E                   		SEC
13211  000005E                   STORE_REDUCE_VOL#:
13212  000005E                   		ROR A
13213  000005E                   		EOR #80H





13214  000005E                   		STA !SP0AT
13215  000005E                   		.IF (WITH_VOL_ADJ .EQ. 0)
13216  000005E                   			LDA <(CH_PREVIOUS_PCM_SP+VS1A_START)
13217  000005E                   		.ELSE
13218  000005E                   			LDA <(CH_PREVIOUS_PCM_VOL_SP+VS1A_START)
13219  000005E                   		.ENDIF
13220  000005E                   		ROR A
13221  000005E                   		BRA STORE_LOW_PCM_TO_TBUF#
13222  000005E                   	.ENDIF
13223  000005E                   VSXA_STORE_PCM#:	
13224  000005E                   	.IF (WITH_VOL_ADJ .EQ. 0)
13225  000005E  A5 0C				LDA <(CH_PREVIOUS_PCM_SP+1+VS1A_START)
13226  0000060                   	.ELSE
13227  0000060                   		LDA <(CH_PREVIOUS_PCM_VOL_SP+1+VS1A_START)
13228  0000060                   	.ENDIF
13229  0000060  8D 3E 08     		STA !SP0AT
13230  0000063                   	.IF (WITH_VOL_ADJ .EQ. 0)
13231  0000063  A5 0B				LDA <(CH_PREVIOUS_PCM_SP+VS1A_START)
13232  0000065                   	.ELSE
13233  0000065                   		LDA <(CH_PREVIOUS_PCM_VOL_SP+VS1A_START)
13234  0000065                   	.ENDIF
13235  0000065                   STORE_LOW_PCM_TO_TBUF#:
13236  0000065                   	.IF (WITH_SP0XL_RESOLUTION .EQ. 2)
13237  0000065                   		AND #FCH
13238  0000065                   	.ENDIF
13239  0000065                   	.IF (WITH_SP0XL_RESOLUTION .EQ. 3)
13240  0000065                   		AND #F0H
13241  0000065                   	.ENDIF
13242  0000065  8D 3C 08     	STA !SP0ALT
13243  0000068                   	;ENDM
13244  0000068                   	.ENDIF
13245  0000068  A0 00			LDY #CHANNEL_VS1A
13246  000006A                   	.IF (WITH_PAUSE_RESUME .EQ. 1H)
13247  000006A                   		LDA <(CH_STATUS_SP+VS1A_START)
13248  000006A                   		BIT #SP_PAUSE
13249  000006A                   		BEQ 3
13250  000006A                   		EXTERN SP_PAUSE_RAMP_PROC
13251  000006A                   		JMP SP_PAUSE_RAMP_PROC
13252  000006A                   		BIT #SP_RESUME
13253  000006A                   		BEQ VS1A_NEXT_ACTION_CONST
13254  000006A                   		EXTERN SP_RESUME_RAMP_PROC
13255  000006A                   		JMP SP_RESUME_RAMP_PROC
13256  000006A                   	.ENDIF
13257  000006A                   VS1A_NEXT_ACTION_CONST:
13258  000006A  6C 09 00     	JMP (DIRECT_PAGE+CH_ISR_SYNTH_START_SP+VS1A_START)
13259  000006D                   LIB_VS1B_ISR:
13260  000006D                   QUIT_LIB_VS1_ISR:
13261  000006D  4C 7A 00     	JMP QUIT_LIB_ISR
13262  0000070                   	.ENDIF
13263  0000070                   	;ENDM
13264  0000070                   .ENDIF 
13265  0000070                   
13266  0000070                   	QUIT_ENABLE_BAM_INT_EXCEPT
13267  0000070                   .ifdef	FW_BAM_TIMER
13268  0000070                   	LDA <IEF0_FLAG					
13269  0000070                   	BIT #C0H					
13270  0000070                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			





13271  0000070                   	BIT #40H					
13272  0000070                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
13273  0000070                   	LDA #40H					
13274  0000070                   	TRB <IEF0_FLAG					
13275  0000070                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13276  0000070                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
13277  0000070                   	SEI						
13278  0000070                   	LDA <IEF0_BAK					
13279  0000070                   	AND #(FFH^UIO_TIMER_INT)			
13280  0000070                   	ORA !IEF0					
13281  0000070                   	STA !IEF0					
13282  0000070                   	LDA #80H					
13283  0000070                   	TRB <IEF0_FLAG					
13284  0000070                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13285  0000070                   NEXT_CHECK_BAM_INT_EXCEPT#:
13286  0000070                   	BIT #30H					
13287  0000070                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13288  0000070                   	BIT #10H					
13289  0000070                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
13290  0000070                   	LDA #10H					
13291  0000070                   	TRB <IEF0_FLAG					
13292  0000070                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13293  0000070                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
13294  0000070                   	SEI						
13295  0000070                   	LDA <IEF0_BAK					
13296  0000070                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
13297  0000070                   	ORA #UIO_TIMER_INT				
13298  0000070                   	ORA !IEF0					
13299  0000070                   	STA !IEF0					
13300  0000070                   	LDA #20H					
13301  0000070                   	TRB <IEF0_FLAG					
13302  0000070                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
13303  0000070                   .endif
13304  0000070                   	;ENDM
13305  0000070  68           	PLA
13306  0000071  40           	RTI
13307  0000072                   ;===============================================================
13308  0000072                   ;  SR_NAME: TIMER2_ISR			;
13309  0000072                   ;  INPUT  : ISR2_NEXT_SYNTH_START	;OUTPUT : SP0BLT, SP0BT
13310  0000072                   ;===============================================================
13311  0000072                   TM1_ISR:
13312  0000072                   LIB_VS2_ISR:
13313  0000072                   LIB_VS2A_ISR:
13314  0000072  48           	PHA
13315  0000073  A9 04			LDA #INT0_TM1
13316  0000075  8D 16 08     	STA !EFC0     			;CLEAR EVF OF TIMER1
13317  0000078                   
13318  0000078                   .ifdef	FW_BAM_TIMER	
13319  0000078                   .ifndef	FW_PWM_TIMER_TM1	
13320  0000078                   	ENABLE_BAM_INT_EXCEPT
13321  0000078                   .endif
13322  0000078                   .ifdef	FW_PWM_TIMER_TM1	
13323  0000078                   	ENABLE_SPEECH_INT_EXCEPT
13324  0000078                   .endif
13325  0000078                   .endif
13326  0000078                   
13327  0000078                   .ifdef	FW_PWM_TIMER_TM1





13328  0000078                   	JMP FW_PWM_TIMER_DOWNCOUNT
13329  0000078                   FW_TIMER_DWONCOUNT_RET:
13330  0000078                   .endif
13331  0000078                   
13332  0000078                   .IF (WITH_VS2A .EQ. 1H)
13333  0000078                   	PHX
13334  0000078                   	PHY
13335  0000078                   
13336  0000078                   	STORE_SW_CS
13337  0000078                   	LDA !BANK
13338  0000078                   	PHA
13339  0000078                   
13340  0000078                   	JMP_CH3_ISR_ACTION
13341  0000078                   .ENDIF 
13342  0000078                   
13343  0000078                   	QUIT_ENABLE_BAM_INT_EXCEPT
13344  0000078                   .ifdef	FW_BAM_TIMER
13345  0000078                   	LDA <IEF0_FLAG					
13346  0000078                   	BIT #C0H					
13347  0000078                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
13348  0000078                   	BIT #40H					
13349  0000078                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
13350  0000078                   	LDA #40H					
13351  0000078                   	TRB <IEF0_FLAG					
13352  0000078                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13353  0000078                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
13354  0000078                   	SEI						
13355  0000078                   	LDA <IEF0_BAK					
13356  0000078                   	AND #(FFH^UIO_TIMER_INT)			
13357  0000078                   	ORA !IEF0					
13358  0000078                   	STA !IEF0					
13359  0000078                   	LDA #80H					
13360  0000078                   	TRB <IEF0_FLAG					
13361  0000078                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13362  0000078                   NEXT_CHECK_BAM_INT_EXCEPT#:
13363  0000078                   	BIT #30H					
13364  0000078                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13365  0000078                   	BIT #10H					
13366  0000078                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
13367  0000078                   	LDA #10H					
13368  0000078                   	TRB <IEF0_FLAG					
13369  0000078                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13370  0000078                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
13371  0000078                   	SEI						
13372  0000078                   	LDA <IEF0_BAK					
13373  0000078                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
13374  0000078                   	ORA #UIO_TIMER_INT				
13375  0000078                   	ORA !IEF0					
13376  0000078                   	STA !IEF0					
13377  0000078                   	LDA #20H					
13378  0000078                   	TRB <IEF0_FLAG					
13379  0000078                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
13380  0000078                   .endif
13381  0000078                   	;ENDM
13382  0000078  68           	PLA
13383  0000079  40           	RTI
13384  000007A                   ;===============================================================





13385  000007A                   ;  Quit Libary ISR Lable
13386  000007A                   ;===============================================================
13387  000007A                   QUIT_LIB_ISR:
13388  000007A  68           	PLA
13389  000007B  8D 18 08     	STA !BANK
13390  000007E                   	RELOAD_SW_CS
13391  000007E                   .IF (WITH_EXT32MBIT .EQ. 1)
13392  000007E                   	CMP #80H
13393  000007E                   	BCC END_RELOAD_SW_CS#
13394  000007E                   	PLA 
13395  000007E                   	BEQ SW_CS_0#
13396  000007E                   	LDA #08H
13397  000007E                   	TSB !BP2
13398  000007E                   	BRA END_RELOAD_SW_CS#
13399  000007E                   SW_CS_0#:
13400  000007E                   	LDA #08H
13401  000007E                       TRB !BP2
13402  000007E                   END_RELOAD_SW_CS#:
13403  000007E                   .ELSE
13404  000007E                   .IF (WITH_EXT64M_SPI .EQ. 1H)
13405  000007E                   	PLA
13406  000007E                   	STA !BANK1
13407  000007E                   .ENDIF
13408  000007E                   .ENDIF
13409  000007E                   	;ENDM
13410  000007E                   
13411  000007E  7A           	PLY
13412  000007F  FA           	PLX
13413  0000080                   	QUIT_ENABLE_BAM_INT_EXCEPT
13414  0000080                   .ifdef	FW_BAM_TIMER
13415  0000080                   	LDA <IEF0_FLAG					
13416  0000080                   	BIT #C0H					
13417  0000080                   	BEQ NEXT_CHECK_BAM_INT_EXCEPT#			
13418  0000080                   	BIT #40H					
13419  0000080                   	BEQ NEXT_CHECK_SPEECH1_INT_EXCEPT#		
13420  0000080                   	LDA #40H					
13421  0000080                   	TRB <IEF0_FLAG					
13422  0000080                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13423  0000080                   NEXT_CHECK_SPEECH1_INT_EXCEPT#:
13424  0000080                   	SEI						
13425  0000080                   	LDA <IEF0_BAK					
13426  0000080                   	AND #(FFH^UIO_TIMER_INT)			
13427  0000080                   	ORA !IEF0					
13428  0000080                   	STA !IEF0					
13429  0000080                   	LDA #80H					
13430  0000080                   	TRB <IEF0_FLAG					
13431  0000080                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13432  0000080                   NEXT_CHECK_BAM_INT_EXCEPT#:
13433  0000080                   	BIT #30H					
13434  0000080                   	BEQ END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13435  0000080                   	BIT #10H					
13436  0000080                   	BEQ NEXT_CHECK_SPEECH2_INT_EXCEPT#		
13437  0000080                   	LDA #10H					
13438  0000080                   	TRB <IEF0_FLAG					
13439  0000080                   	BRA END_QUIT_ENABLE_BAM_INT_EXCEPT#		
13440  0000080                   NEXT_CHECK_SPEECH2_INT_EXCEPT#:
13441  0000080                   	SEI						





13442  0000080                   	LDA <IEF0_BAK					
13443  0000080                   	AND #FFH^(INT0_TM0+INT0_TM1+INT0_TMG0)		
13444  0000080                   	ORA #UIO_TIMER_INT				
13445  0000080                   	ORA !IEF0					
13446  0000080                   	STA !IEF0					
13447  0000080                   	LDA #20H					
13448  0000080                   	TRB <IEF0_FLAG					
13449  0000080                   END_QUIT_ENABLE_BAM_INT_EXCEPT#:
13450  0000080                   .endif
13451  0000080                   	;ENDM
13452  0000080  68           	PLA
13453  0000081  40           	RTI
13454  0000082                   
13455  0000082                   ;===============================================
13456  0000082                   ; Main program start here after resetting
13457  0000082                   ;===============================================
13458  0000082                   MAIN_START:
13459  0000082                   	SET_STACK_POINTER_TO STACK_END			;USER CAN CHANGE THE VALUE
13460  0000082  A2 7F			LDX	#STACK_END
13461  0000084  9A           	TXS
13462  0000085                   	;ENDM
13463  0000085                       SYSTEM_INIT_PROCEDURE				;SYSTEM INITIALIZATION PROCEDURE
13464  0000085                   	.IF	(CHIPSERIES = 'N588H').OR.(CHIPSERIES = 'N588J')
13465  0000085                       	SYSTEM_INIT_PROCEDURE_N588H
13466  0000085                   	.IF	 (PARTNO='N588H000')
13467  0000085                   	SYSTEM_INIT_PROCEDURE_N588H000
13468  0000085                   	.ELSE
13469  0000085                   	SYSTEM_INIT_PROCEDURE_N588H340
13470  0000085  A9 04			LDA #04H
13471  0000087  0C 0F 08     	TSB CTL_CPU
13472  000008A  A9 16			LDA #16H
13473  000008C  8D FF 08     	STA CFGF
13474  000008F  A9 FF			LDA #FFH 
13475  0000091  8D FE 08     	STA CFGE 
13476  0000094                   	.IFDEF      ROSC_USER
13477  0000094                   	    LDA #75H  	        
13478  0000094                   	.ENDIF
13479  0000094                   	.IFDEF      ROSC_4M
13480  0000094                   	    LDA #65H
13481  0000094                   	.ENDIF	
13482  0000094                   	.IFDEF      ROSC_8M
13483  0000094                   	    LDA #55H
13484  0000094                   	.ENDIF
13485  0000094                   	.IFDEF      ROSC_6M
13486  0000094  A9 45			    LDA #45H
13487  0000096                   	.ENDIF
13488  0000096                   	.IF	 (PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341')
13489  0000096                   	    ORA #00H
13490  0000096                   	.ELSE
13491  0000096  09 02			    ORA #02H	
13492  0000098                   	.ENDIF	
13493  0000098  8D FA 08     	STA CFGA
13494  000009B  A9 17			LDA #17H
13495  000009D  8D FD 08     	STA CFGD
13496  00000A0  A9 02			LDA #02H
13497  00000A2  8D FC 08     	STA CFGC
13498  00000A5  A9 02			LDA #02H





13499  00000A7                   	.IFDEF      INN_INTERNAL
13500  00000A7                   	    ORA #20H
13501  00000A7                   	.ENDIF	
13502  00000A7                   	.IFDEF      LVR_20V
13503  00000A7                   	    ORA #C0H
13504  00000A7                   	.ENDIF
13505  00000A7                   	.IFDEF      LVR_22V
13506  00000A7  09 80			    ORA #80H
13507  00000A9                   	.ENDIF	
13508  00000A9                   	.IFDEF      LVR_26V
13509  00000A9                   	    ORA #40H
13510  00000A9                   	.ENDIF
13511  00000A9                   	.IFDEF      LVR_28V
13512  00000A9                   	    ORA #00H
13513  00000A9                   	.ENDIF
13514  00000A9  8D FB 08     	STA CFGB
13515  00000AC                   	.IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')
13516  00000AC  A9 00			    LDA #00H
13517  00000AE                   	.ENDIF
13518  00000AE                   	.IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170').OR.(PARTNO='N588JP170')
13519  00000AE                   	    LDA #00H
13520  00000AE                   	.ENDIF
13521  00000AE                   	.IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
13522  00000AE                   	    LDA #02H
13523  00000AE                   	.ENDIF
13524  00000AE                   	.IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
13525  00000AE                   	    LDA #02H
13526  00000AE                   	.ENDIF
13527  00000AE  8D F9 08     	STA	CFG9
13528  00000B1                   	.IF	(CHIPSERIES = 'N588H')
13529  00000B1  A9 9E			    LDA #9EH
13530  00000B3                   	.ENDIF
13531  00000B3                   	.IF	(CHIPSERIES = 'N588J')
13532  00000B3                   	    LDA #96H
13533  00000B3                   	.ENDIF
13534  00000B3  8D F8 08     	STA	CFG8
13535  00000B6  A9 02			LDA 	#02H
13536  00000B8  8D F7 08     	STA	CFG7
13537  00000BB  A9 00			LDA	#00H
13538  00000BD  8D F6 08     	STA	CFG6
13539  00000C0  8D F5 08     	STA	CFG5
13540  00000C3  8D F4 08     	STA	CFG4
13541  00000C6                   	.IFDEF	WDTIMER
13542  00000C6  A9 F7			    LDA	#F7H
13543  00000C8                   	.ELSE
13544  00000C8                   	    LDA	#77H
13545  00000C8                   	.ENDIF	
13546  00000C8  8D F3 08     	STA	CFG3
13547  00000CB  A9 FF			LDA	#FFH
13548  00000CD  8D F2 08     	STA	CFG2
13549  00000D0                   	.IFDEF	PHR_150
13550  00000D0                   	    LDA	#DFH
13551  00000D0                   	.ELSE
13552  00000D0  A9 9F			    LDA	#9FH
13553  00000D2                   	.ENDIF
13554  00000D2  8D F1 08     	STA	CFG1
13555  00000D5                   	.IF	 (PARTNO='N588H040').OR.(PARTNO='N588H060').OR.(PARTNO='N588H061').OR.(PARTNO='N588H080').OR.(PARTNO='N588H081').OR.(PARTNO='N588H120').OR.(PARTNO='N588H170').OR.(PARTNO='N588HP080').OR.(PARTNO='N588HP170')





13556  00000D5  A9 00			    LDA #00H
13557  00000D7                   	.ENDIF
13558  00000D7                   	.IF	 (PARTNO='N588J010').OR.(PARTNO='N588J040').OR.(PARTNO='N588J060').OR.(PARTNO='N588J080').OR.(PARTNO='N588J120').OR.(PARTNO='N588J170').OR.(PARTNO='N588JP170')
13559  00000D7                   	    LDA #00H
13560  00000D7                   	.ENDIF
13561  00000D7                   	.IF	 (PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340')
13562  00000D7                   	    LDA #F0H
13563  00000D7                   	.ENDIF
13564  00000D7                   	.IF	 (PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
13565  00000D7                   	    LDA #F0H
13566  00000D7                   	.ENDIF
13567  00000D7  8D F0 08     	STA	CFG0
13568  00000DA                   	;ENDM
13569  00000DA                   	.ENDIF
13570  00000DA                   	;ENDM
13571  00000DA                       	.ENDIF
13572  00000DA                   	;ENDM
13573  00000DA                   	CLEAR_RAM_RANGE RAM_BEGIN,RAM_END			;USER CAN CHANGE THE VALUE
13574  00000DA  A9 7F			LDA	#.LOW.RAM_END
13575  00000DC  85 00			STA	<RAM_BEGIN			
13576  00000DE  A9 00			LDA	#.HIGH.RAM_END	
13577  00000E0  85 01			STA	<RAM_BEGIN+1			
13578  00000E2                   CLEAR_LOOP_1#:
13579  00000E2  A9 00			LDA	#00
13580  00000E4  92 00			STA	(<RAM_BEGIN)
13581  00000E6  A5 01			LDA	<RAM_BEGIN+1
13582  00000E8  C9 00			CMP 	#(.HIGH.RAM_BEGIN+2)
13583  00000EA  D0 06			BNE 	DEC_ADDR_1#
13584  00000EC  A5 00			LDA	<RAM_BEGIN
13585  00000EE  C9 02			CMP	#(.LOW.RAM_BEGIN+2)
13586  00000F0  F0 16			BEQ	END_CLEAR_1#
13587  00000F2                   DEC_ADDR_1#:
13588  00000F2  38           	SEC
13589  00000F3  A5 00			LDA	<RAM_BEGIN
13590  00000F5  E9 01			SBC	#01H
13591  00000F7  85 00			STA	<RAM_BEGIN
13592  00000F9  A5 01			LDA	<RAM_BEGIN+1
13593  00000FB  E9 00			SBC	#00H
13594  00000FD  85 01			STA	<RAM_BEGIN+1
13595  00000FF                   	.IF	 (CHIPBODY!='N588H000')
13596  00000FF  C9 01			CMP	#01h
13597  0000101  D0 02			BNE	NOT_IN_01#	
13598  0000103  C6 01			DEC	<RAM_BEGIN+1
13599  0000105                   	.ENDIF
13600  0000105                   NOT_IN_01#:
13601  0000105  4C E2 00     	JMP	CLEAR_LOOP_1#
13602  0000108                   END_CLEAR_1#:
13603  0000108  A9 00			LDA	#00h
13604  000010A  85 00			STA	<RAM_BEGIN	
13605  000010C  85 01			STA	<RAM_BEGIN+1
13606  000010E                   	;ENDM
13607  000010E  58            	CLI
13608  000010F                   	SPECIAL_REGISTERS_INIT
13609  000010F                   	.IF (WITH_SIM_SP .EQ. 1H)
13610  000010F                   		LDA #RDPC_WSC+WITH_RDPC_VALUE
13611  000010F                   		STA !RDPC
13612  000010F                   		.IF (WITH_SIM_TYPE .EQ. 0)





13613  000010F                   	      		LDA #SIC_EN
13614  000010F                   	      		STA !SIC
13615  000010F                   	      		.IF (WITH_EXT32MBIT .EQ. 1)
13616  000010F                   	      			LDA #01H
13617  000010F                   	      			TRB !BP2D
13618  000010F                   	        	.ENDIF
13619  000010F                   	        .ENDIF
13620  000010F                   		.IF (WITH_SIM_TYPE .EQ. 1)
13621  000010F                   		        LDA #(SIC_EN+SIC_SPI)
13622  000010F                   		      	STA !SIC
13623  000010F                   		.ENDIF
13624  000010F                   	.ENDIF		
13625  000010F                   .IF((WITH_MS .EQ. 0) && (WITH_SP .EQ. 0))
13626  000010F                   .ELSE
13627  000010F                   	.IF(WITH_SPEAKER_SWITCH .EQ. 1)
13628  000010F                   		LDA <SPEN_TMP
13629  000010F                   		BNE END_STORE_SPEAKER#
13630  000010F                   		LDA #WITH_SPEAKER_OUTPUT_TYPE
13631  000010F                   		STA <SPEN_TMP	
13632  000010F                   END_STORE_SPEAKER#:
13633  000010F                   	.ENDIF
13634  000010F  9C 33 08     		STZ !SPEN
13635  0000112                   .ENDIF
13636  0000112                   .IF(WITH_PSF_PROJECT .EQ. 0)
13637  0000112  A9 FF			LDA #FFH
13638  0000114  8D 01 08     	STA !BP0
13639  0000117  8D 02 08     	STA !BP1
13640  000011A                   	.IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
13641  000011A                   		STA !BP2
13642  000011A                   	.ENDIF
13643  000011A                   .ENDIF
13644  000011A                   	EXTERN	UIO_INIT
13645  000011A  20 00 00     	JSR 	UIO_INIT
13646  000011D                   	.IF (N55P_DEVICE_NUM .GT. 0H)
13647  000011D                   	EXTERN	UIO_N55P_INIT
13648  000011D                   	JSR 	UIO_N55P_INIT
13649  000011D                   	.ENDIF
13650  000011D                   .IF(WITH_PSF_PROJECT .EQ. 0)
13651  000011D                   .IFDEF       BPXM_RAM	
13652  000011D                   	.IF	(PARTNO='N588H000').OR.(PARTNO='N588H200').OR.(PARTNO='N588H250').OR.(PARTNO='N588H340').OR.(PARTNO='N588H201').OR.(PARTNO='N588H251').OR.(PARTNO='N588H341').OR.(PARTNO='N588H480').OR.(PARTNO='N588H650').OR.(PARTNO='N588HP340').OR.(PARTNO='N588J200').OR.(PARTNO='N588J250').OR.(PARTNO='N588J340').OR.(PARTNO='N588J201').OR.(PARTNO='N588J251').OR.(PARTNO='N588J341').OR.(PARTNO='N588J480').OR.(PARTNO='N588J650')
13653  000011D                   	LDX !BP2D
13654  000011D                   	EXTERN BP2M_BAK_TABLE
13655  000011D                   	LDA !BP2M_BAK_TABLE,X
13656  000011D                   	STA <BP2M_BAK
13657  000011D                   	.ENDIF
13658  000011D                   	LDX !BP1D
13659  000011D                   	EXTERN BP1M_BAK_TABLE
13660  000011D                   	LDA !BP1M_BAK_TABLE,X
13661  000011D                   	STA <BP1M_BAK
13662  000011D                   	LDX !BP0D
13663  000011D                   	EXTERN BP0M_BAK_TABLE
13664  000011D                   	LDA !BP0M_BAK_TABLE,X
13665  000011D                   	STA <BP0M_BAK
13666  000011D                   .ENDIF
13667  000011D                   .ENDIF
13668  000011D                   	PUBLIC		DRUM_LIST_TABLE_LOW
13669  000011D                   	PUBLIC		DRUM_LIST_TABLE_HIGH





13670  000011D                   	PUBLIC		DRUM_LIST_TABLE_HIGH8
13671  000011D                   DRUM_LIST_TABLE_LOW:
13672  000011D                   DRUM_LIST_TABLE_HIGH:
13673  000011D                   DRUM_LIST_TABLE_HIGH8:
13674  000011D                   	.IF (WITH_VS0B .EQ. 1H)	
13675  000011D                   		PUBLIC		LIB_VS0B_ISR
13676  000011D                   		PUBLIC		LIB_VS1B_ISR
13677  000011D                   		PUBLIC		LIB_VS2B_ISR
13678  000011D                   		PUBLIC		QUIT_LIB_VS0_ISR
13679  000011D                   		PUBLIC		QUIT_LIB_VS1_ISR
13680  000011D                   		PUBLIC		QUIT_LIB_VS2_ISR
13681  000011D                   		LDA #.LOW.LIB_VS0B_ISR
13682  000011D                   		STA <VS0A_START+CH_ISR_SYNTH_START_SP
13683  000011D                   		LDA #.HIGH.LIB_VS0B_ISR
13684  000011D                   		STA <VS0A_START+CH_ISR_SYNTH_START_SP+1
13685  000011D                   		LDA #.LOW.QUIT_LIB_VS0_ISR
13686  000011D                   		STA <VS0B_START+CH_ISR_SYNTH_START_SP
13687  000011D                   		LDA #.HIGH.QUIT_LIB_VS0_ISR
13688  000011D                   		STA <VS0B_START+CH_ISR_SYNTH_START_SP+1
13689  000011D                   		LDA #.LOW.LIB_VS1B_ISR
13690  000011D                   		STA <VS1A_START+CH_ISR_SYNTH_START_SP
13691  000011D                   		LDA #.HIGH.LIB_VS1B_ISR
13692  000011D                   		STA <VS1A_START+CH_ISR_SYNTH_START_SP+1
13693  000011D                   		LDA #.LOW.QUIT_LIB_VS1_ISR
13694  000011D                   		STA <VS1B_START+CH_ISR_SYNTH_START_SP
13695  000011D                   		LDA #.HIGH.QUIT_LIB_VS1_ISR
13696  000011D                   		STA <VS1B_START+CH_ISR_SYNTH_START_SP+1
13697  000011D                   		LDA #.LOW.LIB_VS2B_ISR
13698  000011D                   		STA <VS2A_START+CH_ISR_SYNTH_START_SP
13699  000011D                   		LDA #.HIGH.LIB_VS2B_ISR
13700  000011D                   		STA <VS2A_START+CH_ISR_SYNTH_START_SP+1
13701  000011D                   		LDA #80H
13702  000011D                   		STA <VS0A_START+CH_OLD_SAMPLE_EMM+1
13703  000011D                   		STA <VS0B_START+CH_OLD_SAMPLE_EMM+1
13704  000011D                   		STA <VS1A_START+CH_OLD_SAMPLE_EMM+1
13705  000011D                   		STA <VS1B_START+CH_OLD_SAMPLE_EMM+1
13706  000011D                   		STA <VS2A_START+CH_OLD_SAMPLE_EMM+1
13707  000011D                   		STA <VS2B_START+CH_OLD_SAMPLE_EMM+1
13708  000011D                   	.ELSE 
13709  000011D                   		.IF (WITH_ISR_VS0A .EQ. 1H)
13710  000011D                   			PUBLIC		QUIT_LIB_VS0_ISR
13711  000011D                   			LDA #.LOW.QUIT_LIB_VS0_ISR
13712  000011D                   			STA <VS0A_START+CH_ISR_SYNTH_START_SP
13713  000011D                   			LDA #.HIGH.QUIT_LIB_VS0_ISR
13714  000011D                   			STA <VS0A_START+CH_ISR_SYNTH_START_SP+1
13715  000011D                   		.ENDIF
13716  000011D                   		.IF (WITH_ISR_VS1A .EQ. 1H)
13717  000011D                   			PUBLIC		QUIT_LIB_VS1_ISR
13718  000011D  A9 6D					LDA #.LOW.QUIT_LIB_VS1_ISR
13719  000011F  85 09					STA <VS1A_START+CH_ISR_SYNTH_START_SP
13720  0000121  A9 00					LDA #.HIGH.QUIT_LIB_VS1_ISR
13721  0000123  85 0A					STA <VS1A_START+CH_ISR_SYNTH_START_SP+1
13722  0000125                   		.ENDIF
13723  0000125                   		.IF (WITH_ISR_VS2A .EQ. 1H)
13724  0000125                   			PUBLIC		QUIT_LIB_VS2_ISR
13725  0000125                   			LDA #.LOW.QUIT_LIB_VS2_ISR
13726  0000125                   			STA <VS2A_START+CH_ISR_SYNTH_START_SP





13727  0000125                   			LDA #.HIGH.QUIT_LIB_VS2_ISR
13728  0000125                   			STA <VS2A_START+CH_ISR_SYNTH_START_SP+1
13729  0000125                   		.ENDIF
13730  0000125                   	.ENDIF
13731  0000125                   	.IF (WITH_SP .EQ. 1).OR.(WITH_MS .EQ. 1)
13732  0000125  A0 FF			LDY #FFH
13733  0000127                   INIT_PCM#:
13734  0000127  C8           	INY
13735  0000128  BE 00 00     	LDX !SP_CHANNEL_ADDR_TABLE,Y		
13736  000012B  F0 08			BEQ END_INIT_PCM#
13737  000012D  A9 80			LDA #80H
13738  000012F  95 04			STA <CH_PREVIOUS_PCM_SP+1,X
13739  0000131  74 03			STZ <CH_PREVIOUS_PCM_SP,X
13740  0000133                   	.IF (WITH_VOL_ADJ .EQ. 1H)
13741  0000133                   	LDA #80H
13742  0000133                   	STA <CH_PREVIOUS_PCM_VOL_SP+1,X
13743  0000133                   	STZ <CH_PREVIOUS_PCM_VOL_SP,X
13744  0000133                   	.ENDIF
13745  0000133  80 F2			BRA INIT_PCM#
13746  0000135                   END_INIT_PCM#:
13747  0000135                   	.ENDIF
13748  0000135                   	.IF (WITH_GLOBAL_CHANNEL_VOLM == 1 || WITH_GLOBAL_CHANNEL_INS == 1 ||WITH_MULTI_CHANNEL == 1)
13749  0000135                   		LDY #FFH
13750  0000135                   INIT_GLOBAL_CHANNEL_SETTING#:
13751  0000135                   		INY
13752  0000135                   		CPY #03H
13753  0000135                   		BCS END_INIT_GLOBAL_CHANNEL_SETTING#
13754  0000135                   		EXTERN MS_CHANNEL_TABLE
13755  0000135                   		LDA !MS_CHANNEL_TABLE,Y
13756  0000135                   		BEQ INIT_GLOBAL_CHANNEL_SETTING#
13757  0000135                   		.IF (WITH_GLOBAL_CHANNEL_VOLM .EQ. 1H)
13758  0000135                   			EXTERN MS_GLOBAL_CHANNEL_VOLUME_TABLE
13759  0000135                   			LDX MS_GLOBAL_CHANNEL_VOLUME_TABLE,Y
13760  0000135                   			LDA #7FH
13761  0000135                   			STA GLOBAL_CHANNEL_VOLM0,X
13762  0000135                   		.ENDIF
13763  0000135                   		.IF (WITH_GLOBAL_CHANNEL_INS .EQ. 1H)
13764  0000135                   			EXTERN MS_GLOBAL_CHANNEL_INS_TABLE
13765  0000135                   			LDX MS_GLOBAL_CHANNEL_INS_TABLE,Y
13766  0000135                   			STZ GLOBAL_CHANNEL_INS0,X
13767  0000135                   		.ENDIF
13768  0000135                   		.IF (WITH_MULTI_CHANNEL .EQ. 1H)
13769  0000135                   			EXTERN ASSIGN_MELODY_CHANNEL_TABLE
13770  0000135                   			LDX ASSIGN_MELODY_CHANNEL_TABLE,Y
13771  0000135                   			TYA
13772  0000135                   			STA CH_SYNTH_CHANNEL0,X
13773  0000135                   		.ENDIF
13774  0000135                   		BRA INIT_GLOBAL_CHANNEL_SETTING#
13775  0000135                   END_INIT_GLOBAL_CHANNEL_SETTING#:
13776  0000135                   	.ENDIF
13777  0000135                   	;ENDM
13778  0000135                        .IF(WITH_FW_CAP_SENSOR_KEYS .GT. 0)
13779  0000135                           EN_CAP_SENSOR
13780  0000135                   ;EXTERN CAP_SENSOR_INIT_API
13781  0000135                   ;JSR 	CAP_SENSOR_INIT_API
13782  0000135                        .ENDIF
13783  0000135                   ;---------------------------SPEECH EQUATION -------------------------------------------------------------------------------





13784  0000135                   ;	PLAY MANSPEAK_MDM<CH=1/2/3,VOL=8,SR=8000>
13785  0000135                   ;		MANSPEAK_MDM is speech file name with MDPCM format
13786  0000135                   ;		CH is speech channel assignment
13787  0000135                   ;		CH: 1->TIMER0  2:TIMER1 3:TIMERG0(for N588H,no tone or speech&midi not play simultaneity)
13788  0000135                   ;		CH: 1->TIMERG0 2:TIMER0 3:TIMER1 (for N588H,has tone when speech&midi play simultaneity)
13789  0000135                   ;		CH: 1->TIMER0			 (for N588J)
13790  0000135                   ;		VOL=4 is volume level(0~8)
13791  0000135                   ;		SR=8000 is sampling rate,
13792  0000135                   ;		if user not assign value to SR then use the default S.R. in speech file
13793  0000135                   ;---------------------------MELODY EQUATION-------------------------------------------------------------------------------
13794  0000135                   ;	PLAY MARCH<CH=MS,VOL=8,TPO=120>
13795  0000135                   ;		March is melody file name with MIDI format 0
13796  0000135                   ;		MS is melody channel assignment
13797  0000135                   ;		VOL=5 is volume level(0~8)
13798  0000135                   ;		TPO=120 is tempo value
13799  0000135                   ;		For N588H:Support midi
13800  0000135                   ;		For N588J:NOT support midi
13801  0000135                   ;		if user not assign value to TPO then use the default tempo in MIDI file
13802  0000135                   ;---------------------------EVO EQUATION ---------------------------------------------------------------------------------
13803  0000135                   ;	PLAY CLAP_1PIN<CH=EVO1/EVO2/EVO3,FORMAT=EVO>
13804  0000135                   ;		CLAP_1PIN is file name with WIO format(speech with event or UIO command)
13805  0000135                   ;		CH is evo channel assignment
13806  0000135                   ;		For N588H:EVO1/EVO2/EVO3
13807  0000135                   ;		For N588J:EVO1
13808  0000135                   ;		if user not assign FORMAT then use the default EVO FORMAT(no audio data,only event and UIO command)
13809  0000135                   ;-------------------------------------------------------------------------------------------------------------------------
13810  0000135                   
13811  0000135                   
13812  0000135  4C 91 04     	JMP	POI_USER
13813  0000138                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\BK0_ASM_FILES.ASM.APP"
13814  0000138                   ; <<<<<<< 1.6.1.4 >>>>>>>>>>> 
13815  0000138                   ; Create Time: 2018/10/23 ÐÇÆÚ¶þ ÉÏÎç 10:35:10
13816  0000138                   
13817  0000138                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\COMMON_PG.ASM.APP"
13818  0000138                   ;=======================================
13819  0000138                   ;	<< BK0S0.ASM >>
13820  0000138                   ;===========================================
13821  0000138                   ;
13822  0000138                   
13823  0000138                   .IF ( C_SCORE_2_4DIGIT_EN .EQ.1)
13824  0000138                   ;===========================
13825  0000138                   ; max: 9999
13826  0000138                   ;===========================
13827  0000138                   
13828  0000138                   BK0_SCORE_2_4DIGIT:
13829  0000138                   
13830  0000138                   	LDA	R_P1_SCORE_NO1
13831  0000138                   	STA	REG_HL
13832  0000138                   	LDA	R_P1_SCORE_NO
13833  0000138                   	STA	REG_EA
13834  0000138                   
13835  0000138                   BK0_SCORE_2_4DIGIT_S000:
13836  0000138                   	LDA	#00H
13837  0000138                   	STA	R_DIGIT_3
13838  0000138                   	STA	R_DIGIT_2
13839  0000138                   	STA	R_DIGIT_1
13840  0000138                   





13841  0000138                   SCORE_2_4DIGIT_S010:
13842  0000138                   	LDA	REG_HL
13843  0000138                   	CMP	#.HIGH.1000
13844  0000138                   	BCC	SCORE_2_4DIGIT_S100
13845  0000138                   	BNE	SCORE_2_4DIGIT_S011
13846  0000138                   
13847  0000138                   	LDA	REG_EA
13848  0000138                   	CMP	#.LOW.1000
13849  0000138                   	BCC	SCORE_2_4DIGIT_S100
13850  0000138                   
13851  0000138                   SCORE_2_4DIGIT_S011:
13852  0000138                   	SEC
13853  0000138                   	LDA	REG_EA
13854  0000138                   	SBC	#.LOW.1000
13855  0000138                   	STA	REG_EA
13856  0000138                   	LDA	REG_HL
13857  0000138                   	SBC	#.HIGH.1000
13858  0000138                   	STA	REG_HL
13859  0000138                   
13860  0000138                   	INC	R_DIGIT_3
13861  0000138                   	BRA	SCORE_2_4DIGIT_S010
13862  0000138                   
13863  0000138                   SCORE_2_4DIGIT_S100:
13864  0000138                   
13865  0000138                   	LDA	REG_HL
13866  0000138                   	BNE	SCORE_2_4DIGIT_S111
13867  0000138                   
13868  0000138                   	LDA	REG_EA
13869  0000138                   	CMP	#100
13870  0000138                   	BCC	SCORE_2_4DIGIT_S200
13871  0000138                   
13872  0000138                   SCORE_2_4DIGIT_S111:
13873  0000138                   	SEC	
13874  0000138                   	LDA	REG_EA
13875  0000138                   	SBC	#100
13876  0000138                   	STA	REG_EA
13877  0000138                   	LDA	REG_HL
13878  0000138                   	SBC	#0
13879  0000138                   	STA	REG_HL
13880  0000138                   
13881  0000138                   	INC	R_DIGIT_2
13882  0000138                   	BRA	SCORE_2_4DIGIT_S100
13883  0000138                   
13884  0000138                   SCORE_2_4DIGIT_S200:
13885  0000138                   	LDA	REG_EA
13886  0000138                   	CMP	#10
13887  0000138                   	BCC	SCORE_2_4DIGIT_S300
13888  0000138                   
13889  0000138                   	SEC	
13890  0000138                   	LDA	REG_EA
13891  0000138                   	SBC	#10
13892  0000138                   	STA	REG_EA
13893  0000138                   
13894  0000138                   	INC	R_DIGIT_1
13895  0000138                   	BRA	SCORE_2_4DIGIT_S200
13896  0000138                   
13897  0000138                   SCORE_2_4DIGIT_S300:





13898  0000138                   	LDA	REG_EA
13899  0000138                   	STA	R_DIGIT_0
13900  0000138                   
13901  0000138                   
13902  0000138                   SCORE_2_4DIGIT_S400:
13903  0000138                   
13904  0000138                   	RTS
13905  0000138                   .ENDIF
13906  0000138                   
13907  0000138                   .IF ( C_SCORE_2_3DIGIT_EN .EQ.1)
13908  0000138                   ;=============================
13909  0000138                   ; MAX: 999
13910  0000138                   ;=============================
13911  0000138                   BK0_SCORE_2_3DIGIT:
13912  0000138                   
13913  0000138                   	LDA	R_P1_SCORE_NO1
13914  0000138                   	STA	REG_HL
13915  0000138                   	LDA	R_P1_SCORE_NO
13916  0000138                   	STA	REG_EA
13917  0000138                   
13918  0000138                   BK0_SCORE_2_3DIGIT_S000:
13919  0000138                   
13920  0000138                   	LDA	#00H
13921  0000138                   	STA	R_DIGIT_2
13922  0000138                   	STA	R_DIGIT_1
13923  0000138                   
13924  0000138                   SCORE_2_3DIGIT_S010:
13925  0000138                   	LDA	REG_HL
13926  0000138                   	BNE	SCORE_2_3DIGIT_S011
13927  0000138                   
13928  0000138                   	LDA	REG_EA
13929  0000138                   	CMP	#100
13930  0000138                   	BCC	SCORE_2_3DIGIT_S100
13931  0000138                   
13932  0000138                   SCORE_2_3DIGIT_S011:
13933  0000138                   	SEC	
13934  0000138                   	LDA	REG_EA
13935  0000138                   	SBC	#100
13936  0000138                   	STA	REG_EA
13937  0000138                   	LDA	REG_HL
13938  0000138                   	SBC	#0
13939  0000138                   	STA	REG_HL
13940  0000138                   
13941  0000138                   	INC	R_DIGIT_2
13942  0000138                   	BRA	SCORE_2_3DIGIT_S010
13943  0000138                   
13944  0000138                   SCORE_2_3DIGIT_S100:
13945  0000138                   	LDA	REG_EA
13946  0000138                   	CMP	#10
13947  0000138                   	BCC	SCORE_2_3DIGIT_S200
13948  0000138                   
13949  0000138                   	SEC	
13950  0000138                   	LDA	REG_EA
13951  0000138                   	SBC	#10
13952  0000138                   	STA	REG_EA
13953  0000138                   
13954  0000138                   	INC	R_DIGIT_1





13955  0000138                   	BRA	SCORE_2_3DIGIT_S100
13956  0000138                   
13957  0000138                   SCORE_2_3DIGIT_S200:
13958  0000138                   	LDA	REG_EA
13959  0000138                   	STA	R_DIGIT_0
13960  0000138                   
13961  0000138                   
13962  0000138                   ;SCORE_2_3DIGIT_S300:
13963  0000138                   
13964  0000138                   	RTS
13965  0000138                   .ENDIF
13966  0000138                   
13967  0000138                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\COMMON_USER.ASM.APP"
13968  0000138                   ;=======================================
13969  0000138                   ;	<< BK0S0.ASM >>
13970  0000138                   ;===========================================
13971  0000138                   ;
13972  0000138                   
13973  0000138                   
13974  0000138                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\WAITKEY_PG.ASM.APP"
13975  0000138                   ;=======================================
13976  0000138                   ;	<< WAITKEY_LIB.ASM >>
13977  0000138                   ;===========================================
13978  0000138                   ;----------------------
13979  0000138                   
13980  0000138                   
13981  0000138                   WAITKEY_FLAG:
13982  0000138                   
13983  0000138  60           	RTS
13984  0000139                   
13985  0000139                   WAITKEY:
13986  0000139  A9 00			LDA	#0
13987  000013B  8D 03 00     	STA	USER_FLAG_A
13988  000013E  8D 04 00     	STA	USER_FLAG_B
13989  0000141                   ;
13990  0000141                   WAITKEY_S10:
13991  0000141                   	MACRO_CLR_WDT
13992  0000141                   	.IF (C_CHIP.EQ.C_W567BS)
13993  0000141                   	LDA #1
13994  0000141                   	STA !WDTC
13995  0000141                   	.ENDIF
13996  0000141                   	.IF (C_CHIP.EQ.C_N567GHK)
13997  0000141                   	LDA #CTL_CPU_WDT
13998  0000141                   	TSB !CTL_CPU
13999  0000141                   	.ENDIF
14000  0000141                   	.IF (C_CHIP.EQ.C_N588L)
14001  0000141                   	LDA #CTL_CPU_WDT
14002  0000141                   	TSB !CTL_CPU
14003  0000141                   	.ENDIF
14004  0000141                   	.IF (C_CHIP.EQ.C_N588H)
14005  0000141  A9 02			LDA #CTL_CPU_WDT
14006  0000143  0C 0F 08     	TSB !CTL_CPU
14007  0000146                   	.ENDIF
14008  0000146                   	.IF (C_CHIP.EQ.C_W588AS)
14009  0000146                   	LDA #1
14010  0000146                   	STA !WDTC
14011  0000146                   	.ENDIF





14012  0000146                   	.IF (C_CHIP.EQ.C_W588CD)
14013  0000146                   	LDA #1
14014  0000146                   	STA !WDTC
14015  0000146                   	.ENDIF
14016  0000146                   	;ENDM
14017  0000146                   ;
14018  0000146                   
14019  0000146                   
14020  0000146                   	MR_TEST_TMG0_GAP_FLAG
14021  0000146  A9 04			LDA	#C_BIT2
14022  0000148  24 06			BIT	<USER_INT_FLAG0
14023  000014A                   	;ENDM
14024  000014A  F0 07			BEQ	WAITKEY_TMG0_RET
14025  000014C                   	MR_CLR_TMG0_GAP_FLAG
14026  000014C  A9 04			LDA	#C_BIT2
14027  000014E  14 06			TRB	<USER_INT_FLAG0
14028  0000150                   	;ENDM
14029  0000150                   
14030  0000150                   ;================================
14031  0000150                   ;2MS
14032  0000150  4C 3A 03     	JMP	WAITKEY_TMG0
14033  0000153                   WAITKEY_TMG0_RET:
14034  0000153                   ;================================
14035  0000153                   
14036  0000153                   
14037  0000153  AD 03 00     	LDA	USER_FLAG_A
14038  0000156  D0 E0			BNE	WAITKEY_FLAG
14039  0000158  AD 04 00     	LDA	USER_FLAG_B;
14040  000015B  D0 DB			BNE	WAITKEY_FLAG
14041  000015D                   
14042  000015D                   ;==============================
14043  000015D  4C 37 03     	JMP	WAITKEY_CHK
14044  0000160                   WAITKEY_CHK_RET:
14045  0000160                   
14046  0000160                   ;==============================
14047  0000160                   
14048  0000160                   .IF	(C_SPCH1_ENABLE .EQ. 1)
14049  0000160                   ;CHECK SPCH1 / mixed MS
14050  0000160  A5 05			LDA	<USER_FLAG10
14051  0000162  89 01			BIT	#C_CHK_SPCH1_BIT
14052  0000164  F0 11			BEQ	WAITKEY_SPCH1END_RET
14053  0000166                   ;
14054  0000166                   	CHK_BUSY_CH1;
14055  0000166  A5 00			LDA <GLOBAL_PLAY
14056  0000168  89 00			BIT #SP1_BZ
14057  000016A                   	;ENDM
14058  000016A  D0 0B			BNE	WAITKEY_SPCH1END_RET
14059  000016C                   
14060  000016C                   .IF ( C_AUTOSLEEP_WAITKEY_EN .EQ. 1 )
14061  000016C                   	MR_AUTOSLEEP_SPCH1_FREE
14062  000016C                   .ENDIF
14063  000016C                   
14064  000016C  A9 01			LDA	#C_CHK_SPCH1_BIT
14065  000016E  14 05			TRB	<USER_FLAG10
14066  0000170                   ;SET FLAG
14067  0000170  A9 01			LDA	#C_SPCH1_BIT
14068  0000172  04 03			TSB	<USER_FLAG_A





14069  0000174                   
14070  0000174                   ;==================================
14071  0000174  4C 3D 03     	JMP	WAITKEY_SPCH1END
14072  0000177                   .ENDIF ; C_SPCH1_ENABLE .EQ. 1
14073  0000177                   WAITKEY_SPCH1END_RET:
14074  0000177                   ;==================================
14075  0000177                   
14076  0000177                   .IF (C_SPCH2_ENABLE .EQ. 1)
14077  0000177                   ;CHECK SPCH2
14078  0000177                   	LDA	<USER_FLAG10
14079  0000177                   	BIT	#C_CHK_SPCH2_BIT
14080  0000177                   	BEQ	WAITKEY_SPCH2END_RET
14081  0000177                   ;
14082  0000177                   	CHK_BUSY_CH2
14083  0000177                   	BNE	WAITKEY_SPCH2END_RET
14084  0000177                   
14085  0000177                   .IF ( C_AUTOSLEEP_WAITKEY_EN .EQ. 1 )
14086  0000177                   	MR_AUTOSLEEP_SPCH2_FREE
14087  0000177                   .ENDIF
14088  0000177                   
14089  0000177                   	LDA	#C_CHK_SPCH2_BIT
14090  0000177                   	TRB	<USER_FLAG10
14091  0000177                   ;SET FLAG
14092  0000177                   	LDA	#C_SPCH2_BIT
14093  0000177                   	TSB	<USER_FLAG_A
14094  0000177                   
14095  0000177                   ;==================================
14096  0000177                   	JMP	WAITKEY_SPCH2END
14097  0000177                   .ENDIF ; C_SPCH2_ENABLE .EQ. 1
14098  0000177                   WAITKEY_SPCH2END_RET:
14099  0000177                   ;==================================
14100  0000177                   
14101  0000177                   .IF (C_SPCH3_ENABLE .EQ. 1)
14102  0000177                   ;CHECK SPCH3
14103  0000177                   	LDA	<USER_FLAG10
14104  0000177                   	BIT	#C_CHECK_SPCH3_BIT
14105  0000177                   	BEQ	WAITKEY_SPCH3END_RET
14106  0000177                   ;
14107  0000177                   	CHK_BUSY_CH3
14108  0000177                   	BNE	WAITKEY_SPCH3END_RET
14109  0000177                   
14110  0000177                   .IF ( C_AUTOSLEEP_WAITKEY_EN .EQ. 1 )
14111  0000177                   	MR_AUTOSLEEP_SPCH3_FREE
14112  0000177                   .ENDIF
14113  0000177                   
14114  0000177                   	LDA	#C_CHECK_SPCH3_BIT
14115  0000177                   	TRB	<USER_FLAG10
14116  0000177                   ;SET FLAG
14117  0000177                   	LDA	#C_SPCH3_BIT
14118  0000177                   	TSB	<USER_FLAG_A
14119  0000177                   
14120  0000177                   ;==================================
14121  0000177                   	JMP	WAITKEY_SPCH3END
14122  0000177                   .ENDIF ; C_SPCH3_ENABLE .EQ. 1
14123  0000177                   WAITKEY_SPCH3END_RET:
14124  0000177                   ;==================================
14125  0000177                   





14126  0000177                   
14127  0000177                   .IF ( C_MS_ENABLE .EQ. 1 )
14128  0000177                   ;CHECK MS1
14129  0000177                   	LDA	<USER_FLAG10
14130  0000177                   	BIT	#C_CHK_MS1_BIT
14131  0000177                   	BEQ	WAITKEY_MSEND_RET
14132  0000177                   ;
14133  0000177                   	CHK_BUSY_MS
14134  0000177                   	BEQ	WAITKEY_MS_FREE
14135  0000177                   	LDA #B_USER_MS1_BUSY
14136  0000177                   	BIT <USER_FLAG20
14137  0000177                   	BEQ	WAITKEY_MS_FREE
14138  0000177                   	LDA	#1
14139  0000177                   	BRA	WAITKEY_MSEND_RET
14140  0000177                   WAITKEY_MS_FREE:
14141  0000177                   
14142  0000177                   
14143  0000177                   	LDA	#C_CHK_MS1_BIT
14144  0000177                   	TRB	<USER_FLAG10
14145  0000177                   ;SET FLAG
14146  0000177                   	LDA	#C_MS1_BIT
14147  0000177                   	TSB	<USER_FLAG_A
14148  0000177                   
14149  0000177                   ;==================================
14150  0000177                   	JMP	WAITKEY_MSEND
14151  0000177                   .ENDIF ; C_MS_ENABLE .EQ. 1
14152  0000177                   WAITKEY_MSEND_RET:
14153  0000177                   ;==================================
14154  0000177                   
14155  0000177  4C 46 03     	JMP	WAITKEY_EVT
14156  000017A                   WAITKEY_EVT_RET:
14157  000017A                   ;=============================================
14158  000017A                   ;CHECK (8.192MS \ 5.33MS ) 
14159  000017A                   	MR_TEST_GAPTIME_FLAG
14160  000017A  A9 08			LDA	#C_BIT3
14161  000017C  24 06			BIT	<USER_INT_FLAG0
14162  000017E                   	;ENDM
14163  000017E  D0 03			BNE	WAITKEY_S100
14164  0000180                   
14165  0000180  4C 41 01     	JMP	WAITKEY_S10
14166  0000183                   
14167  0000183                   WAITKEY_S100:
14168  0000183                   	MR_CLR_GAPTIME_FLAG
14169  0000183  A9 08			LDA	#C_BIT3
14170  0000185  14 06			TRB	<USER_INT_FLAG0
14171  0000187                   	;ENDM
14172  0000187                   ;
14173  0000187                   ;=============================================
14174  0000187                   ;5.33MS
14175  0000187  4C 49 03     	JMP	WAITKEY_FXF15
14176  000018A                   WAITKEY_FXF15_RET:
14177  000018A                   ;=============================================
14178  000018A                   
14179  000018A                   
14180  000018A                   
14181  000018A                   ;=============================================
14182  000018A                   ;5.33MS





14183  000018A  18           	CLC
14184  000018B  AD 05 00     	LDA	USER_FLAG10
14185  000018E  69 10			ADC	#10H
14186  0000190  8D 05 00     	STA	USER_FLAG10
14187  0000193  89 40			BIT	#40H
14188  0000195  F0 07			BEQ	WAITKEY_S105
14189  0000197  A9 40			LDA	#40H
14190  0000199  14 05			TRB	<USER_FLAG10	; CLEAR FLAG
14191  000019B                   
14192  000019B                   ;	JMP	WAITKEY_42D6MS
14193  000019B                   ;WAITKEY_42D6MS_RET:
14194  000019B                   
14195  000019B  4C 66 03     	JMP	WAITKEY_21D3MS
14196  000019E                   WAITKEY_21D3MS_RET:
14197  000019E                   
14198  000019E                   WAITKEY_S105:
14199  000019E                   ;
14200  000019E                   
14201  000019E                   
14202  000019E                   ;	INC	GAP_CNT
14203  000019E                   ;	LDA	GAP_CNT
14204  000019E                   ;	CMP	#16
14205  000019E                   ;	BCC	WAITKEY_S110
14206  000019E                   ;	STZ	GAP_CNT
14207  000019E                   ;;85MS reach
14208  000019E                   ;
14209  000019E                   ;	JMP	WAITKEY_85MS
14210  000019E                   WAITKEY_85MS_RET:
14211  000019E                   
14212  000019E                   
14213  000019E                   
14214  000019E                   WAITKEY_S110:
14215  000019E                   
14216  000019E  4C 41 01     	JMP	WAITKEY_S10
14217  00001A1                   
14218  00001A1                   
14219  00001A1                   
14220  00001A1                   ;====================================
14221  00001A1                   ;====================================
14222  00001A1                   BK0_WAIT_DLYCNT0:
14223  00001A1                   	MACRO_CLR_WDT
14224  00001A1                   	.IF (C_CHIP.EQ.C_W567BS)
14225  00001A1                   	LDA #1
14226  00001A1                   	STA !WDTC
14227  00001A1                   	.ENDIF
14228  00001A1                   	.IF (C_CHIP.EQ.C_N567GHK)
14229  00001A1                   	LDA #CTL_CPU_WDT
14230  00001A1                   	TSB !CTL_CPU
14231  00001A1                   	.ENDIF
14232  00001A1                   	.IF (C_CHIP.EQ.C_N588L)
14233  00001A1                   	LDA #CTL_CPU_WDT
14234  00001A1                   	TSB !CTL_CPU
14235  00001A1                   	.ENDIF
14236  00001A1                   	.IF (C_CHIP.EQ.C_N588H)
14237  00001A1  A9 02			LDA #CTL_CPU_WDT
14238  00001A3  0C 0F 08     	TSB !CTL_CPU
14239  00001A6                   	.ENDIF





14240  00001A6                   	.IF (C_CHIP.EQ.C_W588AS)
14241  00001A6                   	LDA #1
14242  00001A6                   	STA !WDTC
14243  00001A6                   	.ENDIF
14244  00001A6                   	.IF (C_CHIP.EQ.C_W588CD)
14245  00001A6                   	LDA #1
14246  00001A6                   	STA !WDTC
14247  00001A6                   	.ENDIF
14248  00001A6                   	;ENDM
14249  00001A6                   ;
14250  00001A6                   ;
14251  00001A6                   ;CHECK 8.192MS/5.33MS
14252  00001A6                   	MR_TEST_GAPTIME_FLAG
14253  00001A6  A9 08			LDA	#C_BIT3
14254  00001A8  24 06			BIT	<USER_INT_FLAG0
14255  00001AA                   	;ENDM
14256  00001AA  D0 02			BNE	BK0_WAIT_DLYCNT0_S100
14257  00001AC                   
14258  00001AC  80 F3			BRA	BK0_WAIT_DLYCNT0
14259  00001AE                   
14260  00001AE                   BK0_WAIT_DLYCNT0_S100:
14261  00001AE                   	MR_CLR_GAPTIME_FLAG
14262  00001AE  A9 08			LDA	#C_BIT3
14263  00001B0  14 06			TRB	<USER_INT_FLAG0
14264  00001B2                   	;ENDM
14265  00001B2                   ;5.33MS
14266  00001B2  AD 00 00     	LDA	WB_DLYCNT0
14267  00001B5  0D 01 00     	ORA	WB_DLYCNT0+1
14268  00001B8  F0 0B			BEQ	BK0_WAIT_DLYCNT0_S110
14269  00001BA  EE 00 00     	INC	WB_DLYCNT0
14270  00001BD  D0 06			BNE	BK0_WAIT_DLYCNT0_S110
14271  00001BF  EE 01 00     	INC	WB_DLYCNT0+1
14272  00001C2  D0 01			BNE	BK0_WAIT_DLYCNT0_S110
14273  00001C4                   ;	LDA	#CONST_CNT0_BIT
14274  00001C4                   ;	TSB	USER_FLAG_B
14275  00001C4  60           	RTS
14276  00001C5                   BK0_WAIT_DLYCNT0_S110:
14277  00001C5  4C A1 01     	JMP	BK0_WAIT_DLYCNT0
14278  00001C8                   
14279  00001C8                   
14280  00001C8                   BK0_STOP_ALL:
14281  00001C8                   	MACRO_CHECK_CH1_DISABLE
14282  00001C8  A9 01			LDA	#C_CHK_SPCH1_BIT
14283  00001CA  1C 05 00     	TRB	USER_FLAG10
14284  00001CD  A9 01			LDA	#C_SPCH1_BIT
14285  00001CF  1C 03 00     	TRB	USER_FLAG_A
14286  00001D2                   	;ENDM
14287  00001D2                   	MACRO_CHECK_CH2_DISABLE
14288  00001D2  A9 02			LDA	#C_CHK_SPCH2_BIT
14289  00001D4  1C 05 00     	TRB	USER_FLAG10
14290  00001D7  A9 02			LDA	#C_SPCH2_BIT
14291  00001D9  1C 03 00     	TRB	USER_FLAG_A
14292  00001DC                   	;ENDM
14293  00001DC                   	MACRO_CHECK_MS_DISABLE
14294  00001DC  A9 08			LDA	#C_CHK_MS1_BIT
14295  00001DE  1C 05 00     	TRB	USER_FLAG10
14296  00001E1  A9 08			LDA	#C_MS1_BIT





14297  00001E3  1C 03 00     	TRB	USER_FLAG_A
14298  00001E6                   	;ENDM
14299  00001E6                   
14300  00001E6                   .IF( ( C_SPCH1_ENABLE	.EQ.	1 ) .OR. ( C_SPCH2_ENABLE	.EQ.	1 ).OR. ( C_SPCH3_ENABLE	.EQ.	1 ) )
14301  00001E6  4C 00 00     	JMP STOP_ALL
14302  00001E9                   .ENDIF
14303  00001E9  60           	RTS	
14304  00001EA                   
14305  00001EA                   BK0_STOP_CH1:
14306  00001EA                   .IF	(C_SPCH1_ENABLE .EQ. 1)
14307  00001EA                   	MACRO_CHECK_CH1_DISABLE
14308  00001EA  A9 01			LDA	#C_CHK_SPCH1_BIT
14309  00001EC  1C 05 00     	TRB	USER_FLAG10
14310  00001EF  A9 01			LDA	#C_SPCH1_BIT
14311  00001F1  1C 03 00     	TRB	USER_FLAG_A
14312  00001F4                   	;ENDM
14313  00001F4  4C 00 00     	JMP STOP_CH1
14314  00001F7                   .ENDIF	
14315  00001F7  60           	RTS	
14316  00001F8                   BK0_STOP_CH2:
14317  00001F8                   .IF	(C_SPCH2_ENABLE .EQ. 1)
14318  00001F8                   	MACRO_CHECK_CH2_DISABLE
14319  00001F8                   	JMP STOP_CH2
14320  00001F8                   .ENDIF
14321  00001F8  60           	RTS	
14322  00001F9                   BK0_STOP_CH3:
14323  00001F9                   .IF	(C_SPCH3_ENABLE .EQ. 1)
14324  00001F9                   	MACRO_CHECK_CH3_DISABLE
14325  00001F9                   	JMP STOP_CH3
14326  00001F9                   .ENDIF
14327  00001F9  60           	RTS	
14328  00001FA                   BK0_STOP_MS:
14329  00001FA                   .IF	(C_MS_ENABLE .EQ. 1)
14330  00001FA                   	MACRO_CHECK_CH3_DISABLE
14331  00001FA                   	JMP STOP_MS
14332  00001FA                   .ENDIF	
14333  00001FA  60           	RTS	
14334  00001FB                   
14335  00001FB                   
14336  00001FB                   
14337  00001FB                   ;WAIT_SPCH1_W_CHK:
14338  00001FB                   ;	MACRO_CHECK_CH1_ENABLE
14339  00001FB                   ;WAIT_SPCH1:
14340  00001FB                   ;	JSR	WAITKEY
14341  00001FB                   ;WAIT_SPCH1_S10:
14342  00001FB                   ;	LDA	USER_FLAG_A
14343  00001FB                   ;	BIT	#C_SPCH1_BIT
14344  00001FB                   ;	BNE	WAIT_SPCH1_CH1END
14345  00001FB                   
14346  00001FB                   ;	JMP	WAIT_SPCH1
14347  00001FB                   ;WAIT_SPCH1_CH1END:
14348  00001FB                   ;	MACRO_CLR_CH1_FLAG
14349  00001FB                   
14350  00001FB                   ;speech
14351  00001FB  60           	RTS
14352  00001FC                   
14353  00001FC                   WAIT_SPCH1_W_CHK:





14354  00001FC                   	MACRO_CHECK_CH1_ENABLE
14355  00001FC  A9 01			LDA	#C_CHK_SPCH1_BIT
14356  00001FE  0C 05 00     	TSB	USER_FLAG10
14357  0000201  A9 01			LDA	#C_SPCH1_BIT
14358  0000203  1C 03 00     	TRB	USER_FLAG_A
14359  0000206                   	;ENDM
14360  0000206                   WAIT_SPCH1:
14361  0000206  20 39 01     	JSR	WAITKEY
14362  0000209                   WAIT_SPCH1_S10:
14363  0000209  AD 03 00     	LDA	USER_FLAG_A
14364  000020C  89 01			BIT	#C_SPCH1_BIT
14365  000020E  D0 03			BNE	WAIT_SPCH1_CH1END
14366  0000210                   
14367  0000210  4C 06 02     	JMP	WAIT_SPCH1
14368  0000213                   WAIT_SPCH1_CH1END:
14369  0000213                   	MACRO_CLR_CH1_FLAG
14370  0000213  A9 01			LDA	#C_SPCH1_BIT
14371  0000215  1C 03 00     	TRB	USER_FLAG_A
14372  0000218                   	;ENDM
14373  0000218                   
14374  0000218                   WAIT_SPCH1_CH1END_S100:
14375  0000218                   ;SPCH1 END
14376  0000218                   
14377  0000218  60           	RTS
14378  0000219                   
14379  0000219                   
14380  0000219                   
14381  0000219                   .IFDEF C_EQU_EN
14382  0000219                   ;WAIT_EQU_W_CHK:
14383  0000219                   	MACRO_CHECK_CH1_ENABLE
14384  0000219                   WAIT_EQU:
14385  0000219                   	JSR	WAITKEY
14386  0000219                   WAIT_EQU_S10:
14387  0000219                   	LDA	USER_FLAG_A
14388  0000219                   	BIT	#C_SPCH1_BIT
14389  0000219                   	BNE	WAIT_EQU_CH1END
14390  0000219                   
14391  0000219                   	JMP	WAIT_EQU
14392  0000219                   WAIT_EQU_CH1END:
14393  0000219                   	MACRO_CLR_CH1_FLAG
14394  0000219                   
14395  0000219                   	MR_DET_EQU_FG
14396  0000219                   	BNE	WAIT_EQU_CH1END_S100
14397  0000219                   ;speech
14398  0000219                   	RTS
14399  0000219                   
14400  0000219                   WAIT_EQU_CH1END_S100:
14401  0000219                   
14402  0000219                   .IF ( C_EQU_EN .EQ. 1 )	
14403  0000219                   	JSR	BK0_PLAY_EQU_NEXT
14404  0000219                   	BNE	WAIT_EQU_CH1END_NEXT ; NEXT
14405  0000219                   .ENDIF
14406  0000219                   ;EQU END
14407  0000219                   	MR_NRL_EQU
14408  0000219                   
14409  0000219                   	RTS
14410  0000219                   





14411  0000219                   WAIT_EQU_CH1END_NEXT:
14412  0000219                   	JMP	WAIT_EQU_S10
14413  0000219                   
14414  0000219                   
14415  0000219                   .ENDIF
14416  0000219                   
14417  0000219                   
14418  0000219                   
14419  0000219                   ;=================================================
14420  0000219                   
14421  0000219                   
14422  0000219                   
14423  0000219                   ;==========================================
14424  0000219                   .IF ( C_MS_ENABLE .EQ. 1 )
14425  0000219                   CHK_MIDI_STATUS:
14426  0000219                   	CHK_BUSY_MS
14427  0000219                   	BEQ	CHK_MIDI_STATUS_FREE
14428  0000219                   	LDA #B_USER_MS1_BUSY
14429  0000219                   	BIT <USER_FLAG20
14430  0000219                   	BEQ	CHK_MIDI_STATUS_FREE
14431  0000219                   	LDA	#1
14432  0000219                   	RTS
14433  0000219                   CHK_MIDI_STATUS_FREE:
14434  0000219                   	LDA	#0
14435  0000219                   	RTS
14436  0000219                   .ENDIF
14437  0000219                   
14438  0000219                   
14439  0000219                   
14440  0000219                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\WAITKEY_PG1.ASM.APP"
14441  0000219                   ;=======================================
14442  0000219                   ;	<< BK0S0.ASM >>
14443  0000219                   ;===========================================
14444  0000219                   ;
14445  0000219                   ;6144khz : 10ms
14446  0000219                   ;used: A,X
14447  0000219                   BK0_DELAY61440CYCLE:
14448  0000219  A2 30			LDX	#48
14449  000021B                   BK0_DELAY61440CYCLE_S10:
14450  000021B  A9 00			LDA	#0
14451  000021D                   BK0_DELAY61440CYCLE_S20
14452  000021D  1A           	INC	A;2
14453  000021E  D0 FD			BNE	BK0_DELAY61440CYCLE_S20;3
14454  0000220                   
14455  0000220                   	MACRO_CLR_WDT
14456  0000220                   	.IF (C_CHIP.EQ.C_W567BS)
14457  0000220                   	LDA #1
14458  0000220                   	STA !WDTC
14459  0000220                   	.ENDIF
14460  0000220                   	.IF (C_CHIP.EQ.C_N567GHK)
14461  0000220                   	LDA #CTL_CPU_WDT
14462  0000220                   	TSB !CTL_CPU
14463  0000220                   	.ENDIF
14464  0000220                   	.IF (C_CHIP.EQ.C_N588L)
14465  0000220                   	LDA #CTL_CPU_WDT
14466  0000220                   	TSB !CTL_CPU
14467  0000220                   	.ENDIF





14468  0000220                   	.IF (C_CHIP.EQ.C_N588H)
14469  0000220  A9 02			LDA #CTL_CPU_WDT
14470  0000222  0C 0F 08     	TSB !CTL_CPU
14471  0000225                   	.ENDIF
14472  0000225                   	.IF (C_CHIP.EQ.C_W588AS)
14473  0000225                   	LDA #1
14474  0000225                   	STA !WDTC
14475  0000225                   	.ENDIF
14476  0000225                   	.IF (C_CHIP.EQ.C_W588CD)
14477  0000225                   	LDA #1
14478  0000225                   	STA !WDTC
14479  0000225                   	.ENDIF
14480  0000225                   	;ENDM
14481  0000225                   
14482  0000225  CA           	DEX
14483  0000226  D0 F3			BNE	BK0_DELAY61440CYCLE_S10
14484  0000228  60           	RTS
14485  0000229                   
14486  0000229                   
14487  0000229                   
14488  0000229                   BK0_START_TMG0_2MS:
14489  0000229  A9 04			LDA	#0100B  ; / 64
14490  000022B  8D 28 08     	STA	!TMG0C ; SET CLK
14491  000022E  A9 BF			LDA	#191 ; +1
14492  0000230  8D 29 08     	STA	!TMG0V
14493  0000233  A9 01			LDA	#01H
14494  0000235  0C 28 08     	TSB	TMG0C ;START
14495  0000238  A9 08			LDA	#TIMERG0_INT_BIT
14496  000023A  0C 1E 08     	TSB	!IEF0
14497  000023D  60           	RTS
14498  000023E                   
14499  000023E                   BK0_START_TMG0_05MS_W_CHK:
14500  000023E  A9 01			LDA	#01H
14501  0000240  2C 28 08     	BIT	TMG0C ;START
14502  0000243  D0 14			BNE	BK0_START_TMG0_05MS_END
14503  0000245                   BK0_START_TMG0_05MS:
14504  0000245  A9 04			LDA	#0100B  ; / 64
14505  0000247  8D 28 08     	STA	!TMG0C ; SET CLK
14506  000024A  A9 2F			LDA	#47 ; +1
14507  000024C  8D 29 08     	STA	!TMG0V
14508  000024F  A9 01			LDA	#01H
14509  0000251  0C 28 08     	TSB	TMG0C ;START
14510  0000254  A9 08			LDA	#TIMERG0_INT_BIT
14511  0000256  0C 1E 08     	TSB	!IEF0
14512  0000259                   BK0_START_TMG0_05MS_END:
14513  0000259  60           	RTS
14514  000025A                   
14515  000025A                   BK0_START_TMG0_0625MS:
14516  000025A  A9 04			LDA	#0100B  ; / 64
14517  000025C  8D 28 08     	STA	!TMG0C ; SET CLK
14518  000025F  A9 3B			LDA	#59 ; +1
14519  0000261  8D 29 08     	STA	!TMG0V
14520  0000264  A9 01			LDA	#01H
14521  0000266  0C 28 08     	TSB	TMG0C ;START
14522  0000269  A9 08			LDA	#TIMERG0_INT_BIT
14523  000026B  0C 1E 08     	TSB	!IEF0
14524  000026E  60           	RTS





14525  000026F                   BK0_START_TMG0_0250MS:
14526  000026F  A9 04			LDA	#0100B  ; / 64
14527  0000271  8D 28 08     	STA	!TMG0C ; SET CLK
14528  0000274  A9 17			LDA	#23 ; +1
14529  0000276  8D 29 08     	STA	!TMG0V
14530  0000279  A9 01			LDA	#01H
14531  000027B  0C 28 08     	TSB	TMG0C ;START
14532  000027E  A9 08			LDA	#TIMERG0_INT_BIT
14533  0000280  0C 1E 08     	TSB	!IEF0
14534  0000283  60           	RTS
14535  0000284                   
14536  0000284                   BK0_START_TMG0_0125MS:
14537  0000284  A9 04			LDA	#0100B  ; / 64
14538  0000286  8D 28 08     	STA	!TMG0C ; SET CLK
14539  0000289  A9 0B			LDA	#11 ; +1
14540  000028B  8D 29 08     	STA	!TMG0V
14541  000028E  A9 01			LDA	#01H
14542  0000290  0C 28 08     	TSB	TMG0C ;START
14543  0000293  A9 08			LDA	#TIMERG0_INT_BIT
14544  0000295  0C 1E 08     	TSB	!IEF0
14545  0000298  60           	RTS
14546  0000299                   
14547  0000299                   
14548  0000299                   BK0_START_TMG0_07MS:
14549  0000299  A9 04			LDA	#0100B  ; / 64
14550  000029B  8D 28 08     	STA	!TMG0C ; SET CLK
14551  000029E  A9 43			LDA	#67 ; +1
14552  00002A0  8D 29 08     	STA	!TMG0V
14553  00002A3  A9 01			LDA	#01H
14554  00002A5  0C 28 08     	TSB	TMG0C ;START
14555  00002A8  A9 08			LDA	#TIMERG0_INT_BIT
14556  00002AA  0C 1E 08     	TSB	!IEF0
14557  00002AD  60           	RTS
14558  00002AE                   
14559  00002AE                   
14560  00002AE                   BK0_STOP_TMG0:
14561  00002AE  A9 01			LDA	#01H
14562  00002B0  1C 28 08     	TRB	TMG0C ;START
14563  00002B3  A9 08			LDA	#TIMERG0_INT_BIT
14564  00002B5  1C 1E 08     	TRB	!IEF0
14565  00002B8  60           	RTS
14566  00002B9                   
14567  00002B9                   ;===================================
14568  00002B9                   BK0_DELAY10US:
14569  00002B9  A9 05			LDA #5
14570  00002BB  80 06			BRA	BK0_DELAY100US_S10
14571  00002BD                   
14572  00002BD                   
14573  00002BD                   BK0_DELAY50US:
14574  00002BD                   ;6144KHz: 50US*6=300
14575  00002BD                   ;300/9=67
14576  00002BD                   ;
14577  00002BD  A9 21			LDA #33
14578  00002BF  80 02			BRA	BK0_DELAY100US_S10
14579  00002C1                   
14580  00002C1                   BK0_DELAY100US:
14581  00002C1                   ;6144KHz: 100US*6=600





14582  00002C1                   ;600/9=67
14583  00002C1                   ;
14584  00002C1  A9 43			LDA #67
14585  00002C3                   BK0_DELAY100US_S10:
14586  00002C3  EA           	NOP	; 2
14587  00002C4  EA           	NOP	; 2
14588  00002C5  3A           	DEC A		;2
14589  00002C6  D0 FB			BNE BK0_DELAY100US_S10	;3
14590  00002C8  60           	RTS	; 1.5US
14591  00002C9                   
14592  00002C9                   
14593  00002C9                   BK0_DELAY500US:
14594  00002C9                   ;6144KHz: 50US*6=300
14595  00002C9                   ;300/9=67
14596  00002C9                   ;
14597  00002C9  A9 78			LDA #120
14598  00002CB  80 02			BRA	BK0_DELAY1000US_S10
14599  00002CD                   
14600  00002CD                   BK0_DELAY1MS:
14601  00002CD                   ;6144KHz: 1000US*6=6000
14602  00002CD                   ;6000/25=240
14603  00002CD                   ;
14604  00002CD  A9 F0			LDA #240
14605  00002CF                   BK0_DELAY1000US_S10:
14606  00002CF  EA           	NOP	; 2
14607  00002D0  EA           	NOP	; 2
14608  00002D1  EA           	NOP	; 2
14609  00002D2  EA           	NOP	; 2
14610  00002D3  EA           	NOP	; 2
14611  00002D4                   
14612  00002D4  EA           	NOP	; 2
14613  00002D5  EA           	NOP	; 2
14614  00002D6  EA           	NOP	; 2
14615  00002D7  EA           	NOP	; 2
14616  00002D8  EA           	NOP	; 2
14617  00002D9                   
14618  00002D9  3A           	DEC A		;2
14619  00002DA  D0 F3			BNE BK0_DELAY1000US_S10	;3
14620  00002DC  60           	RTS	; 1.5US
14621  00002DD                   
14622  00002DD                   
14623  00002DD                   
14624  00002DD                   ;=========================
14625  00002DD                   BK0_DELAY50MS:
14626  00002DD  A2 FA			LDX	#250
14627  00002DF                   
14628  00002DF                   BK0_DELAY50MS_S10:
14629  00002DF                   	MACRO_CLR_WDT
14630  00002DF                   	.IF (C_CHIP.EQ.C_W567BS)
14631  00002DF                   	LDA #1
14632  00002DF                   	STA !WDTC
14633  00002DF                   	.ENDIF
14634  00002DF                   	.IF (C_CHIP.EQ.C_N567GHK)
14635  00002DF                   	LDA #CTL_CPU_WDT
14636  00002DF                   	TSB !CTL_CPU
14637  00002DF                   	.ENDIF
14638  00002DF                   	.IF (C_CHIP.EQ.C_N588L)





14639  00002DF                   	LDA #CTL_CPU_WDT
14640  00002DF                   	TSB !CTL_CPU
14641  00002DF                   	.ENDIF
14642  00002DF                   	.IF (C_CHIP.EQ.C_N588H)
14643  00002DF  A9 02			LDA #CTL_CPU_WDT
14644  00002E1  0C 0F 08     	TSB !CTL_CPU
14645  00002E4                   	.ENDIF
14646  00002E4                   	.IF (C_CHIP.EQ.C_W588AS)
14647  00002E4                   	LDA #1
14648  00002E4                   	STA !WDTC
14649  00002E4                   	.ENDIF
14650  00002E4                   	.IF (C_CHIP.EQ.C_W588CD)
14651  00002E4                   	LDA #1
14652  00002E4                   	STA !WDTC
14653  00002E4                   	.ENDIF
14654  00002E4                   	;ENDM
14655  00002E4                   
14656  00002E4  20 C1 02     	JSR	BK0_DELAY100US; A
14657  00002E7  20 C1 02     	JSR	BK0_DELAY100US;	A
14658  00002EA  CA           	DEX
14659  00002EB  D0 F2			BNE	BK0_DELAY50MS_S10
14660  00002ED  60           	RTS
14661  00002EE                   
14662  00002EE                   BK0_DELAY10MS:
14663  00002EE  A2 32			LDX	#50
14664  00002F0                   BK0_DELAY10MS_S10:
14665  00002F0                   	MACRO_CLR_WDT
14666  00002F0                   	.IF (C_CHIP.EQ.C_W567BS)
14667  00002F0                   	LDA #1
14668  00002F0                   	STA !WDTC
14669  00002F0                   	.ENDIF
14670  00002F0                   	.IF (C_CHIP.EQ.C_N567GHK)
14671  00002F0                   	LDA #CTL_CPU_WDT
14672  00002F0                   	TSB !CTL_CPU
14673  00002F0                   	.ENDIF
14674  00002F0                   	.IF (C_CHIP.EQ.C_N588L)
14675  00002F0                   	LDA #CTL_CPU_WDT
14676  00002F0                   	TSB !CTL_CPU
14677  00002F0                   	.ENDIF
14678  00002F0                   	.IF (C_CHIP.EQ.C_N588H)
14679  00002F0  A9 02			LDA #CTL_CPU_WDT
14680  00002F2  0C 0F 08     	TSB !CTL_CPU
14681  00002F5                   	.ENDIF
14682  00002F5                   	.IF (C_CHIP.EQ.C_W588AS)
14683  00002F5                   	LDA #1
14684  00002F5                   	STA !WDTC
14685  00002F5                   	.ENDIF
14686  00002F5                   	.IF (C_CHIP.EQ.C_W588CD)
14687  00002F5                   	LDA #1
14688  00002F5                   	STA !WDTC
14689  00002F5                   	.ENDIF
14690  00002F5                   	;ENDM
14691  00002F5                   
14692  00002F5  20 C1 02     	JSR	BK0_DELAY100US; A
14693  00002F8  20 C1 02     	JSR	BK0_DELAY100US;	A
14694  00002FB  CA           	DEX
14695  00002FC  D0 F2			BNE	BK0_DELAY10MS_S10





14696  00002FE  60           	RTS
14697  00002FF                   
14698  00002FF                   ;====================================
14699  00002FF                   
14700  00002FF                   
14701  00002FF                   BK0_STORE_BPX:
14702  00002FF                   .IF ( C_BP0_STATUS_EN .EQ. 1 )
14703  00002FF  AD 01 08     	LDA	!BP0
14704  0000302  8D 08 00     	STA	BP0_STATUS
14705  0000305                   .ENDIF
14706  0000305                   .IF ( C_BP1_STATUS_EN .EQ. 1 )
14707  0000305  AD 02 08     	LDA	!BP1
14708  0000308  8D 09 00     	STA	BP1_STATUS
14709  000030B                   .ENDIF
14710  000030B                   .IF ( C_BP2_STATUS_EN .EQ. 1 )
14711  000030B                   	LDA	!BP2
14712  000030B                   	STA	BP2_STATUS
14713  000030B                   .ENDIF
14714  000030B                   ;
14715  000030B  60           	RTS
14716  000030C                   ;==========================
14717  000030C                   
14718  000030C                   BK0_STORE_BPX_WO_BOND_PWOFF:
14719  000030C                   .IF ( C_BP0_STATUS_EN .EQ. 1 )
14720  000030C  AD 08 00     	LDA	BP0_STATUS
14721  000030F  29 00			AND	#C_BP0_BOND
14722  0000311  8D 08 00     	STA	BP0_STATUS
14723  0000314  A9 00			LDA	#C_BP0_BOND
14724  0000316  49 FF			EOR	#0FFH
14725  0000318  2D 01 08     	AND	!BP0
14726  000031B  0D 08 00     	ORA	BP0_STATUS
14727  000031E  8D 08 00     	STA	BP0_STATUS
14728  0000321                   .ENDIF
14729  0000321                   .IF ( C_BP1_STATUS_EN .EQ. 1 )
14730  0000321  AD 09 00     	LDA	BP1_STATUS
14731  0000324  29 00			AND	#C_BP1_BOND
14732  0000326  8D 09 00     	STA	BP1_STATUS
14733  0000329  A9 00			LDA	#C_BP1_BOND
14734  000032B  49 FF			EOR	#0FFH
14735  000032D  2D 02 08     	AND	!BP1
14736  0000330  0D 09 00     	ORA	BP1_STATUS
14737  0000333  8D 09 00     	STA	BP1_STATUS
14738  0000336                   .ENDIF
14739  0000336                   .IF ( C_BP2_STATUS_EN .EQ. 1 )
14740  0000336                   	LDA	BP2_STATUS
14741  0000336                   	AND	#C_BP2_BOND
14742  0000336                   	STA	BP2_STATUS
14743  0000336                   	LDA	#C_BP2_BOND
14744  0000336                   	EOR	#0FFH
14745  0000336                   	AND	!BP2
14746  0000336                   	ORA	BP2_STATUS
14747  0000336                   	STA	BP2_STATUS
14748  0000336                   .ENDIF
14749  0000336                   ;
14750  0000336                   
14751  0000336                   
14752  0000336  60           	RTS





14753  0000337                   
14754  0000337                   
14755  0000337                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\WAITKEY_USER_PCC.ASM.APP"
14756  0000337                   ;=======================================
14757  0000337                   ;	<< WAITKEY_USER.ASM >>
14758  0000337                   ;===========================================
14759  0000337                   ;
14760  0000337                   
14761  0000337                   
14762  0000337                   WAITKEY_CHK:
14763  0000337                   
14764  0000337                   ;=========================================
14765  0000337                   WAITKEY_CHK_PCC:
14766  0000337                   
14767  0000337                   
14768  0000337                   
14769  0000337                   
14770  0000337  4C 60 01     	JMP	WAITKEY_CHK_RET
14771  000033A                   
14772  000033A                   ;===================================
14773  000033A                   
14774  000033A                   WAITKEY_TMG0:
14775  000033A                   
14776  000033A                   WAITKEY_TMG0_PCC:
14777  000033A                   
14778  000033A                   
14779  000033A  4C 53 01     	JMP	WAITKEY_TMG0_RET
14780  000033D                   
14781  000033D                   ;===============================================
14782  000033D                   
14783  000033D                   ;=================================
14784  000033D                   WAITKEY_SPCH1END:
14785  000033D                   
14786  000033D                   WAITKEY_SPCH1END_PCC:
14787  000033D                   
14788  000033D                   
14789  000033D                   
14790  000033D  4C 77 01     	JMP	WAITKEY_SPCH1END_RET
14791  0000340                   
14792  0000340                   ;=================================
14793  0000340                   WAITKEY_SPCH2END:
14794  0000340                   
14795  0000340                   WAITKEY_SPCH2END_PCC:
14796  0000340                   
14797  0000340                   
14798  0000340                   
14799  0000340  4C 77 01     	JMP	WAITKEY_SPCH2END_RET
14800  0000343                   
14801  0000343                   ;==============================
14802  0000343                   WAITKEY_MSEND:
14803  0000343                   
14804  0000343                   WAITKEY_MSEND_PCC:
14805  0000343                   
14806  0000343                   
14807  0000343                   
14808  0000343  4C 77 01     	JMP	WAITKEY_MSEND_RET
14809  0000346                   





14810  0000346                   ;=================================
14811  0000346                   WAITKEY_EVT:
14812  0000346                   
14813  0000346                   WAITKEY_EVT_PCC:
14814  0000346                   
14815  0000346                   
14816  0000346  4C 7A 01     	JMP	WAITKEY_EVT_RET
14817  0000349                   
14818  0000349                   ;=================================
14819  0000349                   
14820  0000349                   ;==================================
14821  0000349                   WAITKEY_FXF15:
14822  0000349                   ;5.33MS
14823  0000349                   
14824  0000349                   WAITKEY_FXF15_PCC:
14825  0000349  20 DB 06     	JSR	BK0_SCAN_S_KEY
14826  000034C                   
14827  000034C                   
14828  000034C                   
14829  000034C                   WAITKEY_5D33MS_S10:
14830  000034C                   
14831  000034C                   COUNT_DLYCNT_S10:
14832  000034C                   .IF (C_DLYCNT0_ENABLE .EQ. 1)
14833  000034C  AD 00 00     	LDA	WB_DLYCNT0
14834  000034F  0D 01 00     	ORA	WB_DLYCNT0+1
14835  0000352  F0 0F			BEQ	COUNT_DLYCNT_S20
14836  0000354  EE 00 00     	INC	WB_DLYCNT0
14837  0000357  D0 0A			BNE	COUNT_DLYCNT_S20
14838  0000359  EE 01 00     	INC	WB_DLYCNT0+1
14839  000035C  D0 05			BNE	COUNT_DLYCNT_S20
14840  000035E  A9 01			LDA	#C_CNT0_BIT
14841  0000360  0C 04 00     	TSB	USER_FLAG_B
14842  0000363                   
14843  0000363                   COUNT_DLYCNT_S20:
14844  0000363                   .ENDIF
14845  0000363                   .IF (C_DLYCNT1_ENABLE .EQ. 1)
14846  0000363                   	LDA	WB_DLYCNT1
14847  0000363                   	ORA	WB_DLYCNT1+1
14848  0000363                   	BEQ	COUNT_DLYCNT_S30
14849  0000363                   	INC	WB_DLYCNT1
14850  0000363                   	BNE	COUNT_DLYCNT_S30
14851  0000363                   	INC	WB_DLYCNT1+1
14852  0000363                   	BNE	COUNT_DLYCNT_S30
14853  0000363                   	LDA	#C_CNT1_BIT
14854  0000363                   	TSB	USER_FLAG_B
14855  0000363                   
14856  0000363                   COUNT_DLYCNT_S30:
14857  0000363                   .ENDIF
14858  0000363                   .IF (C_DLYCNT2_ENABLE .EQ. 1)
14859  0000363                   	LDA	WB_DLYCNT2
14860  0000363                   	ORA	WB_DLYCNT2+1
14861  0000363                   	BEQ	COUNT_DLYCNT_S31
14862  0000363                   	INC	WB_DLYCNT2
14863  0000363                   	BNE	COUNT_DLYCNT_S31
14864  0000363                   	INC	WB_DLYCNT2+1
14865  0000363                   	BNE	COUNT_DLYCNT_S31
14866  0000363                   	LDA	#C_CNT2_BIT





14867  0000363                   	TSB	USER_FLAG_B
14868  0000363                   
14869  0000363                   COUNT_DLYCNT_S31:
14870  0000363                   .ENDIF
14871  0000363                   
14872  0000363                   .IF ( C_DLYCNT3_ENABLE .EQ. 1 )
14873  0000363                   	LDA	WB_DLYCNT3
14874  0000363                   	ORA	WB_DLYCNT3+1
14875  0000363                   	BEQ	COUNT_DLYCNT_S32
14876  0000363                   	INC	WB_DLYCNT3
14877  0000363                   	BNE	COUNT_DLYCNT_S32
14878  0000363                   	INC	WB_DLYCNT3+1
14879  0000363                   	BNE	COUNT_DLYCNT_S32
14880  0000363                   	LDA	#C_CNT3_BIT
14881  0000363                   	TSB	USER_FLAG_B
14882  0000363                   
14883  0000363                   COUNT_DLYCNT_S32:
14884  0000363                   .ENDIF
14885  0000363                   
14886  0000363                   .IF ( C_DLYCNT4_ENABLE .EQ. 1 )
14887  0000363                   	LDA	WB_DLYCNT4
14888  0000363                   	ORA	WB_DLYCNT4+1
14889  0000363                   	BEQ	COUNT_DLYCNT_S33
14890  0000363                   	INC	WB_DLYCNT4
14891  0000363                   	BNE	COUNT_DLYCNT_S33
14892  0000363                   	INC	WB_DLYCNT4+1
14893  0000363                   	BNE	COUNT_DLYCNT_S33
14894  0000363                   	LDA	#C_CNT4_BIT
14895  0000363                   	TSB	USER_FLAG_B
14896  0000363                   
14897  0000363                   COUNT_DLYCNT_S33:
14898  0000363                   .ENDIF
14899  0000363                   
14900  0000363                   .IFDEF C_BID_M0_EN
14901  0000363                   	LDA	R_M1_DLYCNT
14902  0000363                   	ORA	R_M1_DLYCNT+1
14903  0000363                   	BEQ	COUNT_DLYCNT_S40
14904  0000363                   	INC	R_M1_DLYCNT
14905  0000363                   	BNE	COUNT_DLYCNT_S40
14906  0000363                   	INC	R_M1_DLYCNT+1
14907  0000363                   	BNE	COUNT_DLYCNT_S40
14908  0000363                   ;¿¨ËÀ
14909  0000363                   ;	MR_SET_M1_STOP
14910  0000363                   ;DEBUG
14911  0000363                   
14912  0000363                   	MR_SET_M1_STOP_W_BUF
14913  0000363                   
14914  0000363                   COUNT_DLYCNT_S40:
14915  0000363                   .ENDIF
14916  0000363                   
14917  0000363                   .IFDEF  C_EQU_EN
14918  0000363                   	LDA	EQU_DLYCNT
14919  0000363                   	ORA	EQU_DLYCNT+1
14920  0000363                   	BEQ	COUNT_DLYCNT_S50
14921  0000363                   	INC	EQU_DLYCNT
14922  0000363                   	BNE	COUNT_DLYCNT_S50
14923  0000363                   	INC	EQU_DLYCNT+1





14924  0000363                   	BNE	COUNT_DLYCNT_S50
14925  0000363                   ;
14926  0000363                   	MR_DET_EQU_FG
14927  0000363                   	BEQ	COUNT_DLYCNT_S50 ; not equ; stop timer
14928  0000363                   
14929  0000363                   	LDA	#C_EQU_CNT_BIT
14930  0000363                   	TSB	USER_FLAG_B
14931  0000363                   
14932  0000363                   ;	JSR	PLAY_EQU_NEXT
14933  0000363                   ;	BNE	COUNT_DLYCNT_S50
14934  0000363                   ;EQU END
14935  0000363                   
14936  0000363                   COUNT_DLYCNT_S50:
14937  0000363                   .ENDIF
14938  0000363                   
14939  0000363                   .IFDEF C_M1_EN
14940  0000363                   ;	JSR	CNT_M1_INV_PROT_DLY;·´Ïò±£»¤¼ÆÊ±
14941  0000363                   .ENDIF
14942  0000363                   
14943  0000363                   
14944  0000363                   ;--------------------------------
14945  0000363  4C 8A 01     	JMP	WAITKEY_FXF15_RET
14946  0000366                   ;==================================
14947  0000366                   ;=================================
14948  0000366                   
14949  0000366                   
14950  0000366                   WAITKEY_42D6MS:
14951  0000366                   WAITKEY_21D3MS:
14952  0000366                   
14953  0000366                   WAITKEY_21D3MS_PCC:
14954  0000366                   
14955  0000366                   
14956  0000366                   ;42.6MS REACH
14957  0000366                   ;.IF (External_MIDI_Note .EQ. 1)
14958  0000366                   ;	JSR	NOTEON_CNT
14959  0000366                   ;.ENDIF
14960  0000366                   
14961  0000366                   ;----------------------
14962  0000366  4C 75 03     	JMP	WK_AUTOCNT
14963  0000369                   WK_AUTOCNT_RET:
14964  0000369                   
14965  0000369                   
14966  0000369  4C 9E 01     	JMP	WAITKEY_21D3MS_RET
14967  000036C                   
14968  000036C                   ;	JMP	WAITKEY_42D6MS_RET
14969  000036C                   
14970  000036C                   ;==================================
14971  000036C                   ;==================================
14972  000036C                   
14973  000036C                   
14974  000036C                   
14975  000036C                   CHKKEY_INIT:
14976  000036C                   
14977  000036C  A9 FF			LDA	#C_NOP
14978  000036E                   
14979  000036E                   .IF ( C_KEYCH_MAX .GT. 0 )
14980  000036E  85 0A			STA	<WB_KEYCH_CODE





14981  0000370                   .ENDIF
14982  0000370                   
14983  0000370                   .IF ( C_KEYCH_MAX .GT. 1 )
14984  0000370  85 0B			STA	<WB_KEYCH_CODE+1
14985  0000372                   .ENDIF
14986  0000372                   
14987  0000372                   .IF ( C_KEYCH_MAX .GT. 2 )
14988  0000372  85 0C			STA	<WB_KEYCH_CODE+2
14989  0000374                   .ENDIF
14990  0000374                   .IF ( C_KEYCH_MAX .GT. 3 )
14991  0000374                   	STA	<WB_KEYCH_CODE+3
14992  0000374                   .ENDIF
14993  0000374                   
14994  0000374  60           	RTS
14995  0000375                   
14996  0000375                   
14997  0000375                   
14998  0000375                   
14999  0000375                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_PG.ASM.APP"
15000  0000375                   
15001  0000375                   
15002  0000375                   ;==========================
15003  0000375                   
15004  0000375                   
15005  0000375                   
15006  0000375                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PROJ_USER.ASM.APP"
15007  0000375                   
15008  0000375                   
15009  0000375                   ;==========================
15010  0000375                   
15011  0000375                   
15012  0000375                   
15013  0000375                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\AUTOSLEEP_PG.ASM.APP"
15014  0000375                   
15015  0000375                   WK_AUTOCNT:
15016  0000375  AD 13 00     	LDA	WB_AUTOCNT0
15017  0000378                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
15018  0000378  0D 14 00     	ORA	WB_AUTOCNT01
15019  000037B                   .ENDIF
15020  000037B  F0 0F			BEQ	WK_AUTOCNT_S100
15021  000037D                   
15022  000037D  EE 13 00     	INC	WB_AUTOCNT0
15023  0000380  D0 0A			BNE	WK_AUTOCNT_S100
15024  0000382                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
15025  0000382  EE 14 00     	INC	WB_AUTOCNT01
15026  0000385  D0 05			BNE	WK_AUTOCNT_S100
15027  0000387                   .ENDIF
15028  0000387                   
15029  0000387                   ;reach
15030  0000387  A9 80			LDA	#C_AUTO_CNT_BIT
15031  0000389  0C 04 00     	TSB	USER_FLAG_B
15032  000038C                   WK_AUTOCNT_S100:
15033  000038C  4C 69 03     	JMP	WK_AUTOCNT_RET
15034  000038F                   
15035  000038F                   
15036  000038F                   .IF ( C_AUTOSLEEP_WAITKEY_EN .EQ. 1 )
15037  000038F                   ;==============================================================





15038  000038F                   BK0_AUTOCNT_SOLVE_MUTE_WITHCHK:
15039  000038F                   
15040  000038F                   .IF ( C_MS_ENABLE .EQ. 1 )
15041  000038F                   	JSR	CHK_MIDI_STATUS
15042  000038F                   	BNE	BK0_AUTOCNT_SOLVE
15043  000038F                   .ENDIF ; C_MS_ENABLE .EQ. 1
15044  000038F                   
15045  000038F                   .IF	(C_SPCH1_ENABLE .EQ. 1)
15046  000038F                   	CHK_BUSY_CH1
15047  000038F                   	BNE	BK0_AUTOCNT_SOLVE
15048  000038F                   .ENDIF
15049  000038F                   
15050  000038F                   .IF	(C_SPCH2_ENABLE .EQ. 1)
15051  000038F                   	CHK_BUSY_CH2
15052  000038F                   	BNE	BK0_AUTOCNT_SOLVE
15053  000038F                   .ENDIF
15054  000038F                   
15055  000038F                   .IF	(C_SPCH3_ENABLE .EQ. 1)
15056  000038F                   	CHK_BUSY_CH3
15057  000038F                   	BNE	BK0_AUTOCNT_SOLVE
15058  000038F                   .ENDIF
15059  000038F                   
15060  000038F                   	BRA	BK0_AUTOCNT_SOLVE_MUTE
15061  000038F                   
15062  000038F                   BK0_AUTOCNT_SOLVE:
15063  000038F                   	LDA	AUTOSLEEP_FLAG
15064  000038F                   	CMP	AUTOSLEEP_FLAG_BK
15065  000038F                   	BEQ	BK0_AUTOCNT_SOLVE_END1
15066  000038F                   	STA	AUTOSLEEP_FLAG_BK;STORE
15067  000038F                   	CMP	#0
15068  000038F                   	BNE	BK0_AUTOCNT_SOLVE_S10
15069  000038F                   ;START AUTO SLEEP CNT
15070  000038F                   BK0_AUTOCNT_SOLVE_MUTE:
15071  000038F                   ;	MR_DET_TRY
15072  000038F                   ;	BEQ	BK0_AUTOCNT_SOLVE_S01
15073  000038F                   	MR_SET_AUTOCNT2
15074  000038F                   
15075  000038F                   BK0_AUTOCNT_SOLVE_END1:
15076  000038F                   	RTS
15077  000038F                   BK0_AUTOCNT_SOLVE_S01:
15078  000038F                   	MR_SET_AUTOCNT2_TRYME
15079  000038F                   	RTS
15080  000038F                   BK0_AUTOCNT_SOLVE_S10:
15081  000038F                   	LDA	AUTOSLEEP_FLAG
15082  000038F                   	CMP	#C_AUTOSLEEP_MS1_BIT
15083  000038F                   	BEQ	BK0_AUTOCNT_SOLVE_S11 ;----------------------- if only midi playing:
15084  000038F                   	CMP	#C_AUTOSLEEP_DRUMP_BIT | C_AS_DRUMP_RP_CH_BIT
15085  000038F                   	BEQ	BK0_AUTOCNT_SOLVE_S12 ;----------------------- if only DRUMP playing:
15086  000038F                   
15087  000038F                   	MR_STOP_AUTOCNT
15088  000038F                   
15089  000038F                   	RTS
15090  000038F                   BK0_AUTOCNT_SOLVE_S11:
15091  000038F                   ;Èç¹ûÔÚ²¥·ÅÖÐÓÐ°´¼ü£¬ÖØÖÃÕâ¸ö¼ÆÊ±
15092  000038F                   ; - ÔÚÓÐ°´¼üÖÐ´¦Àí
15093  000038F                   BK0_AUTOCNT_SOLVE_S12:
15094  000038F                   ;	





15095  000038F                   	MR_SET_AUTOCNT3; 
15096  000038F                   
15097  000038F                   BK0_AUTOCNT_SOLVE_END:
15098  000038F                   	RTS
15099  000038F                   ;==================================
15100  000038F                   ;==================================
15101  000038F                   BK0_AUTOSLEEP_KEYIN:
15102  000038F                   ;Èç¹ûÔÚ²¥·ÅÖÐÓÐ°´¼ü£¬ÖØÖÃÕâ¸ö¼ÆÊ±
15103  000038F                   ; - ÔÚÓÐ°´¼üÖÐ´¦Àí
15104  000038F                   ;	LDA	<SYS_MODE_NO
15105  000038F                   ;	CMP	#C_GUIDE4_PLAY_MODE ; ÔÝÍ£Ê½µÄOKON
15106  000038F                   ;	BNE	BK0_AUTOSLEEP_KEYIN_S10
15107  000038F                   
15108  000038F                   ;BK0_AUTOSLEEP_KEYIN_S10:
15109  000038F                   
15110  000038F                   	LDA	AUTOSLEEP_FLAG
15111  000038F                   	CMP	#C_AUTOSLEEP_MS1_BIT
15112  000038F                   	BEQ	BK0_AUTOSLEEP_KEYIN_S20 ;----------------------- if only midi playing:
15113  000038F                   	CMP	#C_AUTOSLEEP_DRUMP_BIT | C_AS_DRUMP_RP_CH_BIT
15114  000038F                   	BEQ	BK0_AUTOSLEEP_KEYIN_S20 ;----------------------- if only DRUMP playing:
15115  000038F                   
15116  000038F                   	RTS
15117  000038F                   BK0_AUTOSLEEP_KEYIN_S20:
15118  000038F                   
15119  000038F                   	MR_SET_AUTOCNT3
15120  000038F                   
15121  000038F                   	RTS
15122  000038F                   
15123  000038F                   
15124  000038F                   
15125  000038F                   
15126  000038F                   
15127  000038F                   ;===============================
15128  000038F                   ;IN: X
15129  000038F                   ;BK0_AUTOSLEEP_NOTEOFF:
15130  000038F                   ;	MR_CMP_MODE_NO	C_PIANO_DRUMP_RP_MODE
15131  000038F                   ;	BNE	BK0_AUTOSLEEP_NOTEOFF_S10
15132  000038F                   ;	CPX	#3
15133  000038F                   ;	BNE	BK0_AUTOSLEEP_NOTEOFF_S10
15134  000038F                   ;if the drump replay mode: not off the ch3 flag
15135  000038F                   ;	RTS
15136  000038F                   ;BK0_AUTOSLEEP_NOTEOFF_S10:
15137  000038F                   ;	LDA	BK0_AUTOSLEEP_NOTEON_TBL,X
15138  000038F                   ;	TRB	<AUTOSLEEP_FLAG
15139  000038F                   ;	RTS
15140  000038F                   
15141  000038F                   ;=================================================
15142  000038F                   BK0_AUTOSLEEP_INIT:
15143  000038F                   	STZ	<AUTOSLEEP_FLAG
15144  000038F                   	STZ	<AUTOSLEEP_FLAG_BK
15145  000038F                   	RTS
15146  000038F                   
15147  000038F                   BK0_AUTOSLEEP_NOTEON_BUSY_X:
15148  000038F                   	LDA	BK0_AUTOSLEEP_NOTEON_TBL,X
15149  000038F                   	TSB	<AUTOSLEEP_FLAG
15150  000038F                   	RTS
15151  000038F                   BK0_AUTOSLEEP_NOTEON_TBL:





15152  000038F                   	DB	C_BIT4
15153  000038F                   	DB	C_BIT5
15154  000038F                   	DB	C_BIT6
15155  000038F                   	DB	C_BIT7
15156  000038F                   
15157  000038F                   .ENDIF  ; C_AUTOSLEEP_WAITKEY_EN
15158  000038F                   
15159  000038F                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\AUTOSLEEP_USER.ASM.APP"
15160  000038F                   
15161  000038F                   .IF ( C_AUTOSLEEP_FLAG_EN .EQ. 1 )
15162  000038F                   PCC_POI_MODULE_CHKSKEY EQU C_FALSE
15163  000038F                   .IF(PCC_POI_MODULE_CHKSKEY.EQ.C_FALSE)
15164  000038F                   	STZ	AUTOSLEEP_FLAG
15165  000038F                   	STZ	AUTOSLEEP_FLAG_BK
15166  000038F                   .ENDIF;PCC_POI_MODULE_CHKSKEY
15167  000038F                   
15168  000038F                   .ENDIF
15169  000038F                   
15170  000038F                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\PWOFF_USER_PCC.ASM.APP"
15171  000038F                   
15172  000038F                   
15173  000038F                   
15174  000038F                   ;=======================================
15175  000038F                   PWOFF_LOOP_PRE1:
15176  000038F                   
15177  000038F                   ;	MR_SET_MODE_NO C_MODE0_0
15178  000038F                   
15179  000038F                   .IFDEF C_LED_MATRIX_EN
15180  000038F                   	JSR	BK0_MATRIX_LED_CTL_OFF
15181  000038F                   .ENDIF
15182  000038F                   
15183  000038F  4C 37 04     	JMP	ENTER_STOP
15184  0000392                   
15185  0000392                   
15186  0000392                   PWOFF_LOOP_WAITSP:
15187  0000392                   
15188  0000392                   ;	MR_PLAY_GROUP_RANDOM C_IDX_SLEEP
15189  0000392                   
15190  0000392                   PWOFF_LOOP2:
15191  0000392                   ; MODE1: F4
15192  0000392                   
15193  0000392                   
15194  0000392                   PWOFF_LOOP2_PCC:
15195  0000392                   
15196  0000392                   
15197  0000392                   
15198  0000392                   	MACRO_CHECK_CH1_ENABLE
15199  0000392  A9 01			LDA	#C_CHK_SPCH1_BIT
15200  0000394  0C 05 00     	TSB	USER_FLAG10
15201  0000397  A9 01			LDA	#C_SPCH1_BIT
15202  0000399  1C 03 00     	TRB	USER_FLAG_A
15203  000039C                   	;ENDM
15204  000039C                   
15205  000039C                   PWOFF_LOOP:
15206  000039C  20 39 01     	JSR	WAITKEY
15207  000039F                   PWOFF_LOOP_S10:
15208  000039F  AD 03 00     	LDA	USER_FLAG_A





15209  00003A2  89 10			BIT	#C_KEYCH0_BIT
15210  00003A4  D0 26			BNE	PWOFF_LOOP_KEYCH0_J1
15211  00003A6  89 20			BIT	#C_KEYCH1_BIT
15212  00003A8  D0 25			BNE	PWOFF_LOOP_KEYCH1_J1
15213  00003AA  89 40			BIT	#C_KEYCH2_BIT
15214  00003AC  D0 24			BNE	PWOFF_LOOP_KEYCH2_J1
15215  00003AE  89 80			BIT	#C_KEYCH3_BIT
15216  00003B0  D0 23			BNE	PWOFF_LOOP_KEYCH3_J1
15217  00003B2  89 01			BIT	#C_SPCH1_BIT
15218  00003B4  D0 25			BNE	PWOFF_LOOP_CH1END_J1
15219  00003B6  89 02			BIT	#C_SPCH2_BIT
15220  00003B8  D0 24			BNE	PWOFF_LOOP_CH2END_J1
15221  00003BA                   
15222  00003BA  AD 04 00     	LDA	USER_FLAG_B
15223  00003BD  89 01			BIT	#C_CNT0_BIT
15224  00003BF  D0 20			BNE	PWOFF_LOOP_CNT0
15225  00003C1  89 02			BIT	#C_CNT1_BIT
15226  00003C3  D0 23			BNE	PWOFF_LOOP_CNT1
15227  00003C5  89 80			BIT	#C_AUTO_CNT_BIT
15228  00003C7  D0 0F			BNE	PWOFF_LOOP_AUTOCNT_J1
15229  00003C9                   
15230  00003C9  4C 9C 03     	JMP	PWOFF_LOOP
15231  00003CC                   PWOFF_LOOP_KEYCH0_J1:
15232  00003CC  4C 2F 04     	JMP	PWOFF_LOOP_KEYCH0
15233  00003CF                   PWOFF_LOOP_KEYCH1_J1:
15234  00003CF  4C 17 04     	JMP	PWOFF_LOOP_KEYCH1
15235  00003D2                   PWOFF_LOOP_KEYCH2_J1:
15236  00003D2  4C 1F 04     	JMP	PWOFF_LOOP_KEYCH2
15237  00003D5                   PWOFF_LOOP_KEYCH3_J1:
15238  00003D5  4C 27 04     	JMP	PWOFF_LOOP_KEYCH3
15239  00003D8                   PWOFF_LOOP_AUTOCNT_J1:
15240  00003D8  4C 10 04     	JMP PWOFF_LOOP_AUTOCNT
15241  00003DB                   PWOFF_LOOP_CH1END_J1:
15242  00003DB  4C FD 03     	JMP PWOFF_LOOP_CH1END
15243  00003DE                   PWOFF_LOOP_CH2END_J1:
15244  00003DE  4C 08 04     	JMP PWOFF_LOOP_CH2END
15245  00003E1                   PWOFF_LOOP_CNT0:
15246  00003E1                   	MACRO_CLR_CNT0_FLAG
15247  00003E1  A9 01			LDA	#C_BIT0
15248  00003E3  14 04			TRB	<USER_FLAG_B
15249  00003E5                   	;ENDM
15250  00003E5                   
15251  00003E5                   
15252  00003E5  4C 9F 03     	JMP	PWOFF_LOOP_S10
15253  00003E8                   PWOFF_LOOP_CNT1:
15254  00003E8                   	MACRO_CLR_CNT1_FLAG
15255  00003E8  A9 02			LDA	#C_BIT1
15256  00003EA  14 04			TRB	<USER_FLAG_B
15257  00003EC                   	;ENDM
15258  00003EC                   ;
15259  00003EC                   
15260  00003EC  4C 9F 03     	JMP	PWOFF_LOOP_S10
15261  00003EF                   PWOFF_LOOP_CNT2:
15262  00003EF                   	MACRO_CLR_CNT2_FLAG
15263  00003EF  A9 04			LDA	#C_BIT2
15264  00003F1  14 04			TRB	<USER_FLAG_B
15265  00003F3                   	;ENDM





15266  00003F3                   
15267  00003F3  4C 9F 03     	JMP	PWOFF_LOOP_S10
15268  00003F6                   PWOFF_LOOP_CNT3:
15269  00003F6                   	MACRO_CLR_CNT3_FLAG
15270  00003F6  A9 08			LDA	#C_BIT3
15271  00003F8  14 04			TRB	<USER_FLAG_B
15272  00003FA                   	;ENDM
15273  00003FA                   
15274  00003FA  4C 9F 03     	JMP	PWOFF_LOOP_S10
15275  00003FD                   PWOFF_LOOP_CH1END:
15276  00003FD                   	MACRO_CLR_CH1_FLAG
15277  00003FD  A9 01			LDA	#C_SPCH1_BIT
15278  00003FF  1C 03 00     	TRB	USER_FLAG_A
15279  0000402                   	;ENDM
15280  0000402                   ;
15281  0000402                   .IF ( C_EQU_PWOFF_EN .EQ. 1 )	
15282  0000402                   
15283  0000402                   	MR_DET_EQU_FG
15284  0000402                   	BNE	PWOFF_LOOP_CH1END_S100
15285  0000402                   
15286  0000402                   	JMP	ENTER_STOP; ;SPEECH
15287  0000402                   
15288  0000402                   PWOFF_LOOP_CH1END_S100:
15289  0000402                   	JSR	BK0_PLAY_EQU_NEXT
15290  0000402                   	BNE	PWOFF_LOOP_CH1END_NEXT ; NEXT
15291  0000402                   ;EQU END
15292  0000402                   .ENDIF
15293  0000402                   
15294  0000402  4C 37 04     	JMP	ENTER_STOP
15295  0000405                   PWOFF_LOOP_CH1END_NEXT:
15296  0000405                   
15297  0000405  4C 9F 03     	JMP	PWOFF_LOOP_S10
15298  0000408                   
15299  0000408                   PWOFF_LOOP_CH2END:
15300  0000408                   	MACRO_CLR_CH2_FLAG
15301  0000408  A9 02			LDA	#C_SPCH2_BIT
15302  000040A  1C 03 00     	TRB	USER_FLAG_A
15303  000040D                   	;ENDM
15304  000040D                   
15305  000040D  4C 9F 03     	JMP	PWOFF_LOOP_S10
15306  0000410                   
15307  0000410                   PWOFF_LOOP_AUTOCNT:
15308  0000410                   	MACRO_CLR_AUTOCNT_FLAG
15309  0000410  A9 80			LDA	#C_AUTO_CNT_BIT
15310  0000412  14 04			TRB	<USER_FLAG_B
15311  0000414                   	;ENDM
15312  0000414                   ;
15313  0000414                   
15314  0000414  4C 9F 03     	JMP	PWOFF_LOOP_S10
15315  0000417                   
15316  0000417                   PWOFF_LOOP_KEYCH1:
15317  0000417                   	MACRO_CLR_KEYCH1_FLAG
15318  0000417  A9 20			LDA	#C_KEYCH1_BIT
15319  0000419  1C 03 00     	TRB	USER_FLAG_A
15320  000041C                   	;ENDM
15321  000041C                   ;MODE
15322  000041C                   





15323  000041C  4C 9F 03     	JMP	PWOFF_LOOP_S10
15324  000041F                   PWOFF_LOOP_KEYCH2:
15325  000041F                   	MACRO_CLR_KEYCH2_FLAG
15326  000041F  A9 40			LDA	#C_KEYCH2_BIT
15327  0000421  1C 03 00     	TRB	USER_FLAG_A
15328  0000424                   	;ENDM
15329  0000424                   ;MODE
15330  0000424                   
15331  0000424  4C 9F 03     	JMP	PWOFF_LOOP_S10
15332  0000427                   PWOFF_LOOP_KEYCH3:
15333  0000427                   	MACRO_CLR_KEYCH3_FLAG
15334  0000427  A9 80			LDA	#C_KEYCH3_BIT
15335  0000429  1C 03 00     	TRB	USER_FLAG_A
15336  000042C                   	;ENDM
15337  000042C                   
15338  000042C  4C 9F 03     	JMP	PWOFF_LOOP_S10
15339  000042F                   
15340  000042F                   PWOFF_LOOP_KEYCH0:
15341  000042F                   	MACRO_CLR_KEYCH0_FLAG
15342  000042F  A9 10			LDA	#C_KEYCH0_BIT
15343  0000431  1C 03 00     	TRB	USER_FLAG_A
15344  0000434                   	;ENDM
15345  0000434                   ; key channel 0
15346  0000434                   
15347  0000434  4C 9F 03     	JMP	PWOFF_LOOP_S10
15348  0000437                   
15349  0000437                   
15350  0000437                   
15351  0000437                   
15352  0000437                   ;================================
15353  0000437                   ENTER_STOP:
15354  0000437                   
15355  0000437                   .IF ( C_SPCH1_ENABLE	.EQ.	1 ) .OR. ( C_SPCH2_ENABLE	.EQ.	1 ).OR. ( C_SPCH3_ENABLE	.EQ.	1 ) 
15356  0000437                   
15357  0000437  20 00 00     	JSR STOP_ALL
15358  000043A                   
15359  000043A                   .ENDIF
15360  000043A                   
15361  000043A                   	MACRO_CLR_AUTOCNT_FLAG
15362  000043A  A9 80			LDA	#C_AUTO_CNT_BIT
15363  000043C  14 04			TRB	<USER_FLAG_B
15364  000043E                   	;ENDM
15365  000043E                   ;¹Ø±ÕCMP_A
15366  000043E                   	.IFDEF C_CMPA_EN
15367  000043E                   	JSR	BK0_CMPAB_OFF
15368  000043E                   
15369  000043E                   	.ENDIF
15370  000043E                   
15371  000043E                   ;===============================
15372  000043E                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
15373  000043E                   
15374  000043E  A9 00			LDA	#C_PWOFF_BP0D
15375  0000440  8D 0A 08     	STA	!BP0D
15376  0000443  A9 00			LDA	#C_PWOFF_BP0M_BAK
15377  0000445  85 21			STA	BP0M_BAK
15378  0000447  09 FF			ORA	#C_PWOFF_BP0_OP
15379  0000449  8D 01 08     	STA	!BP0





15380  000044C                   .ELSE
15381  000044C                   	LDA	#C_PWOFF_BP0D
15382  000044C                   	STA	!BP0D
15383  000044C                   	LDA	#C_PWOFF_R_BP0
15384  000044C                   	.IF ( C_R_BP0_USED .EQ. 1 )
15385  000044C                   	STA	R_BP0
15386  000044C                   	.ENDIF
15387  000044C                   	STA	!BP0
15388  000044C                   .ENDIF
15389  000044C                   
15390  000044C                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
15391  000044C                   
15392  000044C                   	LDA	#C_PWOFF_BP1D
15393  000044C                   	STA	!BP1D
15394  000044C                   	LDA	#C_PWOFF_BP1M_BAK
15395  000044C                   	STA	BP1M_BAK
15396  000044C                   	ORA	#C_PWOFF_BP1_OP
15397  000044C                   	STA	!BP1
15398  000044C                   .ELSE
15399  000044C  A9 FF			LDA	#C_PWOFF_BP1D
15400  000044E  8D 0B 08     	STA	!BP1D
15401  0000451  A9 FF			LDA	#C_PWOFF_R_BP1
15402  0000453  8D 07 00     	STA	R_BP1
15403  0000456  8D 02 08     	STA	!BP1
15404  0000459                   .ENDIF
15405  0000459                   
15406  0000459                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )
15407  0000459                   
15408  0000459                   	LDA	#C_PWOFF_BP2D
15409  0000459                   	STA	!BP2D
15410  0000459                   	LDA	#C_PWOFF_BP2M_BAK
15411  0000459                   	STA	BP2M_BAK
15412  0000459                   	ORA	#C_PWOFF_BP2_OP
15413  0000459                   	STA	!BP2
15414  0000459                   .ELSE
15415  0000459                   	.IFDEF	BP2
15416  0000459                   	LDA	#C_PWOFF_BP2D
15417  0000459                   	STA	!BP2D
15418  0000459                   	LDA	#C_PWOFF_R_BP2
15419  0000459                   	.IF ( C_R_BP2_USED .EQ. 1 )
15420  0000459                   		STA	R_BP2
15421  0000459                   	.ENDIF
15422  0000459                   	STA	!BP2
15423  0000459                   	.ENDIF
15424  0000459                   .ENDIF
15425  0000459                   
15426  0000459                   ;=============================
15427  0000459                   ;	LDA	#C_PWOFF_BP0D
15428  0000459                   ;	STA	!BP0D
15429  0000459                   ;	LDA	#C_PWOFF_R_BP0
15430  0000459                   ;.IF ( C_R_BP0_USED .EQ. 1 )
15431  0000459                   ;	STA	R_BP0
15432  0000459                   ;.ENDIF
15433  0000459                   ;	STA	!BP0
15434  0000459                   ;
15435  0000459                   ;;	MR_SET_PWOFF_FG
15436  0000459                   ;;check current mode





15437  0000459                   ;;MODE0
15438  0000459                   ;	LDA	#C_PWOFF0_BP1D
15439  0000459                   ;	STA	!BP1D
15440  0000459                   ;	LDA	#C_PWOFF0_R_BP1
15441  0000459                   ;	STA	R_BP1
15442  0000459                   ;	STA	!BP1
15443  0000459                   ;	
15444  0000459                   ;	.IFDEF	BP2
15445  0000459                   ;	LDA	#C_PWOFF_BP2D
15446  0000459                   ;	STA	!BP2D
15447  0000459                   ;	LDA	#C_PWOFF_R_BP2
15448  0000459                   ;.IF ( C_R_BP2_USED .EQ. 1 )
15449  0000459                   ;	STA	R_BP2
15450  0000459                   ;.ENDIF
15451  0000459                   ;	STA	!BP2
15452  0000459                   ;	.ENDIF
15453  0000459                   
15454  0000459                   ;if some IO change to input from output ;->;DELAY1MS
15455  0000459                   ;	JSR	BK0_DELAY1MS
15456  0000459  20 C1 02     	JSR BK0_DELAY100US	
15457  000045C                   
15458  000045C  20 0C 03     	JSR	BK0_STORE_BPX_WO_BOND_PWOFF
15459  000045F                   
15460  000045F                   ;================================================
15461  000045F                   ENTER_STOP_PRE_PCC:
15462  000045F                   
15463  000045F                   
15464  000045F                   
15465  000045F                   
15466  000045F                   ;=================================================
15467  000045F                   ;	MACRO_CLOSE_SPK
15468  000045F                   ;----------------  SETTING wakeup source --------------
15469  000045F  A9 03			LDA	#C_BP1EN_PWOFF
15470  0000461  8D 52 08     	STA	BP1EN
15471  0000464                   
15472  0000464                   .IF ( C_TMG0_EN .EQ. 1 )
15473  0000464                   	JSR	BK0_STOP_TMG0
15474  0000464                   .ENDIF
15475  0000464                   	MACRO_INT_DISABLE FXF15_INT_BIT
15476  0000464                   	.IF (C_CHIP.EQ.C_N588H)
15477  0000464  A9 80			LDA	#.LOW.FXF15_INT_BIT
15478  0000466  1C 1E 08     	TRB	!IEF0
15479  0000469                   	.ENDIF
15480  0000469                   	;ENDM
15481  0000469                   
15482  0000469                   	MACRO_CLR_WDT
15483  0000469                   	.IF (C_CHIP.EQ.C_W567BS)
15484  0000469                   	LDA #1
15485  0000469                   	STA !WDTC
15486  0000469                   	.ENDIF
15487  0000469                   	.IF (C_CHIP.EQ.C_N567GHK)
15488  0000469                   	LDA #CTL_CPU_WDT
15489  0000469                   	TSB !CTL_CPU
15490  0000469                   	.ENDIF
15491  0000469                   	.IF (C_CHIP.EQ.C_N588L)
15492  0000469                   	LDA #CTL_CPU_WDT
15493  0000469                   	TSB !CTL_CPU





15494  0000469                   	.ENDIF
15495  0000469                   	.IF (C_CHIP.EQ.C_N588H)
15496  0000469  A9 02			LDA #CTL_CPU_WDT
15497  000046B  0C 0F 08     	TSB !CTL_CPU
15498  000046E                   	.ENDIF
15499  000046E                   	.IF (C_CHIP.EQ.C_W588AS)
15500  000046E                   	LDA #1
15501  000046E                   	STA !WDTC
15502  000046E                   	.ENDIF
15503  000046E                   	.IF (C_CHIP.EQ.C_W588CD)
15504  000046E                   	LDA #1
15505  000046E                   	STA !WDTC
15506  000046E                   	.ENDIF
15507  000046E                   	;ENDM
15508  000046E                   	MACRO_ENTER_STOP
15509  000046E                   	.IF (C_CHIP.EQ.C_W567BS)
15510  000046E                   	LDA	#1
15511  000046E                   	STA	STOP
15512  000046E                   	.ENDIF
15513  000046E                   	.IF (C_CHIP.EQ.C_N567GHK)
15514  000046E                   	LDA #CTL_CPU_STOP
15515  000046E                   	TSB !CTL_CPU
15516  000046E                   	.ENDIF
15517  000046E                   	.IF (C_CHIP.EQ.C_N588L)
15518  000046E                   	LDA #CTL_CPU_STOP
15519  000046E                   	TSB !CTL_CPU
15520  000046E                   	.ENDIF
15521  000046E                   	.IF (C_CHIP.EQ.C_N588H)
15522  000046E  A9 01			LDA #CTL_CPU_STOP
15523  0000470  0C 0F 08     	TSB !CTL_CPU
15524  0000473                   	.ENDIF
15525  0000473                   	.IF (C_CHIP.EQ.C_W588AS)
15526  0000473                   	LDA	#1
15527  0000473                   	STA	STOP
15528  0000473                   	.ENDIF
15529  0000473                   	.IF (C_CHIP.EQ.C_W588CD)
15530  0000473                   	LDA	#1
15531  0000473                   	STA	STOP
15532  0000473                   	.ENDIF
15533  0000473                   	;ENDM
15534  0000473                   
15535  0000473  EA           	NOP
15536  0000474  EA           	NOP
15537  0000475  EA           	NOP
15538  0000476                   
15539  0000476                   	MACRO_INT_ENABLE FXF15_INT_BIT
15540  0000476                   	.IF (C_CHIP.EQ.C_N588H)
15541  0000476  A9 80			LDA	#.LOW.FXF15_INT_BIT
15542  0000478  0C 1E 08     	TSB	!IEF0
15543  000047B                   	.ENDIF
15544  000047B                   	;ENDM
15545  000047B                   
15546  000047B                   ;	MACRO_SET_SPK
15547  000047B                   
15548  000047B  A9 E0			LDA	#0E0H
15549  000047D                   WAKEUP_DELAY:
15550  000047D  1A           	INC	A





15551  000047E  D0 FD			BNE	WAKEUP_DELAY
15552  0000480                   
15553  0000480                   	MR_SET_AUTOCNT1
15554  0000480                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
15555  0000480                   	MR_SET_AUTOCNT_1B T0001S_21
15556  0000480                   .ENDIF
15557  0000480                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
15558  0000480                   	MR_SET_AUTOCNT_2B T0001S_21
15559  0000480  A9 D1			LDA	#.LOW.T0001S_21
15560  0000482  8D 13 00     	STA	WB_AUTOCNT0
15561  0000485  A9 FF			LDA	#.HIGH.T0001S_21
15562  0000487  8D 14 00     	STA	WB_AUTOCNT01
15563  000048A  A9 80			LDA	#C_AUTO_CNT_BIT
15564  000048C  14 04			TRB	<USER_FLAG_B
15565  000048E                   	;ENDM
15566  000048E                   .ENDIF
15567  000048E                   	;ENDM
15568  000048E                   
15569  000048E  4C E6 04     	JMP	MAIN_WAKEUP
15570  0000491                   
15571  0000491                   
15572  0000491                   
15573  0000491                   
15574  0000491                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\MAIN0_USER_PCC.ASM.APP"
15575  0000491                   
15576  0000491                   
15577  0000491                   
15578  0000491                   ;LVR+LVD ->SLEEP,²»¿ªÊ¼¹¦ÄÜ¡£
15579  0000491                   
15580  0000491                   ;RESET_F.0=1;LVR
15581  0000491                   ;RESET_F.3=1;POR
15582  0000491                   ;RESET_F.4=1;RESET PIN
15583  0000491                   
15584  0000491                   POI_USER:
15585  0000491                   
15586  0000491                   ;¼ÆËãRAMµÄÊ¹ÓÃÇé¿ö
15587  0000491  A9 17			LDA	#R_USER_STACK_ST
15588  0000493  C9 00			CMP	#R_USER_RAM_ST
15589  0000495  90 FA			BCC	POI_USER
15590  0000497  38           	SEC
15591  0000498  E9 00			SBC	#R_USER_RAM_ST
15592  000049A  C9 0C			CMP	#C_RESERVE_BYTE_USER_STACK
15593  000049C  B0 02			BCS	POI_RAM_OK
15594  000049E                   ;
15595  000049E                   
15596  000049E  80 F1			BRA	POI_USER ; reset
15597  00004A0                   
15598  00004A0                   POI_RAM_OK:
15599  00004A0                   
15600  00004A0                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
15601  00004A0                   
15602  00004A0  A9 00			LDA	#C_PWON_BP0D
15603  00004A2  8D 0A 08     	STA	!BP0D
15604  00004A5  A9 00			LDA	#C_PWON_BP0M_BAK
15605  00004A7  85 21			STA	BP0M_BAK
15606  00004A9  09 FF			ORA	#C_PWON_BP0_OP
15607  00004AB  8D 01 08     	STA	!BP0





15608  00004AE                   .ELSE
15609  00004AE                   	LDA	#C_PWON_BP0D
15610  00004AE                   	STA	!BP0D
15611  00004AE                   	LDA	#C_PWON_R_BP0
15612  00004AE                   	.IF ( C_R_BP0_USED .EQ. 1 )
15613  00004AE                   	STA	R_BP0
15614  00004AE                   	.ENDIF
15615  00004AE                   	STA	!BP0
15616  00004AE                   .ENDIF
15617  00004AE                   
15618  00004AE                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
15619  00004AE                   
15620  00004AE                   	LDA	#C_PWON_BP1D
15621  00004AE                   	STA	!BP1D
15622  00004AE                   	LDA	#C_PWON_BP1M_BAK
15623  00004AE                   	STA	BP1M_BAK
15624  00004AE                   	ORA	#C_PWON_BP1_OP
15625  00004AE                   	STA	!BP1
15626  00004AE                   .ELSE
15627  00004AE  A9 FF			LDA	#C_PWON_BP1D
15628  00004B0  8D 0B 08     	STA	!BP1D
15629  00004B3  A9 FF			LDA	#C_PWON_R_BP1
15630  00004B5  8D 07 00     	STA	R_BP1
15631  00004B8  8D 02 08     	STA	!BP1
15632  00004BB                   .ENDIF
15633  00004BB                   
15634  00004BB                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )
15635  00004BB                   
15636  00004BB                   	LDA	#C_PWON_BP2D
15637  00004BB                   	STA	!BP2D
15638  00004BB                   	LDA	#C_PWON_BP2M_BAK
15639  00004BB                   	STA	BP2M_BAK
15640  00004BB                   	ORA	#C_PWON_BP2_OP
15641  00004BB                   	STA	!BP2
15642  00004BB                   .ELSE
15643  00004BB                   	.IFDEF	BP2
15644  00004BB                   	LDA	#C_PWON_BP2D
15645  00004BB                   	STA	!BP2D
15646  00004BB                   	LDA	#C_PWON_R_BP2
15647  00004BB                   	.IF ( C_R_BP2_USED .EQ. 1 )
15648  00004BB                   		STA	R_BP2
15649  00004BB                   	.ENDIF
15650  00004BB                   	STA	!BP2
15651  00004BB                   	.ENDIF
15652  00004BB                   .ENDIF
15653  00004BB  20 19 02     	JSR	BK0_DELAY61440CYCLE
15654  00004BE                   
15655  00004BE                   .IFDEF C_CMPA_EN
15656  00004BE                   	JSR	BK0_CMPA_ON
15657  00004BE                   	JSR	FRESH_STS0
15658  00004BE                   .ENDIF ; C_CMPA_EN
15659  00004BE                   
15660  00004BE                   POI_WAIT_CPU:
15661  00004BE  20 FF 02     	JSR	BK0_STORE_BPX
15662  00004C1                   
15663  00004C1  20 19 02     	JSR	BK0_DELAY61440CYCLE
15664  00004C4  20 19 02     	JSR	BK0_DELAY61440CYCLE





15665  00004C7  20 19 02     	JSR	BK0_DELAY61440CYCLE
15666  00004CA                   
15667  00004CA                   ;CHECK AGAIN
15668  00004CA                   .IF ( C_BP0_STATUS_EN .EQ. 1 )
15669  00004CA  AD 01 08     	LDA	!BP0
15670  00004CD  CD 08 00     	CMP	BP0_STATUS
15671  00004D0  D0 EC			BNE	POI_WAIT_CPU
15672  00004D2                   .ENDIF
15673  00004D2                   .IF ( C_BP1_STATUS_EN .EQ. 1 )
15674  00004D2  AD 02 08     	LDA	!BP1
15675  00004D5  CD 09 00     	CMP	BP1_STATUS
15676  00004D8  D0 E4			BNE	POI_WAIT_CPU
15677  00004DA                   .ENDIF
15678  00004DA                   .IF ( C_BP2_STATUS_EN .EQ. 1 )
15679  00004DA                   	LDA	!BP2
15680  00004DA                   	CMP	BP2_STATUS
15681  00004DA                   	BNE	POI_WAIT_CPU
15682  00004DA                   .ENDIF
15683  00004DA                   
15684  00004DA                   
15685  00004DA                   .IF	(C_MS_ENABLE .EQ. 1)
15686  00004DA                   	EN_GLOBALVOL_VOL_MIDI1
15687  00004DA                   .ENDIF
15688  00004DA                   
15689  00004DA                   .IF	(C_SPCH1_ENABLE .EQ. 1)
15690  00004DA                   	.IF ( Speech_Volume_Adjustment .EQ. 1 )
15691  00004DA                   	EN_GLOBALVOL_VOL1
15692  00004DA                   	.ENDIF
15693  00004DA                   .ENDIF
15694  00004DA                   
15695  00004DA                   .IF	(C_SPCH2_ENABLE .EQ. 1)
15696  00004DA                   	.IF ( Speech_Volume_Adjustment .EQ. 1 )
15697  00004DA                   	EN_GLOBALVOL_VOL2
15698  00004DA                   	.ENDIF	
15699  00004DA                   .ENDIF	
15700  00004DA                   
15701  00004DA                   	.IF ( Speech_Volume_Adjustment .EQ. 1 )
15702  00004DA                   	LDA	#C_DEFAULT_TPO_IDX|C_DEFAULT_VOL_IDX
15703  00004DA                   	STA	VOL_TPO_IDX
15704  00004DA                   	JSR	BK0_SET_VOL
15705  00004DA                   	.ENDIF	
15706  00004DA                   
15707  00004DA  20 6C 03     	JSR	CHKKEY_INIT
15708  00004DD                   ;========================================================
15709  00004DD                   ;========================================================
15710  00004DD                   POI_MODULE_PCC:
15711  00004DD                   ;CHKSKEY
15712  00004DD  EA           	NOP
15713  00004DE                   
15714  00004DE                   
15715  00004DE                   
15716  00004DE                   ;========================================================
15717  00004DE                   
15718  00004DE                   .IFDEF C_CMPA_EN
15719  00004DE                   ;CHECK CMPA
15720  00004DE                   	JSR	STORE_STS0
15721  00004DE                   





15722  00004DE                   	LDA	#B_CHK_STS0_ST
15723  00004DE                   	BIT	<R_CHK_STS0_ST
15724  00004DE                   	BNE	POI_LVD_S10
15725  00004DE                   ;0: BP10<BP11
15726  00004DE                   
15727  00004DE                   .IF ( DEBUG_CMPA .EQ. 1 )
15728  00004DE                   	BRA POI_LVD_S10
15729  00004DE                   .ENDIF ; DEBUG_CMPA
15730  00004DE                   
15731  00004DE                   	JMP	ENTER_STOP
15732  00004DE                   
15733  00004DE                   POI_LVD_S10:
15734  00004DE                   .ENDIF ; C_CMPA_EN
15735  00004DE                   
15736  00004DE                   ;CHECK LVR
15737  00004DE                   .IFDEF C_CHK_LVR_EN
15738  00004DE                   	LDA	RESET_F
15739  00004DE                   	AND	#11001B
15740  00004DE                   	CMP	#00001B
15741  00004DE                   	BNE	POI_LVR_S10
15742  00004DE                   	LDA	#0FFH
15743  00004DE                   	STA	RESET_F
15744  00004DE                   ;LVR->ENTER STOP
15745  00004DE                   	JMP	ENTER_STOP
15746  00004DE                   
15747  00004DE                   POI_LVR_S10:
15748  00004DE                   	LDA	#0FFH
15749  00004DE                   	STA	RESET_F
15750  00004DE                   .ENDIF
15751  00004DE                   
15752  00004DE                   ;===============================
15753  00004DE                   ;CHECK TEST MODE
15754  00004DE                   ;===============================
15755  00004DE                   POI_CHKTEST_PCC:
15756  00004DE                   
15757  00004DE                   
15758  00004DE                   
15759  00004DE                   ;========================================
15760  00004DE                   
15761  00004DE                   
15762  00004DE                   ;===============================
15763  00004DE                   ;CHECK TEST MODE end
15764  00004DE                   ;=======================================
15765  00004DE                   
15766  00004DE                   
15767  00004DE                   ;not TEST MODE
15768  00004DE                   ;========================================
15769  00004DE                   ;	JMP	ENTER_STOP
15770  00004DE                   
15771  00004DE                   
15772  00004DE                   .IF ( C_TMG0_EN .EQ. 1 )
15773  00004DE                   	JSR	BK0_START_TMG0_0625MS
15774  00004DE                   .ENDIF
15775  00004DE                   	MACRO_INT_ENABLE FXF15_INT_BIT
15776  00004DE                   	.IF (C_CHIP.EQ.C_N588H)
15777  00004DE  A9 80			LDA	#.LOW.FXF15_INT_BIT
15778  00004E0  0C 1E 08     	TSB	!IEF0





15779  00004E3                   	.ENDIF
15780  00004E3                   	;ENDM
15781  00004E3                   
15782  00004E3                   ;	JMP	M0_PRE
15783  00004E3  4C E3 05     	JMP	PWON_CHK_MODE
15784  00004E6                   
15785  00004E6                   
15786  00004E6                   
15787  00004E6                   ;=======================================
15788  00004E6                   MAIN_WAKEUP:
15789  00004E6                   
15790  00004E6                   	MACRO_INT_ENABLE FXF15_INT_BIT
15791  00004E6                   	.IF (C_CHIP.EQ.C_N588H)
15792  00004E6  A9 80			LDA	#.LOW.FXF15_INT_BIT
15793  00004E8  0C 1E 08     	TSB	!IEF0
15794  00004EB                   	.ENDIF
15795  00004EB                   	;ENDM
15796  00004EB                   .IF ( C_TMG0_EN .EQ. 1 )
15797  00004EB                   	JSR	BK0_START_TMG0_0625MS
15798  00004EB                   .ENDIF
15799  00004EB                   ;======================================
15800  00004EB                   
15801  00004EB                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
15802  00004EB                   
15803  00004EB  A9 00			LDA	#C_WAKEUP_BP0D
15804  00004ED  8D 0A 08     	STA	!BP0D
15805  00004F0  A9 00			LDA	#C_WAKEUP_BP0M_BAK
15806  00004F2  85 21			STA	BP0M_BAK
15807  00004F4  09 FF			ORA	#C_WAKEUP_BP0_OP
15808  00004F6  8D 01 08     	STA	!BP0
15809  00004F9                   .ELSE
15810  00004F9                   	LDA	#C_WAKEUP_BP0D
15811  00004F9                   	STA	!BP0D
15812  00004F9                   	LDA	#C_WAKEUP_R_BP0
15813  00004F9                   	.IF ( C_R_BP0_USED .EQ. 1 )
15814  00004F9                   	STA	R_BP0
15815  00004F9                   	.ENDIF
15816  00004F9                   	STA	!BP0
15817  00004F9                   .ENDIF
15818  00004F9                   
15819  00004F9                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
15820  00004F9                   
15821  00004F9                   	LDA	#C_WAKEUP_BP1D
15822  00004F9                   	STA	!BP1D
15823  00004F9                   	LDA	#C_WAKEUP_BP1M_BAK
15824  00004F9                   	STA	BP1M_BAK
15825  00004F9                   	ORA	#C_WAKEUP_BP1_OP
15826  00004F9                   	STA	!BP1
15827  00004F9                   .ELSE
15828  00004F9  A9 FF			LDA	#C_WAKEUP_BP1D
15829  00004FB  8D 0B 08     	STA	!BP1D
15830  00004FE  A9 FF			LDA	#C_WAKEUP_R_BP1
15831  0000500  8D 07 00     	STA	R_BP1
15832  0000503  8D 02 08     	STA	!BP1
15833  0000506                   .ENDIF
15834  0000506                   
15835  0000506                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )





15836  0000506                   
15837  0000506                   	LDA	#C_WAKEUP_BP2D
15838  0000506                   	STA	!BP2D
15839  0000506                   	LDA	#C_WAKEUP_BP2M_BAK
15840  0000506                   	STA	BP2M_BAK
15841  0000506                   	ORA	#C_WAKEUP_BP2_OP
15842  0000506                   	STA	!BP2
15843  0000506                   .ELSE
15844  0000506                   	.IFDEF	BP2
15845  0000506                   	LDA	#C_WAKEUP_BP2D
15846  0000506                   	STA	!BP2D
15847  0000506                   	LDA	#C_WAKEUP_R_BP2
15848  0000506                   	.IF ( C_R_BP2_USED .EQ. 1 )
15849  0000506                   		STA	R_BP2
15850  0000506                   	.ENDIF
15851  0000506                   	STA	!BP2
15852  0000506                   	.ENDIF
15853  0000506                   .ENDIF
15854  0000506                   
15855  0000506                   
15856  0000506                   ;if some IO change to input from output ;->;DELAY1MS
15857  0000506                   ;	JSR	BK0_DELAY1MS
15858  0000506                   
15859  0000506                   	MR_SET_AUTOCNT1
15860  0000506                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
15861  0000506                   	MR_SET_AUTOCNT_1B T0001S_21
15862  0000506                   .ENDIF
15863  0000506                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
15864  0000506                   	MR_SET_AUTOCNT_2B T0001S_21
15865  0000506  A9 D1			LDA	#.LOW.T0001S_21
15866  0000508  8D 13 00     	STA	WB_AUTOCNT0
15867  000050B  A9 FF			LDA	#.HIGH.T0001S_21
15868  000050D  8D 14 00     	STA	WB_AUTOCNT01
15869  0000510  A9 80			LDA	#C_AUTO_CNT_BIT
15870  0000512  14 04			TRB	<USER_FLAG_B
15871  0000514                   	;ENDM
15872  0000514                   .ENDIF
15873  0000514                   	;ENDM
15874  0000514                   
15875  0000514                   ;=================================
15876  0000514                   MAIN_WAKEUP_PCC:
15877  0000514                   ;
15878  0000514                   
15879  0000514                   ;=================================
15880  0000514                   .IF ( C_MODESWITCH_CHK_EN .EQ. 1 )
15881  0000514                   	MR_SET_AUTOCNT1
15882  0000514                   	JMP	WAKEUP_CHKKEY_LOOP_PRE
15883  0000514                   .ELSE
15884  0000514                   ;===============================
15885  0000514                   ;check any key in mode
15886  0000514                   
15887  0000514                   	MR_SET_AUTOCNT1
15888  0000514                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
15889  0000514                   	MR_SET_AUTOCNT_1B T0001S_21
15890  0000514                   .ENDIF
15891  0000514                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
15892  0000514                   	MR_SET_AUTOCNT_2B T0001S_21





15893  0000514  A9 D1			LDA	#.LOW.T0001S_21
15894  0000516  8D 13 00     	STA	WB_AUTOCNT0
15895  0000519  A9 FF			LDA	#.HIGH.T0001S_21
15896  000051B  8D 14 00     	STA	WB_AUTOCNT01
15897  000051E  A9 80			LDA	#C_AUTO_CNT_BIT
15898  0000520  14 04			TRB	<USER_FLAG_B
15899  0000522                   	;ENDM
15900  0000522                   .ENDIF
15901  0000522                   	;ENDM
15902  0000522                   
15903  0000522  4C E6 05     	JMP	M0_WAKEUP
15904  0000525                   .ENDIF
15905  0000525                   
15906  0000525                   ;=======================================
15907  0000525                   ; 	wakeup From key or mode key
15908  0000525                   ;need to check mode key firstly
15909  0000525                   ;need to check keys before mode enter
15910  0000525                   ;=======================================
15911  0000525                   WAKEUP_CHKKEY_LOOP_PRE:
15912  0000525                   ;
15913  0000525                   ;
15914  0000525                   
15915  0000525                   WAKEUP_CHKKEY_LOOP:
15916  0000525  20 39 01     	JSR	WAITKEY
15917  0000528                   WAKEUP_CHKKEY_CHK_USER_FLAG:
15918  0000528  AD 03 00     	LDA	USER_FLAG_A
15919  000052B  89 10			BIT	#C_KEYCH0_BIT
15920  000052D  D0 26			BNE	WAKEUP_CHKKEY_LOOP_KEYCH0_J1
15921  000052F  89 20			BIT	#C_KEYCH1_BIT
15922  0000531  D0 25			BNE	WAKEUP_CHKKEY_LOOP_KEYCH1_J1
15923  0000533  89 40			BIT	#C_KEYCH2_BIT
15924  0000535  D0 24			BNE	WAKEUP_CHKKEY_LOOP_KEYCH2_J1
15925  0000537  89 80			BIT	#C_KEYCH3_BIT
15926  0000539  D0 23			BNE	WAKEUP_CHKKEY_LOOP_KEYCH3_J1
15927  000053B  89 01			BIT	#C_SPCH1_BIT
15928  000053D  D0 25			BNE	WAKEUP_CHKKEY_LOOP_CH1END_J1
15929  000053F  89 02			BIT	#C_SPCH2_BIT
15930  0000541  D0 24			BNE	WAKEUP_CHKKEY_LOOP_CH2END_J1
15931  0000543                   
15932  0000543  AD 04 00     	LDA	USER_FLAG_B
15933  0000546  89 01			BIT	#C_CNT0_BIT
15934  0000548  D0 20			BNE	WAKEUP_CHKKEY_LOOP_CNT0
15935  000054A  89 02			BIT	#C_CNT1_BIT
15936  000054C  D0 23			BNE	WAKEUP_CHKKEY_LOOP_CNT1
15937  000054E  89 80			BIT	#C_AUTO_CNT_BIT
15938  0000550  D0 0F			BNE	WAKEUP_CHKKEY_LOOP_AUTOCNT_J1
15939  0000552                   
15940  0000552  4C 25 05     	JMP	WAKEUP_CHKKEY_LOOP
15941  0000555                   WAKEUP_CHKKEY_LOOP_KEYCH0_J1:
15942  0000555  4C B5 05     	JMP	WAKEUP_CHKKEY_LOOP_KEYCH0
15943  0000558                   WAKEUP_CHKKEY_LOOP_KEYCH1_J1:
15944  0000558  4C 9D 05     	JMP	WAKEUP_CHKKEY_LOOP_KEYCH1
15945  000055B                   WAKEUP_CHKKEY_LOOP_KEYCH2_J1:
15946  000055B  4C A5 05     	JMP	WAKEUP_CHKKEY_LOOP_KEYCH2
15947  000055E                   WAKEUP_CHKKEY_LOOP_KEYCH3_J1:
15948  000055E  4C AD 05     	JMP	WAKEUP_CHKKEY_LOOP_KEYCH3
15949  0000561                   WAKEUP_CHKKEY_LOOP_AUTOCNT_J1:





15950  0000561  4C 96 05     	JMP WAKEUP_CHKKEY_LOOP_AUTOCNT
15951  0000564                   WAKEUP_CHKKEY_LOOP_CH1END_J1:
15952  0000564  4C 86 05     	JMP WAKEUP_CHKKEY_LOOP_CH1END
15953  0000567                   WAKEUP_CHKKEY_LOOP_CH2END_J1:
15954  0000567  4C 8E 05     	JMP WAKEUP_CHKKEY_LOOP_CH2END
15955  000056A                   WAKEUP_CHKKEY_LOOP_CNT0:
15956  000056A                   	MACRO_CLR_CNT0_FLAG
15957  000056A  A9 01			LDA	#C_BIT0
15958  000056C  14 04			TRB	<USER_FLAG_B
15959  000056E                   	;ENDM
15960  000056E                   ;IDLE
15961  000056E                   
15962  000056E                   
15963  000056E  4C 28 05     	JMP	WAKEUP_CHKKEY_CHK_USER_FLAG
15964  0000571                   WAKEUP_CHKKEY_LOOP_CNT1:
15965  0000571                   	MACRO_CLR_CNT1_FLAG
15966  0000571  A9 02			LDA	#C_BIT1
15967  0000573  14 04			TRB	<USER_FLAG_B
15968  0000575                   	;ENDM
15969  0000575                   ;
15970  0000575                   
15971  0000575  4C 28 05     	JMP	WAKEUP_CHKKEY_CHK_USER_FLAG
15972  0000578                   WAKEUP_CHKKEY_LOOP_CNT2:
15973  0000578                   	MACRO_CLR_CNT2_FLAG
15974  0000578  A9 04			LDA	#C_BIT2
15975  000057A  14 04			TRB	<USER_FLAG_B
15976  000057C                   	;ENDM
15977  000057C                   
15978  000057C  4C 28 05     	JMP	WAKEUP_CHKKEY_CHK_USER_FLAG
15979  000057F                   WAKEUP_CHKKEY_LOOP_CNT3:
15980  000057F                   	MACRO_CLR_CNT3_FLAG
15981  000057F  A9 08			LDA	#C_BIT3
15982  0000581  14 04			TRB	<USER_FLAG_B
15983  0000583                   	;ENDM
15984  0000583                   
15985  0000583  4C 28 05     	JMP	WAKEUP_CHKKEY_CHK_USER_FLAG
15986  0000586                   WAKEUP_CHKKEY_LOOP_CH1END:
15987  0000586                   	MACRO_CLR_CH1_FLAG
15988  0000586  A9 01			LDA	#C_SPCH1_BIT
15989  0000588  1C 03 00     	TRB	USER_FLAG_A
15990  000058B                   	;ENDM
15991  000058B                   ;
15992  000058B                   
15993  000058B  4C 28 05     	JMP	WAKEUP_CHKKEY_CHK_USER_FLAG
15994  000058E                   
15995  000058E                   WAKEUP_CHKKEY_LOOP_CH2END:
15996  000058E                   	MACRO_CLR_CH2_FLAG
15997  000058E  A9 02			LDA	#C_SPCH2_BIT
15998  0000590  1C 03 00     	TRB	USER_FLAG_A
15999  0000593                   	;ENDM
16000  0000593                   ;
16001  0000593                   
16002  0000593  4C 28 05     	JMP	WAKEUP_CHKKEY_CHK_USER_FLAG
16003  0000596                   
16004  0000596                   WAKEUP_CHKKEY_LOOP_AUTOCNT:
16005  0000596                   	MACRO_CLR_AUTOCNT_FLAG
16006  0000596  A9 80			LDA	#C_AUTO_CNT_BIT





16007  0000598  14 04			TRB	<USER_FLAG_B
16008  000059A                   	;ENDM
16009  000059A                   ;
16010  000059A                   
16011  000059A  4C 37 04     	JMP	ENTER_STOP
16012  000059D                   
16013  000059D                   WAKEUP_CHKKEY_LOOP_KEYCH1:
16014  000059D                   	MACRO_CLR_KEYCH1_FLAG
16015  000059D  A9 20			LDA	#C_KEYCH1_BIT
16016  000059F  1C 03 00     	TRB	USER_FLAG_A
16017  00005A2                   	;ENDM
16018  00005A2                   ;
16019  00005A2                   
16020  00005A2  4C BD 05     	JMP	WAKEUP_CHKKEY_END
16021  00005A5                   
16022  00005A5                   WAKEUP_CHKKEY_LOOP_KEYCH2:
16023  00005A5                   	MACRO_CLR_KEYCH2_FLAG
16024  00005A5  A9 40			LDA	#C_KEYCH2_BIT
16025  00005A7  1C 03 00     	TRB	USER_FLAG_A
16026  00005AA                   	;ENDM
16027  00005AA                   ;MODE change
16028  00005AA                   
16029  00005AA  4C BD 05     	JMP	WAKEUP_CHKKEY_END
16030  00005AD                   
16031  00005AD                   WAKEUP_CHKKEY_LOOP_KEYCH3:
16032  00005AD                   	MACRO_CLR_KEYCH3_FLAG
16033  00005AD  A9 80			LDA	#C_KEYCH3_BIT
16034  00005AF  1C 03 00     	TRB	USER_FLAG_A
16035  00005B2                   	;ENDM
16036  00005B2                   
16037  00005B2  4C BD 05     	JMP	WAKEUP_CHKKEY_END
16038  00005B5                   
16039  00005B5                   WAKEUP_CHKKEY_LOOP_KEYCH0:
16040  00005B5                   	MACRO_CLR_KEYCH0_FLAG
16041  00005B5  A9 10			LDA	#C_KEYCH0_BIT
16042  00005B7  1C 03 00     	TRB	USER_FLAG_A
16043  00005BA                   	;ENDM
16044  00005BA                   ; key channel 0
16045  00005BA                   ;check ANYKEY_WAKEUP key
16046  00005BA                   
16047  00005BA  4C BD 05     	JMP	WAKEUP_CHKKEY_END
16048  00005BD                   ;======================================
16049  00005BD                   ;=========================================
16050  00005BD                   WAKEUP_CHKKEY_END:
16051  00005BD                   
16052  00005BD                   ;==================================================
16053  00005BD                   WAKEUP_CHKKEY_END_PCC:
16054  00005BD                   
16055  00005BD                   ;==================================================
16056  00005BD                   
16057  00005BD                   	.IFDEF C_LED_MATRIX_EN
16058  00005BD                   	JSR	BK0_LED_MATRIX_RAM_INIT
16059  00005BD                   	.ENDIF
16060  00005BD                   
16061  00005BD                   	MACRO_INT_ENABLE FXF15_INT_BIT
16062  00005BD                   	.IF (C_CHIP.EQ.C_N588H)
16063  00005BD  A9 80			LDA	#.LOW.FXF15_INT_BIT





16064  00005BF  0C 1E 08     	TSB	!IEF0
16065  00005C2                   	.ENDIF
16066  00005C2                   	;ENDM
16067  00005C2                   
16068  00005C2                   .IF ( C_TMG0_EN .EQ. 1 )
16069  00005C2                   	JSR	BK0_START_TMG0_0625MS
16070  00005C2                   .ENDIF
16071  00005C2                   
16072  00005C2                   ;=============================
16073  00005C2                   
16074  00005C2                   .IF ( C_BP0_ULTRAIO_EN .EQ. 1 )
16075  00005C2                   
16076  00005C2  A9 00			LDA	#C_WAKEUP1_BP0D
16077  00005C4  8D 0A 08     	STA	!BP0D
16078  00005C7  A9 00			LDA	#C_WAKEUP1_BP0M_BAK
16079  00005C9  85 21			STA	BP0M_BAK
16080  00005CB  09 FF			ORA	#C_WAKEUP1_BP0_OP
16081  00005CD  8D 01 08     	STA	!BP0
16082  00005D0                   .ELSE
16083  00005D0                   	LDA	#C_WAKEUP1_BP0D
16084  00005D0                   	STA	!BP0D
16085  00005D0                   	LDA	#C_WAKEUP1_R_BP0
16086  00005D0                   	.IF ( C_R_BP0_USED .EQ. 1 )
16087  00005D0                   	STA	R_BP0
16088  00005D0                   	.ENDIF
16089  00005D0                   	STA	!BP0
16090  00005D0                   .ENDIF
16091  00005D0                   
16092  00005D0                   .IF ( C_BP1_ULTRAIO_EN .EQ. 1 )
16093  00005D0                   
16094  00005D0                   	LDA	#C_WAKEUP1_BP1D
16095  00005D0                   	STA	!BP1D
16096  00005D0                   	LDA	#C_WAKEUP1_BP1M_BAK
16097  00005D0                   	STA	BP1M_BAK
16098  00005D0                   	ORA	#C_WAKEUP1_BP1_OP
16099  00005D0                   	STA	!BP1
16100  00005D0                   .ELSE
16101  00005D0  A9 FF			LDA	#C_WAKEUP1_BP1D
16102  00005D2  8D 0B 08     	STA	!BP1D
16103  00005D5  A9 FF			LDA	#C_WAKEUP1_R_BP1
16104  00005D7  8D 07 00     	STA	R_BP1
16105  00005DA  8D 02 08     	STA	!BP1
16106  00005DD                   .ENDIF
16107  00005DD                   
16108  00005DD                   .IF ( C_BP2_ULTRAIO_EN .EQ. 1 )
16109  00005DD                   
16110  00005DD                   	LDA	#C_WAKEUP1_BP2D
16111  00005DD                   	STA	!BP2D
16112  00005DD                   	LDA	#C_WAKEUP1_BP2M_BAK
16113  00005DD                   	STA	BP2M_BAK
16114  00005DD                   	ORA	#C_WAKEUP1_BP2_OP
16115  00005DD                   	STA	!BP2
16116  00005DD                   .ELSE
16117  00005DD                   	.IFDEF	BP2
16118  00005DD                   	LDA	#C_WAKEUP1_BP2D
16119  00005DD                   	STA	!BP2D
16120  00005DD                   	LDA	#C_WAKEUP1_R_BP2





16121  00005DD                   	.IF ( C_R_BP2_USED .EQ. 1 )
16122  00005DD                   		STA	R_BP2
16123  00005DD                   	.ENDIF
16124  00005DD                   	STA	!BP2
16125  00005DD                   	.ENDIF
16126  00005DD                   .ENDIF
16127  00005DD                   
16128  00005DD                   ;================================
16129  00005DD                   ;	LDA	#C_WAKEUP1_BP0D
16130  00005DD                   ;	STA	!BP0D
16131  00005DD                   ;	LDA	#C_WAKEUP1_R_BP0
16132  00005DD                   ;.IF ( C_R_BP0_USED .EQ. 1 )
16133  00005DD                   ;	STA	R_BP0
16134  00005DD                   ;.ENDIF
16135  00005DD                   ;	STA	!BP0
16136  00005DD                   ;	
16137  00005DD                   ;	LDA	#C_WAKEUP1_BP1D
16138  00005DD                   ;	STA	!BP1D
16139  00005DD                   ;	LDA	#C_WAKEUP1_R_BP1
16140  00005DD                   ;	STA	R_BP1
16141  00005DD                   ;	STA	!BP1
16142  00005DD                   ;
16143  00005DD                   ;	.IFDEF	BP2
16144  00005DD                   ;	LDA	#C_WAKEUP1_BP2D
16145  00005DD                   ;	STA	!BP2D
16146  00005DD                   ;	LDA	#C_WAKEUP1_R_BP2
16147  00005DD                   ;.IF ( C_R_BP2_USED .EQ. 1 )
16148  00005DD                   ;	STA	R_BP2
16149  00005DD                   ;.ENDIF
16150  00005DD                   ;	STA	!BP2
16151  00005DD                   ;	.ENDIF
16152  00005DD                   
16153  00005DD                   ;===============================
16154  00005DD                   ;after keys checked
16155  00005DD                   ;mode key check end: before other key
16156  00005DD                   ;===============================
16157  00005DD                   WAKEUP_CHK_MODE:
16158  00005DD                   ;===============================
16159  00005DD                   ;===============================
16160  00005DD                   
16161  00005DD                   
16162  00005DD                   
16163  00005DD                   .IF ( C_MODESWITCH_CHK_EN .EQ. 1 )
16164  00005DD                   	MR_SET_AUTOCNT2
16165  00005DD                   ; check mode switch status
16166  00005DD                   	LDA	#B_S_KEY1
16167  00005DD                   	BIT	R_S_KEY1_STATUS
16168  00005DD                   	BNE	WAKEUP_CHK_MODE_S10
16169  00005DD                   
16170  00005DD                   	JMP	M0_WAKEUP
16171  00005DD                   WAKEUP_CHK_MODE_S10:
16172  00005DD                   
16173  00005DD                   	JMP	M1_WAKEUP
16174  00005DD                   ;======================================
16175  00005DD                   .ELSE
16176  00005DD  4C DD 05     	JMP	WAKEUP_CHK_MODE
16177  00005E0                   





16178  00005E0                   .ENDIF
16179  00005E0                   MODE_SWITCH:
16180  00005E0  4C DD 05     	JMP	WAKEUP_CHK_MODE
16181  00005E3                   ;========================================
16182  00005E3                   PWON_CHK_MODE:
16183  00005E3                   .IF ( C_MODESWITCH_CHK_EN .EQ. 1 )
16184  00005E3                   	MR_SET_AUTOCNT2
16185  00005E3                   ; check mode switch status
16186  00005E3                   	LDA	#B_S_KEY1
16187  00005E3                   	BIT	R_S_KEY1_STATUS
16188  00005E3                   	BNE	PWON_CHK_MODE_S10
16189  00005E3                   
16190  00005E3                   	JMP	M0_PRE ; goto mode0
16191  00005E3                   PWON_CHK_MODE_S10:
16192  00005E3                   
16193  00005E3                   	JMP	M1_PRE ; goto mode1
16194  00005E3                   .ELSE
16195  00005E3  4C F6 05     	JMP	M0_PRE ; goto mode0
16196  00005E6                   
16197  00005E6                   .ENDIF
16198  00005E6                   ;=======================================
16199  00005E6                   ;=======================================
16200  00005E6                   
16201  00005E6                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\MODE0_USER_PCC.ASM.APP"
16202  00005E6                   
16203  00005E6                   
16204  00005E6                   ;==================================================
16205  00005E6                   ;note:
16206  00005E6                   ;	JMP	PWOFF_LOOP_WAITSP
16207  00005E6                   ;	MR_SET_AUTOCNT1_1B ; --------------- not directly to enter sleep 
16208  00005E6                   
16209  00005E6                   ;==================================================
16210  00005E6                   
16211  00005E6                   ;=========================================
16212  00005E6                   ;		M0
16213  00005E6                   ;=========================================
16214  00005E6                   
16215  00005E6                   C_MODE0_0 EQU 00H ; ;HOLD
16216  00005E6                   C_MODE0_1 EQU 01H ; 
16217  00005E6                   C_MODE0_2 EQU 02H ;
16218  00005E6                   C_MODE0_3 EQU 03H ;
16219  00005E6                   C_MODE0_4 EQU 04H ;
16220  00005E6                   C_MODE0_5 EQU 05H ;
16221  00005E6                   
16222  00005E6                   
16223  00005E6                   ;=========================================
16224  00005E6                   M0_WAKEUP:
16225  00005E6                   
16226  00005E6                   	MR_SET_DLYCNT0 CNT_STOP
16227  00005E6  A9 00			LDA	#.LOW.CNT_STOP
16228  00005E8  8D 00 00     	STA	WB_DLYCNT0
16229  00005EB  A9 00			LDA	#.HIGH.CNT_STOP
16230  00005ED  8D 01 00     	STA	WB_DLYCNT0+1
16231  00005F0  A9 01			LDA	#C_CNT0_BIT
16232  00005F2  14 04			TRB	<USER_FLAG_B
16233  00005F4                   	;ENDM
16234  00005F4                   





16235  00005F4  80 0E			BRA	M0_PRE2
16236  00005F6                   M0_PRE:
16237  00005F6                   
16238  00005F6                   	MR_SET_DLYCNT0 CNT_STOP
16239  00005F6  A9 00			LDA	#.LOW.CNT_STOP
16240  00005F8  8D 00 00     	STA	WB_DLYCNT0
16241  00005FB  A9 00			LDA	#.HIGH.CNT_STOP
16242  00005FD  8D 01 00     	STA	WB_DLYCNT0+1
16243  0000600  A9 01			LDA	#C_CNT0_BIT
16244  0000602  14 04			TRB	<USER_FLAG_B
16245  0000604                   	;ENDM
16246  0000604                   ;===================================
16247  0000604                   M0_PRE_PCC:
16248  0000604                   
16249  0000604                   
16250  0000604                   ;===================================
16251  0000604                   
16252  0000604                   
16253  0000604                   M0_PRE2:
16254  0000604                   
16255  0000604                   
16256  0000604                   	MR_SET_MODE_NO C_MODE0_0
16257  0000604  A9 00			LDA	#C_MODE0_0
16258  0000606  85 0D			STA	<SYS_MODE_NO
16259  0000608                   	;ENDM
16260  0000608                   ;
16261  0000608                   ;--------------------------------------------
16262  0000608                   M0:
16263  0000608                   
16264  0000608  20 39 01     	JSR WAITKEY
16265  000060B                   
16266  000060B                   ;==========================================
16267  000060B                   M0_CHK_USER_FLAG:
16268  000060B  AD 03 00     	LDA	USER_FLAG_A
16269  000060E  89 10			BIT	#C_KEYCH0_BIT
16270  0000610  D0 2C			BNE	M0S0_KEYCH0_J1
16271  0000612  89 20			BIT	#C_KEYCH1_BIT
16272  0000614  D0 2B			BNE	M0S0_KEYCH1_J1
16273  0000616  89 40			BIT	#C_KEYCH2_BIT
16274  0000618  D0 2A			BNE	M0S0_KEYCH2_J1
16275  000061A  89 80			BIT	#C_KEYCH3_BIT
16276  000061C  D0 29			BNE	M0S0_KEYCH3_J1
16277  000061E  89 01			BIT	#C_SPCH1_BIT
16278  0000620  D0 2E			BNE	M0S0_CH1END
16279  0000622  89 02			BIT	#C_SPCH2_BIT
16280  0000624  D0 15			BNE	M0S0_CH2END_J1
16281  0000626                   
16282  0000626  AD 04 00     	LDA	USER_FLAG_B
16283  0000629  89 01			BIT	#C_CNT0_BIT
16284  000062B  D0 1D			BNE	M0S0_CNT0_J1
16285  000062D  89 02			BIT	#C_CNT1_BIT
16286  000062F  D0 1C			BNE	M0S0_CNT1_J1
16287  0000631  89 80			BIT	#C_AUTO_CNT_BIT
16288  0000633  D0 03			BNE	M0S0_AUTOCNT_J1
16289  0000635                   
16290  0000635  4C 08 06     	JMP	M0
16291  0000638                   





16292  0000638                   M0S0_AUTOCNT_J1
16293  0000638  4C 71 06     	JMP	M0S0_AUTOCNT
16294  000063B                   
16295  000063B                   M0S0_CH2END_J1:
16296  000063B  4C 58 06     	JMP	M0S0_CH2END
16297  000063E                   M0S0_KEYCH0_J1:
16298  000063E  4C AB 06     	JMP	M0S0_KEYCH0
16299  0000641                   M0S0_KEYCH1_J1:
16300  0000641  4C A3 06     	JMP	M0S0_KEYCH1
16301  0000644                   M0S0_KEYCH2_J1:
16302  0000644  4C 9B 06     	JMP	M0S0_KEYCH2
16303  0000647                   M0S0_KEYCH3_J1:
16304  0000647  4C 93 06     	JMP	M0S0_KEYCH3
16305  000064A                   
16306  000064A                   
16307  000064A                   M0S0_CNT0_J1:
16308  000064A  4C B0 06     	JMP	M0S0_CNT0
16309  000064D                   M0S0_CNT1_J1		
16310  000064D  4C B7 06     	JMP	M0S0_CNT1
16311  0000650                   
16312  0000650                   M0S0_CH1END:
16313  0000650                   	MACRO_CLR_CH1_FLAG
16314  0000650  A9 01			LDA	#C_SPCH1_BIT
16315  0000652  1C 03 00     	TRB	USER_FLAG_A
16316  0000655                   	;ENDM
16317  0000655                   
16318  0000655                   M0S0_CH1END_PCC:
16319  0000655                   
16320  0000655                   
16321  0000655  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16322  0000658                   
16323  0000658                   M0S0_CH2END:
16324  0000658                   	MACRO_CLR_CH2_FLAG
16325  0000658  A9 02			LDA	#C_SPCH2_BIT
16326  000065A  1C 03 00     	TRB	USER_FLAG_A
16327  000065D                   	;ENDM
16328  000065D                   
16329  000065D  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16330  0000660                   
16331  0000660                   M0S0_AUTOCNT_S20:
16332  0000660                   
16333  0000660                   	MR_SET_AUTOCNT1
16334  0000660                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
16335  0000660                   	MR_SET_AUTOCNT_1B T0001S_21
16336  0000660                   .ENDIF
16337  0000660                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
16338  0000660                   	MR_SET_AUTOCNT_2B T0001S_21
16339  0000660  A9 D1			LDA	#.LOW.T0001S_21
16340  0000662  8D 13 00     	STA	WB_AUTOCNT0
16341  0000665  A9 FF			LDA	#.HIGH.T0001S_21
16342  0000667  8D 14 00     	STA	WB_AUTOCNT01
16343  000066A  A9 80			LDA	#C_AUTO_CNT_BIT
16344  000066C  14 04			TRB	<USER_FLAG_B
16345  000066E                   	;ENDM
16346  000066E                   .ENDIF
16347  000066E                   	;ENDM
16348  000066E                   





16349  000066E  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16350  0000671                   
16351  0000671                   M0S0_AUTOCNT:
16352  0000671                   	MACRO_CLR_AUTOCNT_FLAG
16353  0000671  A9 80			LDA	#C_AUTO_CNT_BIT
16354  0000673  14 04			TRB	<USER_FLAG_B
16355  0000675                   	;ENDM
16356  0000675                   
16357  0000675                   M0S0_AUTOCNT_PCC:
16358  0000675                   
16359  0000675                   
16360  0000675                   
16361  0000675                   .IFDEF  C_CHKSKEY_EN
16362  0000675                   .IF ( C_S_KEY1_ENABLE .EQ. 1)
16363  0000675  AD 15 00     	LDA	R_S_KEY1_DEBOUNCE
16364  0000678  D0 E6			BNE	M0S0_AUTOCNT_S20
16365  000067A                   .ENDIF
16366  000067A                   .IF ( C_S_KEY2_ENABLE .EQ. 1)
16367  000067A  AD 16 00     	LDA	R_S_KEY2_DEBOUNCE
16368  000067D  D0 E1			BNE	M0S0_AUTOCNT_S20
16369  000067F                   .ENDIF
16370  000067F                   .IF ( C_S_KEY3_ENABLE .EQ. 1)
16371  000067F                   	LDA	R_S_KEY3_DEBOUNCE
16372  000067F                   	BNE	M0S0_AUTOCNT_S20
16373  000067F                   .ENDIF
16374  000067F                   .IF ( C_S_KEY4_ENABLE .EQ. 1)
16375  000067F                   	LDA	R_S_KEY4_DEBOUNCE
16376  000067F                   	BNE	M0S0_AUTOCNT_S20
16377  000067F                   .ENDIF
16378  000067F                   .IF ( C_S_KEY5_ENABLE .EQ. 1)
16379  000067F                   	LDA	R_S_KEY5_DEBOUNCE
16380  000067F                   	BNE	M0S0_AUTOCNT_S20
16381  000067F                   .ENDIF
16382  000067F                   .IF ( C_S_KEY6_ENABLE .EQ. 1)
16383  000067F                   	LDA	R_S_KEY6_DEBOUNCE
16384  000067F                   	BNE	M0S0_AUTOCNT_S20
16385  000067F                   .ENDIF
16386  000067F                   .IF ( C_S_KEY7_ENABLE .EQ. 1)
16387  000067F                   	LDA	R_S_KEY7_DEBOUNCE
16388  000067F                   	BNE	M0S0_AUTOCNT_S20
16389  000067F                   .ENDIF
16390  000067F                   .IF ( C_S_KEY8_ENABLE .EQ. 1)
16391  000067F                   	LDA	R_S_KEY8_DEBOUNCE
16392  000067F                   	BNE	M0S0_AUTOCNT_S20
16393  000067F                   .ENDIF
16394  000067F                   .IF ( C_S_KEY9_ENABLE .EQ. 1)
16395  000067F                   	LDA	R_S_KEY9_DEBOUNCE
16396  000067F                   	BNE	M0S0_AUTOCNT_S20
16397  000067F                   .ENDIF
16398  000067F                   .IF ( C_S_KEY10_ENABLE .EQ. 1)
16399  000067F                   	LDA	R_S_KEY10_DEBOUNCE
16400  000067F                   	BNE	M0S0_AUTOCNT_S10
16401  000067F                   .ENDIF
16402  000067F                   .IF ( C_S_KEY11_ENABLE .EQ. 1)
16403  000067F                   	LDA	R_S_KEY11_DEBOUNCE
16404  000067F                   	BNE	M0S0_AUTOCNT_S10
16405  000067F                   .ENDIF





16406  000067F                   .IF ( C_S_KEY12_ENABLE .EQ. 1)
16407  000067F                   	LDA	R_S_KEY12_DEBOUNCE
16408  000067F                   	BNE	M0S0_AUTOCNT_S10
16409  000067F                   .ENDIF
16410  000067F                   .IF ( C_S_KEY13_ENABLE .EQ. 1)
16411  000067F                   	LDA	R_S_KEY13_DEBOUNCE
16412  000067F                   	BNE	M0S0_AUTOCNT_S10
16413  000067F                   .ENDIF
16414  000067F                   .IF ( C_S_KEY14_ENABLE .EQ. 1)
16415  000067F                   	LDA	R_S_KEY14_DEBOUNCE
16416  000067F                   	BNE	M0S0_AUTOCNT_S10
16417  000067F                   .ENDIF
16418  000067F                   .IF ( C_S_KEY15_ENABLE .EQ. 1)
16419  000067F                   	LDA	R_S_KEY15_DEBOUNCE
16420  000067F                   	BNE	M0S0_AUTOCNT_S10
16421  000067F                   .ENDIF
16422  000067F                   .IF ( C_S_KEY16_ENABLE .EQ. 1)
16423  000067F                   	LDA	R_S_KEY16_DEBOUNCE
16424  000067F                   	BNE	M0S0_AUTOCNT_S10
16425  000067F                   .ENDIF
16426  000067F                   .IF ( C_S_KEY17_ENABLE .EQ. 1)
16427  000067F                   	LDA	R_S_KEY17_DEBOUNCE
16428  000067F                   	BNE	M0S0_AUTOCNT_S10
16429  000067F                   .ENDIF
16430  000067F                   .IF ( C_S_KEY18_ENABLE .EQ. 1)
16431  000067F                   	LDA	R_S_KEY18_DEBOUNCE
16432  000067F                   	BNE	M0S0_AUTOCNT_S10
16433  000067F                   .ENDIF
16434  000067F                   .IF ( C_S_KEY19_ENABLE .EQ. 1)
16435  000067F                   	LDA	R_S_KEY19_DEBOUNCE
16436  000067F                   	BNE	M0S0_AUTOCNT_S10
16437  000067F                   .ENDIF
16438  000067F                   .IF ( C_S_KEY20_ENABLE .EQ. 1)
16439  000067F                   	LDA	R_S_KEY20_DEBOUNCE
16440  000067F                   	BNE	M0S0_AUTOCNT_S10
16441  000067F                   .ENDIF
16442  000067F                   .IF ( C_S_KEY21_ENABLE .EQ. 1)
16443  000067F                   	LDA	R_S_KEY21_DEBOUNCE
16444  000067F                   	BNE	M0S0_AUTOCNT_S10
16445  000067F                   .ENDIF
16446  000067F                   .IF ( C_S_KEY22_ENABLE .EQ. 1)
16447  000067F                   	LDA	R_S_KEY22_DEBOUNCE
16448  000067F                   	BNE	M0S0_AUTOCNT_S10
16449  000067F                   .ENDIF
16450  000067F                   .IF ( C_S_KEY23_ENABLE .EQ. 1)
16451  000067F                   	LDA	R_S_KEY23_DEBOUNCE
16452  000067F                   	BNE	M0S0_AUTOCNT_S10
16453  000067F                   .ENDIF
16454  000067F                   .IF ( C_S_KEY24_ENABLE .EQ. 1)
16455  000067F                   	LDA	R_S_KEY24_DEBOUNCE
16456  000067F                   	BNE	M0S0_AUTOCNT_S10
16457  000067F                   .ENDIF
16458  000067F                   .ENDIF
16459  000067F                   
16460  000067F                   .IFDEF C_CHK1KEY_EN
16461  000067F                   	JSR	BK0_DET_CHK1KEY
16462  000067F                   	BNE	M0S0_AUTOCNT_S10





16463  000067F                   .ENDIF
16464  000067F                   
16465  000067F                   .IFDEF C_CHKMKEY_EN
16466  000067F                   	JSR	BK0_DET_CHKMKEY
16467  000067F                   	BNE	M0S0_AUTOCNT_S10
16468  000067F                   .ENDIF
16469  000067F                   
16470  000067F  4C 92 03     	JMP	PWOFF_LOOP_WAITSP
16471  0000682                   
16472  0000682                   M0S0_AUTOCNT_S10:
16473  0000682                   
16474  0000682                   	MR_SET_AUTOCNT1
16475  0000682                   .IF ( C_AUTOSLEEP_1B .EQ. 1 )
16476  0000682                   	MR_SET_AUTOCNT_1B T0001S_21
16477  0000682                   .ENDIF
16478  0000682                   .IF ( C_AUTOSLEEP_2B .EQ. 1 )
16479  0000682                   	MR_SET_AUTOCNT_2B T0001S_21
16480  0000682  A9 D1			LDA	#.LOW.T0001S_21
16481  0000684  8D 13 00     	STA	WB_AUTOCNT0
16482  0000687  A9 FF			LDA	#.HIGH.T0001S_21
16483  0000689  8D 14 00     	STA	WB_AUTOCNT01
16484  000068C  A9 80			LDA	#C_AUTO_CNT_BIT
16485  000068E  14 04			TRB	<USER_FLAG_B
16486  0000690                   	;ENDM
16487  0000690                   .ENDIF
16488  0000690                   	;ENDM
16489  0000690                   
16490  0000690  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16491  0000693                   M0S0_KEYCH3:
16492  0000693                   	MACRO_CLR_KEYCH3_FLAG
16493  0000693  A9 80			LDA	#C_KEYCH3_BIT
16494  0000695  1C 03 00     	TRB	USER_FLAG_A
16495  0000698                   	;ENDM
16496  0000698                   
16497  0000698                   
16498  0000698  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16499  000069B                   
16500  000069B                   M0S0_KEYCH2:
16501  000069B                   	MACRO_CLR_KEYCH2_FLAG
16502  000069B  A9 40			LDA	#C_KEYCH2_BIT
16503  000069D  1C 03 00     	TRB	USER_FLAG_A
16504  00006A0                   	;ENDM
16505  00006A0                   
16506  00006A0                   
16507  00006A0  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16508  00006A3                   
16509  00006A3                   M0S0_KEYCH1:
16510  00006A3                   	MACRO_CLR_KEYCH1_FLAG
16511  00006A3  A9 20			LDA	#C_KEYCH1_BIT
16512  00006A5  1C 03 00     	TRB	USER_FLAG_A
16513  00006A8                   	;ENDM
16514  00006A8                   
16515  00006A8                   ;
16516  00006A8                   
16517  00006A8  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16518  00006AB                   
16519  00006AB                   M0S0_KEYCH0:





16520  00006AB                   ; key channel 0
16521  00006AB                   	MACRO_CLR_KEYCH0_FLAG
16522  00006AB  A9 10			LDA	#C_KEYCH0_BIT
16523  00006AD  1C 03 00     	TRB	USER_FLAG_A
16524  00006B0                   	;ENDM
16525  00006B0                   
16526  00006B0                   M0S0_KEYCH0_PCC:
16527  00006B0                   ;------------------------------------------------------
16528  00006B0                   
16529  00006B0                   M0S0_CNT0:
16530  00006B0                   	MACRO_CLR_CNT0_FLAG
16531  00006B0  A9 01			LDA	#C_BIT0
16532  00006B2  14 04			TRB	<USER_FLAG_B
16533  00006B4                   	;ENDM
16534  00006B4                   
16535  00006B4                   M0S0_CNT0_PCC:
16536  00006B4                   
16537  00006B4                   
16538  00006B4  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16539  00006B7                   
16540  00006B7                   M0S0_CNT1:
16541  00006B7                   	MACRO_CLR_CNT1_FLAG
16542  00006B7  A9 02			LDA	#C_BIT1
16543  00006B9  14 04			TRB	<USER_FLAG_B
16544  00006BB                   	;ENDM
16545  00006BB  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16546  00006BE                   ;-----------------------------------------------------
16547  00006BE                   
16548  00006BE                   M0S0_KEYCH0_TBL:
16549  00006BE  D006            	DW	M0S0_KEYCH0_0
16550  00006C0  D006            	DW	M0S0_KEYCH0_1
16551  00006C2  D006            	DW	M0S0_KEYCH0_2
16552  00006C4  D006            	DW	M0S0_KEYCH0_3
16553  00006C6  D006            	DW	M0S0_KEYCH0_4
16554  00006C8  D006            	DW	M0S0_KEYCH0_5
16555  00006CA  D006            	DW	M0S0_KEYCH0_6
16556  00006CC  D006            	DW	M0S0_KEYCH0_7
16557  00006CE  D006            	DW	M0S0_KEYCH0_8
16558  00006D0                   
16559  00006D0                   
16560  00006D0                   M0S0_KEYCH0_0:
16561  00006D0                   M0S0_KEYCH0_1:
16562  00006D0                   M0S0_KEYCH0_2:
16563  00006D0                   M0S0_KEYCH0_3:
16564  00006D0                   M0S0_KEYCH0_4:
16565  00006D0                   M0S0_KEYCH0_5:
16566  00006D0                   M0S0_KEYCH0_6:
16567  00006D0                   M0S0_KEYCH0_7:
16568  00006D0                   M0S0_KEYCH0_8:
16569  00006D0                   
16570  00006D0  4C 0B 06     	JMP	M0_CHK_USER_FLAG
16571  00006D3                   
16572  00006D3                   ;=====================================
16573  00006D3                   ;	SUBROUTINE,TABLE
16574  00006D3                   ;=======================================
16575  00006D3                   T_LED_FSH1_TBL:
16576  00006D3  7E              	DB	01111110B





16577  00006D4  7D              	DB	01111101B
16578  00006D5  7B              	DB	01111011B
16579  00006D6  77              	DB	01110111B
16580  00006D7  6F              	DB	01101111B
16581  00006D8  5F              	DB	01011111B
16582  00006D9  3F              	DB	00111111B
16583  00006DA  00              	DB	00H
16584  00006DB                   
16585  00006DB                   
16586  00006DB                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\CHKSKEY_PG.ASM.APP"
16587  00006DB                   
16588  00006DB                   
16589  00006DB                   
16590  00006DB                   
16591  00006DB                   
16592  00006DB                   ;-------------------------
16593  00006DB                   ;;------------------- POI
16594  00006DB                   ;-------------------------
16595  00006DB                   
16596  00006DB                   ;===============================
16597  00006DB                   
16598  00006DB                   ;----------------------------------------
16599  00006DB                   
16600  00006DB                   ;//==============================
16601  00006DB                   BK0_SCAN_S_KEY:
16602  00006DB                   ;=================================
16603  00006DB                   ;	¼ì²éµ¥¶ÀÀ­ÏßµÄ°´¼ü
16604  00006DB                   ;=================================
16605  00006DB                   ;check KEY1
16606  00006DB                   CHK_KEY1:
16607  00006DB                   .IF(C_S_KEY1_ENABLE .EQ. 1)
16608  00006DB  A9 01			LDA	#B_S_KEY1
16609  00006DD  2C 02 08     	BIT	!SR_S_KEY1_PORT
16610  00006E0  D0 1B			BNE	CHK_KEY1_HIGH
16611  00006E2                   ;LOW
16612  00006E2  24 00			BIT	<R_S_KEY1_STATUS
16613  00006E4  F0 23			BEQ	CHK_KEY1_QUIT
16614  00006E6                   ;FALL
16615  00006E6                   
16616  00006E6  A5 15			LDA	<R_S_KEY1_DEBOUNCE
16617  00006E8  F0 0D			BEQ	CHK_KEY1_LOW_S10
16618  00006EA  E6 15			INC	<R_S_KEY1_DEBOUNCE
16619  00006EC  D0 1B			BNE	CHK_KEY1_QUIT
16620  00006EE                   ;GET KEY
16621  00006EE  A9 01			LDA	#B_S_KEY1
16622  00006F0  14 00			TRB	<R_S_KEY1_STATUS
16623  00006F2                   
16624  00006F2  4C 38 07     	JMP	S_KEY1_F
16625  00006F5                   
16626  00006F5                   S_KEY1_F_RET:
16627  00006F5  80 12			BRA	CHK_KEY1_QUIT
16628  00006F7                   
16629  00006F7                   CHK_KEY1_LOW_S10:
16630  00006F7  A9 F9			LDA	#C_S_KEY1_DEBOUNCE ; -DEBOUNCE * 5.33MS
16631  00006F9  85 15			STA	<R_S_KEY1_DEBOUNCE
16632  00006FB  80 0C			BRA	CHK_KEY1_QUIT
16633  00006FD                   CHK_KEY1_HIGH:





16634  00006FD  9C 15 00     	STZ	R_S_KEY1_DEBOUNCE
16635  0000700  24 00			BIT	<R_S_KEY1_STATUS
16636  0000702  D0 05			BNE	CHK_KEY1_QUIT
16637  0000704  04 00			TSB	<R_S_KEY1_STATUS
16638  0000706                   
16639  0000706  4C 3B 07     	JMP	S_KEY1_R
16640  0000709                   
16641  0000709                   S_KEY1_R_RET:
16642  0000709                   CHK_KEY1_QUIT:
16643  0000709                   .ENDIF
16644  0000709                   .IF(C_S_KEY2_ENABLE .EQ. 1)
16645  0000709                   ;check KEY2 ; TUMMY
16646  0000709                   CHK_KEY2:
16647  0000709  A9 02			LDA	#B_S_KEY2
16648  000070B  2C 02 08     	BIT	!SR_S_KEY2_PORT
16649  000070E  D0 1B			BNE	CHK_KEY2_HIGH
16650  0000710                   ;LOW
16651  0000710  24 00			BIT	<R_S_KEY2_STATUS
16652  0000712  F0 23			BEQ	CHK_KEY2_QUIT
16653  0000714                   
16654  0000714                   ;FALL
16655  0000714                   
16656  0000714  A5 16			LDA	<R_S_KEY2_DEBOUNCE
16657  0000716  F0 0D			BEQ	CHK_KEY2_LOW_S10
16658  0000718  E6 16			INC	<R_S_KEY2_DEBOUNCE
16659  000071A  D0 1B			BNE	CHK_KEY2_QUIT
16660  000071C                   ;GET KEY
16661  000071C  A9 02			LDA	#B_S_KEY2
16662  000071E  14 00			TRB	<R_S_KEY2_STATUS
16663  0000720                   
16664  0000720  4C 3E 07     	JMP	S_KEY2_F
16665  0000723                   S_KEY2_F_RET:
16666  0000723  80 12			BRA	CHK_KEY2_QUIT
16667  0000725                   CHK_KEY2_LOW_S10:
16668  0000725  A9 F9			LDA	#C_S_KEY2_DEBOUNCE ; -DEBOUNCE * 5.33MS
16669  0000727  85 16			STA	<R_S_KEY2_DEBOUNCE
16670  0000729  80 0C			BRA	CHK_KEY2_QUIT
16671  000072B                   CHK_KEY2_HIGH:
16672  000072B  9C 16 00     	STZ	R_S_KEY2_DEBOUNCE
16673  000072E  24 00			BIT	<R_S_KEY2_STATUS
16674  0000730  D0 05			BNE	CHK_KEY2_QUIT
16675  0000732  04 00			TSB	<R_S_KEY2_STATUS
16676  0000734                   
16677  0000734  4C 41 07     	JMP	S_KEY2_R
16678  0000737                   
16679  0000737                   S_KEY2_R_RET:
16680  0000737                   CHK_KEY2_QUIT:
16681  0000737                   .ENDIF
16682  0000737                   .IF(C_S_KEY3_ENABLE .EQ. 1)
16683  0000737                   ;check KEY3; MOUTH; LEFT SWITCH
16684  0000737                   CHK_KEY3:
16685  0000737                   	LDA	#B_S_KEY3
16686  0000737                   	BIT	SR_S_KEY3_PORT
16687  0000737                   	BNE	CHK_KEY3_HIGH
16688  0000737                   ;LOW
16689  0000737                   
16690  0000737                   	BIT	<R_S_KEY3_STATUS





16691  0000737                   	BEQ	CHK_KEY3_QUIT
16692  0000737                   
16693  0000737                   ;FALL
16694  0000737                   
16695  0000737                   	LDA	<R_S_KEY3_DEBOUNCE
16696  0000737                   	BEQ	CHK_KEY3_LOW_S10
16697  0000737                   	INC	<R_S_KEY3_DEBOUNCE
16698  0000737                   	BNE	CHK_KEY3_QUIT
16699  0000737                   ;GET KEY
16700  0000737                   	LDA	#B_S_KEY3
16701  0000737                   	TRB	<R_S_KEY3_STATUS
16702  0000737                   
16703  0000737                   	JMP	S_KEY3_F
16704  0000737                   S_KEY3_F_RET:
16705  0000737                   	BRA	CHK_KEY3_QUIT
16706  0000737                   
16707  0000737                   CHK_KEY3_LOW_S10:
16708  0000737                   	LDA	#C_S_KEY3_DEBOUNCE ; -DEBOUNCE * 5.33MS
16709  0000737                   	STA	<R_S_KEY3_DEBOUNCE
16710  0000737                   	BRA	CHK_KEY3_QUIT
16711  0000737                   CHK_KEY3_HIGH:
16712  0000737                   	STZ	R_S_KEY3_DEBOUNCE
16713  0000737                   
16714  0000737                   	BIT	<R_S_KEY3_STATUS
16715  0000737                   	BNE	CHK_KEY3_QUIT
16716  0000737                   
16717  0000737                   ;GET HIGH
16718  0000737                   
16719  0000737                   	LDA	#B_S_KEY3
16720  0000737                   	TSB	<R_S_KEY3_STATUS
16721  0000737                   
16722  0000737                   	JMP	S_KEY3_R
16723  0000737                   
16724  0000737                   S_KEY3_R_RET:
16725  0000737                   CHK_KEY3_QUIT:
16726  0000737                   .ENDIF
16727  0000737                   .IF(C_S_KEY4_ENABLE .EQ. 1)
16728  0000737                   ;check KEY4 ; BODY; BALL SWITCH
16729  0000737                   CHK_KEY4:
16730  0000737                   	LDA	#B_S_KEY4
16731  0000737                   	BIT	!SR_S_KEY4_PORT
16732  0000737                   	BNE	CHK_KEY4_HIGH
16733  0000737                   ;LOW
16734  0000737                   	BIT	<R_S_KEY4_STATUS
16735  0000737                   	BEQ	CHK_KEY4_QUIT
16736  0000737                   
16737  0000737                   ;FALL
16738  0000737                   
16739  0000737                   	LDA	<R_S_KEY4_DEBOUNCE
16740  0000737                   	BEQ	CHK_KEY4_LOW_S10
16741  0000737                   	INC	<R_S_KEY4_DEBOUNCE
16742  0000737                   	BNE	CHK_KEY4_QUIT
16743  0000737                   ;GET KEY
16744  0000737                   	LDA	#B_S_KEY4
16745  0000737                   	TRB	<R_S_KEY4_STATUS
16746  0000737                   
16747  0000737                   	JMP	S_KEY4_F





16748  0000737                   S_KEY4_F_RET:
16749  0000737                   	BRA	CHK_KEY4_QUIT
16750  0000737                   
16751  0000737                   CHK_KEY4_LOW_S10:
16752  0000737                   	LDA	#C_S_KEY4_DEBOUNCE ; -DEBOUNCE * 5.33MS
16753  0000737                   	STA	<R_S_KEY4_DEBOUNCE
16754  0000737                   	BRA	CHK_KEY4_QUIT
16755  0000737                   CHK_KEY4_HIGH:
16756  0000737                   	STZ	R_S_KEY4_DEBOUNCE
16757  0000737                   	BIT	<R_S_KEY4_STATUS
16758  0000737                   	BNE	CHK_KEY4_QUIT
16759  0000737                   	TSB	<R_S_KEY4_STATUS
16760  0000737                   
16761  0000737                   	JMP	S_KEY4_R
16762  0000737                   
16763  0000737                   S_KEY4_R_RET:
16764  0000737                   CHK_KEY4_QUIT:
16765  0000737                   .ENDIF
16766  0000737                   .IF(C_S_KEY5_ENABLE .EQ. 1)
16767  0000737                   ;check KEY5 ;  LVD; LOW :< 4.0V
16768  0000737                   CHK_KEY5:
16769  0000737                   	LDA	#B_S_KEY5
16770  0000737                   	BIT	!SR_S_KEY5_PORT
16771  0000737                   	BNE	CHK_KEY5_HIGH
16772  0000737                   ;LOW
16773  0000737                   	BIT	<R_S_KEY5_STATUS
16774  0000737                   	BEQ	CHK_KEY5_QUIT
16775  0000737                   
16776  0000737                   ;FALL
16777  0000737                   
16778  0000737                   	LDA	<R_S_KEY5_DEBOUNCE
16779  0000737                   	BEQ	CHK_KEY5_LOW_S10
16780  0000737                   	INC	<R_S_KEY5_DEBOUNCE
16781  0000737                   	BNE	CHK_KEY5_QUIT
16782  0000737                   ;GET KEY
16783  0000737                   	LDA	#B_S_KEY5
16784  0000737                   	TRB	<R_S_KEY5_STATUS
16785  0000737                   
16786  0000737                   	JMP	S_KEY5_F
16787  0000737                   S_KEY5_F_RET:
16788  0000737                   	BRA	CHK_KEY5_QUIT
16789  0000737                   
16790  0000737                   CHK_KEY5_LOW_S10:
16791  0000737                   	LDA	#C_S_KEY5_DEBOUNCE ; -DEBOUNCE * 5.33MS
16792  0000737                   	STA	<R_S_KEY5_DEBOUNCE
16793  0000737                   	BRA	CHK_KEY5_QUIT
16794  0000737                   CHK_KEY5_HIGH:
16795  0000737                   	STZ	R_S_KEY5_DEBOUNCE
16796  0000737                   	BIT	<R_S_KEY5_STATUS
16797  0000737                   	BNE	CHK_KEY5_QUIT
16798  0000737                   	TSB	<R_S_KEY5_STATUS
16799  0000737                   
16800  0000737                   	JMP	S_KEY5_R
16801  0000737                   
16802  0000737                   S_KEY5_R_RET:
16803  0000737                   CHK_KEY5_QUIT:
16804  0000737                   .ENDIF





16805  0000737                   .IF(C_S_KEY6_ENABLE .EQ. 1)
16806  0000737                   ;check KEY6; DOLL/RPOTTY
16807  0000737                   CHK_KEY6:
16808  0000737                   	LDA	#B_S_KEY6
16809  0000737                   	BIT	!SR_S_KEY6_PORT
16810  0000737                   	BNE	CHK_KEY6_HIGH
16811  0000737                   ;LOW
16812  0000737                   	BIT	<R_S_KEY6_STATUS
16813  0000737                   	BEQ	CHK_KEY6_QUIT
16814  0000737                   
16815  0000737                   ;FALL
16816  0000737                   
16817  0000737                   	LDA	<R_S_KEY6_DEBOUNCE
16818  0000737                   	BEQ	CHK_KEY6_LOW_S10
16819  0000737                   	INC	<R_S_KEY6_DEBOUNCE
16820  0000737                   	BNE	CHK_KEY6_QUIT
16821  0000737                   ;GET KEY
16822  0000737                   	LDA	#B_S_KEY6
16823  0000737                   	TRB	<R_S_KEY6_STATUS
16824  0000737                   
16825  0000737                   	JMP	S_KEY6_F
16826  0000737                   S_KEY6_F_RET:
16827  0000737                   	BRA	CHK_KEY6_QUIT
16828  0000737                   
16829  0000737                   CHK_KEY6_LOW_S10:
16830  0000737                   	LDA	#C_S_KEY6_DEBOUNCE ; -DEBOUNCE * 5.33MS
16831  0000737                   	STA	<R_S_KEY6_DEBOUNCE
16832  0000737                   	BRA	CHK_KEY6_QUIT
16833  0000737                   CHK_KEY6_HIGH:
16834  0000737                   	STZ	R_S_KEY6_DEBOUNCE
16835  0000737                   	BIT	<R_S_KEY6_STATUS
16836  0000737                   	BNE	CHK_KEY6_QUIT
16837  0000737                   
16838  0000737                   	LDA	#B_S_KEY6
16839  0000737                   	TSB	<R_S_KEY6_STATUS
16840  0000737                   
16841  0000737                   	JMP	S_KEY6_R
16842  0000737                   
16843  0000737                   S_KEY6_R_RET:
16844  0000737                   CHK_KEY6_QUIT:
16845  0000737                   .ENDIF
16846  0000737                   .IF(C_S_KEY7_ENABLE .EQ. 1)
16847  0000737                   ;check KEY7
16848  0000737                   CHK_KEY7:
16849  0000737                   	LDA	#B_S_KEY7
16850  0000737                   	BIT	!SR_S_KEY7_PORT
16851  0000737                   	BNE	CHK_KEY7_HIGH
16852  0000737                   ;LOW
16853  0000737                   	BIT	<R_S_KEY7_STATUS
16854  0000737                   	BEQ	CHK_KEY7_QUIT
16855  0000737                   
16856  0000737                   ;FALL
16857  0000737                   
16858  0000737                   	LDA	<R_S_KEY7_DEBOUNCE
16859  0000737                   	BEQ	CHK_KEY7_LOW_S10
16860  0000737                   	INC	<R_S_KEY7_DEBOUNCE
16861  0000737                   	BNE	CHK_KEY7_QUIT





16862  0000737                   ;GET KEY
16863  0000737                   	LDA	#B_S_KEY7
16864  0000737                   	TRB	<R_S_KEY7_STATUS
16865  0000737                   
16866  0000737                   	JMP	S_KEY7_F
16867  0000737                   
16868  0000737                   S_KEY7_F_RET:
16869  0000737                   	BRA	CHK_KEY7_QUIT
16870  0000737                   
16871  0000737                   CHK_KEY7_LOW_S10:
16872  0000737                   	LDA	#C_S_KEY7_DEBOUNCE ; -DEBOUNCE * 5.33MS
16873  0000737                   	STA	<R_S_KEY7_DEBOUNCE
16874  0000737                   	BRA	CHK_KEY7_QUIT
16875  0000737                   CHK_KEY7_HIGH:
16876  0000737                   	STZ	R_S_KEY7_DEBOUNCE
16877  0000737                   	BIT	<R_S_KEY7_STATUS
16878  0000737                   	BNE	CHK_KEY7_QUIT
16879  0000737                   	TSB	<R_S_KEY7_STATUS
16880  0000737                   
16881  0000737                   	JMP	S_KEY7_R
16882  0000737                   
16883  0000737                   S_KEY7_R_RET:
16884  0000737                   CHK_KEY7_QUIT:
16885  0000737                   .ENDIF
16886  0000737                   
16887  0000737                   .IF(C_S_KEY8_ENABLE .EQ. 1)
16888  0000737                   ;check KEY8
16889  0000737                   CHK_KEY8:
16890  0000737                   	LDA	#B_S_KEY8
16891  0000737                   	BIT	!SR_S_KEY8_PORT
16892  0000737                   	BNE	CHK_KEY8_HIGH
16893  0000737                   ;LOW
16894  0000737                   	BIT	<R_S_KEY8_STATUS
16895  0000737                   	BEQ	CHK_KEY8_QUIT
16896  0000737                   	LDA	<R_S_KEY8_DEBOUNCE
16897  0000737                   	BEQ	CHK_KEY8_LOW_S10
16898  0000737                   	INC	<R_S_KEY8_DEBOUNCE
16899  0000737                   	BNE	CHK_KEY8_QUIT
16900  0000737                   ;GET KEY
16901  0000737                   	LDA	#B_S_KEY8
16902  0000737                   	TRB	<R_S_KEY8_STATUS
16903  0000737                   
16904  0000737                   	JMP	S_KEY8_F
16905  0000737                   
16906  0000737                   S_KEY8_F_RET:
16907  0000737                   	BRA	CHK_KEY8_QUIT
16908  0000737                   
16909  0000737                   CHK_KEY8_LOW_S10:
16910  0000737                   	LDA	#C_S_KEY8_DEBOUNCE ; -DEBOUNCE * 5.33MS
16911  0000737                   	STA	<R_S_KEY8_DEBOUNCE
16912  0000737                   	BRA	CHK_KEY8_QUIT
16913  0000737                   CHK_KEY8_HIGH:
16914  0000737                   	STZ	R_S_KEY8_DEBOUNCE
16915  0000737                   	BIT	<R_S_KEY8_STATUS
16916  0000737                   	BNE	CHK_KEY8_QUIT
16917  0000737                   	TSB	<R_S_KEY8_STATUS
16918  0000737                   





16919  0000737                   	JMP	S_KEY8_R
16920  0000737                   
16921  0000737                   S_KEY8_R_RET:
16922  0000737                   CHK_KEY8_QUIT:
16923  0000737                   .ENDIF
16924  0000737                   .IF(C_S_KEY9_ENABLE .EQ. 1)
16925  0000737                   ;check KEY9
16926  0000737                   CHK_KEY9:
16927  0000737                   	LDA	#B_S_KEY9
16928  0000737                   	BIT	!SR_S_KEY9_PORT
16929  0000737                   	BNE	CHK_KEY9_HIGH
16930  0000737                   ;LOW
16931  0000737                   	BIT	<R_S_KEY9_STATUS
16932  0000737                   	BEQ	CHK_KEY9_QUIT
16933  0000737                   	LDA	<R_S_KEY9_DEBOUNCE
16934  0000737                   	BEQ	CHK_KEY9_LOW_S10
16935  0000737                   	INC	<R_S_KEY9_DEBOUNCE
16936  0000737                   	BNE	CHK_KEY9_QUIT
16937  0000737                   ;GET KEY
16938  0000737                   	LDA	#B_S_KEY9
16939  0000737                   	TRB	<R_S_KEY9_STATUS
16940  0000737                   
16941  0000737                   	JMP	S_KEY9_F
16942  0000737                   
16943  0000737                   S_KEY9_F_RET:
16944  0000737                   	BRA	CHK_KEY9_QUIT
16945  0000737                   CHK_KEY9_LOW_S10:
16946  0000737                   	LDA	#C_S_KEY9_DEBOUNCE ; -DEBOUNCE * 5.33MS
16947  0000737                   	STA	<R_S_KEY9_DEBOUNCE
16948  0000737                   	BRA	CHK_KEY9_QUIT
16949  0000737                   CHK_KEY9_HIGH:
16950  0000737                   	STZ	R_S_KEY9_DEBOUNCE
16951  0000737                   	BIT	<R_S_KEY9_STATUS
16952  0000737                   	BNE	CHK_KEY9_QUIT
16953  0000737                   	TSB	<R_S_KEY9_STATUS
16954  0000737                   
16955  0000737                   	JMP	S_KEY9_R
16956  0000737                   
16957  0000737                   S_KEY9_R_RET:
16958  0000737                   
16959  0000737                   CHK_KEY9_QUIT:
16960  0000737                   .ENDIF
16961  0000737                   .IF(C_S_KEY10_ENABLE .EQ. 1)
16962  0000737                   ;check KEY10
16963  0000737                   CHK_KEY10:
16964  0000737                   	LDA	#B_S_KEY10
16965  0000737                   	BIT	!SR_S_KEY10_PORT
16966  0000737                   	BNE	CHK_KEY10_HIGH
16967  0000737                   ;LOW
16968  0000737                   	BIT	<R_S_KEY10_STATUS
16969  0000737                   	BEQ	CHK_KEY10_QUIT
16970  0000737                   	LDA	<R_S_KEY10_DEBOUNCE
16971  0000737                   	BEQ	CHK_KEY10_LOW_S10
16972  0000737                   	INC	<R_S_KEY10_DEBOUNCE
16973  0000737                   	BNE	CHK_KEY10_QUIT
16974  0000737                   ;GET KEY
16975  0000737                   	LDA	#B_S_KEY10





16976  0000737                   	TRB	<R_S_KEY10_STATUS
16977  0000737                   
16978  0000737                   	JMP	S_KEY10_F
16979  0000737                   
16980  0000737                   S_KEY10_F_RET:
16981  0000737                   	BRA	CHK_KEY10_QUIT
16982  0000737                   CHK_KEY10_LOW_S10:
16983  0000737                   	LDA	#C_S_KEY10_DEBOUNCE ; -DEBOUNCE * 5.33MS
16984  0000737                   	STA	<R_S_KEY10_DEBOUNCE
16985  0000737                   	BRA	CHK_KEY10_QUIT
16986  0000737                   CHK_KEY10_HIGH:
16987  0000737                   	STZ	R_S_KEY10_DEBOUNCE
16988  0000737                   	BIT	<R_S_KEY10_STATUS
16989  0000737                   	BNE	CHK_KEY10_QUIT
16990  0000737                   	TSB	<R_S_KEY10_STATUS
16991  0000737                   
16992  0000737                   	JMP	S_KEY10_R
16993  0000737                   
16994  0000737                   S_KEY10_R_RET:
16995  0000737                   
16996  0000737                   CHK_KEY10_QUIT:
16997  0000737                   .ENDIF
16998  0000737                   .IF(C_S_KEY11_ENABLE .EQ. 1)
16999  0000737                   ;check KEY11
17000  0000737                   CHK_KEY11:
17001  0000737                   	LDA	#B_S_KEY11
17002  0000737                   	BIT	!SR_S_KEY11_PORT
17003  0000737                   	BNE	CHK_KEY11_HIGH
17004  0000737                   ;LOW
17005  0000737                   	BIT	<R_S_KEY11_STATUS
17006  0000737                   	BEQ	CHK_KEY11_QUIT
17007  0000737                   	LDA	<R_S_KEY11_DEBOUNCE
17008  0000737                   	BEQ	CHK_KEY11_LOW_S10
17009  0000737                   	INC	<R_S_KEY11_DEBOUNCE
17010  0000737                   	BNE	CHK_KEY11_QUIT
17011  0000737                   ;GET KEY
17012  0000737                   	LDA	#B_S_KEY11
17013  0000737                   	TRB	<R_S_KEY11_STATUS
17014  0000737                   
17015  0000737                   	JMP	S_KEY11_F
17016  0000737                   
17017  0000737                   S_KEY11_F_RET:
17018  0000737                   	BRA	CHK_KEY11_QUIT
17019  0000737                   CHK_KEY11_LOW_S10:
17020  0000737                   	LDA	#C_S_KEY11_DEBOUNCE ; -DEBOUNCE * 5.33MS
17021  0000737                   	STA	<R_S_KEY11_DEBOUNCE
17022  0000737                   	BRA	CHK_KEY11_QUIT
17023  0000737                   CHK_KEY11_HIGH:
17024  0000737                   	STZ	R_S_KEY11_DEBOUNCE
17025  0000737                   	BIT	<R_S_KEY11_STATUS
17026  0000737                   	BNE	CHK_KEY11_QUIT
17027  0000737                   	TSB	<R_S_KEY11_STATUS
17028  0000737                   
17029  0000737                   	JMP	S_KEY11_R
17030  0000737                   
17031  0000737                   S_KEY11_R_RET:
17032  0000737                   





17033  0000737                   CHK_KEY11_QUIT:
17034  0000737                   .ENDIF
17035  0000737                   .IF(C_S_KEY12_ENABLE .EQ. 1)
17036  0000737                   ;check KEY12
17037  0000737                   CHK_KEY12:
17038  0000737                   	LDA	#B_S_KEY12
17039  0000737                   	BIT	!SR_S_KEY12_PORT
17040  0000737                   	BNE	CHK_KEY12_HIGH
17041  0000737                   ;LOW
17042  0000737                   	BIT	<R_S_KEY12_STATUS
17043  0000737                   	BEQ	CHK_KEY12_QUIT
17044  0000737                   	LDA	<R_S_KEY12_DEBOUNCE
17045  0000737                   	BEQ	CHK_KEY12_LOW_S10
17046  0000737                   	INC	<R_S_KEY12_DEBOUNCE
17047  0000737                   	BNE	CHK_KEY12_QUIT
17048  0000737                   ;GET KEY
17049  0000737                   	LDA	#B_S_KEY12
17050  0000737                   	TRB	<R_S_KEY12_STATUS
17051  0000737                   
17052  0000737                   	JMP	S_KEY12_F
17053  0000737                   
17054  0000737                   S_KEY12_F_RET:
17055  0000737                   	BRA	CHK_KEY12_QUIT
17056  0000737                   CHK_KEY12_LOW_S10:
17057  0000737                   	LDA	#C_S_KEY12_DEBOUNCE ; -DEBOUNCE * 5.33MS
17058  0000737                   	STA	<R_S_KEY12_DEBOUNCE
17059  0000737                   	BRA	CHK_KEY12_QUIT
17060  0000737                   CHK_KEY12_HIGH:
17061  0000737                   	STZ	R_S_KEY12_DEBOUNCE
17062  0000737                   	BIT	<R_S_KEY12_STATUS
17063  0000737                   	BNE	CHK_KEY12_QUIT
17064  0000737                   	TSB	<R_S_KEY12_STATUS
17065  0000737                   
17066  0000737                   	JMP	S_KEY12_R
17067  0000737                   
17068  0000737                   S_KEY12_R_RET:
17069  0000737                   
17070  0000737                   CHK_KEY12_QUIT:
17071  0000737                   .ENDIF
17072  0000737                   .IF(C_S_KEY13_ENABLE .EQ. 1)
17073  0000737                   ;check KEY13
17074  0000737                   CHK_KEY13:
17075  0000737                   	LDA	#B_S_KEY13
17076  0000737                   	BIT	!SR_S_KEY13_PORT
17077  0000737                   	BNE	CHK_KEY13_HIGH
17078  0000737                   ;LOW
17079  0000737                   	BIT	<R_S_KEY13_STATUS
17080  0000737                   	BEQ	CHK_KEY13_QUIT
17081  0000737                   	LDA	<R_S_KEY13_DEBOUNCE
17082  0000737                   	BEQ	CHK_KEY13_LOW_S10
17083  0000737                   	INC	<R_S_KEY13_DEBOUNCE
17084  0000737                   	BNE	CHK_KEY13_QUIT
17085  0000737                   ;GET KEY
17086  0000737                   	LDA	#B_S_KEY13
17087  0000737                   	TRB	<R_S_KEY13_STATUS
17088  0000737                   
17089  0000737                   	JMP	S_KEY13_F





17090  0000737                   
17091  0000737                   S_KEY13_F_RET:
17092  0000737                   	BRA	CHK_KEY13_QUIT
17093  0000737                   CHK_KEY13_LOW_S10:
17094  0000737                   	LDA	#C_S_KEY13_DEBOUNCE ; -DEBOUNCE * 5.33MS
17095  0000737                   	STA	<R_S_KEY13_DEBOUNCE
17096  0000737                   	BRA	CHK_KEY13_QUIT
17097  0000737                   CHK_KEY13_HIGH:
17098  0000737                   	STZ	R_S_KEY13_DEBOUNCE
17099  0000737                   	BIT	<R_S_KEY13_STATUS
17100  0000737                   	BNE	CHK_KEY13_QUIT
17101  0000737                   	TSB	<R_S_KEY13_STATUS
17102  0000737                   
17103  0000737                   	JMP	S_KEY13_R
17104  0000737                   
17105  0000737                   S_KEY13_R_RET:
17106  0000737                   
17107  0000737                   CHK_KEY13_QUIT:
17108  0000737                   .ENDIF
17109  0000737                   .IF(C_S_KEY14_ENABLE .EQ. 1)
17110  0000737                   ;check KEY14
17111  0000737                   CHK_KEY14:
17112  0000737                   	LDA	#B_S_KEY14
17113  0000737                   	BIT	!SR_S_KEY14_PORT
17114  0000737                   	BNE	CHK_KEY14_HIGH
17115  0000737                   ;LOW
17116  0000737                   	BIT	<R_S_KEY14_STATUS
17117  0000737                   	BEQ	CHK_KEY14_QUIT
17118  0000737                   	LDA	<R_S_KEY14_DEBOUNCE
17119  0000737                   	BEQ	CHK_KEY14_LOW_S10
17120  0000737                   	INC	<R_S_KEY14_DEBOUNCE
17121  0000737                   	BNE	CHK_KEY14_QUIT
17122  0000737                   ;GET KEY
17123  0000737                   	LDA	#B_S_KEY14
17124  0000737                   	TRB	<R_S_KEY14_STATUS
17125  0000737                   
17126  0000737                   	JMP	S_KEY14_F
17127  0000737                   
17128  0000737                   S_KEY14_F_RET:
17129  0000737                   	BRA	CHK_KEY14_QUIT
17130  0000737                   CHK_KEY14_LOW_S10:
17131  0000737                   	LDA	#C_S_KEY14_DEBOUNCE ; -DEBOUNCE * 5.33MS
17132  0000737                   	STA	<R_S_KEY14_DEBOUNCE
17133  0000737                   	BRA	CHK_KEY14_QUIT
17134  0000737                   CHK_KEY14_HIGH:
17135  0000737                   	STZ	R_S_KEY14_DEBOUNCE
17136  0000737                   	BIT	<R_S_KEY14_STATUS
17137  0000737                   	BNE	CHK_KEY14_QUIT
17138  0000737                   	TSB	<R_S_KEY14_STATUS
17139  0000737                   
17140  0000737                   	JMP	S_KEY14_R
17141  0000737                   
17142  0000737                   S_KEY14_R_RET:
17143  0000737                   
17144  0000737                   CHK_KEY14_QUIT:
17145  0000737                   .ENDIF
17146  0000737                   .IF(C_S_KEY15_ENABLE .EQ. 1)





17147  0000737                   ;check KEY15
17148  0000737                   CHK_KEY15:
17149  0000737                   	LDA	#B_S_KEY15
17150  0000737                   	BIT	!SR_S_KEY15_PORT
17151  0000737                   	BNE	CHK_KEY15_HIGH
17152  0000737                   ;LOW
17153  0000737                   	BIT	<R_S_KEY15_STATUS
17154  0000737                   	BEQ	CHK_KEY15_QUIT
17155  0000737                   	LDA	<R_S_KEY15_DEBOUNCE
17156  0000737                   	BEQ	CHK_KEY15_LOW_S10
17157  0000737                   	INC	<R_S_KEY15_DEBOUNCE
17158  0000737                   	BNE	CHK_KEY15_QUIT
17159  0000737                   ;GET KEY
17160  0000737                   	LDA	#B_S_KEY15
17161  0000737                   	TRB	<R_S_KEY15_STATUS
17162  0000737                   
17163  0000737                   	JMP	S_KEY15_F
17164  0000737                   
17165  0000737                   S_KEY15_F_RET:
17166  0000737                   	BRA	CHK_KEY15_QUIT
17167  0000737                   CHK_KEY15_LOW_S10:
17168  0000737                   	LDA	#C_S_KEY15_DEBOUNCE ; -DEBOUNCE * 5.33MS
17169  0000737                   	STA	<R_S_KEY15_DEBOUNCE
17170  0000737                   	BRA	CHK_KEY15_QUIT
17171  0000737                   CHK_KEY15_HIGH:
17172  0000737                   	STZ	R_S_KEY15_DEBOUNCE
17173  0000737                   	BIT	<R_S_KEY15_STATUS
17174  0000737                   	BNE	CHK_KEY15_QUIT
17175  0000737                   	TSB	<R_S_KEY15_STATUS
17176  0000737                   
17177  0000737                   	JMP	S_KEY15_R
17178  0000737                   
17179  0000737                   S_KEY15_R_RET:
17180  0000737                   
17181  0000737                   CHK_KEY15_QUIT:
17182  0000737                   .ENDIF
17183  0000737                   .IF(C_S_KEY16_ENABLE .EQ. 1)
17184  0000737                   ;check KEY16
17185  0000737                   CHK_KEY16:
17186  0000737                   	LDA	#B_S_KEY16
17187  0000737                   	BIT	!SR_S_KEY16_PORT
17188  0000737                   	BNE	CHK_KEY16_HIGH
17189  0000737                   ;LOW
17190  0000737                   	BIT	<R_S_KEY16_STATUS
17191  0000737                   	BEQ	CHK_KEY16_QUIT
17192  0000737                   	LDA	<R_S_KEY16_DEBOUNCE
17193  0000737                   	BEQ	CHK_KEY16_LOW_S10
17194  0000737                   	INC	<R_S_KEY16_DEBOUNCE
17195  0000737                   	BNE	CHK_KEY16_QUIT
17196  0000737                   ;GET KEY
17197  0000737                   	LDA	#B_S_KEY16
17198  0000737                   	TRB	<R_S_KEY16_STATUS
17199  0000737                   
17200  0000737                   	JMP	S_KEY16_F
17201  0000737                   
17202  0000737                   S_KEY16_F_RET:
17203  0000737                   	BRA	CHK_KEY16_QUIT





17204  0000737                   CHK_KEY16_LOW_S10:
17205  0000737                   	LDA	#C_S_KEY16_DEBOUNCE ; -DEBOUNCE * 5.33MS
17206  0000737                   	STA	<R_S_KEY16_DEBOUNCE
17207  0000737                   	BRA	CHK_KEY16_QUIT
17208  0000737                   CHK_KEY16_HIGH:
17209  0000737                   	STZ	R_S_KEY16_DEBOUNCE
17210  0000737                   	BIT	<R_S_KEY16_STATUS
17211  0000737                   	BNE	CHK_KEY16_QUIT
17212  0000737                   	TSB	<R_S_KEY16_STATUS
17213  0000737                   
17214  0000737                   	JMP	S_KEY16_R
17215  0000737                   
17216  0000737                   S_KEY16_R_RET:
17217  0000737                   
17218  0000737                   CHK_KEY16_QUIT:
17219  0000737                   .ENDIF
17220  0000737                   .IF(C_S_KEY17_ENABLE .EQ. 1)
17221  0000737                   ;check KEY17
17222  0000737                   CHK_KEY17:
17223  0000737                   	LDA	#B_S_KEY17
17224  0000737                   	BIT	!SR_S_KEY17_PORT
17225  0000737                   	BNE	CHK_KEY17_HIGH
17226  0000737                   ;LOW
17227  0000737                   	BIT	<R_S_KEY17_STATUS
17228  0000737                   	BEQ	CHK_KEY17_QUIT
17229  0000737                   	LDA	<R_S_KEY17_DEBOUNCE
17230  0000737                   	BEQ	CHK_KEY17_LOW_S10
17231  0000737                   	INC	<R_S_KEY17_DEBOUNCE
17232  0000737                   	BNE	CHK_KEY17_QUIT
17233  0000737                   ;GET KEY
17234  0000737                   	LDA	#B_S_KEY17
17235  0000737                   	TRB	<R_S_KEY17_STATUS
17236  0000737                   
17237  0000737                   	JMP	S_KEY17_F
17238  0000737                   
17239  0000737                   S_KEY17_F_RET:
17240  0000737                   	BRA	CHK_KEY17_QUIT
17241  0000737                   CHK_KEY17_LOW_S10:
17242  0000737                   	LDA	#C_S_KEY17_DEBOUNCE ; -DEBOUNCE * 5.33MS
17243  0000737                   	STA	<R_S_KEY17_DEBOUNCE
17244  0000737                   	BRA	CHK_KEY17_QUIT
17245  0000737                   CHK_KEY17_HIGH:
17246  0000737                   	STZ	R_S_KEY17_DEBOUNCE
17247  0000737                   	BIT	<R_S_KEY17_STATUS
17248  0000737                   	BNE	CHK_KEY17_QUIT
17249  0000737                   	TSB	<R_S_KEY17_STATUS
17250  0000737                   
17251  0000737                   	JMP	S_KEY17_R
17252  0000737                   
17253  0000737                   S_KEY17_R_RET:
17254  0000737                   
17255  0000737                   CHK_KEY17_QUIT:
17256  0000737                   .ENDIF
17257  0000737                   .IF(C_S_KEY18_ENABLE .EQ. 1)
17258  0000737                   ;check KEY18
17259  0000737                   CHK_KEY18:
17260  0000737                   	LDA	#B_S_KEY18





17261  0000737                   	BIT	!SR_S_KEY18_PORT
17262  0000737                   	BNE	CHK_KEY18_HIGH
17263  0000737                   ;LOW
17264  0000737                   	BIT	<R_S_KEY18_STATUS
17265  0000737                   	BEQ	CHK_KEY18_QUIT
17266  0000737                   	LDA	<R_S_KEY18_DEBOUNCE
17267  0000737                   	BEQ	CHK_KEY18_LOW_S10
17268  0000737                   	INC	<R_S_KEY18_DEBOUNCE
17269  0000737                   	BNE	CHK_KEY18_QUIT
17270  0000737                   ;GET KEY
17271  0000737                   	LDA	#B_S_KEY18
17272  0000737                   	TRB	<R_S_KEY18_STATUS
17273  0000737                   
17274  0000737                   	JMP	S_KEY18_F
17275  0000737                   
17276  0000737                   S_KEY18_F_RET:
17277  0000737                   	BRA	CHK_KEY18_QUIT
17278  0000737                   CHK_KEY18_LOW_S10:
17279  0000737                   	LDA	#C_S_KEY18_DEBOUNCE ; -DEBOUNCE * 5.33MS
17280  0000737                   	STA	<R_S_KEY18_DEBOUNCE
17281  0000737                   	BRA	CHK_KEY18_QUIT
17282  0000737                   CHK_KEY18_HIGH:
17283  0000737                   	STZ	R_S_KEY18_DEBOUNCE
17284  0000737                   	BIT	<R_S_KEY18_STATUS
17285  0000737                   	BNE	CHK_KEY18_QUIT
17286  0000737                   	TSB	<R_S_KEY18_STATUS
17287  0000737                   
17288  0000737                   	JMP	S_KEY18_R
17289  0000737                   
17290  0000737                   S_KEY18_R_RET:
17291  0000737                   
17292  0000737                   CHK_KEY18_QUIT:
17293  0000737                   .ENDIF
17294  0000737                   .IF(C_S_KEY19_ENABLE .EQ. 1)
17295  0000737                   ;check KEY19
17296  0000737                   CHK_KEY19:
17297  0000737                   	LDA	#B_S_KEY19
17298  0000737                   	BIT	!SR_S_KEY19_PORT
17299  0000737                   	BNE	CHK_KEY19_HIGH
17300  0000737                   ;LOW
17301  0000737                   	BIT	<R_S_KEY19_STATUS
17302  0000737                   	BEQ	CHK_KEY19_QUIT
17303  0000737                   	LDA	<R_S_KEY19_DEBOUNCE
17304  0000737                   	BEQ	CHK_KEY19_LOW_S10
17305  0000737                   	INC	<R_S_KEY19_DEBOUNCE
17306  0000737                   	BNE	CHK_KEY19_QUIT
17307  0000737                   ;GET KEY
17308  0000737                   	LDA	#B_S_KEY19
17309  0000737                   	TRB	<R_S_KEY19_STATUS
17310  0000737                   
17311  0000737                   	JMP	S_KEY19_F
17312  0000737                   
17313  0000737                   S_KEY19_F_RET:
17314  0000737                   	BRA	CHK_KEY19_QUIT
17315  0000737                   CHK_KEY19_LOW_S10:
17316  0000737                   	LDA	#C_S_KEY19_DEBOUNCE ; -DEBOUNCE * 5.33MS
17317  0000737                   	STA	<R_S_KEY19_DEBOUNCE





17318  0000737                   	BRA	CHK_KEY19_QUIT
17319  0000737                   CHK_KEY19_HIGH:
17320  0000737                   	STZ	R_S_KEY19_DEBOUNCE
17321  0000737                   	BIT	<R_S_KEY19_STATUS
17322  0000737                   	BNE	CHK_KEY19_QUIT
17323  0000737                   	TSB	<R_S_KEY19_STATUS
17324  0000737                   
17325  0000737                   	JMP	S_KEY19_R
17326  0000737                   
17327  0000737                   S_KEY19_R_RET:
17328  0000737                   
17329  0000737                   CHK_KEY19_QUIT:
17330  0000737                   .ENDIF
17331  0000737                   .IF(C_S_KEY20_ENABLE .EQ. 1)
17332  0000737                   ;check KEY20
17333  0000737                   CHK_KEY20:
17334  0000737                   	LDA	#B_S_KEY20
17335  0000737                   	BIT	!SR_S_KEY20_PORT
17336  0000737                   	BNE	CHK_KEY20_HIGH
17337  0000737                   ;LOW
17338  0000737                   	BIT	<R_S_KEY20_STATUS
17339  0000737                   	BEQ	CHK_KEY20_QUIT
17340  0000737                   	LDA	<R_S_KEY20_DEBOUNCE
17341  0000737                   	BEQ	CHK_KEY20_LOW_S10
17342  0000737                   	INC	<R_S_KEY20_DEBOUNCE
17343  0000737                   	BNE	CHK_KEY20_QUIT
17344  0000737                   ;GET KEY
17345  0000737                   	LDA	#B_S_KEY20
17346  0000737                   	TRB	<R_S_KEY20_STATUS
17347  0000737                   
17348  0000737                   	JMP	S_KEY20_F
17349  0000737                   
17350  0000737                   S_KEY20_F_RET:
17351  0000737                   	BRA	CHK_KEY20_QUIT
17352  0000737                   CHK_KEY20_LOW_S10:
17353  0000737                   	LDA	#C_S_KEY20_DEBOUNCE ; -DEBOUNCE * 5.33MS
17354  0000737                   	STA	<R_S_KEY20_DEBOUNCE
17355  0000737                   	BRA	CHK_KEY20_QUIT
17356  0000737                   CHK_KEY20_HIGH:
17357  0000737                   	STZ	R_S_KEY20_DEBOUNCE
17358  0000737                   	BIT	<R_S_KEY20_STATUS
17359  0000737                   	BNE	CHK_KEY20_QUIT
17360  0000737                   	TSB	<R_S_KEY20_STATUS
17361  0000737                   
17362  0000737                   	JMP	S_KEY20_R
17363  0000737                   
17364  0000737                   S_KEY20_R_RET:
17365  0000737                   
17366  0000737                   CHK_KEY20_QUIT:
17367  0000737                   .ENDIF
17368  0000737                   .IF(C_S_KEY21_ENABLE .EQ. 1)
17369  0000737                   ;check KEY21
17370  0000737                   CHK_KEY21:
17371  0000737                   	LDA	#B_S_KEY21
17372  0000737                   	BIT	!SR_S_KEY21_PORT
17373  0000737                   	BNE	CHK_KEY21_HIGH
17374  0000737                   ;LOW





17375  0000737                   	BIT	<R_S_KEY21_STATUS
17376  0000737                   	BEQ	CHK_KEY21_QUIT
17377  0000737                   	LDA	<R_S_KEY21_DEBOUNCE
17378  0000737                   	BEQ	CHK_KEY21_LOW_S10
17379  0000737                   	INC	<R_S_KEY21_DEBOUNCE
17380  0000737                   	BNE	CHK_KEY21_QUIT
17381  0000737                   ;GET KEY
17382  0000737                   	LDA	#B_S_KEY21
17383  0000737                   	TRB	<R_S_KEY21_STATUS
17384  0000737                   
17385  0000737                   	JMP	S_KEY21_F
17386  0000737                   
17387  0000737                   S_KEY21_F_RET:
17388  0000737                   	BRA	CHK_KEY21_QUIT
17389  0000737                   CHK_KEY21_LOW_S10:
17390  0000737                   	LDA	#C_S_KEY21_DEBOUNCE ; -DEBOUNCE * 5.33MS
17391  0000737                   	STA	<R_S_KEY21_DEBOUNCE
17392  0000737                   	BRA	CHK_KEY21_QUIT
17393  0000737                   CHK_KEY21_HIGH:
17394  0000737                   	STZ	R_S_KEY21_DEBOUNCE
17395  0000737                   	BIT	<R_S_KEY21_STATUS
17396  0000737                   	BNE	CHK_KEY21_QUIT
17397  0000737                   	TSB	<R_S_KEY21_STATUS
17398  0000737                   
17399  0000737                   	JMP	S_KEY21_R
17400  0000737                   
17401  0000737                   S_KEY21_R_RET:
17402  0000737                   
17403  0000737                   CHK_KEY21_QUIT:
17404  0000737                   .ENDIF
17405  0000737                   .IF(C_S_KEY22_ENABLE .EQ. 1)
17406  0000737                   ;check KEY22
17407  0000737                   CHK_KEY22:
17408  0000737                   	LDA	#B_S_KEY22
17409  0000737                   	BIT	!SR_S_KEY22_PORT
17410  0000737                   	BNE	CHK_KEY22_HIGH
17411  0000737                   ;LOW
17412  0000737                   	BIT	<R_S_KEY22_STATUS
17413  0000737                   	BEQ	CHK_KEY22_QUIT
17414  0000737                   	LDA	<R_S_KEY22_DEBOUNCE
17415  0000737                   	BEQ	CHK_KEY22_LOW_S10
17416  0000737                   	INC	<R_S_KEY22_DEBOUNCE
17417  0000737                   	BNE	CHK_KEY22_QUIT
17418  0000737                   ;GET KEY
17419  0000737                   	LDA	#B_S_KEY22
17420  0000737                   	TRB	<R_S_KEY22_STATUS
17421  0000737                   
17422  0000737                   	JMP	S_KEY22_F
17423  0000737                   
17424  0000737                   S_KEY22_F_RET:
17425  0000737                   	BRA	CHK_KEY22_QUIT
17426  0000737                   CHK_KEY22_LOW_S10:
17427  0000737                   	LDA	#C_S_KEY22_DEBOUNCE ; -DEBOUNCE * 5.33MS
17428  0000737                   	STA	<R_S_KEY22_DEBOUNCE
17429  0000737                   	BRA	CHK_KEY22_QUIT
17430  0000737                   CHK_KEY22_HIGH:
17431  0000737                   	STZ	R_S_KEY22_DEBOUNCE





17432  0000737                   	BIT	<R_S_KEY22_STATUS
17433  0000737                   	BNE	CHK_KEY22_QUIT
17434  0000737                   	TSB	<R_S_KEY22_STATUS
17435  0000737                   
17436  0000737                   	JMP	S_KEY22_R
17437  0000737                   
17438  0000737                   S_KEY22_R_RET:
17439  0000737                   
17440  0000737                   CHK_KEY22_QUIT:
17441  0000737                   .ENDIF
17442  0000737                   .IF(C_S_KEY23_ENABLE .EQ. 1)
17443  0000737                   ;check KEY23
17444  0000737                   CHK_KEY23:
17445  0000737                   	LDA	#B_S_KEY23
17446  0000737                   	BIT	!SR_S_KEY23_PORT
17447  0000737                   	BNE	CHK_KEY23_HIGH
17448  0000737                   ;LOW
17449  0000737                   	BIT	<R_S_KEY23_STATUS
17450  0000737                   	BEQ	CHK_KEY23_QUIT
17451  0000737                   	LDA	<R_S_KEY23_DEBOUNCE
17452  0000737                   	BEQ	CHK_KEY23_LOW_S10
17453  0000737                   	INC	<R_S_KEY23_DEBOUNCE
17454  0000737                   	BNE	CHK_KEY23_QUIT
17455  0000737                   ;GET KEY
17456  0000737                   	LDA	#B_S_KEY23
17457  0000737                   	TRB	<R_S_KEY23_STATUS
17458  0000737                   
17459  0000737                   	JMP	S_KEY23_F
17460  0000737                   
17461  0000737                   S_KEY23_F_RET:
17462  0000737                   	BRA	CHK_KEY23_QUIT
17463  0000737                   CHK_KEY23_LOW_S10:
17464  0000737                   	LDA	#C_S_KEY23_DEBOUNCE ; -DEBOUNCE * 5.33MS
17465  0000737                   	STA	<R_S_KEY23_DEBOUNCE
17466  0000737                   	BRA	CHK_KEY23_QUIT
17467  0000737                   CHK_KEY23_HIGH:
17468  0000737                   	STZ	R_S_KEY23_DEBOUNCE
17469  0000737                   	BIT	<R_S_KEY23_STATUS
17470  0000737                   	BNE	CHK_KEY23_QUIT
17471  0000737                   	TSB	<R_S_KEY23_STATUS
17472  0000737                   
17473  0000737                   	JMP	S_KEY23_R
17474  0000737                   
17475  0000737                   S_KEY23_R_RET:
17476  0000737                   
17477  0000737                   CHK_KEY23_QUIT:
17478  0000737                   .ENDIF
17479  0000737                   .IF(C_S_KEY24_ENABLE .EQ. 1)
17480  0000737                   ;check KEY24
17481  0000737                   CHK_KEY24:
17482  0000737                   	LDA	#B_S_KEY24
17483  0000737                   	BIT	!SR_S_KEY24_PORT
17484  0000737                   	BNE	CHK_KEY24_HIGH
17485  0000737                   ;LOW
17486  0000737                   	BIT	<R_S_KEY24_STATUS
17487  0000737                   	BEQ	CHK_KEY24_QUIT
17488  0000737                   	LDA	<R_S_KEY24_DEBOUNCE





17489  0000737                   	BEQ	CHK_KEY24_LOW_S10
17490  0000737                   	INC	<R_S_KEY24_DEBOUNCE
17491  0000737                   	BNE	CHK_KEY24_QUIT
17492  0000737                   ;GET KEY
17493  0000737                   	LDA	#B_S_KEY24
17494  0000737                   	TRB	<R_S_KEY24_STATUS
17495  0000737                   
17496  0000737                   	JMP	S_KEY24_F
17497  0000737                   
17498  0000737                   S_KEY24_F_RET:
17499  0000737                   	BRA	CHK_KEY24_QUIT
17500  0000737                   CHK_KEY24_LOW_S10:
17501  0000737                   	LDA	#C_S_KEY24_DEBOUNCE ; -DEBOUNCE * 5.33MS
17502  0000737                   	STA	<R_S_KEY24_DEBOUNCE
17503  0000737                   	BRA	CHK_KEY24_QUIT
17504  0000737                   CHK_KEY24_HIGH:
17505  0000737                   	STZ	R_S_KEY24_DEBOUNCE
17506  0000737                   	BIT	<R_S_KEY24_STATUS
17507  0000737                   	BNE	CHK_KEY24_QUIT
17508  0000737                   	TSB	<R_S_KEY24_STATUS
17509  0000737                   
17510  0000737                   	JMP	S_KEY24_R
17511  0000737                   
17512  0000737                   S_KEY24_R_RET:
17513  0000737                   
17514  0000737                   CHK_KEY24_QUIT:
17515  0000737                   .ENDIF
17516  0000737  60           	RTS
17517  0000738                   
17518  0000738                   
17519  0000738                   
17520  0000738                   	INCLUDE	"D:\ASM_SAVE_BACKUP\NUVOTON8BIT\N588H_TEMPLATE\N588H340_NUIDE V3.06.012_SDS3.12.001_CS V1.6.1.4\INCLUDE\CHKSKEY_USER.ASM.APP"
17521  0000738                   
17522  0000738                   
17523  0000738                   ;==============================
17524  0000738                   ;=================================
17525  0000738                   ;	¼ì²éµ¥¶ÀÀ­ÏßµÄ°´¼ü
17526  0000738                   ;=================================
17527  0000738                   
17528  0000738                   WAITKEY_FXF15_PCC_CHKSKEY EQU C_TRUE
17529  0000738                   .IF(WAITKEY_FXF15_PCC_CHKSKEY.EQ.C_FALSE)
17530  0000738                   	JSR	BK0_SCAN_S_KEY
17531  0000738                   .ENDIF;WAITKEY_FXF15_PCC_CHKSKEY
17532  0000738                   
17533  0000738                   ENTERN_STOP_PRE_PCC_CHKSKEY EQU C_TRUE
17534  0000738                   .IF(ENTERN_STOP_PRE_PCC_CHKSKEY.EQ.C_FALSE)
17535  0000738                   	JSR	BK0_CHKSKEY_CLR_DEB
17536  0000738                   .ENDIF;ENTERN_STOP_PRE_PCC_CHKSKEY
17537  0000738                   
17538  0000738                   POI_MODULE_PCC_CHKSKEY EQU C_TRUE
17539  0000738                   .IF(POI_MODULE_PCC_CHKSKEY.EQ.C_FALSE)
17540  0000738                   ;CHKSKEY
17541  0000738                   	NOP
17542  0000738                   .ENDIF;POI_MODULE_PCC_CHKSKEY
17543  0000738                   ;
17544  0000738                   ;Èç¹ûÔÚreleaseµÄÊ±ºòÉèÖÃÐÝÃßÊ±¼ä×¢Òâ£ºÈç¹ûÔÚ°´×¡¼üÐÝÃß£¬ËÉ¿ª¼ü»½ÐÑÊ±»á±»ÉèÖÃÐÝÃßÊ±¼ä¡£
17545  0000738                   ;





17546  0000738                   .IF(C_S_KEY1_ENABLE .EQ. 1)
17547  0000738                   S_KEY1_F:
17548  0000738                   S_KEY1_F_PCC:
17549  0000738                   
17550  0000738                   
17551  0000738  4C F5 06     	JMP	S_KEY1_F_RET
17552  000073B                   S_KEY1_R:
17553  000073B                   S_KEY1_R_PCC:
17554  000073B                   
17555  000073B  4C 09 07     	JMP	S_KEY1_R_RET
17556  000073E                   .ENDIF
17557  000073E                   
17558  000073E                   .IF(C_S_KEY2_ENABLE .EQ. 1)
17559  000073E                   S_KEY2_F:
17560  000073E                   S_KEY2_F_PCC:
17561  000073E                   
17562  000073E                   
17563  000073E  4C 23 07     	JMP	S_KEY2_F_RET
17564  0000741                   S_KEY2_R:
17565  0000741                   S_KEY2_R_PCC:
17566  0000741                   
17567  0000741  4C 37 07     	JMP	S_KEY2_R_RET
17568  0000744                   .ENDIF
17569  0000744                   
17570  0000744                   .IF(C_S_KEY3_ENABLE .EQ. 1)
17571  0000744                   S_KEY3_F:
17572  0000744                   S_KEY3_F_PCC:
17573  0000744                   
17574  0000744                   	JMP	S_KEY3_F_RET
17575  0000744                   S_KEY3_R:
17576  0000744                   S_KEY3_R_PCC:
17577  0000744                   
17578  0000744                   	JMP	S_KEY3_R_RET
17579  0000744                   .ENDIF
17580  0000744                   
17581  0000744                   .IF(C_S_KEY4_ENABLE .EQ. 1)
17582  0000744                   S_KEY4_F:
17583  0000744                   S_KEY4_F_PCC:
17584  0000744                   
17585  0000744                   	JMP	S_KEY4_F_RET
17586  0000744                   S_KEY4_R:
17587  0000744                   S_KEY4_R_PCC:
17588  0000744                   
17589  0000744                   
17590  0000744                   	JMP	S_KEY4_R_RET
17591  0000744                   .ENDIF
17592  0000744                   
17593  0000744                   .IF(C_S_KEY5_ENABLE .EQ. 1)
17594  0000744                   S_KEY5_F:
17595  0000744                   S_KEY5_F_PCC:
17596  0000744                   
17597  0000744                   	JMP	S_KEY5_F_RET
17598  0000744                   S_KEY5_R:
17599  0000744                   S_KEY5_R_PCC:
17600  0000744                   
17601  0000744                   	JMP	S_KEY5_R_RET
17602  0000744                   .ENDIF





17603  0000744                   
17604  0000744                   .IF(C_S_KEY6_ENABLE .EQ. 1)
17605  0000744                   S_KEY6_F:
17606  0000744                   S_KEY6_F_PCC:
17607  0000744                   
17608  0000744                   	JMP	S_KEY6_F_RET
17609  0000744                   S_KEY6_R:
17610  0000744                   S_KEY6_R_PCC:
17611  0000744                   
17612  0000744                   	JMP	S_KEY6_R_RET
17613  0000744                   .ENDIF
17614  0000744                   
17615  0000744                   .IF(C_S_KEY7_ENABLE .EQ. 1)
17616  0000744                   S_KEY7_F:
17617  0000744                   S_KEY7_F_PCC:
17618  0000744                   
17619  0000744                   	JMP	S_KEY7_F_RET
17620  0000744                   S_KEY7_R:
17621  0000744                   S_KEY7_R_PCC:
17622  0000744                   
17623  0000744                   	JMP	S_KEY7_R_RET
17624  0000744                   .ENDIF
17625  0000744                   
17626  0000744                   .IF(C_S_KEY8_ENABLE .EQ. 1)
17627  0000744                   S_KEY8_F:
17628  0000744                   S_KEY8_F_PCC:
17629  0000744                   
17630  0000744                   	JMP	S_KEY8_F_RET
17631  0000744                   S_KEY8_R:
17632  0000744                   S_KEY8_R_PCC:
17633  0000744                   
17634  0000744                   	JMP	S_KEY8_R_RET
17635  0000744                   .ENDIF
17636  0000744                   
17637  0000744                   .IF(C_S_KEY9_ENABLE .EQ. 1)
17638  0000744                   S_KEY9_F:
17639  0000744                   S_KEY9_F_PCC:
17640  0000744                   
17641  0000744                   
17642  0000744                   	JMP	S_KEY9_F_RET
17643  0000744                   S_KEY9_R:
17644  0000744                   S_KEY9_R_PCC:
17645  0000744                   
17646  0000744                   	JMP	S_KEY9_R_RET
17647  0000744                   .ENDIF
17648  0000744                   
17649  0000744                   .IF(C_S_KEY10_ENABLE .EQ. 1)
17650  0000744                   S_KEY10_F:
17651  0000744                   S_KEY10_F_PCC:
17652  0000744                   
17653  0000744                   
17654  0000744                   	JMP	S_KEY10_F_RET
17655  0000744                   S_KEY10_R:
17656  0000744                   S_KEY10_R_PCC:
17657  0000744                   
17658  0000744                   	JMP	S_KEY10_R_RET
17659  0000744                   .ENDIF





17660  0000744                   
17661  0000744                   .IF(C_S_KEY11_ENABLE .EQ. 1)
17662  0000744                   S_KEY11_F:
17663  0000744                   S_KEY11_F_PCC:
17664  0000744                   
17665  0000744                   
17666  0000744                   	JMP	S_KEY11_F_RET
17667  0000744                   S_KEY11_R:
17668  0000744                   S_KEY11_R_PCC:
17669  0000744                   
17670  0000744                   	JMP	S_KEY11_R_RET
17671  0000744                   .ENDIF
17672  0000744                   
17673  0000744                   .IF(C_S_KEY12_ENABLE .EQ. 1)
17674  0000744                   S_KEY12_F:
17675  0000744                   S_KEY12_F_PCC:
17676  0000744                   
17677  0000744                   	JMP	S_KEY12_F_RET
17678  0000744                   S_KEY12_R:
17679  0000744                   S_KEY12_R_PCC:
17680  0000744                   
17681  0000744                   	JMP	S_KEY12_R_RET
17682  0000744                   .ENDIF
17683  0000744                   
17684  0000744                   .IF(C_S_KEY13_ENABLE .EQ. 1)
17685  0000744                   S_KEY13_F:
17686  0000744                   S_KEY13_F_PCC:
17687  0000744                   
17688  0000744                   	JMP	S_KEY13_F_RET
17689  0000744                   S_KEY13_R:
17690  0000744                   S_KEY13_R_PCC:
17691  0000744                   
17692  0000744                   	JMP	S_KEY13_R_RET
17693  0000744                   .ENDIF
17694  0000744                   
17695  0000744                   .IF(C_S_KEY14_ENABLE .EQ. 1)
17696  0000744                   S_KEY14_F:
17697  0000744                   S_KEY14_F_PCC:
17698  0000744                   
17699  0000744                   	JMP	S_KEY14_F_RET
17700  0000744                   S_KEY14_R:
17701  0000744                   S_KEY14_R_PCC:
17702  0000744                   
17703  0000744                   	JMP	S_KEY14_R_RET
17704  0000744                   .ENDIF
17705  0000744                   
17706  0000744                   .IF(C_S_KEY15_ENABLE .EQ. 1)
17707  0000744                   S_KEY15_F:
17708  0000744                   S_KEY15_F_PCC:
17709  0000744                   
17710  0000744                   	JMP	S_KEY15_F_RET
17711  0000744                   S_KEY15_R:
17712  0000744                   S_KEY15_R_PCC:
17713  0000744                   
17714  0000744                   	JMP	S_KEY15_R_RET
17715  0000744                   .ENDIF
17716  0000744                   





17717  0000744                   .IF(C_S_KEY16_ENABLE .EQ. 1)
17718  0000744                   S_KEY16_F:
17719  0000744                   S_KEY16_F_PCC:
17720  0000744                   
17721  0000744                   	JMP	S_KEY16_F_RET
17722  0000744                   S_KEY16_R:
17723  0000744                   S_KEY16_R_PCC:
17724  0000744                   
17725  0000744                   	JMP	S_KEY16_R_RET
17726  0000744                   .ENDIF
17727  0000744                   
17728  0000744                   .IF(C_S_KEY17_ENABLE .EQ. 1)
17729  0000744                   S_KEY17_F:
17730  0000744                   S_KEY17_F_PCC:
17731  0000744                   
17732  0000744                   	JMP	S_KEY17_F_RET
17733  0000744                   S_KEY17_R:
17734  0000744                   S_KEY17_R_PCC:
17735  0000744                   
17736  0000744                   	JMP	S_KEY17_R_RET
17737  0000744                   .ENDIF
17738  0000744                   
17739  0000744                   .IF(C_S_KEY18_ENABLE .EQ. 1)
17740  0000744                   S_KEY18_F:
17741  0000744                   S_KEY18_F_PCC:
17742  0000744                   
17743  0000744                   	JMP	S_KEY18_F_RET
17744  0000744                   S_KEY18_R:
17745  0000744                   S_KEY18_R_PCC:
17746  0000744                   
17747  0000744                   	JMP	S_KEY18_R_RET
17748  0000744                   .ENDIF
17749  0000744                   
17750  0000744                   .IF(C_S_KEY19_ENABLE .EQ. 1)
17751  0000744                   S_KEY19_F:
17752  0000744                   S_KEY19_F_PCC:
17753  0000744                   
17754  0000744                   	JMP	S_KEY19_F_RET
17755  0000744                   S_KEY19_R:
17756  0000744                   S_KEY19_R_PCC:
17757  0000744                   
17758  0000744                   	JMP	S_KEY19_R_RET
17759  0000744                   .ENDIF
17760  0000744                   
17761  0000744                   .IF(C_S_KEY20_ENABLE .EQ. 1)
17762  0000744                   S_KEY20_F:
17763  0000744                   S_KEY20_F_PCC:
17764  0000744                   
17765  0000744                   	JMP	S_KEY20_F_RET
17766  0000744                   S_KEY20_R:
17767  0000744                   S_KEY20_R_PCC:
17768  0000744                   
17769  0000744                   	JMP	S_KEY20_R_RET
17770  0000744                   .ENDIF
17771  0000744                   
17772  0000744                   .IF(C_S_KEY21_ENABLE .EQ. 1)
17773  0000744                   S_KEY21_F:





17774  0000744                   S_KEY21_F_PCC:
17775  0000744                   
17776  0000744                   	JMP	S_KEY21_F_RET
17777  0000744                   S_KEY21_R:
17778  0000744                   S_KEY21_R_PCC:
17779  0000744                   
17780  0000744                   	JMP	S_KEY21_R_RET
17781  0000744                   .ENDIF
17782  0000744                   
17783  0000744                   .IF(C_S_KEY22_ENABLE .EQ. 1)
17784  0000744                   S_KEY22_F:
17785  0000744                   S_KEY22_F_PCC:
17786  0000744                   
17787  0000744                   	JMP	S_KEY22_F_RET
17788  0000744                   S_KEY22_R:
17789  0000744                   S_KEY22_R_PCC:
17790  0000744                   
17791  0000744                   	JMP	S_KEY22_R_RET
17792  0000744                   .ENDIF
17793  0000744                   
17794  0000744                   .IF(C_S_KEY23_ENABLE .EQ. 1)
17795  0000744                   S_KEY23_F:
17796  0000744                   S_KEY23_F_PCC:
17797  0000744                   
17798  0000744                   	JMP	S_KEY23_F_RET
17799  0000744                   S_KEY23_R:
17800  0000744                   S_KEY23_R_PCC:
17801  0000744                   
17802  0000744                   	JMP	S_KEY23_R_RET
17803  0000744                   .ENDIF
17804  0000744                   
17805  0000744                   .IF(C_S_KEY24_ENABLE .EQ. 1)
17806  0000744                   S_KEY24_F:
17807  0000744                   S_KEY24_F_PCC:
17808  0000744                   
17809  0000744                   	JMP	S_KEY24_F_RET
17810  0000744                   S_KEY24_R:
17811  0000744                   S_KEY24_R_PCC:
17812  0000744                   
17813  0000744                   	JMP	S_KEY24_R_RET
17814  0000744                   .ENDIF
17815  0000744                   
17816  0000744                   BK0_CHKSKEY_CLR_DEB:
17817  0000744                   .IF ( C_S_KEY1_ENABLE .EQ. 1)
17818  0000744  9C 15 00     	STZ	R_S_KEY1_DEBOUNCE
17819  0000747                   .ENDIF
17820  0000747                   .IF ( C_S_KEY2_ENABLE .EQ. 1)
17821  0000747  9C 16 00     	STZ	R_S_KEY2_DEBOUNCE
17822  000074A                   .ENDIF
17823  000074A                   .IF ( C_S_KEY3_ENABLE .EQ. 1)
17824  000074A                   	STZ	R_S_KEY3_DEBOUNCE
17825  000074A                   .ENDIF
17826  000074A                   .IF ( C_S_KEY4_ENABLE .EQ. 1)
17827  000074A                   	STZ	R_S_KEY4_DEBOUNCE
17828  000074A                   .ENDIF
17829  000074A                   .IF ( C_S_KEY5_ENABLE .EQ. 1)
17830  000074A                   	STZ	R_S_KEY5_DEBOUNCE





17831  000074A                   .ENDIF
17832  000074A                   .IF ( C_S_KEY6_ENABLE .EQ. 1)
17833  000074A                   	STZ	R_S_KEY6_DEBOUNCE
17834  000074A                   .ENDIF
17835  000074A                   .IF ( C_S_KEY7_ENABLE .EQ. 1)
17836  000074A                   	STZ	R_S_KEY7_DEBOUNCE
17837  000074A                   .ENDIF
17838  000074A                   .IF ( C_S_KEY8_ENABLE .EQ. 1)
17839  000074A                   	STZ	R_S_KEY8_DEBOUNCE
17840  000074A                   .ENDIF
17841  000074A                   .IF ( C_S_KEY9_ENABLE .EQ. 1)
17842  000074A                   	STZ	R_S_KEY9_DEBOUNCE
17843  000074A                   .ENDIF
17844  000074A                   .IF ( C_S_KEY10_ENABLE .EQ. 1)
17845  000074A                   	STZ	R_S_KEY10_DEBOUNCE
17846  000074A                   .ENDIF
17847  000074A                   .IF ( C_S_KEY11_ENABLE .EQ. 1)
17848  000074A                   	STZ	R_S_KEY11_DEBOUNCE
17849  000074A                   .ENDIF
17850  000074A                   .IF ( C_S_KEY12_ENABLE .EQ. 1)
17851  000074A                   	STZ	R_S_KEY12_DEBOUNCE
17852  000074A                   .ENDIF
17853  000074A                   .IF ( C_S_KEY13_ENABLE .EQ. 1)
17854  000074A                   	STZ	R_S_KEY13_DEBOUNCE
17855  000074A                   .ENDIF
17856  000074A                   .IF ( C_S_KEY14_ENABLE .EQ. 1)
17857  000074A                   	STZ	R_S_KEY14_DEBOUNCE
17858  000074A                   .ENDIF
17859  000074A                   .IF ( C_S_KEY15_ENABLE .EQ. 1)
17860  000074A                   	STZ	R_S_KEY15_DEBOUNCE
17861  000074A                   .ENDIF
17862  000074A                   .IF ( C_S_KEY16_ENABLE .EQ. 1)
17863  000074A                   	STZ	R_S_KEY16_DEBOUNCE
17864  000074A                   .ENDIF
17865  000074A                   .IF ( C_S_KEY17_ENABLE .EQ. 1)
17866  000074A                   	STZ	R_S_KEY17_DEBOUNCE
17867  000074A                   .ENDIF
17868  000074A                   .IF ( C_S_KEY18_ENABLE .EQ. 1)
17869  000074A                   	STZ	R_S_KEY18_DEBOUNCE
17870  000074A                   .ENDIF
17871  000074A                   .IF ( C_S_KEY19_ENABLE .EQ. 1)
17872  000074A                   	STZ	R_S_KEY19_DEBOUNCE
17873  000074A                   .ENDIF
17874  000074A                   .IF ( C_S_KEY20_ENABLE .EQ. 1)
17875  000074A                   	STZ	R_S_KEY20_DEBOUNCE
17876  000074A                   .ENDIF
17877  000074A                   .IF ( C_S_KEY21_ENABLE .EQ. 1)
17878  000074A                   	STZ	R_S_KEY21_DEBOUNCE
17879  000074A                   .ENDIF
17880  000074A                   .IF ( C_S_KEY22_ENABLE .EQ. 1)
17881  000074A                   	STZ	R_S_KEY22_DEBOUNCE
17882  000074A                   .ENDIF
17883  000074A                   .IF ( C_S_KEY23_ENABLE .EQ. 1)
17884  000074A                   	STZ	R_S_KEY23_DEBOUNCE
17885  000074A                   .ENDIF
17886  000074A                   .IF ( C_S_KEY24_ENABLE .EQ. 1)
17887  000074A                   	STZ	R_S_KEY24_DEBOUNCE





17888  000074A                   .ENDIF
17889  000074A  60           	RTS
17890  000074B                   
17891  000074B                   
17892  000074B                   
17893  000074B                   
17894  000074B                   
17895  000074B                   
17896  000074B                   ;------ original code start ------
17897  000074B                   MAIN_LOOP:
17898  000074B  A9 02			LDA #CTL_CPU_WDT
17899  000074D  0C 0F 08     	TSB !CTL_CPU
17900  0000750                   
17901  0000750                   	.IF(WITH_FW_CAP_SENSOR_KEYS .GT. 0)
17902  0000750                   	    CAP_SENSOR_ACTION    
17903  0000750                   	    CAP_SENSOR_KEY_DETECTION  
17904  0000750                   	.ENDIF
17905  0000750                   
17906  0000750                   	.IF (N55P_DEVICE_UIO_USED .GT. 0H)
17907  0000750                   	    N55P_EXPANDER_PROCESS
17908  0000750                   	.ENDIF
17909  0000750                   
17910  0000750  4C 4B 07     	JMP	MAIN_LOOP
17911  0000753                   ;============================================;
17912  0000753                   ; CAP SENSOR KEYS LABLE LIST
17913  0000753                   ;============================================;
17914  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY1
17915  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY2
17916  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY3
17917  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY4
17918  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY5
17919  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY6
17920  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY7
17921  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY8
17922  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY9
17923  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY10
17924  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY11
17925  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY12
17926  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY13
17927  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY14
17928  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY15
17929  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY16
17930  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY17
17931  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY18
17932  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY19
17933  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY20
17934  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY21
17935  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY22
17936  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY23
17937  0000753                        PUBLIC     CAP_SENSOR_TOUCHED_KEY24
17938  0000753                   
17939  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY1
17940  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY2
17941  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY3
17942  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY4
17943  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY5
17944  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY6





17945  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY7
17946  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY8
17947  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY9
17948  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY10
17949  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY11
17950  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY12
17951  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY13
17952  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY14
17953  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY15
17954  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY16
17955  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY17
17956  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY18
17957  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY19
17958  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY20
17959  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY21
17960  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY22
17961  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY23
17962  0000753                        PUBLIC     CAP_SENSOR_UNTOUCHED_KEY24
17963  0000753                   ;============================================;
17964  0000753                   ; Touched Key Labels                         ;
17965  0000753                   ;============================================;
17966  0000753                   CAP_SENSOR_TOUCHED_KEY1:
17967  0000753  60                RTS
17968  0000754                   
17969  0000754                   CAP_SENSOR_TOUCHED_KEY2:
17970  0000754  60                RTS
17971  0000755                   
17972  0000755                   CAP_SENSOR_TOUCHED_KEY3:
17973  0000755  60                RTS
17974  0000756                   
17975  0000756                   CAP_SENSOR_TOUCHED_KEY4:
17976  0000756  60                RTS
17977  0000757                   
17978  0000757                   CAP_SENSOR_TOUCHED_KEY5:
17979  0000757  60                RTS
17980  0000758                   
17981  0000758                   CAP_SENSOR_TOUCHED_KEY6:
17982  0000758  60                RTS
17983  0000759                   
17984  0000759                   CAP_SENSOR_TOUCHED_KEY7:
17985  0000759  60                RTS
17986  000075A                   
17987  000075A                   CAP_SENSOR_TOUCHED_KEY8:
17988  000075A  60                RTS
17989  000075B                   
17990  000075B                   CAP_SENSOR_TOUCHED_KEY9:
17991  000075B  60                RTS
17992  000075C                   
17993  000075C                   CAP_SENSOR_TOUCHED_KEY10:
17994  000075C  60                RTS
17995  000075D                   
17996  000075D                   CAP_SENSOR_TOUCHED_KEY11:
17997  000075D  60                RTS
17998  000075E                   
17999  000075E                   CAP_SENSOR_TOUCHED_KEY12:
18000  000075E  60                RTS
18001  000075F                   





18002  000075F                   CAP_SENSOR_TOUCHED_KEY13:
18003  000075F  60                RTS
18004  0000760                   
18005  0000760                   CAP_SENSOR_TOUCHED_KEY14:
18006  0000760  60                RTS
18007  0000761                   
18008  0000761                   CAP_SENSOR_TOUCHED_KEY15:
18009  0000761  60                RTS
18010  0000762                   
18011  0000762                   CAP_SENSOR_TOUCHED_KEY16:
18012  0000762  60                RTS
18013  0000763                   
18014  0000763                   CAP_SENSOR_TOUCHED_KEY17:
18015  0000763  60                RTS
18016  0000764                   
18017  0000764                   CAP_SENSOR_TOUCHED_KEY18:
18018  0000764  60                RTS
18019  0000765                   
18020  0000765                   CAP_SENSOR_TOUCHED_KEY19:
18021  0000765  60                RTS
18022  0000766                   
18023  0000766                   CAP_SENSOR_TOUCHED_KEY20:
18024  0000766  60                RTS
18025  0000767                   
18026  0000767                   CAP_SENSOR_TOUCHED_KEY21:
18027  0000767  60                RTS
18028  0000768                   
18029  0000768                   CAP_SENSOR_TOUCHED_KEY22:
18030  0000768  60                RTS
18031  0000769                   
18032  0000769                   CAP_SENSOR_TOUCHED_KEY23:
18033  0000769  60                RTS
18034  000076A                   
18035  000076A                   CAP_SENSOR_TOUCHED_KEY24:
18036  000076A  60                RTS
18037  000076B                   ;============================================;
18038  000076B                   ; Un-Touched Key Labels                      ;
18039  000076B                   ;============================================;
18040  000076B                   CAP_SENSOR_UNTOUCHED_KEY1:
18041  000076B  60                RTS     
18042  000076C                   
18043  000076C                   CAP_SENSOR_UNTOUCHED_KEY2:
18044  000076C  60                RTS    
18045  000076D                   
18046  000076D                   CAP_SENSOR_UNTOUCHED_KEY3:
18047  000076D  60                RTS     
18048  000076E                   
18049  000076E                   CAP_SENSOR_UNTOUCHED_KEY4:
18050  000076E  60                RTS     
18051  000076F                   
18052  000076F                   CAP_SENSOR_UNTOUCHED_KEY5:
18053  000076F  60                RTS     
18054  0000770                   
18055  0000770                   CAP_SENSOR_UNTOUCHED_KEY6:
18056  0000770  60                RTS     
18057  0000771                   
18058  0000771                   CAP_SENSOR_UNTOUCHED_KEY7:





18059  0000771  60                RTS     
18060  0000772                   
18061  0000772                   CAP_SENSOR_UNTOUCHED_KEY8:
18062  0000772  60                RTS     
18063  0000773                   
18064  0000773                   CAP_SENSOR_UNTOUCHED_KEY9:
18065  0000773  60                RTS     
18066  0000774                   
18067  0000774                   CAP_SENSOR_UNTOUCHED_KEY10:
18068  0000774  60                RTS     
18069  0000775                   
18070  0000775                   CAP_SENSOR_UNTOUCHED_KEY11:
18071  0000775  60                RTS     
18072  0000776                   
18073  0000776                   CAP_SENSOR_UNTOUCHED_KEY12:
18074  0000776  60                RTS     
18075  0000777                   
18076  0000777                   CAP_SENSOR_UNTOUCHED_KEY13:
18077  0000777  60                RTS     
18078  0000778                   
18079  0000778                   CAP_SENSOR_UNTOUCHED_KEY14:
18080  0000778  60                RTS     
18081  0000779                   
18082  0000779                   CAP_SENSOR_UNTOUCHED_KEY15:
18083  0000779  60                RTS     
18084  000077A                   
18085  000077A                   CAP_SENSOR_UNTOUCHED_KEY16:
18086  000077A  60                RTS     
18087  000077B                   
18088  000077B                   CAP_SENSOR_UNTOUCHED_KEY17:
18089  000077B  60                RTS     
18090  000077C                   
18091  000077C                   CAP_SENSOR_UNTOUCHED_KEY18:
18092  000077C  60                RTS     
18093  000077D                   
18094  000077D                   CAP_SENSOR_UNTOUCHED_KEY19:
18095  000077D  60                RTS     
18096  000077E                   
18097  000077E                   CAP_SENSOR_UNTOUCHED_KEY20:
18098  000077E  60                RTS     
18099  000077F                   
18100  000077F                   CAP_SENSOR_UNTOUCHED_KEY21:
18101  000077F  60                RTS     
18102  0000780                   
18103  0000780                   CAP_SENSOR_UNTOUCHED_KEY22:
18104  0000780  60                RTS     
18105  0000781                   
18106  0000781                   CAP_SENSOR_UNTOUCHED_KEY23:
18107  0000781  60                RTS     
18108  0000782                   
18109  0000782                   CAP_SENSOR_UNTOUCHED_KEY24:
18110  0000782  60                RTS     
18111  0000783                   
18112  0000783                   	ENDS
18113  0000783                   ;==========================================================================
18114  0000783                   ;	ASSIGN INTERRUPT VECTORS INSIDE THIS SECTION
18115  0000783                   ;==========================================================================





18116  0000783                   	VECTOR:	SECTION	
18117  000098E                   	ORG	098EH
18118  000098E  0009            	DW	0900H			;IV OF BRK
18119  0000990  4800            	DW	TM0_ISR			;TIMER 0 ISR   ;DO NOT REMOVE
18120  0000992  7200            	DW 	TM1_ISR			;TIMER 1 ISR   ;DO NOT REMOVE
18121  0000994  3C00            	DW 	TMG0_ISR		;TIEMRG 0 ISR  ;DO NOT REMOVE
18122  0000996                   	.IF	 (PARTNO='N588H000')	
18123  0000996                   	DW 	TMG1_ISR		;TIMERG 1 ISR 
18124  0000996                   	.ENDIF
18125  0000996                   
18126  0000998                   	ORG	0998H
18127  0000998  1200            	DW	PORT_ISR		;DO NOT REMOVE
18128  000099A                   
18129  000099C                   	ORG 	099CH
18130  000099C  8200            	DW	MAIN_START		;IV OF RESET
18131  000099E  1A00            	DW 	IRQ_ISR			;IV OF IRQ
18132  00009A0                   	ENDS
18133  0000783                   ;**The following is audio external**
18134  0000783                   ;**The following is sentence label**
18135  0000783                   ;**The following is INIT_DECODE_SPEECH label**
18136  0000783                   	EXT_PROGRAM: SECTION
18137  0000000                   	ENDS
18138  0000783                   
		Line(s) Assembled : 18138
		Error(s): 0
		Warn(s) : 0
		Begin Assembling Time : Tue Oct 23 10:35:26 2018
		End   Assembling Time : Tue Oct 23 10:35:26 2018

