;=======================================
;	<< BK0S0.ASM >>
;===========================================
;
;6144khz : 10ms
;used: A,X
BK0_DELAY61440CYCLE: ;61440 INS cycle
	LDX	#48
BK0_DELAY61440CYCLE_S10:
	LDA	#0
BK0_DELAY61440CYCLE_S20
	INC	A;2
	BNE	BK0_DELAY61440CYCLE_S20;3
	
	MACRO_CLR_WDT

	DEX
	BNE	BK0_DELAY61440CYCLE_S10
	RTS
	
	

BK0_START_TMG0_2MS: ; 2MS
	LDA	#0100B  ; / 64
	STA	!TMG0C ; SET CLK
	LDA	#191 ; +1
	STA	!TMG0V
	LDA	#01H
	TSB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TSB	!IEF0
	RTS

BK0_START_TMG0_05MS_W_CHK:
	LDA	#01H
	BIT	TMG0C ;START
	BNE	BK0_START_TMG0_05MS_END
BK0_START_TMG0_05MS: ; 
	LDA	#0100B  ; / 64
	STA	!TMG0C ; SET CLK
	LDA	#47 ; +1
	STA	!TMG0V
	LDA	#01H
	TSB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TSB	!IEF0
BK0_START_TMG0_05MS_END:
	RTS

BK0_START_TMG0_0625MS: ; 2MS
	LDA	#0100B  ; / 64
	STA	!TMG0C ; SET CLK
	LDA	#59 ; +1
	STA	!TMG0V
	LDA	#01H
	TSB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TSB	!IEF0
	RTS
BK0_START_TMG0_0250MS: ; 
	LDA	#0100B  ; / 64
	STA	!TMG0C ; SET CLK
	LDA	#23 ; +1
	STA	!TMG0V
	LDA	#01H
	TSB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TSB	!IEF0
	RTS

BK0_START_TMG0_0125MS: ; 
	LDA	#0100B  ; / 64
	STA	!TMG0C ; SET CLK
	LDA	#11 ; +1
	STA	!TMG0V
	LDA	#01H
	TSB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TSB	!IEF0
	RTS


BK0_START_TMG0_07MS: ; 
	LDA	#0100B  ; / 64
	STA	!TMG0C ; SET CLK
	LDA	#67 ; +1
	STA	!TMG0V
	LDA	#01H
	TSB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TSB	!IEF0
	RTS
	
	
BK0_STOP_TMG0: ; 2MS
	LDA	#01H
	TRB	TMG0C ;START
	LDA	#TIMERG0_INT_BIT
	TRB	!IEF0
	RTS

;===================================
BK0_DELAY10US:
	LDA #5
	BRA	BK0_DELAY100US_S10


BK0_DELAY50US:
;6144KHz: 50US*6=300
;300/9=67
;
	LDA #33
	BRA	BK0_DELAY100US_S10

BK0_DELAY100US:
;6144KHz: 100US*6=600
;600/9=67
;
	LDA #67
BK0_DELAY100US_S10:
	NOP	; 2
	NOP	; 2
	DEC A		;2
	BNE BK0_DELAY100US_S10	;3
	RTS	; 1.5US


BK0_DELAY500US:
;6144KHz: 50US*6=300
;300/9=67
;
	LDA #120
	BRA	BK0_DELAY1000US_S10

BK0_DELAY1MS:
;6144KHz: 1000US*6=6000
;6000/25=240
;
	LDA #240
BK0_DELAY1000US_S10:
	NOP	; 2
	NOP	; 2
	NOP	; 2
	NOP	; 2
	NOP	; 2

	NOP	; 2
	NOP	; 2
	NOP	; 2
	NOP	; 2
	NOP	; 2
	
	DEC A		;2
	BNE BK0_DELAY1000US_S10	;3
	RTS	; 1.5US



;=========================
BK0_DELAY50MS:
	LDX	#250
	
BK0_DELAY50MS_S10:
	MACRO_CLR_WDT

	JSR	BK0_DELAY100US; A
	JSR	BK0_DELAY100US;	A
	DEX
	BNE	BK0_DELAY50MS_S10
	RTS

BK0_DELAY10MS:
	LDX	#50
BK0_DELAY10MS_S10:
	MACRO_CLR_WDT

	JSR	BK0_DELAY100US; A
	JSR	BK0_DELAY100US;	A
	DEX
	BNE	BK0_DELAY10MS_S10
	RTS

;====================================


BK0_STORE_BPX:
.IF ( C_BP0_STATUS_EN .EQ. 1 )
	LDA	!BP0
	STA	BP0_STATUS
.ENDIF
.IF ( C_BP1_STATUS_EN .EQ. 1 )
	LDA	!BP1
	STA	BP1_STATUS
.ENDIF
.IF ( C_BP2_STATUS_EN .EQ. 1 )
	LDA	!BP2
	STA	BP2_STATUS
.ENDIF
;
	RTS
;==========================

BK0_STORE_BPX_WO_BOND_PWOFF:
.IF ( C_BP0_STATUS_EN .EQ. 1 )
	LDA	BP0_STATUS
	AND	#C_BP0_BOND
	STA	BP0_STATUS
	LDA	#C_BP0_BOND
	EOR	#0FFH
	AND	!BP0
	ORA	BP0_STATUS
	STA	BP0_STATUS
.ENDIF
.IF ( C_BP1_STATUS_EN .EQ. 1 )
	LDA	BP1_STATUS
	AND	#C_BP1_BOND
	STA	BP1_STATUS
	LDA	#C_BP1_BOND
	EOR	#0FFH
	AND	!BP1
	ORA	BP1_STATUS
	STA	BP1_STATUS
.ENDIF
.IF ( C_BP2_STATUS_EN .EQ. 1 )
	LDA	BP2_STATUS
	AND	#C_BP2_BOND
	STA	BP2_STATUS
	LDA	#C_BP2_BOND
	EOR	#0FFH
	AND	!BP2
	ORA	BP2_STATUS
	STA	BP2_STATUS
.ENDIF
;


	RTS

